try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="58e6b071-82a6-4f75-94dd-d40acdd47a70",e._sentryDebugIdIdentifier="sentry-dbid-58e6b071-82a6-4f75-94dd-d40acdd47a70")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4842],{83250:function(e,t,s){"use strict";var a,r,n,i,l=s(55953);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(null,arguments)}t.Z=function(e){return l.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:109,height:113,fill:"none"},e),a||(a=l.createElement("path",{fill:"url(#supabase_logo_svg__a)",d:"M63.708 110.284c-2.86 3.601-8.658 1.628-8.727-2.97l-1.007-67.251h45.22c8.19 0 12.758 9.46 7.665 15.874z"})),r||(r=l.createElement("path",{fill:"url(#supabase_logo_svg__b)",fillOpacity:.2,d:"M63.708 110.284c-2.86 3.601-8.658 1.628-8.727-2.97l-1.007-67.251h45.22c8.19 0 12.758 9.46 7.665 15.874z"})),n||(n=l.createElement("path",{fill:"#3ECF8E",d:"M45.317 2.071c2.86-3.601 8.657-1.628 8.726 2.97l.442 67.251H9.83c-8.19 0-12.759-9.46-7.665-15.875z"})),i||(i=l.createElement("defs",null,l.createElement("linearGradient",{id:"supabase_logo_svg__a",x1:53.974,x2:94.163,y1:54.974,y2:71.829,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#249361"}),l.createElement("stop",{offset:1,stopColor:"#3ECF8E"})),l.createElement("linearGradient",{id:"supabase_logo_svg__b",x1:36.156,x2:54.484,y1:30.578,y2:65.081,gradientUnits:"userSpaceOnUse"},l.createElement("stop",null),l.createElement("stop",{offset:1,stopOpacity:0})))))}},21091:function(e,t,s){"use strict";s.d(t,{Y:function(){return _},f:function(){return j}});var a=s(52155),r=s(38109),n=s(98244),i=s(17779),l=s(19227),o=s(73207),d=s(99792),c=s(87294),u=s(4578),m=s(83250),p=s(21517),h=s(57480),x=s(70778),f=s(59253),g=s(73197);let v=new Set(["lov-view","lov-write","lov-search-replace","lov-line-replace","lov-delete","lov-rename"]),b=(e,t,s,a,r)=>{var n;if(null==t?void 0:null===(n=t.file_path)||void 0===n?void 0:n.startsWith("mem://")){if("lov-view"===e)return s?"Recalled memory":"Recalling memory";if(["lov-write","lov-search-replace","lov-line-replace"].includes(e))return s?"Updated memory":"Updating memory"}if(e.startsWith("stripe"))return(0,g.jN)(e);switch(e){case"read_file":case"lov-think":return s?a?"Thought for ".concat(a," second").concat(a>1?"s":""):"Finished thinking":"Thinking";case"lov-view":return s?"Read":"Reading";case"lov-rename":return s?"Renamed":"Renaming";case"lov-delete":return s?"Deleted":"Deleting";case"lov-write":case"lov-search-replace":case"lov-line-replace":return s?"Edited":"Editing";case"lov-add-dependency":return s?"Installed":"Installing";case"lov-remove-dependency":return s?"Uninstalled":"Uninstalling";case"lov-supabase-linter":case"supabase--linter":return"".concat(s?"Checked":"Checking"," performance and security");case"lov-search-files":return s?"Searched for":"Searching for";case"lov-list-dir":return s?"Listed":"Listing";case"lov-read-console-logs":case"lov-read-network-requests":return s?"Checked":"Checking";case"scrape_website":case"lov-fetch-website":return s?"Fetched":"Fetching";case"url_screenshot":case"lov-url-screenshot":return s?"Took screenshot of":"Taking screenshot of";case"lov-download-to-repo":return s?"Downloaded file":"Downloading";case"generate_image":case"imagegen--generate_image":return s?"Generated image":"Generating image";case"edit_image":case"imagegen--edit_image":return s?"Edited image":"Editing image";case"web_search":case"websearch--web_search":return s?"Searched":"Searching";case"supabase_read_query":case"supabase_analytics_query":case"lov-supabase-read-query":case"supabase--read-query":case"lov-supabase-analytics-query":case"supabase--analytics-query":case"lov-experimental-supabase-project-info":case"supabase--project-info":case"lov-experimental-supabase-read-query":case"supabase--read-query":return"".concat(s?"Looked":"Looking"," at ").concat(r?"Backend":"Supabase");case"lov-experimental-supabase-insert":case"lov-supabase-insert":case"supabase--insert":return"".concat(s?"Added":"Adding"," data to ").concat(r?"Backend":"Supabase");case"lov-supabase-migration":case"lov-experimental-supabase-migration":case"supabase--migration":return"".concat(s?"Wrote":"Writing"," ").concat(r?"Backend":"Supabase"," migration");case"lov-experimental-supabase-analytics-query":case"supabase--analytics-query":return"".concat(s?"Looked":"Looking"," at ").concat(r?"Backend":"Supabase"," analytics");case"lov-experimental-supabase-configure-auth":case"supabase--configure-auth":return"Updating Auth config";case"read_project_analytics":case"analytics--read_project_analytics":return"".concat(s?"Checked":"Checking"," analytics");case"Security_Scanner--get_security_scan_results":return s?"Fetched security scan":"Fetching security scan";case"Security_Scanner--run_security_scan":return s?"Ran security scan":"Running security scan";default:return e}},j=(e,t,s)=>{try{var a;let r=null==t?void 0:null===(a=t.file_path)||void 0===a?void 0:a.startsWith("mem://");if((["lov-write","lov-search-replace","lov-line-replace"].includes(e)||"lov-view"===e)&&r)return"";switch(e){case"read_file":case"scrape_website":case"url_screenshot":return(null==t?void 0:t.arg0)||"";case"lov-view":case"lov-delete":case"lov-write":case"lov-search-replace":case"lov-line-replace":return(null==t?void 0:t.file_path)||"";case"lov-rename":return(null==t?void 0:t.original_file_path)&&(null==t?void 0:t.new_file_path)?"".concat(t.original_file_path," to ").concat(t.new_file_path):"";case"lov-download-to-repo":return(null==t?void 0:t.target_path)||"";case"generate_image":case"edit_image":return(null==t?void 0:t.prompt)||"";case"web_search":case"lov-search-files":return(null==t?void 0:t.query)||"";case"lov-add-dependency":case"lov-remove-dependency":return(null==t?void 0:t.package)||"";case"lov-list-dir":return(null==t?void 0:t.dir_path)||"";case"lov-read-console-logs":return"console logs";case"lov-read-network-requests":return"network logs";case"lov-fetch-website":case"lov-url-screenshot":return(null==t?void 0:t.url)||"";case"supabase_read_query":case"lov-supabase-read-query":return s?"Read from database":"Reading from database";case"supabase_analytics_query":case"lov-supabase-analytics-query":return s?"Retrieved logs":"Retrieving logs";default:return""}}catch(e){return""}},y=(e,t)=>{var s;if("lov-view"===e&&(null==t?void 0:null===(s=t.file_path)||void 0===s?void 0:s.startsWith("mem://")))return"lightbulb_2";switch(e){case"lov-download-to-repo":return"download";case"web_search":case"websearch--web_search":return"search";case"generate_image":case"edit_image":case"imagegen--generate_image":case"imagegen--edit_image":return"draw";case"lov-view":return"scan";case"lov-search-replace":case"lov-line-replace":case"lov-write":return"edit_document";case"lov-rename":return"draft";case"lov-delete":return"scan_delete";case"lov-add-dependency":return"extension";case"lov-remove-dependency":return"extension_off";case"lov-think":case"read_file":return"emoji_objects";case"lov-search-files":case"lov-list-dir":return"document_search";case"lov-read-console-logs":case"lov-read-network-requests":return"monitor_heart";case"scrape_website":case"lov-fetch-website":return"tv";case"url_screenshot":case"lov-url-screenshot":return"screenshot_monitor";case"supabase_read_query":return"table";case"supabase_analytics_query":return"history";case"read_project_analytics":return"analytics";default:return"code"}},w=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"light",r="dark"===s?x.A:x.g;switch(e){case"lov-experimental-supabase-read-query":case"lov-experimental-supabase-insert":case"lov-experimental-supabase-migration":case"lov-experimental-supabase-analytics-query":if(!t.query)return null;return(0,a.jsx)(i.Z,{language:"sql",customStyle:{fontSize:"12px"},style:r,children:t.query});default:return null}},_=n.memo(e=>{let{name:t,parsedData:s,done:i=!0,isShimmering:x=!1,duration:g,collapsed:_=!0,onHeightChange:N}=e,C=(0,p.iZ)(e=>e.project),k=(0,l.Iu)(C),S=b(t,s,i,g,k),E=j(t,s,i),I=y(t,s),{resolvedTheme:A}=(0,r.F)(),P=w(t,s,A),{setCurrentFile:z}=(0,h.r)(),{switchToView:M}=(0,f.Z)(),[Z,D]=(0,n.useState)(!0),L=(0,n.useRef)(null),R=(0,n.useRef)(null),[T,O]=(0,n.useState)(0);(0,n.useEffect)(()=>{_&&D(!0)},[_]);let F=!_&&!!P,U=(0,n.useCallback)(()=>!(!E||E.startsWith("mem://"))&&v.has(t)&&E&&E.includes("."),[E,t]),V=(0,c.Z)("md"),W=(0,n.useCallback)(e=>{if(e.stopPropagation(),E&&U()&&!V){let e=E;if("lov-rename"===t&&E.includes(" to ")){let t=E.split(" to ");e=t[1]||t[0]}z(e),M("codeEditor")}},[E,U,t,z,M,V]);return(0,n.useEffect)(()=>{if(R.current){let e=new ResizeObserver(()=>{R.current&&(O(R.current.scrollHeight),null==N||N())});return e.observe(R.current),O(R.current.scrollHeight),()=>e.disconnect()}},[N]),(0,a.jsxs)("div",{ref:L,className:"flex flex-col text-muted-foreground",children:[(0,a.jsxs)("div",{className:(0,u.cn)("flex h-6 items-center gap-1.5 whitespace-nowrap text-base font-medium md:text-sm",F&&"cursor-pointer"),onClick:()=>F&&D(!Z),children:[F&&(0,a.jsx)(d.Z,{name:"chevron_right",size:"small",className:(0,u.cn)("rotate-90 transition-transform duration-200",Z&&"rotate-0")}),(0,a.jsx)("div",{className:"mb-px mr-1 flex shrink-0 items-center",children:t.includes("supabase")||t.includes("Security_Scanner")?k?(0,a.jsx)(d.Z,{name:"database",size:"small"}):(0,a.jsx)(m.Z,{className:"h-4 w-auto",viewBox:"0 0 109 113"}):(0,a.jsx)(d.Z,{name:I,size:"small",className:"text-muted-foreground"})}),(0,a.jsx)(o.N,{className:"flex-shrink-0 font-normal",isShimmering:x,children:S}),E&&(0,a.jsx)("span",{className:(0,u.cn)("relative w-fit max-w-xs truncate rounded-md bg-secondary px-2 py-0 text-start text-xs font-normal text-muted-foreground",U()&&"cursor-pointer transition-colors hover:bg-secondary/80"),"aria-label":E,title:E,onClick:W,children:(0,a.jsx)(o.N,{isShimmering:x,style:{animationDelay:"1.95s",animationTimingFunction:"ease-out"},className:"truncate",children:E})})]}),(0,a.jsx)("div",{ref:R,className:"overflow-hidden",style:{height:Z?0:T,opacity:Z?0:1},children:P})]})});_.displayName="ToolUseCard"},73197:function(e,t,s){"use strict";s.d(t,{jN:function(){return f},w4:function(){return h},wb:function(){return v}});var a=s(52155),r=s(56852),n=s(98244),i=s(96869),l=s(59561),o=s(7815),d=s(99792),c=s(3011),u=s(34544),m=s(32307);function p(e){let{form:t,disabled:s,userInputBlock:i}=e,[u,m]=(0,n.useState)(!1),[p,h]=(0,n.useState)(!1),{name:f,pattern:g,label:v,helpLink:b,link:j,linkTitle:y,...w}=i.data;return(0,a.jsx)(o.Wi,{control:t.control,name:f,rules:{...w,pattern:g?new RegExp(g):void 0},render:e=>{let{field:t}=e;return(0,a.jsxs)(o.xJ,{className:"mt-2 flex flex-col gap-0 rounded-2xl bg-secondary p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(o.lX,{className:"ml-0.5 flex items-center gap-1 text-base font-normal",children:[(0,a.jsx)("span",{className:"align-text-bottom leading-loose",children:v}),b&&(0,a.jsx)(l.z,{variant:"ghost",size:"icon-sm",className:"h-6 hover:bg-transparent",children:(0,a.jsx)(r.default,{href:b,target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)(d.Z,{name:"help",size:"small"})})})]}),j&&(0,a.jsx)(l.z,{variant:"ghost",size:"icon-sm",className:"flex h-6 items-center gap-1 font-normal text-muted-foreground hover:bg-transparent",asChild:!0,children:(0,a.jsxs)(r.default,{href:j,target:"_blank",rel:"noopener noreferrer",children:[y||"Learn more",(0,a.jsx)(d.Z,{name:"arrow_outward",size:"small"})]})})]}),(0,a.jsx)(o.NI,{children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-2 mt-0 flex items-center gap-2",children:[(0,a.jsx)(c.I,{className:"h-8 bg-background ".concat(p?"invalid:border-destructive-foreground invalid:text-destructive-foreground focus:invalid:ring-destructive":""),disabled:s,type:"secret"!==i.type||u?"text":"password",...t,onBlur:e=>{h(!0),t.onBlur()}}),"secret"===i.type&&(0,a.jsx)(l.z,{variant:"ghost",size:"icon-sm",disabled:s,className:"h-6 hover:bg-transparent",onClick:e=>{e.preventDefault(),m(!u)},children:(0,a.jsx)(d.Z,{name:u?"visibility_off":"visibility",size:"small"})})]}),(0,a.jsx)(x,{disabled:s,type:"submit"})]})}),(0,a.jsx)(o.zG,{})]})}})}let h=e=>{let{message:t,disabled:s,userInput:r,onSubmit:n}=e,l=(0,i.cI)();return(0,a.jsx)(o.l0,{...l,children:(0,a.jsx)("form",{onSubmit:l.handleSubmit(n),children:r.map((e,r)=>{switch(e.type){case"instructions":return(0,a.jsx)(u.s,{displayCursor:!1,persisted:t.persisted,children:e.data.text},r);case"input":case"secret":return(0,a.jsx)(p,{form:l,disabled:s,userInputBlock:e},r);default:return null}})})})},x=e=>{let{disabled:t,type:s,onClick:r}=e;return(0,a.jsx)(l.z,{type:s,variant:"outline",onClick:r,disabled:t,children:"Approve"})},f=e=>e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()).replace(/.*--/,""),g=e=>{let{onSubmit:t,text:s,disabled:r}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Tool use"}),(0,a.jsxs)("div",{className:"flex flex-row items-center gap-8",children:[(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"m-0 text-base",children:f(s)})}),(0,a.jsx)(x,{disabled:r,onClick:()=>t({})})]})]})},v=e=>{let{message:t,toolUse:s}=e,{onSubmit:r,isLatestMessage:n,isPending:i}=(0,m.r)(t);return(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("div",{className:"max-w-full",children:s.userInput?(0,a.jsx)(h,{userInput:s.userInput,disabled:!n||i,message:t,onSubmit:r}):(0,a.jsx)(g,{onSubmit:r,disabled:!n||i,text:s.name})})})}},32307:function(e,t,s){"use strict";s.d(t,{L:function(){return o},r:function(){return d}});var a=s(21198),r=s(77162),n=s(26696),i=s(10178),l=s(39230);let o="Lovable tool use: Approved.\n\ncontext: 6951EAA2-1264-4A1A-A86D-817E462202C7",d=e=>{let t=(0,r.D)(),s=(0,a.$m)(),d=(null==s?void 0:s.messageId)===e.id,{mutateAsync:c,isPending:u}=(0,i.mo)({projectId:t});return{onSubmit:async s=>{await c({body:{message:o,id:(0,l.Fd)(),mode:n.S.INSTANT,prev_session_id:e.id,user_input:s},projectId:t})},isLatestMessage:d,isPending:u}}},56959:function(e,t,s){"use strict";var a=s(52155),r=s(59561),n=s(99792),i=s(84183),l=s(4578);t.Z=e=>{let{onClick:t,isBookmarked:s,className:o}=e;return(0,a.jsxs)(i.u,{children:[(0,a.jsx)(i.aJ,{asChild:!0,children:(0,a.jsx)(r.z,{variant:"ghost",size:"icon",className:(0,l.cn)("group/bookmark h-auto w-auto shrink-0 hover:bg-transparent",o),onClick:t,children:(0,a.jsx)(n.Z,{name:s?"bookmark_fill":"bookmark",size:"small",className:(0,l.cn)("text-muted-foreground transition-colors duration-150 ease-in-out group-hover/bookmark:opacity-75",s?"text-affirmative-primary":"")})})}),(0,a.jsx)(i._v,{children:s?"Remove bookmark from history":"Bookmark in history"})]})}},28375:function(e,t,s){"use strict";s.d(t,{z:function(){return sl},Y:function(){return so}});var a=s(52155),r=s(98244),n=s(84864),i=s(4578),l=s(21198),o=s(44854),d=s(34544),c=s(88182),u=s(59561),m=s(99792),p=s(48535),h=s(77162),x=s(94127),f=s(70980),g=s(86818),v=s(59253),b=s(70766);let j=e=>{let{actionProps:t}=e,{switchToView:s,exitView:n,activeView:o}=(0,v.Z)(),d=(0,l.aK)(e=>t.messageId?e.messages[t.messageId]:null),c=(0,l.tV)(t.editId),p=(0,b.VJ)(e=>e.activeMessageId)===t.messageId&&("codeViewer"===o||"error"===o),h=(0,r.useMemo)(()=>{var e;return(null==d?void 0:d.type)==="aiMessage"&&(null===(e=d.errors)||void 0===e?void 0:e.filter(e=>!e.dont_show))||[]},[d]),x=(0,r.useCallback)(()=>{var e;let a=!!(null==c?void 0:null===(e=c.diff)||void 0===e?void 0:e.length);p?n():s("codeViewer",{code:t.code,errors:h,messageId:t.messageId,editId:null==c?void 0:c.id,hasDiffs:a})},[c,p,t.code,t.messageId,h,s,n]);return(0,a.jsxs)(u.z,{size:"sm",className:(0,i.cn)("h-6 gap-1 px-1.5 py-0.5 text-sm font-normal transition-all duration-150 ease-in-out hover:bg-muted-hover md:h-5 md:text-xs",p&&"bg-affirmative ring-1 ring-affirmative-primary hover:bg-accent/80"),variant:"ghost",onClick:x,children:[(0,a.jsx)(m.Z,{name:"code",size:"small"}),(0,a.jsx)("span",{children:"Code"})]})};var y=s(84183),w=s(89671),_=s(99526),N=s(17195),C=s(96659),k=s(81922),S=s(22136),E=s(10990),I=s(21517);let A=e=>{let{editId:t,commitSha:s}=e,n=(0,S.I)(),i=(0,I.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.latest_commit_sha}),o=(0,k.u)(e=>e.setCurrentPage),d=(0,k.u)(e=>e.currentPage),{project_id:c}=(0,_.useParams)(),u=(0,l.tV)(t),m=(0,C.C)(),p=(0,E.Y)({editId:null==u?void 0:u.id,commitSha:null==u?void 0:u.commit_sha}),{isDisabled:h,disabledReason:x}=(0,r.useMemo)(()=>p?{isDisabled:!0,disabledReason:"Cannot restore to an active edit"}:s?n.isPending?{isDisabled:!0,disabledReason:"Restore is in progress"}:m?{isDisabled:!0,disabledReason:(0,a.jsx)("p",{className:"max-w-sm",children:"Cannot revert while there is an active operation in progress (e.g. chat or revert). Please wait for the operation to complete."})}:{isDisabled:m||n.isPending||!s||p,disabledReason:"Disabled"}:{isDisabled:!0,disabledReason:"Not a valid restore target"},[m,n.isPending,s,p]),f=s===i,g=(0,r.useCallback)(e=>{let{eventName:a}=e;t&&(u&&u.pages&&u.pages.length>0&&!u.pages.find(e=>e.name===d)&&o("index"),N.ZP.capture(a,{edit_id:t,commit_sha:s,disabled:h,disabled_reason:x,is_latest_commit:f,is_active_edit:p,project_id:c}),n.mutateAsync({edit:{id:t}}))},[s,d,x,u,t,h,p,c,n,o]);return{onRevert:t?g:void 0,isLatestCommit:f,isDisabled:h,isPending:n.isPending,disabledReason:x}},P=e=>{let{actionProps:t}=e,{onRevert:s,isDisabled:r,isPending:n,disabledReason:l}=A({editId:t.editId,commitSha:t.commitSha}),o=(0,a.jsxs)(u.z,{size:"sm",className:(0,i.cn)("h-6 gap-1 px-1.5 py-0.5 text-sm font-normal transition-colors duration-150 ease-in-out hover:bg-muted-hover md:h-5 md:text-xs"),variant:"ghost",onClick:()=>{s&&s({eventName:w.SL.CODE_CARD.RESTORE_CLICKED})},disabled:r||n,children:[(0,a.jsx)(m.Z,{name:"restart_alt",size:"small",className:n?"animate-spin-reverse":""}),(0,a.jsx)("span",{children:"Restore"})]});return r&&l?(0,a.jsxs)(y.u,{children:[(0,a.jsx)(y.aJ,{asChild:!0,children:(0,a.jsx)("span",{className:"flex items-center rounded",tabIndex:0,children:o})}),(0,a.jsx)(y._v,{children:(0,a.jsx)("p",{children:l})})]}):o},z=(0,r.memo)(e=>{let{children:t,...s}=e;return(0,a.jsx)(u.z,{size:"sm",variant:"ghost",className:"h-5 gap-1 px-1.5 py-0.5 text-xs font-normal transition-colors duration-150 ease-in-out hover:bg-muted-hover",...s,children:t})});z.displayName="CodeCardActionButton";let M=(0,r.memo)(e=>{let{children:t,className:s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("absolute -right-2 bottom-0 translate-y-1/2",s),children:(0,a.jsx)("div",{className:"flex items-center gap-1 rounded-lg border border-muted-border bg-muted p-0.5",children:t})})});M.displayName="BaseCodeCardActions";let Z=(0,r.memo)(e=>(0,a.jsxs)(M,{children:[(0,a.jsx)(P,{actionProps:e}),(0,a.jsx)(j,{actionProps:e})]}));Z.displayName="CodeCardActions";let D=e=>"parts"in e&&"done"in e,L={[x.N.CODE_DIFF]:"I couldn't apply your changes because the edit strategy I chose failed.",[x.N.FILE_EDITED_WITHOUT_PERMISSION]:"I couldn't apply your changes because I tried to edit a file that I don't have permission to edit.",[x.N.EXCLUDED_FILE_EDITED]:"I couldn't apply your changes because it resulted in unwanted changes",[x.N.NO_CODE_CHANGE]:"I couldn't apply your changes because the code changes I suggested were the same as the previous code."},R=e=>{var t,s;let{errors:n,messageParts:l,edit:o,projectId:d}=e,{exitView:h,switchToView:x,activeView:j}=(0,v.Z)(),y=(0,b.VJ)(e=>e.activeMessageId),w=(0,p.qV)({projectId:d,errorIds:(null==n?void 0:n.map(e=>e.id))||[],setErrors:e=>{}}),_=null==n?void 0:null===(t=n[0])||void 0===t?void 0:t.type,N=(0,r.useMemo)(()=>{let e=L[_];return e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:e}),(0,a.jsx)("p",{children:"Please rephrase your request or provide more details."})]}):null},[_]),{onClick:C,isPending:k}=(0,g.hw)({projectId:d,errors:n}),S=n[0].message_id||void 0,E="error"===j&&S===y,I=(0,r.useCallback)(()=>{if(E)h();else{var e;let t=null==l?void 0:l.parts.find(D),s=!!(null==o?void 0:null===(e=o.diff)||void 0===e?void 0:e.length);x("error",{errors:n,code:t,messageId:S,editId:null==o?void 0:o.id,hasDiffs:s})}},[E,null==o?void 0:null===(s=o.diff)||void 0===s?void 0:s.length,null==o?void 0:o.id,n,h,S,null==l?void 0:l.parts,x]),A=(0,f.bk)(e=>e.isSendChatMessageMutationPending),P=k||A||0===n.length;return n&&w?(0,a.jsxs)("div",{className:"mt-4 flex flex-col gap-4 pb-4",children:[(0,a.jsxs)(c.E.div,{className:"relative flex w-5/6 max-w-xs pr-9",initial:{opacity:0},animate:{opacity:1},transition:{ease:"easeOut",duration:.5},children:[(0,a.jsx)(M,{className:"pr-9",children:(0,a.jsxs)(z,{onClick:C,loading:k,disabled:P,children:[!k&&(0,a.jsx)(m.Z,{name:"bolt",size:"small"}),(0,a.jsx)("span",{children:"Try to fix"})]})}),(0,a.jsx)("div",{className:"w-full",children:(0,a.jsxs)(u.z,{onClick:I,variant:"outline",className:(0,i.cn)("flex h-auto w-full items-start gap-2 rounded-xl p-3 text-base font-medium shadow-none md:text-sm","border border-warning-primary bg-warning text-warning-foreground","transition-colors duration-150 ease-in-out","hover:border-warning-primary/80 hover:bg-warning/80",{"border-affirmative-primary/50 bg-affirmative text-affirmative-foreground hover:border-affirmative-primary/40 hover:bg-accent/90":E}),children:[(0,a.jsx)("div",{className:"flex h-5 items-center",children:(0,a.jsx)(m.Z,{name:"warning",size:"small"})}),(0,a.jsxs)("div",{className:"flex w-full flex-col gap-0 overflow-hidden text-left",children:[(0,a.jsx)("span",{className:"truncate font-medium",children:"Error"}),(0,a.jsx)("span",{className:(0,i.cn)("truncate text-base font-normal md:text-sm"),children:g.v7[n[0].type]})]}),(0,a.jsx)(m.Z,{name:"chevron_right"})]})})]}),N]}):null},T=e=>{let{errors:t,messageParts:s,edit:r}=e,n=(0,h.D)(),i=null==t?void 0:t.filter(e=>!e.dont_show);return i&&0!==i.length?(0,a.jsx)(R,{edit:r,errors:i,messageParts:s,projectId:n}):null};var O=s(37298),F=s(56852),U=s(54816),V=s(86338),W=s(66258),H=s.n(W),K=s(13018),q=s(37156),J=s(50484),Y=s(1176);let B=e=>!e||!e.visual_edits_dismissed_at&&!e.visual_edits_temporarily_closed,G=e=>{let{url:t}=e,[s,n]=(0,r.useState)(!0),i=(0,K.dl)(J.P.BetaTesters),{snapshot:{getUserMessageCount:o}}=(0,l.mx)(),{userData:d}=(0,q.SE)(),c=(0,Y.v)(),u=1>=o(),p=(0,r.useMemo)(()=>B(null==d?void 0:d.tips),[null==d?void 0:d.tips]);return u&&s&&i&&p?(0,a.jsx)("div",{className:"w-full",children:(0,a.jsxs)("div",{className:"rounded-lg bg-muted p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between pb-4",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2 text-base font-medium text-popover-foreground",children:[(0,a.jsx)(m.Z,{name:"my_location"}),(0,a.jsx)("h1",{className:"text-base font-medium",children:"Visual Edits"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{className:"text-base text-muted-foreground hover:underline",onClick:()=>{N.ZP.capture(w.SL.VIDEO_PLAYER.DONT_SHOW_AGAIN_CLICKED),c.mutate({visual_edits_dismissed_at:new Date().toISOString()}),n(!1)},children:"Don't show again"}),(0,a.jsx)("button",{className:"text-muted-foreground",onClick:()=>{N.ZP.capture(w.SL.VIDEO_PLAYER.CLOSE_CLICKED),c.mutate({visual_edits_temporarily_closed:new Date().toISOString()}),n(!1)},children:(0,a.jsx)(m.Z,{name:"close"})})]})]}),(0,a.jsx)("div",{className:"overflow-hidden rounded-lg",children:(0,a.jsx)(H(),{url:t,controls:!0,width:"100%",height:"100%",playbackRate:2.5,onPlay:()=>{N.ZP.capture(w.SL.VIDEO_PLAYER.PLAY_STARTED)}})})]})}):null};var X=s(3989),$=s(19214),Q=s(5620),ee=s(12703),et=s(14070),es=s(52465),ea=()=>{let[e,t]=(0,r.useState)(!1),[s,n]=(0,r.useState)(""),i=(0,I.iZ)(e=>e.project),{updateProject:l}=(0,I.d2)();(0,r.useEffect)(()=>{(null==i?void 0:i.custom_instructions)&&n(i.custom_instructions)},[i]);let o=async()=>{try{l({custom_instructions:s},{onSuccess:()=>{N.ZP.capture(w.SL.KNOWLEDGE.SAVED),ee.Am.success("Custom instructions updated",{description:"Your custom instructions have been saved successfully."})}}),t(!1)}catch(e){ee.Am.error("Error",{description:"Failed to update custom instructions. Please try again."})}};return(0,a.jsxs)(et.Vq,{open:e,onOpenChange:t,children:[(0,a.jsx)(et.hg,{asChild:!0,children:(0,a.jsxs)(u.z,{className:"w-fit gap-2 whitespace-nowrap",variant:"outline",size:"sm",onClick:()=>t(!0),children:[(0,a.jsx)(m.Z,{name:"school",className:"text-muted-foreground"}),"Manage knowledge"]})}),(0,a.jsxs)(et.cZ,{size:"lg",children:[(0,a.jsx)(et.fK,{children:(0,a.jsx)(et.$N,{children:"Manage Knowledge"})}),(0,a.jsxs)(et.Be,{children:["Add custom context and instructions for your project. Lovable will use it in every edit. Use it to:",(0,a.jsxs)("ul",{className:"mt-2 list-disc pl-5",children:[(0,a.jsx)("li",{children:"Define project-specific rules or guidelines"}),(0,a.jsx)("li",{children:"Set coding style preferences (e.g., indentation, naming conventions)"}),(0,a.jsx)("li",{children:"Include external documentation or style guides"})]})]}),(0,a.jsx)(es.g,{value:s,onChange:e=>n(e.target.value),placeholder:"Enter your custom instructions and context here...",className:"resize-none",rows:16}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(u.z,{onClick:o,children:"Save"})})]})]})},er=s(10178),en=s(72602),ei=s(56166),el=s(96869),eo=s(25243),ed=s(7815),ec=s(3011),eu=s(13273),em=s(94671),ep=s(39230);let eh=e=>{let t=e.reduce((e,t)=>(e[t.key]=eo.Z_().min(1,{message:"".concat(t.name," is required")}),e),{});return eo.Ry(t)},ex=e=>e.toLowerCase().split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ").replace(/api/i,"API"),ef=(0,r.memo)(e=>{let{secretFormActions:t,isMostRecentMessage:s}=e,[n,i]=(0,r.useState)(!1),l=(0,h.D)(),{mutate:o}=(0,er.mo)({projectId:l}),d=(0,r.useMemo)(()=>t.map(e=>({key:e.name,name:ex(e.name)})),[t]),c=(0,r.useMemo)(()=>eh(d),[d]),p=(0,el.cI)({resolver:(0,en.F)(c),defaultValues:t.reduce((e,t)=>(e[t.name]="",e),{})});(0,r.useEffect)(()=>{n&&p.reset()},[n,p]);let x=(0,ei.D)({mutationFn:async e=>{let t={secrets:Object.entries(e).map(e=>{let[t,s]=e;return{name:t,value:s}})},s=(0,em.SJ)();await s.post("/projects/".concat(l,"/supabase/secrets"),t)},onSuccess:()=>{ee.Am.success("API Keys added successfully"),i(!1),o({body:{id:(0,ep.Fd)(),message:"I have now added the API keys you asked for."}})},onError:e=>{(0,eu.Eo)(e)}}),f=(0,r.useCallback)(async e=>{await x.mutateAsync(e)},[x]);return(0,a.jsxs)(et.Vq,{open:n,onOpenChange:i,children:[(0,a.jsx)(et.hg,{children:(0,a.jsxs)(u.z,{disabled:!s,variant:"outline",size:"sm",className:"flex items-center gap-1 overflow-hidden text-ellipsis whitespace-nowrap",children:[(0,a.jsx)(m.Z,{name:"key",size:"small"}),"Add API Key",1===t.length?"":"s"]})}),(0,a.jsxs)(et.cZ,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(et.fK,{children:[(0,a.jsx)(et.$N,{asChild:!0,children:(0,a.jsxs)("h1",{className:"text-2xl font-medium",children:["Add API Key",1===t.length?"":"s"]})}),(0,a.jsxs)(et.Be,{className:"text-muted-foreground",children:["Enter your API Key",1===t.length?"":"s"," to continue. Manage this later from the Supabase menu."," ",(0,a.jsx)(F.default,{href:"https://docs.lovable.dev/integrations/supabase#storing-secrets-with-supabase",className:"text-primary underline hover:no-underline",target:"_blank",children:"Learn more"})]})]}),(0,a.jsx)(ed.l0,{...p,children:(0,a.jsxs)("form",{onSubmit:p.handleSubmit(f),className:"space-y-4",children:[d.map(e=>(0,a.jsx)(ed.Wi,{control:p.control,name:e.key,render:t=>{let{field:s}=t;return(0,a.jsxs)(ed.xJ,{children:[(0,a.jsx)(ed.lX,{children:e.name}),(0,a.jsx)(ed.NI,{children:(0,a.jsx)(ec.I,{placeholder:"Enter API Key",type:"password",autoComplete:"off",autoSave:"off",...s})}),(0,a.jsx)(ed.zG,{})]})}},e.key)),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(et.GG,{asChild:!0,children:(0,a.jsx)(u.z,{type:"button",disabled:x.isPending,variant:"outline",children:"Cancel"})}),(0,a.jsx)(u.z,{loading:x.isPending,type:"submit",children:"Submit"})]})]})})]})]})});ef.displayName="AddApiKeysButton";var eg=s(25938);let ev=e=>{let{done:t}=e;return(0,a.jsxs)(et.cZ,{className:"gap-4 outline-none focus:ring-0",size:"lg",children:[(0,a.jsxs)("div",{className:"flex flex-col items-start gap-4",children:[(0,a.jsx)(m.Z,{name:"shopify",className:"h-9 w-9"}),(0,a.jsxs)(et.fK,{children:[(0,a.jsx)(et.$N,{className:"text-2xl md:text-3xl",children:"Connect to Shopify"}),(0,a.jsx)(et.Be,{children:"Shopify adds e-commerce functionality to your website. Choose your setup path below."})]})]}),(0,a.jsxs)(eg.mQ,{defaultValue:"no-store",className:"w-full",children:[(0,a.jsxs)(eg.dr,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(eg.SP,{value:"no-store",children:"I don't have a store"}),(0,a.jsx)(eg.SP,{value:"have-store",children:"I already have a store"})]}),(0,a.jsx)(eg.nU,{value:"no-store",className:"mt-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"font-medium text-foreground",children:"Getting started:"}),(0,a.jsxs)("ol",{className:"list-inside list-decimal space-y-2 text-muted-foreground",children:[(0,a.jsxs)("li",{children:["Head to"," ",(0,a.jsx)(F.default,{href:"https://shopify.com/free-trial",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"shopify.com/free-trial"})," ","and create your store"]}),(0,a.jsxs)("li",{children:["Once logged into your Shopify Admin at"," ",(0,a.jsx)(F.default,{href:"https://admin.shopify.com",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"admin.shopify.com"}),", find your Store ID in the address bar:"," ",(0,a.jsx)("code",{className:"rounded bg-muted px-1 py-0.5 text-xs",children:"https://admin.shopify.com/store/[STORE-ID]"})]}),(0,a.jsx)("li",{children:"Paste it in the chat to get started"})]})]})}),(0,a.jsx)(eg.nU,{value:"have-store",className:"mt-4 space-y-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("p",{className:"font-medium text-foreground",children:"Connect your existing store:"}),(0,a.jsxs)("ol",{className:"list-inside list-decimal space-y-2 text-muted-foreground",children:[(0,a.jsxs)("li",{children:["Log into your Shopify Admin at"," ",(0,a.jsx)("a",{href:"https://admin.shopify.com",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"admin.shopify.com"})]}),(0,a.jsxs)("li",{children:["Copy your Store ID from the URL:"," ",(0,a.jsx)("code",{className:"rounded bg-muted px-1 py-0.5 text-xs",children:"https://admin.shopify.com/store/STORE-ID"})]}),(0,a.jsx)("li",{children:"Copy it, then paste it in the chat to get started"})]})]})})]}),(0,a.jsx)(et.cN,{fullWidthButtons:!0,className:"flex-col",children:(0,a.jsx)(u.z,{onClick:()=>{t()},className:"mt-3 w-full",variant:"outline",children:"I have my Shopify Store ID"})})]})};var eb=s(87294);let ej=e=>{let t=document.createElement("div");return t.innerHTML=e,(t.textContent||t.innerText||"").replace(/\n\s*\n/g,"\n\n").trim()};function ey(e){let{open:t,onOpenChange:s,onFeedbackSubmit:n,messageId:i,projectId:l,onCancel:o,initialContent:d}=e,[c,m]=(0,r.useState)(""),[p,h]=(0,r.useState)([]);(0,r.useEffect)(()=>{t&&m(d||"")},[t,d]);let x=e=>{h(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,a.jsx)(et.Vq,{open:t,onOpenChange:e=>{!e&&(c.length>0||p.length>0)&&N.ZP.capture("message_feedback:dialog_cancelled",{messageId:i,projectId:l,action:"close",hadContent:c.length>0,hadCategories:p.length>0}),e||(m(""),h([]),null==o||o()),s(e)},children:(0,a.jsx)(et.cZ,{children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-foreground",children:"Help us improve"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Please tell us why this response wasn't helpful to you."}),(0,a.jsx)("div",{className:"mt-4 grid grid-cols-2 gap-2",children:["Design is off","Unrelated changes made","Functionality is broken","Other"].map(e=>(0,a.jsx)(u.z,{variant:p.includes(e)?"default":"outline",className:"w-full justify-start pl-4 ".concat(p.includes(e)?"border border-primary":""),size:"lg",onClick:()=>x(e),children:e},e))})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-muted-foreground",children:"Additional Feedback"}),(0,a.jsx)(es.g,{placeholder:"This was not helpful because ...",value:c,className:"min-h-24 resize-none",onChange:e=>m(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(u.z,{onClick:()=>{N.ZP.capture("message_feedback:dialog_cancelled",{messageId:i,projectId:l,action:"cancel",hadContent:c.length>0,hadCategories:p.length>0}),m(""),h([]),s(!1),null==o||o()},size:"sm",variant:"secondary",children:"Cancel"}),(0,a.jsx)(u.z,{onClick:()=>{n({content:c,categories:p}),m(""),h([]),s(!1)},size:"sm",variant:"default",children:"Submit"})]})]})})})}let ew=(0,r.memo)(e=>{let{message:t}=e,s=(0,I.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.id}),n=(0,em.SJ)(),[i,l]=(0,r.useState)(t.feedbackSentiment||null),[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l(t.feedbackSentiment||null)},[t.feedbackSentiment]);let p=(0,ei.D)({mutationFn:async e=>{let{sentiment:a,content:r,categories:i}=e;if(!s)throw Error("Project ID is required");let l={sentiment:a};r&&(l.content=r),i&&i.length>0&&(l.category=i.join(", ")),await n.post("/projects/".concat(s,"/messages/").concat(t.id,"/feedback"),l)},onSuccess:()=>{ee.Am.success("Thanks for your feedback!")},onError:e=>{ee.Am.error("Failed to save feedback",{description:(null==e?void 0:e.message)||"Please try again"})}}),h=async()=>{try{let e=ej(t.content);await navigator.clipboard.writeText(e),u(!0),setTimeout(()=>u(!1),2e3),N.ZP.capture("message_copy",{messageId:t.id,projectId:s})}catch(e){(0,eu.Eo)(e)}},x=(0,eb.Z)("md");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mt-1.5 flex flex-shrink-0 items-center gap-3 pr-1",children:[(0,a.jsx)("button",{onClick:()=>{let e="positive"===i?null:"positive";l(e),e&&(p.mutate({sentiment:e}),N.ZP.capture("message_feedback:thumbs_up"))},className:"flex items-center gap-1 transition-colors focus:outline-none ".concat("positive"===i?"text-white-600 hover:text-white-700":"text-muted-foreground hover:text-foreground"),title:"Helpful",children:(0,a.jsx)(m.Z,{size:x?"default":"small",name:"positive"===i?"thumb_up-fill":"thumb_up"})}),(0,a.jsx)("button",{onClick:()=>{"negative"===i?N.ZP.capture("message_feedback:dialog_opened_for_edit",{messageId:t.id,projectId:s,hadPreviousContent:!!t.feedbackContent}):l("negative"),d(!0)},className:"flex items-center gap-1 transition-colors focus:outline-none ".concat("negative"===i?"text-white-600 hover:text-white-700":"text-muted-foreground hover:text-foreground"),title:"Not helpful",children:(0,a.jsx)(m.Z,{size:x?"default":"small",name:"negative"===i?"thumb_down-fill":"thumb_down"})}),(0,a.jsx)("button",{onClick:h,className:"flex items-center gap-1 text-muted-foreground transition-colors hover:text-foreground focus:outline-none",title:c?"Copied!":"Copy message",children:(0,a.jsx)(m.Z,{size:x?"default":"small",name:c?"check":"content_copy"})})]}),(0,a.jsx)(ey,{open:o,onOpenChange:d,onFeedbackSubmit:e=>{p.mutate({sentiment:"negative",content:e.content,categories:e.categories})},messageId:t.id,projectId:s,onCancel:()=>{t.feedbackContent||l(null)},initialContent:t.feedbackContent})]})});ew.displayName="MessageFeedbackButtons";var e_=s(19227),eN=s(26696);let eC=e=>{let{messageId:t,runState:s,toolUseId:r}=e,n=(0,h.D)(),i=(0,I.iZ)(e=>e.project),l=(0,e_.Iu)(i),{mutateAsync:o,isPending:d}=(0,er.mo)({projectId:n}),c=async()=>{await o({body:{message:"I have reviewed the SQL and it looks good. Please run it.",id:(0,ep.Fd)(),mode:eN.S.INSTANT,run_sql_in_message_with_id:t,prev_session_id:r?t:void 0},projectId:n})};return l?null:(0,a.jsx)("div",{children:(0,a.jsx)(u.z,{variant:"default",size:"sm",className:"gap-2 py-2",onClick:c,disabled:void 0!==s&&"not_started"!==s||d,children:"not_started"===s||void 0===s?"Apply changes":"running"===s?"Applying changes...":"failed"===s?"Failed to apply changes":"SQL already executed"})})},ek=e=>e.startsWith("https://supabase.com/dashboard/project/")||e.includes("?settings=supabase")?(0,a.jsx)(O.default,{width:16,height:16,src:"/icons/supabase_logo.svg",alt:"Supabase"}):(0,a.jsx)(m.Z,{name:"arrow_outward"});function eS(e){let{linkActions:t}=e;return t&&0!==t.length?(0,a.jsx)(a.Fragment,{children:null==t?void 0:t.map(e=>{let t=e.url.startsWith("/projects/");return(0,a.jsx)(u.z,{asChild:!0,variant:"outline",size:"sm",className:"flex items-center gap-1 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,a.jsxs)(F.default,{href:e.url,target:t?void 0:"_blank",rel:"noopener noreferrer",children:[ek(e.url),(0,a.jsx)("span",{className:"truncate",children:e.text})]})},e.url)})}):null}function eE(e){let{messagePromptActions:t}=e,s=(0,I.iZ)(e=>e.projectId),r=(0,X.hT)(e=>e.chatMode),{setChatMode:n}=(0,X.VK)(),{isAgentModeDefault:i}=(0,V.v)(),{mutate:l,isPending:o}=(0,er.OU)({projectId:s});return t&&0!==t.length?(0,a.jsx)(a.Fragment,{children:null==t?void 0:t.map(e=>(0,a.jsx)(u.z,{asChild:!0,variant:"outline",size:"sm",disabled:o,onClick:()=>{r===X.jE.CHAT_ONLY&&n(i?X.jE.AGENT:X.jE.DEFAULT),l({body:{id:(0,U.Z)(),message:e.message}})},className:"flex cursor-pointer items-center gap-1 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(m.Z,{name:"chat_bubble",size:"small"}),(0,a.jsx)("span",{className:"truncate",children:e.text})]})},e.message))}):null}function eI(e){let{providerCardActions:t}=e,s=(0,$.z)(ev);return(0,a.jsx)(a.Fragment,{children:null==t?void 0:t.map((e,t)=>"shopify"===e.provider&&(0,a.jsxs)(Q.Zb,{className:"flex w-full flex-1",children:[(0,a.jsxs)(Q.Ol,{className:"flex flex-row items-center gap-2",children:[(0,a.jsx)(m.Z,{name:"shopify"}),(0,a.jsx)(Q.ll,{children:"Connect to Shopify"})]}),(0,a.jsxs)(Q.aY,{className:"w-full",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2 text-sm",children:[(0,a.jsx)(m.Z,{name:"bar_chart"}),"Set up your store"]}),(0,a.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Shopify adds e-commerce functionality to your website. Paste your Shopify Store ID in the chat to get started."}),(0,a.jsx)(u.z,{className:"mt-4 w-full font-normal",variant:"outline",onClick:()=>s({childProps:{done:()=>{s(!1)}}}),children:"Find my Shopify Store ID"})]})]},"".concat(e.provider,"-").concat(t)))})}let eA=e=>{var t,s;let{message:n,messageId:o,lovActions:d,sqlRunState:u,persisted:m}=e,{isMostRecentMessage:p}=(0,l.mx)(),{migrateActions:h,linkActions:x,knowledgeAction:f,messagePromptActions:g,secretFormActions:v,providerCardActions:b}=(0,r.useMemo)(()=>{let e=null==d?void 0:d.filter(e=>"lov_action__migrate"===e.type&&e.done),t=null==d?void 0:d.filter(e=>"lov_action__link"===e.type),s=null==d?void 0:d.filter(e=>"lov_action__message_prompt"===e.type),a=null==d?void 0:d.filter(e=>"lov_action__secret_form"===e.type);return{migrateActions:e,linkActions:t,knowledgeAction:null==d?void 0:d.find(e=>"lov_action__knowledge"===e.type),messagePromptActions:s,secretFormActions:a,providerCardActions:null==d?void 0:d.filter(e=>"lov_action__provider_card"===e.type)}},[d]),j=b&&b.length>0;return(0,a.jsxs)(c.E.div,{className:"flex max-w-full flex-1 flex-col gap-4 overflow-hidden",initial:{opacity:m?1:0},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:[m&&(0,a.jsx)(G,{url:"https://customer-8etxbtq55jiz5gtf.cloudflarestream.com/0989fc00edc27647d46bd169d87b7200/manifest/video.m3u8"}),(0,a.jsxs)("div",{className:(0,i.cn)("flex items-start justify-between gap-4 overflow-hidden",j&&"flex-col"),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex w-full min-w-0 flex-1 flex-wrap items-center gap-2",children:[(null!==(s=null==h?void 0:h.length)&&void 0!==s?s:0)>0&&(0,a.jsx)(eC,{messageId:o,runState:u,toolUseId:null==h?void 0:null===(t=h[0])||void 0===t?void 0:t.toolUseId},"migrate"),(0,a.jsx)(eS,{linkActions:x}),(0,a.jsx)(eE,{messagePromptActions:g}),v&&v.length>0&&(0,a.jsx)(ef,{secretFormActions:v,isMostRecentMessage:p(o)}),f&&(0,a.jsx)(ea,{})]}),j&&(0,a.jsx)(eI,{providerCardActions:b})]}),m&&(0,a.jsx)(ew,{message:n})]})]})};var eP=s(52162),ez=s(29306);let eM=e=>{let t=(0,b.VJ)(e=>e.activeEditId),{activeView:s}=(0,v.Z)(),a=(0,l.aK)(e=>e.edits),r=t?a[t]:null,n=(0,E.Y)({editId:null==e?void 0:e.id,commitSha:null==e?void 0:e.commit_sha}),i=null==r?void 0:r.revert_target_edit_id,o=(null==r?void 0:r.id)===(null==e?void 0:e.id)||!!i&&i===(null==e?void 0:e.id);return{isActive:o&&"snapshot"===s,isActiveCode:o&&"codeViewer"===s,shouldShowCurrentEditHighlight:n&&"preview"===s&&!!e}};var eZ=s(17176),eD=s(28069);let eL=e=>{var t;let{edit:s,messageId:a,code:n}=e,i=(0,I.iZ)(e=>e.project),{switchToView:l,exitView:o}=(0,v.Z)(),{setMobileView:d}=(0,eD.zp)(),c=(0,E.Y)({editId:null==s?void 0:s.id,commitSha:null==s?void 0:s.commit_sha}),{isActive:u,isActiveCode:m}=eM(s),p=(0,r.useMemo)(()=>{if((null==s?void 0:s.commit_sha)&&i)return(0,eZ.t)({projectId:null==i?void 0:i.id,sha:null==s?void 0:s.commit_sha})},[null==s?void 0:s.commit_sha,i]);return{handleOpenPreview:(0,r.useCallback)(e=>{if(e.altKey){window.open(p,"_blank");return}if(u){o();return}if(c){l("preview"),d(eD.$.VIEW);return}l("snapshot",{previewUrl:p,messageId:a,editId:null==s?void 0:s.id})},[u,c,o,s,a,p,l,d]),handleOpenCode:(0,r.useCallback)(()=>{var e;let t=!!(null==s?void 0:null===(e=s.diff)||void 0===e?void 0:e.length);m?o():l("codeViewer",{code:n,errors:void 0,messageId:a,editId:null==s?void 0:s.id,hasDiffs:t})},[null==s?void 0:null===(t=s.diff)||void 0===t?void 0:t.length,null==s?void 0:s.id,m,n,a,l,o])}};var eR=s(25871),eT=s(56959);let eO=e=>{var t,s;let{onClick:n,children:l,edit:o,message:d,code:c,isLoading:m}=e,p=(0,I.iZ)(e=>e.project),{toggleBookmark:h}=(0,eR.g)((null==p?void 0:p.id)||""),{isActive:x,shouldShowCurrentEditHighlight:f}=eM(o),g=(0,r.useCallback)(e=>{e.stopPropagation(),(null==o?void 0:o.id)&&h(o.id,!!o.bookmarked)},[o,h]);return(0,a.jsxs)("div",{className:"flex w-full items-start gap-1",children:[(0,a.jsxs)("div",{className:"relative w-full",children:[!!o&&(0,a.jsx)(Z,{editId:null!==(t=null==o?void 0:o.id)&&void 0!==t?t:void 0,commitSha:null!==(s=null==o?void 0:o.commit_sha)&&void 0!==s?s:void 0,messageId:d.id,code:c}),(0,a.jsx)(u.z,{onClick:n,variant:"outline",className:(0,i.cn)("flex h-auto w-full max-w-56 cursor-pointer gap-2 rounded-xl p-3 text-base font-medium shadow-none sm:max-w-xs md:text-sm",m?"items-center":"items-start","border border-muted-border bg-muted text-foreground","transition-all duration-150 ease-in-out","hover:border-border hover:bg-muted-hover",{"border-affirmative-primary bg-affirmative hover:border-affirmative-primary/80 hover:bg-affirmative/80":f||x,"hover:cursor-auto hover:border-affirmative-primary hover:bg-affirmative":f}),children:l})]}),(null==o?void 0:o.id)&&(0,a.jsx)("div",{className:"flex h-8 w-8 flex-shrink-0 items-center justify-center",children:(0,a.jsx)(eT.Z,{onClick:g,isBookmarked:!!o&&!!o.bookmarked&&(null==o?void 0:o.bookmarked),className:"mt-3"})})]})};var eF=s(21091);let eU=e=>"edit"===e.variant?(0,a.jsx)(eV,{...e}):(0,a.jsx)(eW,{...e}),eV=e=>{let{message:t,edit:s,onClick:r,isActive:n,code:i}=e,l=!0;"aiMessage"===t.type&&(l=i.done||"running"!==t.status);let d=(0,o.zL)(i),c=(0,E.Y)({editId:null==s?void 0:s.id,commitSha:null==s?void 0:s.commit_sha}),u="aiMessage"===t.type&&!t.stopped&&!l;return(0,a.jsxs)(eO,{edit:s,message:t,code:i,onClick:r,isLoading:u,children:[d>0&&(0,a.jsx)("div",{className:"flex h-5 items-center",children:(0,a.jsx)(m.Z,{name:"language",size:"small"})}),l?(0,a.jsx)(eq,{message:t,isCurrentEdit:c,edit:s,isActive:n,code:i}):i&&(0,a.jsx)(eK,{isActive:n,code:i,messageStopped:"aiMessage"===t.type&&t.stopped}),(0,a.jsx)(m.Z,{name:"chevron_right"})]})},eW=e=>{let{message:t,edit:s,onClick:r,isActive:n}=e,i=(0,E.Y)({editId:null==s?void 0:s.id,commitSha:null==s?void 0:s.commit_sha});return(0,a.jsxs)(eO,{edit:s,message:t,code:void 0,onClick:r,isLoading:!1,children:[(0,a.jsx)(eq,{message:t,isCurrentEdit:i,edit:s,isActive:n}),(0,a.jsx)(m.Z,{name:"chevron_right"})]})},eH=(0,r.memo)(e=>{let{message:t,edit:s,code:r}=e,{isActive:n}=eM(s),{handleOpenCode:i,handleOpenPreview:l}=eL({edit:s,messageId:t.id,code:r}),o="aiMessage"===t.type&&t.persisted;return(0,a.jsx)(c.E.div,{className:"relative flex w-5/6 max-w-xs pb-4",initial:{opacity:o?1:0},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:(0,a.jsx)(eU,{variant:"edit",code:r,message:t,edit:null!=s?s:null,onClick:e=>{s?l(e):i()},isActive:n})})});eH.displayName="CodeCard";let eK=(0,r.memo)(e=>{let{isActive:t,code:s,messageStopped:n}=e,[l,o]=(0,r.useState)(""),d=!n;(0,r.useEffect)(()=>{s.parts.length>0&&o(e=>eY(s)||e)},[s]);let u=d?l||"...":l;return(0,a.jsx)("div",{className:"min-h-[1.375rem] min-w-0 flex-1",children:(0,a.jsx)(eP.M,{mode:"popLayout",children:(0,a.jsx)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:(0,i.cn)("truncate text-muted-foreground",{"text-foreground":t}),children:u}),d&&(0,a.jsx)(ez.T,{text:"",className:"mt-0"})]})},u)})})});eK.displayName="EditingTitle";let eq=(0,r.memo)(e=>{let{message:t,edit:s,code:n,isActive:l,isCurrentEdit:d}=e,{title:c,body:u}=(0,r.useMemo)(()=>{let e=void 0!==n?(0,o.zL)(n):0;if(s){var a;return{title:"".concat(null!==(a=s.commit_message)&&void 0!==a?a:"no commit message"),body:d?"Preview Latest":"Preview"}}if(0===e&&"aiMessage"===t.type&&void 0!==t.thinkingTimeMs)return{title:"Saving changes...",body:"View more"};let r="aiMessage"===t.type?t.status:"completed",i="Saving changes...";return"stopped"===r&&(i="Generation stopped"),"completed"!==r||t.editId||(i="Failed to save changes"),{title:"Edited ".concat(e," file").concat(1===e?"":"s"),body:i}},[t,d,s,n]);return(0,a.jsxs)("div",{className:"flex w-full flex-col gap-1 overflow-hidden text-left",children:[(0,a.jsx)("span",{className:(0,i.cn)("truncate",{"text-foreground":l}),children:c}),(0,a.jsx)("span",{className:"truncate font-normal",children:u})]})});eq.displayName="FinishedEditingTitle";let eJ=e=>{if(!e)return"";let t=e.split(/[\/\\]/);return t[t.length-1]},eY=e=>{for(let t=e.parts.length-1;t>=0;t--){let s=e.parts[t];if("writing_file"===s.type||"edit"===s.type)return"Writing ".concat(eJ(s.file_path));if("delete"===s.type)return"Deleting ".concat(eJ(s.file_path));if("rename"===s.type)return"Renaming ".concat(eJ(s.original_file_path));else if("add_dependency"===s.type)return"Installing ".concat(s.dependency);else if("remove_dependency"===s.type)return"Uninstalling ".concat(s.removed_dependency);else if("tool_use"===s.type){let e=(0,eF.f)(s.name||"",s.parsedData,!1);if(e)return e;{let e=s.name||"";return e.split("-").pop()||e}}}return"Thinking..."};var eB=s(73207);let eG=e=>{let{name:t,parsedData:s}=e;switch(t){case"lov-view":case"lov-write":case"lov-search-replace":case"lov-line-replace":return(null==s?void 0:s.file_path)||"";case"lov-think":return t;default:return""}},eX=e=>["lov-view","lov-write","lov-search-replace","lov-line-replace","lov-think"].includes(e),e$=e=>["lov-search-replace","lov-line-replace","lov-write","lov-delete","lov-rename"].includes(e),eQ=e=>{if(0===e.length)return[];let t=[],s=[],a="";for(let r of e){let e=eX(r.name),n=e?eG(r):"";if(e&&n&&n===a&&s.length>0)s.push(r);else{if(s.length>0){let e=s[s.length-1],a=s.every(e=>e.done),r=e.duration;"lov-think"===e.name&&(r=s.reduce((e,t)=>e+(t.duration||0),0)),t.push({...e,done:a,duration:r})}e&&n?(s=[r],a=n):e||(s=[],a="",t.push(r))}}if(s.length>0){let e=s[s.length-1],a=s.every(e=>e.done),r=e.duration;"lov-think"===e.name&&(r=s.reduce((e,t)=>e+(t.duration||0),0)),t.push({...e,done:a,duration:r})}return t},e0=e=>{let{toolUses:t,isShimmering:s}=e,r=t.some(e=>e$(e.name)),n=t.filter(e=>e$(e.name)).length,i=t.length,l=r?n:i,o=r?"".concat(l," edit").concat(1!==l?"s":""," made"):"".concat(l," tool").concat(1!==l?"s":""," used");return(0,a.jsxs)("div",{className:"flex h-6 items-center gap-1.5 whitespace-nowrap text-base font-medium text-muted-foreground md:text-sm",children:[(0,a.jsx)("div",{className:"mb-px mr-1 flex shrink-0 items-center",children:(0,a.jsx)(m.Z,{name:r?"edit_document":"emoji_objects",size:"small",className:"text-muted-foreground"})}),(0,a.jsx)(eB.N,{className:"flex-shrink-0 font-normal",isShimmering:s,children:o})]})},e1=e=>{let{toolUses:t,isStreaming:s=!1,isLastElement:n=!1,messageCompleted:l=!1}=e,[o,d]=(0,r.useState)(!1),c=(0,r.useMemo)(()=>eQ(t),[t]),m=(0,r.useMemo)(()=>0===c.length?"":"".concat(c[0].name,"-").concat(Object.keys(c[0].parsedData).join("-")),[c.length>0?c[0].name:"",c.length>0?Object.keys(c[0].parsedData).join("-"):""]),p=n&&!l,h=t.some(e=>!e.done),x=c.length>1,f=(0,r.useRef)(null),[g,v]=(0,r.useState)(0),b=(0,r.useRef)(null),j=(0,r.useCallback)(()=>{b.current&&clearTimeout(b.current),b.current=setTimeout(()=>{f.current&&v(f.current.scrollHeight)},50)},[]);if((0,r.useEffect)(()=>()=>{b.current&&clearTimeout(b.current)},[]),(0,r.useEffect)(()=>{f.current&&v(f.current.scrollHeight)},[f,o,c]),0===c.length)return null;let y=c[c.length-1],w="lov-think"===y.name||"read_file"===y.name,_=y.done;return(w&&y.done&&n&&!l&&(_=!1),x)?(0,a.jsxs)("div",{className:"relative flex w-full flex-col",children:[(0,a.jsx)(u.z,{onClick:()=>d(!o),variant:"outline",className:(0,i.cn)("absolute right-0 top-0 z-10 flex h-6 items-center justify-center px-1.5 py-1 text-base font-normal transition-all duration-300 ease-out md:text-sm"),"aria-label":o?"Collapse tool uses":"Expand tool uses",children:o?"Hide":"Show all"}),(0,a.jsx)("div",{className:"relative overflow-hidden transition-all duration-300 ease-in-out",style:{height:o?"".concat(g,"px"):"24px"},children:o?(0,a.jsx)("div",{ref:f,className:"absolute top-0 flex w-full flex-col gap-2",children:c.map((e,t)=>(0,a.jsx)("div",{className:"transition-all duration-300 ease-out",children:(0,a.jsx)(eF.Y,{collapsed:!1,onHeightChange:j,name:e.name,parsedData:e.parsedData,done:e.done,isShimmering:p&&t===c.length-1&&!e.done,duration:e.duration})},"".concat(m,"-").concat(t)))}):(0,a.jsx)("div",{className:"flex h-full items-end",children:h||!l&&n?(0,a.jsx)("div",{className:"flex h-6 items-center",children:(0,a.jsx)(eF.Y,{name:y.name,parsedData:y.parsedData,done:_,isShimmering:p&&!_,duration:y.duration,collapsed:!0})}):(0,a.jsx)(e0,{toolUses:c,isShimmering:!1})})})]}):(0,a.jsx)(eF.Y,{name:y.name,parsedData:y.parsedData,done:_,isShimmering:p&&!_,duration:y.duration,collapsed:!1})},e2=(0,r.memo)(e=>{let{mermaid:t,className:s}=e,{switchToView:r,activeView:n,exitView:l}=(0,v.Z)(),o=(0,b.VJ)(e=>e.mermaidContent),d="mermaid"===n&&(null==o?void 0:o.mermaidCode)===t.mermaidCode,p=e=>{if(!e)return"Diagram";let t=e.trim().toLowerCase();return t.startsWith("graph")?"Flowchart":t.startsWith("sequencediagram")?"Sequence":t.startsWith("classdiagram")?"Class":t.startsWith("erdiagram")?"Entity Relationship":t.startsWith("journey")?"User Journey":t.startsWith("gitgraph")?"Git Graph":t.startsWith("pie")?"Pie Chart":t.startsWith("gantt")?"Gantt Chart":t.startsWith("statediagram")?"State":t.startsWith("mindmap")?"Mind Map":"Diagram"},h=p(t.mermaidCode),x=!t.done;return(0,a.jsx)(c.E.div,{className:"relative flex w-5/6 max-w-xs pb-4",initial:{opacity:0},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:(0,a.jsx)(u.z,{onClick:e=>{var s;e.stopPropagation(),t.done&&(d?l():r("mermaid",t),N.ZP.capture(w.SL.MERMAID.DIAGRAM_OPENED,{diagram_type:p(t.mermaidCode),code_length:(null===(s=t.mermaidCode)||void 0===s?void 0:s.length)||0}))},variant:"outline",className:(0,i.cn)("flex h-auto w-full cursor-pointer gap-2 rounded-xl p-3 text-sm font-medium shadow-none",x?"items-center":"items-start","border border-muted-border bg-muted text-foreground","transition-all duration-150 ease-in-out",x?"opacity-60 hover:border-muted-border hover:bg-muted":"hover:border-border hover:bg-muted-hover",d&&"border-affirmative-primary bg-affirmative hover:border-affirmative-primary hover:bg-affirmative hover:opacity-80",s),disabled:x,children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex h-5 items-center",children:(0,a.jsx)(m.Z,{name:"progress_activity",size:"small",className:"animate-spin"})}),(0,a.jsx)("span",{className:"flex-1 text-left",children:"Generating diagram..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex h-5 items-center",children:(0,a.jsx)(m.Z,{name:"auto_stories",size:"small"})}),(0,a.jsx)("span",{className:"flex-1 text-left",children:h}),(0,a.jsx)(m.Z,{name:"chevron_right"})]})})})});var e5=s(38109),e7=s(17779),e9=s(70778);let e6=e=>{let{codeContent:t}=e,[s,n]=(0,r.useState)(!1),i=async()=>{await navigator.clipboard.writeText(String(t)),n(!0),setTimeout(()=>n(!1),2e3)},{resolvedTheme:l}=(0,e5.F)(),o="dark"===l?e9.A:e9.g;return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{className:"hover:bg-card-hover absolute right-2 top-2 rounded-md bg-secondary p-1 transition-colors",onClick:i,children:(0,a.jsx)(m.Z,{name:s?"check":"content_copy",className:"h-4 w-4 text-foreground transition-all duration-300"})}),(0,a.jsx)("div",{className:"max-w-full overflow-x-auto",children:(0,a.jsx)(e7.Z,{children:String(t).replace(/\n$/,""),style:o,language:"sql",wrapLongLines:!0,PreTag:"div"})})]})};var e4=s(73197),e8=s(32307);let e3=e=>{var t;let{message:s,toolUse:r}=e,{onSubmit:n,isLatestMessage:i,isPending:l}=(0,e8.r)(s),o=(null===(t=r.parsedData)||void 0===t?void 0:t.secret_name)||"Secret";return(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("div",{className:"max-w-full",children:(0,a.jsx)(e4.w4,{userInput:[{type:"secret",data:{name:"secret_value",label:o,required:!0}}],disabled:!i||l,message:s,onSubmit:n})})})},te=e=>"parts"in e&&"done"in e,tt=e=>"lovSql"in e&&"done"in e,ts=e=>"mermaidCode"in e&&"done"in e,ta=e=>"content"in e&&""===e.content.trim(),tr=e=>{var t;let{message:s,edit:r,messageParts:n}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tn,{message:s,messageParts:n,edit:r}),s.stopped&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("span",{className:"inline-flex items-center text-muted-foreground",children:"This message was cancelled."})}),s.errors&&(0,a.jsx)(T,{edit:r,messageParts:n,errors:null!==(t=s.errors)&&void 0!==t?t:null}),(0,a.jsx)(eA,{message:s,messageId:s.id,lovActions:null==n?void 0:n.lovActions,sqlRunState:s.sqlRunState,persisted:s.persisted})]})},tn=e=>{let{message:t,messageParts:s,edit:r}=e;if(!s)return t.content.length>0?(0,a.jsx)(d.s,{displayCursor:!1,persisted:t.persisted,children:t.content||""}):null;let n=[],i=[],l=s.parts.some(e=>(0,o.Cg)(e)&&!e.done),c=e=>{i.length>0&&(n.push((0,a.jsx)(e1,{toolUses:i,isStreaming:l,isLastElement:e,messageCompleted:t.persisted},"tool-group-".concat(n.length))),i=[])};for(let e=0;e<s.parts.length;e++){let l=s.parts[e];if((0,o.Cg)(l)){if(l.failed)continue;if(l.name.includes("add_secret"))c(!1),n.push((0,a.jsx)(e3,{message:t,toolUse:l},e));else if(l.requiresApproval&&"lov-supabase-migration"!==l.name&&"supabase--migration"!==l.name)c(!1),n.push((0,a.jsx)(e4.wb,{message:t,toolUse:l},e));else if(i.push({name:l.name,parsedData:l.parsedData,done:l.done,duration:l.duration}),("lov-supabase-migration"===l.name||"supabase--migration"===l.name)&&l.parsedData&&l.parsedData.query){let t=l.parsedData.query.replace(/\\n/g,"\n").replace(/\\t/g,"	").replace(/\\r/g,"\r");n.push((0,a.jsx)(e6,{codeContent:t},e))}}else if(!ta(l)){if(c(!1),te(l))n.push((0,a.jsx)(eH,{message:t,edit:r,code:l},e));else if(tt(l))n.push((0,a.jsx)(e6,{codeContent:l.lovSql},e));else if(ts(l))n.push((0,a.jsx)(e2,{mermaid:l},e));else if("content"in l)n.push((0,a.jsx)(d.s,{displayCursor:!1,persisted:t.persisted,children:l.content},e));else throw Error("Unknown part type")}}return c(!0),(0,a.jsx)(a.Fragment,{children:n})},ti={},tl=e=>{let{message:t,isFirstAIMessage:s}=e,n=(0,l.tV)(t.editId),d=t.timeToFirstTokenMs;void 0===d?ti[t.id]=!0:ti[t.id]&&(ti[t.id]=!1);let c=(0,r.useMemo)(()=>t.content?function(e,t){if((null==e?void 0:e.parts.length)&&e.parts.length>0){let s=e.parts.find(e=>"object"==typeof e&&"type"in e&&"tool_use"===e.type&&"duration"in e);if(s){if(!t)return s.duration=void 0,e;let a=s.duration+Math.floor(t/1e3);s.duration=a}}return e}((0,o.hP)(t.content),d):null,[t.id,t.content,d]);return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-4 overflow-auto pl-8 text-left text-base leading-[22px]"),style:{overflowWrap:"anywhere"},children:(0,a.jsx)(tr,{message:t,edit:n,messageParts:c})})},to=e=>{let{branchName:t}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:"Switched branch to"}),(0,a.jsx)("div",{className:"flex items-center gap-2 rounded-full border border-muted-border bg-muted px-2 py-0.5",children:(0,a.jsx)("p",{children:t})})]})};var td=s(62970),tc=s(77658),tu=s(35127),tm=s(36190),tp=s(53259),th=s(33864);let tx=e=>{let{remixedProjectId:t,isLoading:s=!1}=e;return(0,a.jsxs)(et.cZ,{children:[(0,a.jsxs)(et.fK,{children:[(0,a.jsx)(et.$N,{children:s?"Remixing Project Snapshot...":"Project Snapshot Remixed Successfully"}),(0,a.jsx)(et.Be,{children:s?"Please wait while we remix your project snapshot. This may take a moment.":"Your project snapshot has been remixed to your local development environment."})]}),(0,a.jsx)(et.cN,{children:s?(0,a.jsxs)(u.z,{disabled:!0,children:[(0,a.jsx)(m.Z,{name:"progress_activity",size:"small",className:"animate-spin"}),"Remixing..."]}):(0,a.jsx)(u.z,{asChild:!0,children:(0,a.jsx)("a",{href:"http://localhost:3000/projects/".concat(t),target:"_blank",rel:"noreferrer",children:"Open Remixed Project"})})})]})};var tf=s(33877),tg=s(52078),tv=s(26052),tb=s(26047),tj=s(44647);let ty=e=>"https://us.posthog.com/project/47074/llm-observability/traces/".concat(e),tw=e=>{let{className:t}=e;return(0,a.jsx)(tv.C,{variant:"outline",className:t,children:"ADMIN"})},t_=e=>!!e&&!!(e.data_opt_out||(0,tj.gG)(e.plan)),tN=e=>{let{messageId:t,editId:s}=e,n=(0,h.D)(),i=(0,tb.v)(),l=(0,$.z)(tx),[o,d]=(0,r.useState)(!1),c=t_((0,tf.hO)(e=>e.projectWorkspace)),u=async()=>{l({childProps:{isLoading:!0}}),d(!0);try{let e=(0,em.SJ)(),s=await e.post("/projects/".concat(n,"/remix/snapshot"),{message_id:t,keep_supabase_connection:!0});l({childProps:{remixedProjectId:s.project_id,isLoading:!1}})}catch(e){ee.Am.error("Failed to remix project snapshot",{description:"An error occurred while remixing the project snapshot to local development."}),l(!1)}finally{d(!1)}},{switchToView:p}=(0,v.Z)();return i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tp.VD,{}),(0,a.jsxs)(tp.Xi,{className:"w-full gap-2",onClick:()=>{p("debug",t)},children:[(0,a.jsx)(m.Z,{name:"bug_report",size:"small"}),(0,a.jsx)("span",{children:"Debug"}),(0,a.jsx)(tw,{className:"ml-auto"})]}),!c&&(0,a.jsxs)(tp.Xi,{className:"w-full gap-2",onClick:()=>{p("annotation",t)},children:[(0,a.jsx)(m.Z,{name:"edit",size:"small"}),(0,a.jsx)("span",{children:"Annotate"}),(0,a.jsx)(tw,{className:"ml-auto"})]}),!c&&(0,a.jsxs)(tp.Xi,{className:"w-full gap-2",onClick:u,disabled:o,children:[(0,a.jsx)(m.Z,{name:"refresh",size:"small",className:o?"animate-spin":""}),(0,a.jsx)("span",{children:o?"Remixing...":"Remix Snapshot to Local"}),(0,a.jsx)(tw,{className:"ml-auto"})]}),i&&(0,a.jsx)(tp.Xi,{className:"w-full gap-2",asChild:!0,children:(0,a.jsxs)("a",{href:ty(t),target:"_blank",rel:"noreferrer",children:[(0,a.jsx)(m.Z,{name:"arrow_outward",size:"small"}),(0,a.jsx)("span",{children:"Posthog: View LLM Trace"}),(0,a.jsx)(tw,{className:"ml-auto"})]})}),(0,a.jsx)(tp.Xi,{className:"w-full gap-2",asChild:!0,children:(0,a.jsxs)("a",{href:(0,tg.pr)(n,t),target:"_blank",rel:"noreferrer",children:[(0,a.jsx)(m.Z,{name:"arrow_outward",size:"small"}),(0,a.jsx)("span",{children:"Firestore: Message"}),(0,a.jsx)(tw,{className:"ml-auto"})]})}),s&&(0,a.jsx)(tp.Xi,{className:"w-full gap-2",asChild:!0,children:(0,a.jsxs)("a",{href:(0,tg.oo)(n,s),target:"_blank",rel:"noreferrer",children:[(0,a.jsx)(m.Z,{name:"arrow_outward",size:"small"}),(0,a.jsx)("span",{children:"Firestore: Edit"}),(0,a.jsx)(tw,{className:"ml-auto"})]})})]}):null};var tC=s(47684);let tk=e=>{let{messageId:t}=e,s=(0,h.D)(),n=(0,tC.F)(),i=(0,r.forwardRef)((e,t)=>(0,a.jsx)(tp.Xi,{ref:t,...e,children:(0,a.jsxs)("div",{className:"flex w-full justify-between gap-4",onClick:()=>{N.ZP.capture(w.SL.ELLIPSIS.COPY_LINK_CLICKED)},children:[(0,a.jsx)("span",{children:"Copy message link"}),(0,a.jsx)(m.Z,{name:"link",size:"small",className:"ml-auto"})]})}));i.displayName="TriggerComponent";let l=n({TriggerComponent:i,textToCopy:"".concat(window.location.origin,"/projects/").concat(s,"?messageId=").concat(t)});return(0,a.jsxs)(y.u,{children:[(0,a.jsx)(y.aJ,{asChild:!0,children:l}),(0,a.jsx)(y._v,{children:"Copy link to clipboard"})]})},tS=e=>{let{commitSha:t,previewBuildStatus:s}=e,a=(0,I.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.latest_commit_sha}),{project_id:n}=(0,_.useParams)(),i=(0,I.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.name}),l=t===a,o=(0,r.useMemo)(()=>{if(t&&i)return(0,eZ.t)({projectName:i,sha:t})},[t,i]),{isDisabled:d,disabledReason:c}=(0,r.useMemo)(()=>"pending"===s?{isDisabled:!0,disabledReason:"Preview is being built..."}:"failed"===s?{isDisabled:!0,disabledReason:"Failed to build preview"}:o?{isDisabled:!1,disabledReason:void 0}:{isDisabled:!0,disabledReason:"There is no preview available for this version"},[o,s]),u=(0,r.useCallback)(e=>{let{eventName:s}=e;N.ZP.capture(s,{commit_sha:t,disabled:d,disabled_reason:c,is_latest_commit:l,preview_url:o,project_id:n})},[t,c,d,l,o,n]);return{previewUrl:o,isLatestCommit:l,isDisabled:d,disabledReason:c,onPreview:u}},tE=e=>{let{commitSha:t,previewBuildStatus:s}=e,{previewUrl:r,isDisabled:n,onPreview:i}=tS({commitSha:t,previewBuildStatus:s});return(0,a.jsx)(tp.Xi,{asChild:!0,disabled:n,children:(0,a.jsxs)("a",{className:"w-full",href:r,target:"_blank",rel:"noreferrer",onClick:()=>i({eventName:w.SL.ELLIPSIS.PREVIEW_CLICKED}),children:["Preview",(0,a.jsx)(m.Z,{name:"arrow_outward",className:"ml-auto",size:"small"})]})})},tI=e=>{let{editId:t,commitSha:s}=e,{onRevert:r,isDisabled:n}=A({editId:t,commitSha:s});return(0,a.jsxs)(tp.Xi,{className:"w-full",onClick:()=>r&&r({eventName:w.SL.ELLIPSIS.RESTORE_CLICKED}),disabled:n,children:["Restore",(0,a.jsx)(m.Z,{name:"restart_alt",className:"ml-auto",size:"small"})]})},tA=e=>{let{messageId:t,editId:s,costCredits:r,className:n,createdAt:i,senderName:o="Lovable"}=e,d=(0,l.tV)(s);return(0,a.jsxs)(tp.h_,{children:[(0,a.jsx)(tp.$F,{asChild:!0,className:n,children:(0,a.jsx)(u.z,{variant:"ghost",size:"icon-sm",children:(0,a.jsx)(m.Z,{name:"more_horiz",size:"small"})})}),(0,a.jsxs)(tp.AW,{align:"end",children:[(0,a.jsx)(tk,{messageId:t}),(0,a.jsx)(tE,{commitSha:null==d?void 0:d.commit_sha}),(0,a.jsx)(tI,{editId:s,commitSha:null==d?void 0:d.commit_sha}),void 0!==r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tp.VD,{}),(0,a.jsxs)(tp.Xi,{className:"cursor-default justify-between focus:bg-transparent focus:text-foreground",onSelect:e=>e.preventDefault(),children:[(0,a.jsx)("span",{children:"Credits used"}),(0,th.H)(r)]})]}),(0,a.jsx)(tN,{messageId:t,editId:s})]})]})},tP=e=>e<1e3?"1s":e<6e4?"".concat((e/1e3).toFixed(0),"s"):"".concat(Math.floor(e/6e4),"m ").concat(Math.floor(e%6e4/1e3),"s"),tz=e=>"userCommit"!==e.type&&"userMessage"!==e.type,tM=e=>{let{previousMessageId:t}=e,s=(0,l.aK)(e=>t?e.messages[t]:void 0);return s&&"revertSuccess"!==s.type&&!tz(s)?(0,a.jsx)(tD,{className:"mb-2"}):null},tZ=e=>{let{message:t}=e,s=(0,td.z)(e=>e.showHistory),r=(0,tu.zq)();return s?null:(0,a.jsxs)("div",{className:"mb-3 flex min-w-0 items-center gap-1 text-ellipsis text-nowrap text-muted-foreground @container md:text-sm",children:[(0,a.jsxs)("div",{className:"flex min-w-0 flex-1 items-center leading-none",children:[(0,a.jsx)(tD,{className:"shrink-0 leading-none"}),r&&void 0!==t.thinkingTimeMs&&t.thinkingTimeMs>0&&("completed"===t.status||"stopped"===t.status)&&(0,a.jsxs)("span",{className:"ml-2 mt-px hidden min-w-0 truncate whitespace-nowrap opacity-100 transition-opacity duration-150 ease-out group-hover:opacity-100 @md:inline-block md:opacity-0",children:["Worked for ",tP(t.thinkingTimeMs)]}),(0,a.jsxs)(y.u,{children:[(0,a.jsx)(y.aJ,{asChild:!0,children:(0,a.jsx)("span",{className:(0,i.cn)("ml-auto mt-px flex-shrink cursor-default overflow-hidden opacity-100 transition-opacity duration-150 ease-out group-hover:opacity-100 md:opacity-0"),children:(0,tm._g)(t.createdAt)})}),(0,a.jsx)(y._v,{children:t.createdAt.toLocaleString()})]})]}),(0,a.jsx)(tA,{className:"shrink-0",messageId:t.id,editId:t.editId,costCredits:t.costCredits,createdAt:t.createdAt})]})},tD=e=>{let{className:t}=e;return(0,a.jsxs)("div",{className:(0,i.cn)("flex items-center gap-2 pl-2",t),children:[(0,a.jsx)(tc.xx,{className:(0,i.cn)("mr-1.5 h-3.5 md:mr-1")}),(0,a.jsx)("span",{className:(0,i.cn)("whitespace-nowrap text-lg font-medium md:text-base"),children:"Lovable"})]})};var tL=s(75970),tR=s(84516),tT=s(60468);let tO=e=>{let{message:t}=e,{authUser:s}=(0,tL.Eu)(),r=(0,tR.c)(e=>e.collaborators).find(e=>e.id===t.userId),n=(0,tf.hO)(e=>e.membership),i=r||n;if((null==r?void 0:r.id)===(null==s?void 0:s.uid)||(null==n?void 0:n.user_id)===(null==s?void 0:s.uid)||!i)return null;let l=i.display_name===t.userId?i.email:i.display_name;return(0,a.jsxs)("div",{className:"mt-4 flex max-w-full items-center gap-1.5 self-start truncate pl-2 text-sm font-medium",children:[(0,a.jsx)(tT.Y,{user:{id:t.userId||"",username:l||""},className:"h-5 w-5 text-xs"}),(0,a.jsx)(F.default,{className:"min-w-0 truncate hover:underline",href:"/@".concat(i.username),children:l})]})},tF=e=>{let{message:t,previousMessageId:s}=e;switch(t.type){case"userCommit":return null;case"userMessage":return(0,a.jsx)(tO,{message:t});case"branchSwitched":case"revertSuccess":return(0,a.jsx)(tM,{message:t,previousMessageId:s});case"aiMessage":return(0,a.jsx)(tZ,{message:t})}};var tU=s(34550),tV=s(92044);let tW=e=>{let{shortCommitHash:t,scrollToEdit:s,newUI:i=!1}=e,{loadMessagesFromId:o}=(0,l.mx)(),{exitView:d,switchToView:u,activeView:p}=(0,v.Z)(),{setActiveEditId:h}=(0,b.RA)(),x=(0,l.uO)(t),f=(0,b.VJ)(e=>e.activeMessageId),g=(0,l.Fm)(null==x?void 0:x.id),j=f===(null==x?void 0:x.id)&&"codeViewer"===p,[y,_]=(0,r.useState)("idle");(0,r.useEffect)(()=>{j&&h(null==x?void 0:x.id)},[j,x,h]);let C=(0,r.useCallback)(()=>{x&&(j?(N.ZP.capture(w.SL.CONSOLE.EXITED_VIA_CARD),d()):(N.ZP.capture(w.SL.CODE_CARD.VIEW_CODE_CLICKED),u("codeViewer",{code:void 0,errors:void 0,messageId:x.id,editId:x.id,hasDiffs:!0})))},[x,j,d,u]);if(!x)return null;let k=async()=>{_("loading");try{x.type===tV.I.type.DEVELOPER_UPDATE?(await o({messageId:x.id,id_type:"edit_id"}),s({type:"shortCommitHash",value:t})):(await o({messageId:x.id,id_type:"edit_id"}),s({type:"editId",value:x.id})),_("success")}catch(e){ee.Am.error("Could not scroll to edit. Try refreshing the page."),_("error"),n.logging.warn("Firestore error - RevertChipV2 - scroll to edit",{error:e,editId:null==x?void 0:x.id,shortCommitHash:t})}},S="loading"===y;return i?g?"aiMessage"!==g.type?(tU.Tb(Error("RevertChip: message is not an AI message"),{level:"error"}),null):(0,a.jsx)("div",{className:"flex flex-col gap-2 leading-[22px]",style:{overflowWrap:"anywhere"},children:(0,a.jsxs)(c.E.div,{className:"relative mb-6 mt-3 flex w-5/6 max-w-sm",initial:{opacity:1},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:[S&&(0,a.jsx)("div",{className:"absolute inset-0 z-10 flex items-center justify-center rounded-md bg-background/80",children:(0,a.jsx)(m.Z,{className:"animate-spin",name:"progress_activity",size:"small"})}),(0,a.jsx)(eU,{variant:"revert",message:g,edit:x,onClick:C,isActive:j})]})}):null:(0,a.jsxs)("button",{className:"flex items-center disabled:opacity-50",onClick:k,disabled:S,children:[(0,a.jsx)("span",{className:"ml-6 mr-2 text-sm text-muted-foreground",children:"Restored"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-full border border-muted-border bg-muted px-3 py-1.5 transition-colors hover:bg-muted-hover",children:[(0,a.jsx)("span",{className:"max-w-xs truncate text-sm",title:x.commit_message,"aria-label":x.commit_message,children:x.commit_message}),S&&(0,a.jsx)(m.Z,{className:"ml-1 animate-spin",name:"progress_activity",size:"small"})]})]})},tH=e=>{var t,s,r;let{message:n}=e,o=(0,l.uO)(n.shortCommitHash),d={done:!0,parts:null!==(s=null==o?void 0:null===(t=o.diff)||void 0===t?void 0:t.map(e=>({type:"writing_file",file_path:e.file_path,done:!0,content:e.new_content})))&&void 0!==s?s:[]},u=(0,E.Y)({editId:null==o?void 0:o.id,commitSha:null==o?void 0:o.commit_sha}),{isActive:p}=eM(o),h=eL({edit:o,messageId:n.id,code:d});return o?(0,a.jsx)(c.E.div,{className:"relative ml-6 flex w-5/6 max-w-xs pb-4",initial:{opacity:1},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:(0,a.jsxs)(eO,{edit:o,message:n,code:d,onClick:h.handleOpenPreview,children:[(0,a.jsx)("div",{className:"flex h-5 items-center",children:(0,a.jsx)(tc.xR.GitHub,{className:"mt-px h-4 w-4 text-foreground"})}),(0,a.jsxs)("div",{className:"flex w-full flex-col gap-1 overflow-hidden text-left",children:[(0,a.jsx)("span",{className:(0,i.cn)("truncate",{"text-foreground":p}),children:null!==(r=o.commit_message)&&void 0!==r?r:"No commit message"}),(0,a.jsx)("span",{className:"truncate font-normal",children:u?"Active Edit":"See Preview"})]}),(0,a.jsx)(m.Z,{name:"chevron_right"})]})}):null};var tK=s(91935),tq=s(18587);let tJ=(0,r.memo)(e=>{var t;let{messageId:s,edit:n,simplified:o=!1}=e,{commit_sha:d}=null!=n?n:{},{switchToView:c,exitView:m,activeView:p}=(0,v.Z)(),h=(0,b.VJ)(e=>e.activeEditId),x=(0,l.aK)(e=>e.edits),f=h?x[h]:null,g=(0,I.iZ)(e=>e.project),{toggleBookmark:j}=(0,eR.g)((null==g?void 0:g.id)||""),y=(0,r.useMemo)(()=>{if(d&&g)return(0,eZ.t)({projectId:null==g?void 0:g.id,sha:d})},[d,g]),w=(0,E.Y)({editId:null==n?void 0:n.id,commitSha:null!==(t=null==n?void 0:n.commit_sha)&&void 0!==t?t:void 0}),_=n&&(null==f?void 0:f.id)===(null==n?void 0:n.id)&&"snapshot"===p||w&&!f&&!p,N=(0,r.useMemo)(()=>{if(!(null==n?void 0:n.created_at))return null;let e=new Date(1e3*n.created_at.seconds);return{relative:(0,tK.l)(e,new Date),absolute:(0,tq.WU)(e,"MMM d, yyyy, h:mm a")}},[n]),C=(0,r.useCallback)(e=>{if(e.altKey){window.open(y,"_blank");return}if(_||w){m();return}c("snapshot",{messageId:s,editId:null==n?void 0:n.id,previewUrl:y})},[n,m,_,w,s,y,c]),k=(0,r.useCallback)(e=>{e.stopPropagation(),(null==n?void 0:n.id)&&j(n.id,!!n.bookmarked)},[n,j]),S=(0,r.useMemo)(()=>{if(n){let{commit_message:e,reverted:t}=null!=n?n:{};return(0,a.jsxs)("div",{className:"flex w-full flex-col gap-1 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-x-2 gap-y-1",children:[(0,a.jsx)("span",{className:"flex items-center gap-1 truncate",children:e}),(w||t)&&!o&&(0,a.jsx)(tv.C,{className:"border-0 py-0",variant:w?"default":"destructive",children:w?"Current":"Reverted"})]}),(0,a.jsx)("span",{className:"text-sm font-normal text-muted-foreground",children:N?(0,a.jsx)(a.Fragment,{children:N.absolute}):_?"Click to Exit Preview":"Click to Preview"})]})}return(0,a.jsxs)("div",{className:"flex w-full flex-col overflow-hidden",children:[(0,a.jsx)("span",{children:"No preview available"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"\xa0"})]})},[n,_,w,N,o]);return(0,a.jsxs)(u.z,{onClick:C,disabled:!n,className:(0,i.cn)("mb-2 flex h-auto w-full cursor-pointer items-start gap-2 rounded-lg p-3 text-left text-sm font-medium transition-colors duration-150 ease-in-out","border border-muted-border bg-muted text-foreground","hover:border-border hover:bg-muted-hover",{"border-affirmative-primary bg-affirmative hover:border-affirmative-primary hover:bg-affirmative/80":_},{"hover:cursor-auto hover:bg-affirmative":_&&w}),children:[(0,a.jsx)(eT.Z,{onClick:k,isBookmarked:!!n&&!!n.bookmarked&&(null==n?void 0:n.bookmarked),className:"mt-[3px]"}),S]})});tJ.displayName="LegacyPreviewCard";let tY=e=>{var t;let{message:s}=e,r=(0,l.tV)(s.editId);return(null==r?void 0:null===(t=r.diff)||void 0===t?void 0:t.length)?(0,a.jsx)(eH,{code:{done:!0,parts:r.diff.map(e=>({type:"writing_file",file_path:e.file_path,done:!0,content:e.new_content}))},message:s,edit:r}):(0,a.jsx)("div",{className:"relative w-5/6 max-w-xs",children:(0,a.jsx)(tJ,{edit:r,messageId:s.id})})};var tB=s(37355),tG=s(10683);let tX=e=>{let{download:t}=(0,tB.F)(),[s,a]=(0,r.useState)(void 0),{store:n,cacheImageUrl:i}=(0,l.mx)(),o=n.getState().imageUrlCache,d="".concat(e.dir_name,"/").concat(e.file_name),c=(0,r.useRef)(!1);return(0,r.useEffect)(()=>{c.current||(c.current=!0,(async()=>{if(o[d]){a(o[d]);return}let{url:s}=await t({dir_name:e.dir_name,file_name:e.file_name});a(s),i(d,s)})())},[t,e,d,o,i]),s},t$=e=>{var t;let{images:s,optimistImageUrls:r}=e,n=s.length+(null!==(t=null==r?void 0:r.length)&&void 0!==t?t:0)===1;return(0,a.jsxs)("div",{className:(0,i.cn)("mb-2 ml-auto flex max-w-[240px] flex-wrap justify-end gap-2 md:max-w-[240px]"),children:[null==r?void 0:r.map((e,t)=>(0,a.jsx)(t0,{imageUrl:e,singleImage:n},t)),s.map((e,t)=>(0,a.jsx)(tQ,{image:e,singleImage:n},t))]})},tQ=e=>{let{image:t,singleImage:s}=e,r=tX(t);return(0,a.jsx)(t0,{imageUrl:r,singleImage:s})},t0=e=>{let{imageUrl:t,singleImage:s}=e,{setSelectedImageUrl:n}=(0,l.mx)(),o=(0,tG.Eh)(e=>e.setImages),d=(0,tG.Eh)(e=>e.images),[c,p]=(0,r.useState)(!1),[h,x]=(0,r.useState)(!1),[f,g]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),j=(0,eb.Z)("md"),y=(0,r.useCallback)(()=>{t&&n(t)},[t,n]),_=(0,r.useCallback)(async e=>{if(e.stopPropagation(),t&&!c){b(!0),setTimeout(()=>b(!1),500);try{let e=await fetch(t),s=await e.blob();await navigator.clipboard.write([new ClipboardItem({[s.type]:s})]),p(!0),N.ZP.capture(w.SL.CHAT.IMAGE_COPIED,{image_type:s.type,image_size:s.size}),setTimeout(()=>{p(!1)},2e3)}catch(e){(0,eu.Eo)("Failed to copy image")}}},[t,c]),C=(0,r.useCallback)(async e=>{if(e.stopPropagation(),t&&!h){if(d.length>=10){ee.Am.error("Image limit reached",{description:"Please limit your message to ".concat(10," images.")});return}b(!0),setTimeout(()=>b(!1),500),x(!0);try{let e=await fetch(t),s=await e.blob(),a="image-".concat(Date.now(),".").concat(s.type.split("/")[1]||"png"),r=new File([s],a,{type:s.type}),n={url:URL.createObjectURL(r),name:a,uploading:!1,uploaded:!1,id:(0,U.Z)()};o(e=>[...e,n]),g(!0),N.ZP.capture(w.SL.CHAT.IMAGE_ADDED_TO_INPUT,{image_type:s.type,image_size:s.size,current_image_count:d.length+1}),setTimeout(()=>{g(!1)},2e3)}catch(e){(0,eu.Eo)("Failed to add image to chat")}finally{x(!1)}}},[t,h,d.length,o]);return(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)(u.z,{variant:"ghost",className:(0,i.cn)("relative inline-block p-0 hover:bg-transparent",{"h-[120px] w-[200px] md:h-[90px] md:w-[160px]":s,"h-24 w-24 md:h-16 md:w-16":!s}),type:"button",disabled:!t,onClick:y,children:t?(0,a.jsxs)("div",{className:"group/image-hover relative h-full w-full",children:[(0,a.jsx)("img",{loading:"lazy",src:t,alt:"chat image",className:"h-full w-full rounded-lg border object-cover"}),!j&&(0,a.jsxs)("div",{className:(0,i.cn)("pointer-events-none absolute inset-0 flex items-center justify-center gap-1 rounded-lg bg-black/50 opacity-0 transition-opacity duration-200",{"group-hover/image-hover:opacity-100":!v,"opacity-100":v}),children:[(0,a.jsx)(u.z,{variant:"secondary",size:"icon-sm",onClick:_,disabled:c,className:"pointer-events-auto h-6 w-6 bg-white/90 text-black hover:bg-white disabled:bg-white/90 disabled:text-black disabled:opacity-100",children:(0,a.jsx)(m.Z,{name:c?"check":"content_copy",className:"h-3 w-3"})}),(0,a.jsx)(u.z,{variant:"secondary",size:"icon-sm",onClick:C,disabled:h||f,className:"pointer-events-auto h-6 w-6 bg-white/90 text-black hover:bg-white disabled:bg-white/90 disabled:text-black disabled:opacity-100",children:(0,a.jsx)(m.Z,{name:f?"check":"add_photo_alternate",className:"h-3 w-3"})})]})]}):(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-lg border bg-background/80",children:(0,a.jsx)(m.Z,{name:"progress_activity",size:"small",className:"animate-spin"})})})})};var t1=s(36839),t2=s(48588),t5=s(4918);let t7=e=>{let{content:t,open:s,onOpenChange:r,openText:n,closedText:l}=e;return(0,a.jsxs)(t5.z,{open:s,onOpenChange:r,className:"mt-4 max-w-[300px] overflow-hidden rounded-lg border border-muted-border",children:[(0,a.jsx)(t5.w,{asChild:!0,children:(0,a.jsxs)(u.z,{variant:"secondary",className:(0,i.cn)("h-10 w-full justify-between pr-2 text-sm font-medium transition-all duration-200 ease-out",s&&"rounded-b-none"),children:[s?n:l,(0,a.jsx)(m.Z,{name:s?"unfold_less":"unfold_more",size:"small",className:"transition-transform duration-200 ease-out"})]})}),(0,a.jsx)(c.E.div,{initial:{height:0},animate:{height:s?"auto":0},exit:{height:0},transition:{type:"spring",bounce:0,duration:.4},style:{overflow:"hidden"},children:(0,a.jsx)("pre",{className:"rounded-b-md border-t border-muted-border bg-secondary p-4 py-2 text-sm",children:(0,a.jsx)("code",{className:"block max-h-[300px] overflow-x-auto overflow-y-auto whitespace-pre-wrap break-words",children:t})})})]})},t9=e=>{let{messageContent:t}=e,{error:s}=t6(t),[n,i]=(0,r.useState)(!1);return(0,a.jsx)(t7,{content:s,open:n,onOpenChange:i,openText:"Error",closedText:"Error"})};function t6(e){let t=e.match(/([\s\S]+)```([\s\S]+)```\n+$/);return t?{error:t[2].trim(),text:t[1].trim()}:(n.logging.error("no_error_message_found_in_input",{input:e}),{error:"",text:e})}var t4=s(4494);let t8=e=>{let{finding:t}=e;return(0,a.jsxs)("div",{className:"w-full max-w-full rounded-lg border border-muted-border",children:[(0,a.jsxs)("div",{className:"flex h-10 w-full items-center justify-between rounded-b-none px-4 pr-2 text-sm text-muted-foreground",children:["Security Fix",(0,a.jsx)(tv.C,{variant:(0,t4.M$)(t.level),className:"flex-shrink-0 text-xs",children:(0,t4._s)(t.level)})]}),(0,a.jsx)("div",{className:"flex w-full min-w-0 items-center justify-between gap-4 rounded-b-md border-t border-muted-border p-3 pl-4 text-sm",children:(0,a.jsxs)(y.u,{children:[(0,a.jsx)(y.aJ,{asChild:!0,children:(0,a.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,a.jsx)("span",{className:"w-full truncate font-medium",children:t.name}),(0,a.jsx)(m.Z,{name:"info",size:"small",className:"flex-shrink-0 text-muted-foreground"})]})}),(0,a.jsx)(y._v,{className:"max-w-md whitespace-pre-line",children:t.description})]})})]})},t3=()=>(0,a.jsxs)("div",{className:"w-full rounded-lg border border-muted-border",children:[(0,a.jsxs)("div",{className:"flex h-10 w-full items-center justify-between rounded-b-none px-4 pr-2 text-sm font-medium",children:["Security Review",(0,a.jsx)(m.Z,{name:"security",size:"small"})]}),(0,a.jsx)("div",{className:"rounded-b-md border-t border-muted-border p-4 py-2 text-sm",children:(0,a.jsx)("span",{className:"text-muted-foreground",children:"Analyzing codebase for security vulnerabilities"})})]}),se=e=>{let{content:t}=e,[s,n]=(0,r.useState)(!1);return(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Write the code to create a new integration or update the existing integration with Supabase."}),(0,a.jsx)(t7,{content:t,open:s,onOpenChange:n,openText:"Hide detailed instructions",closedText:"Show detailed instructions"})]})},st=e=>{let{content:t,selectedElements:s,containsError:n,tags:i,isSecurityReview:l}=e,o=(0,r.useMemo)(()=>(0,t2.Oh)(t),[t]);return(0,a.jsxs)("div",{children:[(0,a.jsx)(sr,{selectedElements:s}),o?(0,a.jsx)(t8,{finding:o}):l?(0,a.jsx)(t3,{}):(0,a.jsx)(sn,{content:t,containsError:n}),(0,a.jsx)(ss,{content:t,tags:i})]})},ss=e=>{let{content:t,tags:s}=e;return s.includes("supabase-integration-update")?(0,a.jsx)(se,{content:t}):null},sa=e=>{let{elementType:t}=e,s=(0,t1.a)(t);return s?(0,a.jsx)(m.Z,{name:s,className:"size-4 text-black dark:text-white"}):null},sr=e=>{let{selectedElements:t}=e;return 0===t.length?null:(0,a.jsx)("div",{className:"mb-2 flex flex-wrap gap-2",children:t.map((e,t)=>{var s,r;return(0,a.jsxs)(y.u,{children:[(0,a.jsx)(y.aJ,{asChild:!0,children:(0,a.jsxs)("div",{className:(0,i.cn)((0,u.d)({variant:"outline",size:"sm"}),"flex items-center gap-2 text-xs"),children:[(0,a.jsx)(sa,{elementType:e.elementType}),(0,a.jsx)("span",{children:e.elementType})]})}),(0,a.jsxs)(y._v,{side:"top",children:["Line ",e.lineNumber," in ",null===(r=e.filePath)||void 0===r?void 0:null===(s=r.split)||void 0===s?void 0:s.call(r,"/").pop()]})]},t)})})},sn=e=>{let{content:t,containsError:s}=e,{text:n,error:i}=(0,r.useMemo)(()=>s?t6(t):{text:t,error:null},[t,s]);return(0,a.jsxs)(a.Fragment,{children:[n,i&&(0,a.jsx)(t9,{messageContent:t})]})},si=e=>{let{message:t}=e,{authUser:s}=(0,tL.Eu)(),r=(0,tR.c)(e=>e.collaborators).find(e=>e.id===t.userId),n=(0,tf.hO)(e=>e.membership);if(t.content.includes(e8.L))return null;let l=(null==r?void 0:r.id)===(null==s?void 0:s.uid)||(null==n?void 0:n.user_id)===(null==s?void 0:s.uid);return(0,a.jsxs)("div",{className:(0,i.cn)("flex flex-col",l?"items-end":"items-start pl-8"),children:[(0,a.jsx)(t$,{images:t.images,optimistImageUrls:t.optimistImageUrls}),(0,a.jsx)("div",{className:(0,i.cn)("overflow-wrap-anywhere overflow-auto whitespace-pre-wrap rounded-xl bg-transparent px-0 py-1.5 text-lg leading-[22px] md:text-base",{"max-w-[80%] bg-secondary px-3 py-3":l}),children:(0,a.jsx)(st,{content:t.content,selectedElements:t.selectedElements,containsError:t.containsError,tags:t.tags,isSecurityReview:t.isSecurityReview})})]})},sl=(0,r.memo)(e=>{let{messageId:t,previousMessageId:s,isLastMessage:o=!1,newMessageMinHeight:d,scrollToEdit:c}=e,u=(0,l.aK)(e=>e.messages[t]),m=(0,l.aK)(e=>e.sortedMessageIds).indexOf(t),p=(0,r.useMemo)(()=>(null==u?void 0:u.type)==="aiMessage"&&(1===m||m<2),[u,m]),h=(0,r.useMemo)(()=>{if(!u)return null;switch(u.type){case"userMessage":return(0,a.jsx)(si,{message:u});case"userCommit":return(0,a.jsx)(tH,{message:u});case"aiMessage":return(0,a.jsx)(tl,{message:u,isFirstAIMessage:p});case"branchSwitched":return(0,a.jsx)(to,{branchName:u.branchName});case"revertSuccess":return(0,a.jsx)(tW,{shortCommitHash:u.shortCommitHash,scrollToEdit:c});case"manualEdit":var e;return(0,a.jsxs)("div",{className:"ml-6",children:[(0,a.jsx)(tY,{message:u}),u.errors&&(0,a.jsx)(T,{errors:null!==(e=u.errors)&&void 0!==e?e:null})]});default:return n.logging.error("Unknown message role",{message:u}),null}},[u,p,c]),x=(0,r.useMemo)(()=>({minHeight:o&&d?d+"px":"auto"}),[o,d]);return u?(0,a.jsxs)("div",{className:(0,i.cn)("group flex flex-col pb-4 pr-2",{"pb-20":o&&"aiMessage"===u.type}),"data-message-id":u.id,"data-message-edit-id":so(u),style:x,id:u.id,children:[(0,a.jsx)(tF,{message:u,previousMessageId:s}),(0,a.jsx)("div",{className:(0,i.cn)({"pl-2":"userMessage"!==u.type,"pl-1 md:pl-0":"aiMessage"===u.type}),children:h})]}):null});sl.displayName="ChatItem";let so=e=>{if("aiMessage"===e.type)return e.editId}},48890:function(e,t,s){"use strict";s.d(t,{t:function(){return eK}});var a=s(52155),r=s(17195),n=s(98244),i=s(54961),l=s(86338),o=s(51117),d=s(81858),c=s(62970),u=s(76816),m=s(76647),p=s(53259),h=s(99792),x=s(69130),f=s(75748),g=s(89671),v=s(4578),b=s(83250),j=s(77658);let y=e=>{let{onFileUpload:t}=e,s=(0,d.T_)("ChatInputActionMenu"),[i,l]=(0,n.useState)(!1),{isMac:o}=(0,x.Z)(),{openSettings:y}=(0,u.r)(),{canEdit:w}=(0,f.t)(),_=(0,m.G)(),N=(0,c.z)(e=>e.showHistory),{setShowHistory:C}=(0,c.VF)();return(0,a.jsxs)(p.h_,{open:i,onOpenChange:l,children:[(0,a.jsx)(p.$F,{asChild:!0,children:(0,a.jsx)("button",{className:(0,v.cn)("flex size-6 items-center justify-center rounded-full border border-muted-border text-muted-foreground outline-none duration-150 ease-out","shrink-0 transition-colors hover:bg-muted-hover",i&&"bg-muted-active"),children:(0,a.jsx)(h.Z,{name:"add",size:"small",className:(0,v.cn)("transition-transform",i&&"rotate-[135deg]")})})}),(0,a.jsxs)(p.AW,{align:"start",className:"min-w-[240px]",children:[_&&(0,a.jsxs)(p.Xi,{onClick:()=>y("github"),children:[(0,a.jsx)(j.xR.GitHub,{className:"h-4 w-4"}),(0,a.jsx)("p",{children:"GitHub"})]}),(0,a.jsxs)(p.Xi,{onClick:()=>{N||r.ZP.capture(g.SL.TABS.HISTORY_OPENED),C(e=>!e)},children:[(0,a.jsx)(h.Z,{name:"history_2"}),(0,a.jsx)("p",{children:s("history")})]}),w&&(0,a.jsxs)(p.Xi,{onClick:()=>y("knowledge"),children:[(0,a.jsx)(h.Z,{name:"school"}),(0,a.jsx)("p",{children:s("knowledge")})]}),w&&(0,a.jsxs)(p.Xi,{onClick:()=>y("project"),children:[(0,a.jsx)(h.Z,{name:"settings"}),(0,a.jsx)("p",{children:s("projectSettings")}),o?(0,a.jsx)(p.KM,{className:"hidden sm:flex",children:"."}):(0,a.jsx)(p.KM,{className:"hidden sm:flex",children:"Ctrl."})]}),_&&(0,a.jsxs)(p.Xi,{onClick:()=>y("supabase"),children:[(0,a.jsx)(b.Z,{className:"h-4 w-auto",viewBox:"0 0 109 113"}),(0,a.jsx)("p",{children:"Supabase"})]}),(0,a.jsx)(p.VD,{}),(0,a.jsxs)(p.Xi,{onClick:t,children:[(0,a.jsx)(h.Z,{name:"add_photo_alternate"}),(0,a.jsx)("p",{children:s("attach")})]})]})]})};var w=s(66112),_=s(73181),N=s(52162),C=s(88182),k=s(71919),S=s(93946),E=s(36839);let I=e=>{let{elementType:t}=e,s=(0,E.a)(t);return s?(0,a.jsx)(h.Z,{name:s,fill:"white",className:"size-4"}):null},A=(0,n.memo)(()=>{let e=(0,k.UC)(e=>e.selectedElements),{removeSelectedElement:t}=(0,k.S9)(),s=e=>{var t,s;return"Line ".concat(e.lineNumber," in ").concat(null===(s=e.filePath)||void 0===s?void 0:null===(t=s.split)||void 0===t?void 0:t.call(s,"/").pop())},[r,i]=(0,n.useState)(null),l=(0,n.useCallback)(()=>{r&&t(r)},[r,t]);return(null==e?void 0:e.length)?(0,a.jsx)("div",{className:"bg-transparent",children:(0,a.jsx)("ul",{className:"flex flex-wrap gap-2",children:(0,a.jsx)(N.M,{mode:"popLayout",children:e.map(e=>(0,a.jsx)(C.E.li,{initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.6,transition:{duration:.15}},transition:{duration:.1,ease:[.5,1,.89,1],opacity:{duration:.1}},layoutId:"".concat(e.filePath,"-").concat(e.lineNumber),children:(0,a.jsx)(S.Z,{label:s(e),side:"top",children:(0,a.jsxs)("button",{className:"flex h-full w-full cursor-pointer items-center gap-0.5 rounded-md p-1 pr-2 hover:bg-background",onMouseEnter:()=>i(e),onMouseLeave:()=>i(null),onClick:l,children:[(0,a.jsx)(N.M,{mode:"wait",children:(0,a.jsx)(C.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"flex-shrink-0",children:r!==e?(0,a.jsx)(I,{elementType:e.elementType}):(0,a.jsx)(h.Z,{name:"close",size:"small"})},r===e?"close":"element")}),(0,a.jsx)("span",{className:"flex-grow select-none truncate text-left text-xs",children:"".concat(e.elementType)})]})})},"".concat(e.filePath,"-").concat(e.lineNumber)))})})}):null});A.displayName="ChatInputSelectElementsRow",(0,n.memo)(e=>{var t,s;let{element:r,onRemoveElement:i}=e,[l,o]=(0,n.useState)(!1);return(0,a.jsx)(S.Z,{label:"Line ".concat(r.lineNumber," in ").concat(null===(s=r.filePath)||void 0===s?void 0:null===(t=s.split)||void 0===t?void 0:t.call(s,"/").pop()),side:"top",children:(0,a.jsxs)("button",{onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),className:"group/select-element flex h-full w-full cursor-pointer items-center gap-0.5 rounded-md p-1 pr-2 hover:bg-background",onClick:()=>i(r),children:[(0,a.jsx)(N.M,{mode:"wait",children:(0,a.jsx)(C.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"flex-shrink-0",children:l?(0,a.jsx)(h.Z,{name:"close",size:"small"}):(0,a.jsx)(I,{elementType:r.elementType})},l?"close":"element")}),(0,a.jsx)("span",{className:"flex-grow select-none truncate text-left text-xs",children:"".concat(r.elementType)})]})})}).displayName="ChatInputSelectElement";var P=s(20827),z=s(93023),M=s(21198),Z=s(3989),D=s(59561),L=s(58915),R=s(84183);let T="chat-mode-nudge-last-shown",O=()=>{try{let e=localStorage.getItem(T);if(!e)return!0;let t=parseInt(e,10);return Date.now()-t>=12096e5}catch(e){return!0}},F=()=>{try{localStorage.setItem(T,Date.now().toString())}catch(e){}},U=e=>{let{projectId:t}=e,s=(0,d.T_)("ChatModeToggle"),{isAgentModeDefault:i}=(0,l.v)(),o=(0,Z.hT)(e=>e.chatMode===Z.jE.CHAT_ONLY),{setChatMode:c}=(0,Z.VK)(),u=(0,M.iY)(),[m,p]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{p(!!(null==u?void 0:u.isStuck)&&!o&&!(null==u?void 0:u.chatOnly)&&O())},[u,o]),(0,a.jsxs)(L.J2,{open:m,children:[(0,a.jsx)(L.xo,{asChild:!0,children:(0,a.jsx)("div",{children:(0,a.jsxs)(R.u,{children:[(0,a.jsx)(R.aJ,{asChild:!0,children:(0,a.jsxs)(D.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{r.ZP.capture("chat_mode_toggled",{state:o,project_id:t,stuck_popover_shown:m}),p(!1),m&&F(),o&&F(),c(o?i?Z.jE.AGENT:Z.jE.DEFAULT:Z.jE.CHAT_ONLY)},className:(0,v.cn)("flex h-6 gap-1 rounded-full border py-0 pl-1.5 pr-2.5 font-normal text-muted-foreground hover:border-border hover:bg-transparent md:hover:bg-accent md:hover:text-muted-foreground",{"border-affirmative-primary bg-affirmative-primary text-affirmative-primary-foreground hover:border-affirmative-primary hover:bg-affirmative-primary hover:text-affirmative-primary-foreground md:hover:bg-affirmative-primary/90 md:hover:text-affirmative-primary-foreground":o}),children:[(0,a.jsx)(h.Z,{name:"emoji_objects",size:"small"}),s("chat")]})}),(0,a.jsx)(R._v,{className:"hidden max-w-[35ch] md:flex",children:(0,a.jsx)("p",{children:s("chatTooltip")})})]})})}),(0,a.jsxs)(L.yk,{children:[(0,a.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,a.jsx)("p",{className:"font-medium text-popover-foreground",children:s("feelingStuck")}),(0,a.jsx)(h.Z,{name:"close",className:"cursor-pointer text-muted-foreground",onClick:()=>{p(!1),c(Z.jE.DEFAULT),F(),r.ZP.capture("stuck_popover_dismissed",{project_id:t,message_id:null==u?void 0:u.id})}})]}),(0,a.jsx)("p",{className:"text-muted-foreground",children:s("useChatMode")})]})]})};var V=s(79151),W=s(10086),H=s(52922),K=s(77162);let q=e=>{let{className:t,disabled:s=!1,isSendingDisabled:r=!1}=e,i=(0,K.v)(),{showStopAction:l,mutation:o}=(0,H.q)({projectId:null!=i?i:void 0}),d=(0,n.useCallback)(async()=>{await o.mutateAsync()},[o]);return i&&(l||o.isPending)?(0,a.jsx)("button",{type:"button",className:(0,v.cn)("flex size-6 items-center justify-center rounded-full bg-foreground text-background transition-opacity duration-150 ease-out disabled:cursor-not-allowed disabled:opacity-50",t),disabled:o.isPending,onClick:d,children:(0,a.jsx)(h.Z,{name:"stop_fill",size:"small"})}):(0,a.jsx)("button",{id:"chatinput-send-message-button",type:"submit",className:(0,v.cn)("flex size-6 items-center justify-center rounded-full bg-foreground text-background transition-opacity duration-150 ease-out disabled:cursor-not-allowed disabled:opacity-50",t),disabled:r||s,children:(0,a.jsx)(h.Z,{name:"arrow_upward_alt_600",size:"default"})})};var J=s(87294),Y=s(88515),B=function(){let e=navigator.userAgent.toLowerCase();return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(e)},G=s(35127),X=s(22774),$=s(37156);let Q=new X.XMLParser({ignoreAttributes:!1,preserveOrder:!0,trimValues:!0}),ee=()=>{let[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!1),r=(0,n.useRef)(void 0),i=(0,n.useRef)(void 0),{userData:l}=(0,$.SE)(),o=(0,M.$m)(),d=null==o?void 0:o.messageId,c=null==o?void 0:o.message,u=(0,n.useCallback)(e=>{let t="<lov-actions>",s=e.indexOf(t),a=e.indexOf("</lov-actions>",s);if(-1===s||-1===a)return[];let r=e.substring(s+t.length,a);try{let e=Q.parse(r),t=[];return Array.isArray(e)&&e.forEach(e=>{if(e["lov-suggestion"]){var s,a;let r=e["lov-suggestion"],n=null===(s=e[":@"])||void 0===s?void 0:s["@_message"],i=Array.isArray(r)?null===(a=r[0])||void 0===a?void 0:a["#text"]:null==r?void 0:r["#text"];n&&i&&t.push({title:i.trim(),message:n.trim()})}}),t}catch(e){return console.error("Error parsing lov-actions XML:",e),[]}},[]),m=(0,n.useMemo)(()=>c&&"aiMessage"===c.type?u(c.content):[],[c,u]),p=m.length>0;return(0,n.useEffect)(()=>{d&&d!==r.current&&(r.current=d,a(!1),i.current=void 0)},[d]),(0,n.useEffect)(()=>{let e=(null==l?void 0:l.suggestions_enabled)===!0;if(!e){a(!1);return}p&&c&&d&&d!==i.current&&c.persisted&&e&&(t(m),a(!0),i.current=d)},[p,d,c,m,null==l?void 0:l.suggestions_enabled]),{suggestions:e,isVisible:s,hideSuggestions:(0,n.useCallback)(()=>{a(!1)},[])}};var et=s(98260),es=s(95652),ea=s(10683);let er=e=>{let{suggestions:t,isVisible:s=!0}=e,{store:r}=(0,ea.WR)(),i=r(e=>e.setMessage),l=e=>{i(e.message)},[o,d]=(0,n.useState)(!0),[c,u]=(0,n.useState)(!1),m=(0,n.useRef)(null);return((0,n.useEffect)(()=>{let e=m.current;if(!e||!s){d(!0),u(!1);return}e.scrollLeft=0;let t=()=>{d(0===e.scrollLeft),u(e.scrollLeft+e.clientWidth>=e.scrollWidth-1)};return t(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)},[t,s]),s&&t.length)?(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"relative w-full rounded-t-lg bg-background py-2 pb-2",children:[(0,a.jsx)("div",{ref:m,className:"flex w-full flex-nowrap gap-2 overflow-x-auto px-3 pb-1 scrollbar-hide",children:t.map(e=>(0,a.jsx)(D.z,{className:"h-7 whitespace-nowrap rounded-lg bg-muted px-3 text-sm font-normal text-foreground hover:bg-muted/80 focus:outline-none",type:"button",onClick:()=>l(e),children:e.title},e.message))}),!c&&(0,a.jsx)("div",{className:"pointer-events-none absolute right-0 top-0 h-full w-24 bg-gradient-to-l from-background to-background/0"}),!o&&(0,a.jsx)("div",{className:"pointer-events-none absolute left-0 top-0 h-full w-24 bg-gradient-to-r from-background to-background/0"})]})}):null};var en=s(33474),ei=s(34255),el=s(55302);let eo=(0,ei.j)("relative flex w-full flex-col rounded-t-xl md:rounded-t-3xl border border-b-0 bg-background",{variants:{variant:{secondary:"border-border md:border-muted-border",warning:"border-orange-500/50 bg-orange-500/10",error:"border-red-500/50 bg-red-500/10"}},defaultVariants:{variant:"secondary"}}),ed=e=>{let{variant:t,icon:s,title:r,description:n,children:i,primaryAction:l,secondaryAction:o,onDismiss:d,className:c,dismissible:u=!0,hoverContent:m}=e,p=(0,a.jsx)("div",{"data-nudge":!0,className:(0,v.cn)(eo({variant:t}),c),children:(0,a.jsxs)("div",{className:"flex w-full items-center justify-between gap-2 pb-2 pl-4 pr-2 pt-2 md:pb-8",children:[(0,a.jsxs)("div",{className:"flex flex-1 items-start gap-2",children:[s&&(0,a.jsx)(h.Z,{name:s,className:(0,v.cn)("mt-0.5 text-base","warning"===t&&"text-warning-primary","secondary"===t&&"text-muted-foreground"),size:"small","aria-label":"warning"===t?"Warning":"Information"}),(0,a.jsxs)("div",{className:"flex flex-1 gap-1",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("span",{className:"text-sm font-normal text-foreground",children:r}),n&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:n})]}),i]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[o&&(0,a.jsxs)(D.z,{variant:o.variant||"outline",size:"sm",onClick:o.onClick,disabled:o.disabled,loading:o.loading,className:"gap-1.5",children:[o.icon&&(0,a.jsx)(h.Z,{name:o.icon,size:"small"}),o.label]}),l&&(0,a.jsxs)(D.z,{variant:l.variant||"affirmative",size:"sm",onClick:l.onClick,disabled:l.disabled,loading:l.loading,className:"gap-1.5",children:[l.icon&&(0,a.jsx)(h.Z,{name:l.icon,size:"small"}),l.label]}),u&&d&&(0,a.jsx)("button",{type:"button",className:"group flex h-7 w-7 items-center justify-center hover:bg-transparent",onClick:d,children:(0,a.jsx)(h.Z,{name:"close",size:"small",className:"text-muted-foreground group-hover:opacity-50"})})]})]})});return m?(0,a.jsxs)(el.zs,{children:[(0,a.jsx)(el.Yi,{asChild:!0,"data-nudge":!0,children:(0,a.jsx)("div",{className:"cursor-pointer",children:p})}),(0,a.jsx)(el.bZ,{className:"z-[2000] flex w-fit max-w-[560px] rounded-2xl border-muted-border p-4 md:w-[560px]",side:"top",align:"start",sideOffset:8,asChild:!0,children:m})]}):p};var ec=s(71131),eu=s(38864);let em=e=>{let{projectId:t}=e,{store:s}=(0,ea.WR)(),r=s(e=>e.message),[i,l]=(0,n.useState)([]),[o,d]=(0,n.useState)(!1),{openSettings:c}=(0,u.r)(),m=(0,ec.N)(),p=!!m;if((0,n.useEffect)(()=>{if(r){let e=(0,eu.s)(r);l(e),e.length>0&&d(!1)}else l([])},[r]),0===i.length||o)return null;let x=(0,a.jsx)("div",{className:"flex flex-col gap-2",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-foreground",children:"Detected API Keys"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"API keys in messages can be accessed by team members, may appear in support tickets, and are transmitted over the internet."}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:p?"Store them securely in Supabase instead.":"Connect Supabase first to store them securely."})]})});return(0,a.jsx)(ed,{variant:"warning",icon:"warning",title:"Sensitive API key detected",description:p?"Ask Lovable to store API keys as secrets instead of pasting them in messages.":"API keys detected in your message. Connect Supabase first, then ask Lovable to store them securely instead.",onDismiss:()=>{d(!0)},hoverContent:x,children:(0,a.jsxs)("div",{className:"my-2",children:[!p&&(0,a.jsxs)(D.z,{variant:"outline",size:"sm",onClick:()=>{c("supabase")},children:[(0,a.jsx)(j.xR.Supabase,{className:"h-4 w-4"}),"Connect Supabase"]}),m&&(0,a.jsx)(D.z,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsxs)("a",{href:"https://supabase.com/dashboard/project/".concat(m.id,"/settings/functions"),target:"_blank",rel:"noreferrer",children:[(0,a.jsx)(h.Z,{name:"key",className:"h-4 w-4 text-xs"}),(0,a.jsx)("span",{className:"text-xs",children:"Manage Secrets"}),(0,a.jsx)(h.Z,{name:"arrow_outward",className:"h-4 w-4 text-xs text-muted-foreground"})]})}),(0,a.jsx)(D.z,{variant:"link",size:"sm",asChild:!0,children:(0,a.jsxs)("a",{href:"https://docs.lovable.dev/features/security",target:"_blank",rel:"noreferrer",children:[(0,a.jsx)(h.Z,{name:"help",className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Learn more about security"}),(0,a.jsx)(h.Z,{name:"arrow_outward",className:"h-4 w-4 text-xs text-muted-foreground"})]})})]})})};var ep=s(94671),eh=s(52621),ex=s(12703),ef=s(14070),eg=s(52465);function ev(e){let{open:t,onOpenChange:s,onFeedbackSubmit:i,projectId:l,onCancel:o}=e,[d,c]=(0,n.useState)("");(0,n.useEffect)(()=>{t&&c("")},[t]);let u=e=>{let t=d.length>0;("cancel"===e||"close"===e&&t)&&r.ZP.capture("bronzeage_feedback:dialog_cancelled",{project_id:l,action:e,hadContent:t}),c(""),s(!1),"submit"!==e&&(null==o||o())};return(0,a.jsx)(ef.Vq,{open:t,onOpenChange:e=>{e?s(e):u("close")},children:(0,a.jsx)(ef.cZ,{children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-foreground",children:"Help us improve"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"We'd love to hear about your experience with GPT-5 to help us improve."})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-muted-foreground",children:"Feedback"}),(0,a.jsx)(eg.g,{placeholder:"What do you like about GPT-5? What could be improved?",value:d,className:"min-h-24 resize-none",onChange:e=>c(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(D.z,{onClick:()=>{u("cancel")},size:"sm",variant:"secondary",children:"Dismiss"}),(0,a.jsx)(D.z,{onClick:()=>{i(d),u("submit")},size:"sm",variant:"affirmative",children:"Submit"})]})]})})})}let eb=e=>{let{projectId:t}=e,{shouldShowFeedbackNudge:s,dismissFeedback:i,messageCount:l}=(0,eh.J)(),[o,d]=(0,n.useState)(!1),c=async e=>{let s=(0,ep.SJ)();try{await s.post("/projects/".concat(t,"/gpt/feedback"),{content:e,message_count:l}),r.ZP.capture("bronzeage_feedback:submitted",{project_id:t,message_count:l,feedback_length:e.length,has_feedback:e.trim().length>0}),i()}catch(e){console.error("Failed to submit feedback",e),ex.Am.error("Failed to submit feedback")}};return s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ed,{variant:"secondary",icon:"lightbulb_2",title:"How do you like GPT-5 so far?",primaryAction:{label:"Share Feedback",onClick:()=>{r.ZP.capture("bronzeage_feedback_nudge:share_clicked",{project_id:t,message_count:l}),d(!0)},variant:"affirmative"},onDismiss:()=>{i(),r.ZP.capture("bronzeage_feedback_nudge:dismissed",{project_id:t,message_count:l})}}),(0,a.jsx)(ev,{open:o,onOpenChange:d,onFeedbackSubmit:c,projectId:t})]}):null};var ej=s(1176),ey=s(33877),ew=s(76222),e_=s(61504),eN=s(33864),eC=s(36190);let ek=()=>{var e;let{userData:t}=(0,$.SE)(),s=(0,ey.hO)(e=>e.projectWorkspace),{dailyCreditLimit:i,dailyCreditsUsed:l,bonusCredits:o}=(0,e_.O)(s),[d,c]=(0,n.useState)(!0),m=(0,ej.v)(),p=(0,ew.c)(),{openSettings:h}=(0,u.r)(),x=null==t?void 0:null===(e=t.tips)||void 0===e?void 0:e.upgrade_dialog_dismissed_at,f=(null!=i?i:0)-(null!=l?l:0)+(null!=o?o:0);return((0,n.useEffect)(()=>{x&&!(0,eC.ZK)(x)&&c(!1)},[x]),(null==s?void 0:s.plan)!=="free"||f>2||!d)?null:(0,a.jsx)(ed,{variant:"secondary",title:"".concat((0,eN.H)(f)," free ").concat(1===f?"credit":"credits"," remaining today"),description:p?void 0:"Ask the workspace owner to upgrade",onDismiss:()=>{m.mutate({upgrade_dialog_dismissed_at:new Date().toISOString()}),c(!1)},primaryAction:{label:"Upgrade Now",onClick:()=>{p&&(r.ZP.capture(g.VL.UPGRADE.BUTTON_CLICKED.CHAT,{context:g.VL.UPGRADE.CONTEXT.OUT_OF_CREDITS,remaining_credits:f}),h("billing"))},variant:"affirmative",disabled:!p}})};var eS=s(57967),eE=s(45417),eI=s(72163),eA=s(21517),eP=s(25341),ez=s(26052),eM=s(76332);let eZ="supabase-security-nudge-last-shown",eD=()=>{try{let e=localStorage.getItem(eZ);if(!e)return!0;let t=parseInt(e,10);return Date.now()-t>=864e5}catch(e){return!0}},eL=()=>{try{localStorage.setItem(eZ,Date.now().toString())}catch(e){}},eR=e=>({name:e.name,title:e.name,level:"error"===e.level?"ERROR":"WARN",description:e.description}),eT=e=>{var t,s,i,l,o;let{projectId:d}=e,{openSecurityView:c}=(0,eP.h)(),u=(0,eA.iZ)(e=>e.project),[m,p]=(0,n.useState)(!1),x=(0,G.ZG)(),f=!!(null==u?void 0:null===(t=u.supabase_project_config)||void 0===t?void 0:t.supabase_project_id),{securitySummary:v,scanData:b,isLoading:j,captureSecurityEvent:y}=(0,eI.y)(),{securityWarnings:w,isLoadingWarnings:_,hasSupabaseErrors:N}=(0,eS.N)({projectId:null==u?void 0:u.id,supabaseProjectId:null==u?void 0:null===(s=u.supabase_project_config)||void 0===s?void 0:s.supabase_project_id,setShowPublishConfirmDialog:e=>{},shouldFetchSecurityWarnings:!x&&f}),{handleSecurityReview:C,isSendingSecurityReview:k,isSecurityReviewDisabled:S,securityReviewDisabledReason:E}=(0,eE.C)({projectId:null==u?void 0:u.id}),{errorCount:I,warningCount:A,hasErrors:P,isLoading:z}=x?{errorCount:v.errorCount,warningCount:v.warnCount,hasErrors:v.errorCount>0,isLoading:j}:{errorCount:(null==w?void 0:null===(i=w.supabase)||void 0===i?void 0:i.errors)||0,warningCount:(null==w?void 0:null===(l=w.supabase)||void 0===l?void 0:l.warnings)||0,hasErrors:N,isLoading:_};(0,n.useEffect)(()=>{p(!0===P&&!z&&eD())},[P,z]);let M=()=>{C(),p(!1),r.ZP.capture("supabase_security_nudge_reviewed",{project_id:d,error_count:I,warning_count:A})};if(!m)return null;let Z=I+A,L=x?Object.values((null==b?void 0:b.results)||{}).flatMap(e=>e.items||[]).map(eR):(null==w?void 0:null===(o=w.supabase)||void 0===o?void 0:o.details)||[],T=L.filter(e=>"ERROR"===e.level),O=L.filter(e=>"WARN"===e.level),F=P?T:O,U=P?"".concat(I," Error").concat(I>1?"s":""):"".concat(A," Warning").concat(A>1?"s":""),V=(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("p",{className:"text-xl font-medium text-card-foreground",children:[Z," Security Issues Detected"]}),(0,a.jsxs)("p",{className:"text-base text-muted-foreground",children:[P?"Critical errors":"Warnings"," found in your Supabase project:"]})]}),(0,a.jsxs)("div",{className:"max-h-64 overflow-y-auto",children:[F.slice(0,3).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between py-1.5",children:[(0,a.jsxs)(R.u,{children:[(0,a.jsx)(R.aJ,{asChild:!0,children:(0,a.jsxs)("div",{className:"flex cursor-default items-center gap-1.5",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:e.title}),(0,a.jsx)(h.Z,{name:"info",size:"small",className:"text-muted-foreground"})]})}),(0,a.jsx)(R._v,{children:(0,a.jsx)("p",{children:e.description})})]}),(0,a.jsx)(ez.C,{variant:"ERROR"===e.level?"destructive":"warning",children:"ERROR"===e.level?"Error":"Warning"})]},e.name)),F.length>3&&(0,a.jsxs)("p",{className:"py-1.5 text-sm font-medium text-muted-foreground",children:["+ ",F.length-3," more"," ",P?"error":"warning",F.length-3>1?"s":"","..."]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsxs)(D.z,{variant:"secondary",size:"sm",onClick:()=>{var e;let t=null==u?void 0:null===(e=u.supabase_project_config)||void 0===e?void 0:e.supabase_project_id;t&&window.open("".concat("https://supabase.com/dashboard/project/".concat(t,"/advisors/security")).concat(P?"":"?preset=WARN&id="),"_blank","noopener,noreferrer"),r.ZP.capture("supabase_security_nudge_external_view",{project_id:d,error_count:I,warning_count:A})},className:"gap-1.5",children:["View in Supabase",(0,a.jsx)(h.Z,{name:"arrow_outward",size:"small"})]}),(0,a.jsx)(eM.b,{showTooltip:!!E,tooltipContent:E,children:(0,a.jsx)(D.z,{variant:"affirmative",size:"sm",onClick:M,disabled:S,loading:k,className:"gap-1.5",children:"Security Review"})})]})]});return(0,a.jsx)(ed,{variant:"secondary",icon:"error",title:x?"Security":"Supabase security",primaryAction:{label:"Review",onClick:()=>{y(g.SL.SECURITY.NUDGE_REVIEW_CLICKED,{error_count:I,warning_count:A,security_system_enabled:x}),x?c():M()},variant:"affirmative",loading:!x&&k,disabled:!x&&S},onDismiss:()=>{p(!1),eL(),r.ZP.capture("supabase_security_nudge_dismissed",{project_id:d,error_count:I,warning_count:A})},hoverContent:x?void 0:V,children:(0,a.jsx)(ez.C,{variant:P?"destructive":"warning",className:"flex-shrink-0 gap-1",children:U})})};var eO=s(56551),eF=s(35046),eU=s(7287),eV=s(59253),eW=s(77105);let eH=()=>{let e=(0,K.v)(),t=(0,k.UC)(e=>e.isVisualEditingActive),{setIsVisualEditorPanelOpen:s,turnOffVisualEditing:i}=(0,k.S9)(),{startLiveMode:l}=(0,eU.My)(),{hasUnsavedChanges:o,refreshPreview:d}=(0,et.v)(),c=(0,eF.A7)(e=>e.clearPendingChanges),{activeView:u}=(0,eV.Z)(),{setBlocker:m,clearBlocker:p}=(0,eW.sV)(),f=(0,n.useCallback)(()=>{i(),o&&(c(),d()),p(),r.LJ.capture("visual_editor_toggled",{state:!t,project_id:e})},[i,t,e,c,p,d,o]),g=()=>{s(!0),l(),r.LJ.capture("visual_editor_toggled",{state:t,project_id:e})},b=()=>{t?f():g()},j=t&&o,{isMac:y}=(0,x.Z)(),w=j||"preview"!==u;return(0,n.useEffect)(()=>{t&&(j?m({title:"You have unsaved changes",description:"Are you sure you want to exit the visual editor? You will lose your unsaved changes."}):p(),"preview"!==u&&f())},[j,m,p,t,u,f]),(0,eO.y1)("alt+s",e=>{e.preventDefault(),w||b()},{enableOnFormTags:!0},[w,b]),(0,a.jsxs)(R.u,{instant:j,children:[(0,a.jsx)(R.aJ,{className:"flex py-0",type:"button",asChild:!0,children:(0,a.jsxs)(D.z,{id:"visual-editor-toggle",type:"button",variant:"outline",size:"sm",onClick:b,disabled:w,className:(0,v.cn)("flex h-6 gap-1 rounded-full border py-0 pl-1.5 pr-2.5 font-normal text-muted-foreground hover:border-border hover:bg-transparent md:hover:bg-accent md:hover:text-muted-foreground",{"border-affirmative-primary bg-affirmative-primary text-affirmative-primary-foreground hover:border-affirmative-primary hover:bg-affirmative-primary hover:text-affirmative-primary-foreground md:hover:bg-affirmative-primary/90 md:hover:text-affirmative-primary-foreground":t}),children:[(0,a.jsx)(h.Z,{name:"visual_edits",size:"small"}),"Edit"]})}),(0,a.jsx)(R._v,{children:(0,a.jsx)("p",{children:j?"Save or discard to exit":"Select to edit (".concat(y?"S":"Alt+S",")")})})]})},eK=e=>{let{chatPanelRef:t,children:s}=e,r=(0,c.z)(e=>e.showHistory);return(0,J.Z)("md")?s:r?null:(0,a.jsx)(eJ,{chatPanelRef:t})},eq=e=>e.charAt(0).toUpperCase()+e.slice(1),eJ=(0,n.memo)(e=>{let{chatPanelRef:t}=e,s=(0,G.Zp)(),d=(0,G.aI)(),{isAgentModeDefault:c}=(0,l.v)(),{setSelectedImageUrl:u}=(0,M.mx)(),{hasUnsavedChanges:m}=(0,et.v)(),p=(0,K.v)(),h=(0,k.UC)(e=>e.isVisualEditingActive),{setChatMode:x}=(0,Z.VK)(),{message:f,sendChatMessage:v,isSendingDisabled:b,AuthDialogComponent:j}=(0,en.i)(),{dropzoneElement:N,openFileUpload:C,getInputProps:S}=(0,Y.j)({portalTargetRef:t}),E=h&&m,I=(0,k.UC)(e=>{var t;return null===(t=e.selectedElements)||void 0===t?void 0:t[0]}),D=B(),[L,T]=(0,n.useState)(!1),{suggestions:O,isVisible:F,hideSuggestions:H}=ee(),J=(0,n.useCallback)(async()=>{if(H(),(0,eu.G)(f)){r.ZP.capture(g.SL.CHAT.API_KEY_DETECTED,{project_id:p}),T(!0);return}await v()},[p,v,f,H]);return(0,a.jsxs)("div",{className:"flex max-h-[calc(100%-37px)] shrink-0 flex-col overflow-visible",children:[(0,a.jsx)(es.s,{isOpen:L,onDismiss:()=>T(!1),onConfirm:()=>{T(!1),v(),r.ZP.capture(g.SL.CHAT.API_KEY_WARNING_DISMISSED,{project_id:p})}}),d&&(0,a.jsx)(er,{suggestions:O,isVisible:F}),(0,a.jsx)("div",{className:"relative top-6",children:!D&&p&&(0,a.jsxs)("div",{className:"[&_[data-nudge]:not(:first-child)]:hidden",children:[(0,a.jsx)(em,{projectId:p}),(0,a.jsx)(ek,{}),(0,a.jsx)(eT,{projectId:p}),(0,a.jsx)(eb,{projectId:p})]})}),(0,a.jsxs)(o.x,{className:"relative mr-2 md:mr-0",onSubmit:J,AuthDialogComponent:j,children:[(0,a.jsx)(_.T,{setSelectedImageUrl:u}),!h&&(0,a.jsx)(A,{}),(0,a.jsxs)(R.u,{children:[(0,a.jsx)(R.aJ,{asChild:!0,children:(0,a.jsx)("div",{children:(0,a.jsx)(P.E,{autoSize:!0,minHeight:40,className:"m-1 rounded-md p-0",disabled:E,forceShowPlaceholder:!1,placeholder:I?"Ask Lovable to modify ".concat(eq(I.elementType),"..."):"Ask Lovable...",enableSlashCommands:!1,isChatModeActive:!1,onEnableChatMode:()=>x(Z.jE.CHAT_ONLY),onDisableChatMode:()=>x(c?Z.jE.AGENT:Z.jE.DEFAULT)})})}),(0,a.jsx)(R._v,{hidden:!h||!m,children:(0,a.jsx)("p",{children:"Save to continue"})})]}),(0,a.jsx)(z.yo,{}),(0,a.jsxs)(w.s,{children:[(0,a.jsx)("input",{id:"file-upload",className:"hidden",...S()}),N,(0,a.jsx)(y,{onFileUpload:C}),!D&&(0,a.jsx)(eH,{}),(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-1",children:[p&&(0,a.jsx)(U,{projectId:p}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(i.q,{inProject:!0}),(0,a.jsx)(V.r,{}),s&&p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.O,{projectId:p}),(0,a.jsx)(q,{disabled:E,isSendingDisabled:b})]}):(0,a.jsx)(q,{disabled:E,isSendingDisabled:b})]})]})]})]}),(0,a.jsx)("div",{className:"z-10 h-2 w-full bg-background"})]})});eJ.displayName="ChatInputV2NormalContent"},41173:function(e,t,s){"use strict";s.d(t,{A:function(){return p}});var a=s(52155),r=s(56852),n=s(98244),i=s(59561),l=s(76332),o=s(14070),d=s(99792),c=s(96659),u=s(22136),m=s(70980);let p=()=>{let e=(0,c.C)(),{mutate:t,isPending:s}=(0,u.I)({skipSafetyCheck:!0}),p=(0,m.bk)(e=>e.editIdToConfirmRestoreFor),{setEditIdToConfirmRestoreFor:h}=(0,m.Xr)(),{disabled:x,disabledReason:f}=(0,n.useMemo)(()=>s?{disabled:!0,disabledReason:"Restore is in progress"}:e?{disabled:!0,disabledReason:(0,a.jsx)("p",{className:"max-w-sm",children:"Cannot transfer project while there is an active operation in progress (e.g. chat or revert). Please wait for the operation to complete."})}:{disabled:!1,disabledReason:null},[e,s]);return(0,a.jsx)(o.Vq,{open:!!p,onOpenChange:e=>!e&&h(void 0),children:(0,a.jsxs)(o.cZ,{children:[(0,a.jsx)(o.fK,{children:(0,a.jsx)(o.$N,{children:"Cant revert database changes"})}),(0,a.jsx)(o.Be,{children:"The database was modified since this version. Lovable cant revert database changes automatically. Youll need to update the database manually."}),(0,a.jsxs)(o.cN,{children:[(0,a.jsx)(i.z,{variant:"outline",children:(0,a.jsxs)(r.default,{href:"https://docs.lovable.dev/integrations/supabase",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 overflow-hidden text-ellipsis whitespace-nowrap",children:[(0,a.jsx)("span",{className:"truncate",children:"Learn more"}),(0,a.jsx)(d.Z,{name:"arrow_outward"})]})}),(0,a.jsx)(l.b,{showTooltip:x,tooltipContent:f,children:(0,a.jsx)(o.GG,{asChild:!0,children:(0,a.jsxs)(i.z,{variant:"affirmative",onClick:()=>t({edit:{id:p}}),disabled:x,children:["Proceed Anyway",s&&(0,a.jsx)(d.Z,{className:"ml-1 animate-spin",name:"progress_activity",size:"small"})]})})})]})]})})}},30025:function(e,t,s){"use strict";s.d(t,{W:function(){return r}});var a=s(98244);let r=e=>{let{listRef:t,containerRef:s}=e,[r,n]=(0,a.useState)(!1),[i,l]=(0,a.useState)(!1),[o,d]=(0,a.useState)(!1),c=(0,a.useCallback)(()=>setTimeout(()=>{if(!t.current)return;let e=t.current.scrollSize-t.current.viewportSize-t.current.scrollOffset<84,s=t.current.scrollOffset<84,a=t.current.scrollSize>t.current.viewportSize;l(e),d(s),n(a)},0),[t]),u=(0,a.useCallback)(()=>{t.current&&t.current.scrollTo(t.current.scrollSize)},[t]);return(0,a.useEffect)(()=>{let e=s.current;if(!e)return;let t=new MutationObserver(c);t.observe(e,{childList:!0,subtree:!0});let a=new ResizeObserver(c);return a.observe(e),c(),()=>{t.disconnect(),a.disconnect()}},[s,c]),{isScrollable:r,isScrolledToEnd:i,isScrolledToStart:o,checkScrollPosition:c,scrollToEnd:u}}},33474:function(e,t,s){"use strict";s.d(t,{i:function(){return b}});var a=s(52155),r=s(98244),n=s(86338),i=s(75970),l=s(39230),o=s(3989),d=s(62797),c=s(11134),u=s(93023),m=s(52621),p=s(10683),h=s(76268),x=s(7287),f=s(21517),g=s(71919),v=s(36190);let b=()=>{let{closeVisualEditsPanel:e}=(0,g.S9)(),{agentModeEnabled:t}=(0,n.v)(),{incrementMessageCount:s}=(0,m.J)(),{sendChatMessage:b,hasActiveLock:j}=(0,c.O)(),{clearEditorState:y,restoreEditorState:w}=(0,p.WR)(),_=(0,f.iZ)(e=>e.project),{authUser:N}=(0,i.Eu)(),[C,k]=(0,r.useState)(!1),[S,E]=(0,r.useState)(!1),[I,A]=(0,r.useState)(()=>(0,v.Y)()),P=(0,p.Eh)(e=>e.images);(0,p.Eh)(e=>e.setImages);let z=(0,p.Eh)(e=>e.message),M=(0,g.UC)(e=>e.selectedElements),{setSelectedElements:Z}=(0,g.S9)(),D=(0,o.hT)(e=>e.chatMode),{setChatMode:L}=(0,o.VK)(),{startLiveMode:R}=(0,x.My)();(0,r.useEffect)(()=>{let e=setInterval(()=>{A((0,v.Y)())},1e3);return()=>clearInterval(e)},[]),(0,r.useEffect)(()=>{let e=()=>{A((0,v.Y)())};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[]);let T=(0,r.useMemo)(()=>P.some(e=>!e.uploaded),[P]),O=(0,r.useMemo)(()=>j||S||!_,[j,S,_]),F=(0,r.useMemo)(()=>O||0===z.length||N&&T||(0,u.L0)(z)||I.isRateLimited,[O,z,N,T,I.isRateLimited]),{isAgentModeDefault:U}=(0,n.v)(),V=(0,r.useCallback)(async()=>{if(F)return;if(I.isRateLimited){console.warn("Cannot send message: rate limited");return}if(D===o.jE.CHAT_ONLY&&z.toLowerCase().includes("lov-action")&&L(U?o.jE.AGENT:o.jE.DEFAULT),!N){k(!0);return}let a={selectedElements:M};E(!0),R();try{e(),await b({body:{id:(0,l.Fd)(),message:z,images:P.map(e=>({image_id:e.id,type:h.V.USER_UPLOAD})),selected_elements:M,optimisticImageUrls:P.map(e=>e.url),chat_only:D===o.jE.CHAT_ONLY,agent_mode:t?"enabled":"disabled"},options:{clear:()=>{y(),Z([])},restore:()=>{w(),Z(a.selectedElements)}}}),s()}finally{E(!1)}},[F,I.isRateLimited,D,z,N,P,M,R,L,e,b,y,Z,w,t,s]);return{message:z,sendChatMessage:V,isSendingDisabled:F,isLocked:O,isSubmitting:S,isRateLimited:I.isRateLimited,rateLimitSecondsRemaining:I.secondsRemaining,AuthDialogComponent:(0,a.jsx)(d.o,{open:C,onOpenChange:k})}}},52922:function(e,t,s){"use strict";s.d(t,{q:function(){return u}});var a=s(56166),r=s(98244),n=s(12703),i=s(94671),l=s(96659),o=s(90163),d=s(21198),c=s(17001);function u(e){let{projectId:t}=e,s=(0,i.SJ)(),u=(0,o.b)(),[m,p]=(0,r.useState)(void 0),{addStoppedMessageId:h,setLatestStreamedMessage:x,updateMessage:f}=(0,d.mx)(),g=(0,d.aK)(e=>e.sortedMessageIds),v=(0,d.aK)(e=>e.messages),b=(0,r.useMemo)(()=>null==g?void 0:g.findLast(e=>{var t;return(null===(t=v[e])||void 0===t?void 0:t.type)==="userMessage"}),[g,v]),j=(0,r.useMemo)(()=>null==g?void 0:g.findLast(e=>{var t;return(null===(t=v[e])||void 0===t?void 0:t.type)==="aiMessage"}),[g,v]),y=(0,l.C)(),w=(0,a.D)({mutationFn:async()=>{if(!t)throw Error("No projectId found");if(u){if(!("content"in u))throw Error("Invalid message type");x({...u,stopped:!0})}return s.post("/projects/".concat(t,"/chat/").concat(b,"/cancel"))},onMutate:()=>{let e=j&&v[j];if(e&&"aiMessage"===e.type){let t=e.content===c.u?"This message was cancelled.":e.content;f(j,{...e,content:t,status:"stopped",stopped:!0},!0)}},onSuccess:()=>{h(null==u?void 0:u.id),p(b),x(void 0)},onError:()=>{n.Am.error("Failed to stop message",{description:"Please try again"})}});return{showStopAction:b!==m&&y,mutation:w}}},57480:function(e,t,s){"use strict";s.d(t,{T:function(){return l},r:function(){return o}});var a=s(52155),r=s(98244),n=s(71919);let i=(0,r.createContext)({currentFile:null,states:{},openTabs:[],targetFileAndLineRange:null,setCurrentFile:()=>{},setStates:()=>{},setOpenTabs:()=>{},openFileAtLine:()=>{},openFileAtLineRange:()=>{},clearLineHighlight:()=>{}});function l(e){let{children:t}=e,[s,l]=(0,r.useState)(null),[o,d]=(0,r.useState)({}),[c,u]=(0,r.useState)([]),[m,p]=(0,r.useState)(null),h=(0,n.UC)(e=>e.selectedElements),x=(0,n.UC)(e=>e.isVisualEditingActive),f=(0,r.useCallback)((e,t)=>{let s=t||1;p({filePath:e,startLine:s,endLine:s}),u(t=>t.includes(e)?t:[...t,e]),l(e)},[]),g=(0,r.useCallback)((e,t,s)=>{p({filePath:e,startLine:t,endLine:s||t}),u(t=>t.includes(e)?t:[...t,e]),l(e)},[]),v=(0,r.useCallback)(()=>{p(null)},[]);(0,r.useEffect)(()=>{x||0!==h.length||v()},[x,h,v]);let b=(0,r.useMemo)(()=>({currentFile:s,setCurrentFile:l,states:o,setStates:d,openTabs:c,setOpenTabs:u,targetFileAndLineRange:m,openFileAtLine:f,openFileAtLineRange:g,clearLineHighlight:v}),[s,o,c,m,f,g,v]);return(0,a.jsx)(i.Provider,{value:b,children:t})}let o=()=>{let e=(0,r.useContext)(i);if(void 0===e)throw Error("useCodeEditor must be used within a CodeEditorProvider");return e}},78159:function(e,t,s){"use strict";s.d(t,{p:function(){return L}});var a=s(52155),r=s(98244),n=s(12703),i=s(61222),l=s(99792),o=s(21198),d=s(21517),c=s(30025),u=s(28375),m=s(56959),p=s(59561),h=s(25871),x=s(17176),f=s(4578),g=s(58010),v=s(10990),b=s(59253),j=s(70766);let y=(0,r.memo)(e=>{var t;let{messageId:s,edit:n,isRevertMessage:i,isUnderDaySection:c}=e,{commit_sha:u}=null!=n?n:{},{switchToView:y,exitView:w,activeView:_}=(0,b.Z)(),N=(0,j.VJ)(e=>e.activeEditId),C=(0,o.aK)(e=>e.edits),k=N?C[N]:null,S=(0,d.iZ)(e=>e.project),{toggleBookmark:E}=(0,h.g)((null==S?void 0:S.id)||""),I=(0,r.useMemo)(()=>{if(u&&S)return(0,x.t)({projectId:null==S?void 0:S.id,sha:u})},[u,S]),A=(0,v.Y)({editId:null==n?void 0:n.id,commitSha:null!==(t=null==n?void 0:n.commit_sha)&&void 0!==t?t:void 0}),P=n&&(null==k?void 0:k.id)===(null==n?void 0:n.id)&&"snapshot"===_||A&&!k&&!_,z=(0,r.useMemo)(()=>{if(!(null==n?void 0:n.created_at))return null;let e=new Date(1e3*n.created_at.seconds);return c?(0,g.LJ)(e):(0,g.sb)(e)},[n,c]),M=(0,r.useCallback)(e=>{if(e.altKey){window.open(I,"_blank");return}if(P||A){w();return}y("snapshot",{messageId:s,editId:null==n?void 0:n.id,previewUrl:I})},[n,w,P,A,s,I,y]),Z=(0,r.useCallback)(e=>{e.stopPropagation(),(null==n?void 0:n.id)&&E(n.id,!!n.bookmarked)},[n,E]),{commit_message:D}=null!=n?n:{};return(0,a.jsxs)("div",{className:"flex h-11 min-w-0 items-center gap-1 md:h-10 md:px-3",children:[i?(0,a.jsx)(l.Z,{name:"restart_alt",className:"mb-px text-muted-foreground",size:"small"}):(0,a.jsx)(m.Z,{onClick:Z,isBookmarked:!!n.bookmarked&&(null==n?void 0:n.bookmarked),className:(0,f.cn)(!n.bookmarked&&"md:opacity-0 md:group-hover:opacity-100")}),(0,a.jsx)(p.z,{onClick:M,disabled:!n,className:(0,f.cn)("group flex h-10 w-full cursor-pointer items-center gap-2 rounded-lg px-2.5 text-left text-base font-medium transition-colors duration-150 ease-in-out md:h-9 md:text-sm","min-w-0 bg-background text-foreground hover:bg-muted-hover",{"bg-affirmative text-affirmative-foreground hover:bg-affirmative/80":P&&!i}),children:(0,a.jsxs)("div",{className:"flex w-full min-w-0 items-center justify-between gap-2 overflow-hidden",children:[(0,a.jsx)("div",{className:"flex min-w-0 items-center gap-x-2 gap-y-1 font-normal",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-base text-muted-foreground md:text-sm",children:"Restored"}),(0,a.jsx)("div",{className:"min-w-0 gap-1 truncate rounded-sm border border-muted-border bg-background px-2 py-px",children:D})]}):(0,a.jsx)("span",{className:"items-center gap-1 truncate",children:D})}),(0,a.jsx)("span",{className:(0,f.cn)("text-sm font-normal text-muted-foreground md:text-xs",P&&!i&&"text-affirmative-foreground"),children:z&&(0,a.jsx)(a.Fragment,{children:z.absolute})})]})})]})});y.displayName="HistoryCardContent";let w=e=>{let{messageId:t,isUnderDaySection:s=!1}=e,r=(0,o.aK)(e=>e.messages[t]),n=(0,o.tV)((null==r?void 0:r.type)==="aiMessage"||(null==r?void 0:r.type)==="manualEdit"?null==r?void 0:r.editId:void 0),i=(0,o.uO)((null==r?void 0:r.type)==="userCommit"||(null==r?void 0:r.type)==="revertSuccess"?null==r?void 0:r.shortCommitHash:void 0);if(!r||!["aiMessage","manualEdit","userCommit","revertSuccess"].includes(r.type))return null;let l="userCommit"===r.type||"revertSuccess"===r.type?i:n;return l?(0,a.jsx)("div",{className:"group flex flex-col","data-message-id":r.id,"data-message-edit-id":(0,u.Y)(r),children:(0,a.jsx)(y,{messageId:r.id,edit:l,isRevertMessage:"revertSuccess"===r.type,isUnderDaySection:s})}):null};var _=s(18587),N=s(5068),C=s(64493),k=s(17990),S=s(19021),E=s(5520);let I=e=>{let{message:t,edits:s,latestPublishedTimestamp:a}=e,r=s[t.editId];return a&&r?r.created_at.toDate()>a:!a&&!!r},A=e=>{let{message:t,latestPublishedTimestamp:s}=e;return s&&t.createdAt?t.createdAt>s:!s&&!!t.createdAt},P=e=>{let{message:t,edits:s,latestPublishedTimestamp:a}=e;return"revertSuccess"===t.type?I({message:t,edits:s,latestPublishedTimestamp:a}):A({message:t,latestPublishedTimestamp:a})},z=e=>{let{messageIds:t,messages:s}=e,a=new Map;return t.forEach(e=>{let t=s[e];if(!(null==t?void 0:t.createdAt))return;let r=(0,_.WU)(t.createdAt,"yyyy-MM-dd");a.has(r)||a.set(r,[]),a.get(r).push(e)}),a},M=e=>{let{messagesByDate:t}=e,s=(0,N.b)(new Date),a=(0,C.z)(s,{weekStartsOn:1}),r=e=>(0,k.z)(e)?"Today":(0,S.g)(e)?"Yesterday":(0,E._)(e,{start:a,end:s})?(0,_.WU)(e,"EEEE"):(0,_.WU)(e,"MMMM d");return Array.from(t.entries()).sort((e,t)=>{let[s]=e,[a]=t;return a.localeCompare(s)}).map(e=>{let[t,s]=e;return{label:r(new Date(t)),messageIds:s}})},Z=e=>{let{messageIds:t,messages:s}=e;return M({messagesByDate:z({messageIds:t,messages:s})})},D=e=>{let{messageIds:t,getEditByShortCommitHash:s,latestPublishedTimestamp:a}=e,r=(0,o.aK)(e=>e.edits),n=(0,o.aK)(e=>e.messages),i=[],l=[],d=[],c=e=>["manualEdit","aiMessage","revertSuccess","userCommit"].includes(e),u=e=>{if("userCommit"===e.type||"revertSuccess"===e.type){let t=s(e.shortCommitHash);return!!(null==t?void 0:t.bookmarked)}if("editId"in e&&e.editId){let t=r[e.editId];return!!(null==t?void 0:t.bookmarked)}return!1};return t.forEach(e=>{let t=n[e];if(c(t.type)&&("manualEdit"!==t.type&&"aiMessage"!==t.type||t.editId)){if(u(t)&&"revertSuccess"!==t.type&&i.push(e),P({message:t,edits:r,latestPublishedTimestamp:a})){l.push(e);return}(null==t?void 0:t.createdAt)&&d.push(e)}}),{unpublishedMessageIds:l,bookmarkedMessageIds:i,groupedDailyMessageIds:Z({messageIds:d,messages:n}),hasBookmarkedMessages:i.length>0,hasUnpublishedMessages:l.length>0,hasDailyMessages:d.length>0,splitMessageCount:i.length+l.length+d.length}},L=(0,r.memo)(()=>{var e,t;let s=(0,r.useRef)(null),u=(0,r.useRef)(null),m=(0,d.iZ)(e=>e.project),{snapshot:p,loadEarlierEdits:h}=(0,o.mx)(),x=(0,o.aK)(e=>{let t=e.messages;return Object.keys(t).sort((e,s)=>{var a,r,n,i;return((null===(r=t[e])||void 0===r?void 0:null===(a=r.createdAt)||void 0===a?void 0:a.getTime())||0)-((null===(i=t[s])||void 0===i?void 0:null===(n=i.createdAt)||void 0===n?void 0:n.getTime())||0)})}),f=(0,o.aK)(e=>e.edits),g=(0,o.aK)(e=>"loading"===e.loadingEditsStatus),v=(0,o.aK)(e=>e.hasOlderEdits),b=(0,o.aK)(e=>e.canLoadMoreEdits),j=(0,o.uO)(null!==(t=null==m?void 0:m.latest_commit_sha)&&void 0!==t?t:void 0),{isScrolledToEnd:y,checkScrollPosition:_}=(0,c.W)({listRef:u,containerRef:s}),N=(0,r.useMemo)(()=>[...x].reverse(),[x]);(0,r.useEffect)(()=>{y&&v&&b&&h().catch(()=>{n.Am.error("Failed to load earlier edits")})},[y,v,b,h]);let{unpublishedMessageIds:C,groupedDailyMessageIds:k,bookmarkedMessageIds:S,hasBookmarkedMessages:E,hasUnpublishedMessages:I,hasDailyMessages:A,splitMessageCount:P}=D({messageIds:N,latestPublishedTimestamp:(0,r.useMemo)(()=>{var e;let t=null==m?void 0:null===(e=m.published_deployment)||void 0===e?void 0:e.commit_sha;if(!t)return null;let s=Object.values(f).find(e=>e.commit_sha===t);return s?s.created_at.toDate():null},[null==m?void 0:null===(e=m.published_deployment)||void 0===e?void 0:e.commit_sha,f]),getEditByShortCommitHash:p.getEditByShortCommitHash}),z=(0,r.useRef)(void 0);return((0,r.useEffect)(()=>{if(u.current&&P>0&&void 0!==z.current&&z.current<P){let e=u.current.scrollOffset;u.current.scrollTo(e)}z.current=P},[P]),j&&(E||I||A))?(0,a.jsxs)("div",{ref:s,className:"flex min-h-0 flex-1 overflow-y-scroll",children:[(0,a.jsxs)(i.dM,{overscan:5,ref:u,onScroll:()=>{_()},children:[E&&(0,a.jsx)(R,{title:"Bookmarked",children:S.map(e=>(0,a.jsx)(w,{messageId:e},e))}),I&&(0,a.jsx)(R,{title:"Unpublished",children:C.map(e=>(0,a.jsx)(w,{messageId:e},e))}),A&&k.map(e=>{let{label:t,messageIds:s}=e;return(0,a.jsx)(R,{title:t,children:s.map(e=>(0,a.jsx)(w,{messageId:e,isUnderDaySection:!0},e))},t)})]}),g&&(0,a.jsx)("div",{className:"flex items-center justify-center gap-2 text-sm",children:(0,a.jsx)(l.Z,{className:"animate-spin",name:"progress_activity",size:"small"})})]}):null});L.displayName="HistoryPanel";let R=e=>{let{title:t,subtitle:s,children:r}=e;return(0,a.jsxs)("div",{className:"mb-4 mt-2 flex flex-col",children:[(0,a.jsxs)("p",{className:"mb-1 text-lg font-medium md:pl-3 md:text-base",children:[t,s&&(0,a.jsx)("span",{className:"ml-1 text-sm font-normal text-muted-foreground",children:s})]}),r]})}},57967:function(e,t,s){"use strict";s.d(t,{N:function(){return i}});var a=s(68820),r=s(98244),n=s(93846);let i=e=>{let{projectId:t,setShowPublishConfirmDialog:s,shouldFetchSecurityWarnings:i,supabaseProjectId:l}=e,{data:o,isLoading:d,isError:c}=(0,a.a)(n.W.securityWarnings({projectId:t,enabled:!!t&&!!l&&i})),u=(0,r.useMemo)(()=>{if(c)return{supabase:{errors:0,warnings:0,success:!1}};if(o){var e,t,s,a,r,n;return{supabase:{errors:null!==(a=null===(e=o.supabase)||void 0===e?void 0:e.errors)&&void 0!==a?a:0,warnings:null!==(r=null===(t=o.supabase)||void 0===t?void 0:t.warnings)&&void 0!==r?r:0,success:!0,details:null!==(n=null===(s=o.supabase)||void 0===s?void 0:s.details)&&void 0!==n?n:[]}}}return null},[o,c]),m=u&&u.supabase.errors+u.supabase.warnings>0,p=u&&u.supabase.errors>0;return{securityWarnings:u,isLoadingWarnings:d,handleReviewIssuesInDialog:()=>{if(s(!1),l){let e=u&&0===u.supabase.errors?"?preset=WARN&id=":"";window.open("".concat("https://supabase.com/dashboard/project/".concat(l,"/advisors/security")).concat(e),"_blank")}},hasSupabaseErrors:p,hasSecurityIssues:m}}},70778:function(e,t,s){"use strict";s.d(t,{A:function(){return a},g:function(){return r}});let a={'pre[class*="language-"]':{color:"#c9d1d9",background:"var(--muted)",fontSize:"13px",fontFamily:'var(--font-roboto-mono), "Roboto Mono", Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',lineHeight:"1.5",padding:"1em",overflow:"auto"},'code[class*="language-"]':{color:"#c9d1d9",fontSize:"13px",fontFamily:'var(--font-roboto-mono), "Roboto Mono", Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',lineHeight:"1.5"},comment:{color:"#8b949e"},boolean:{color:"#ff7b72"},number:{color:"#79c0ff"},constant:{color:"#79c0ff"},operator:{color:"#7ee787"},keyword:{color:"oklch(0.833 0.145 321.434)"},function:{color:"#d2a8ff"},variable:{color:"#c9d1d9"},"class-name":{color:"#ffa657"},"type-name":{color:"#ffa657"},"attr-name":{color:"#79c0ff"},string:{color:"#a5d6ff"},tag:{color:"#7ee787"},punctuation:{color:"#7ee787"},selector:{color:"#7ee787"},namespace:{color:"#c9d1d9"},regex:{color:"#ff7b72"},escape:{color:"#a5d6ff"},"::selection":{background:"#2d333b"}},r={'pre[class*="language-"]':{color:"#24292e",background:"var(--background)",fontSize:"13px",fontFamily:'var(--font-roboto-mono), "Roboto Mono", Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',lineHeight:"1.5",padding:"1em",overflow:"auto"},'code[class*="language-"]':{color:"#24292e",fontSize:"13px",fontFamily:'var(--font-roboto-mono), "Roboto Mono", Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',lineHeight:"1.5"},comment:{color:"#6e7781"},boolean:{color:"#cf222e"},number:{color:"#0550ae"},constant:{color:"#0550ae"},operator:{color:"#116329"},keyword:{color:"#3479E5"},function:{color:"#8250df"},"class-name":{color:"#953800"},"attr-name":{color:"#0550ae"},string:{color:"#0a3069"},tag:{color:"#116329"},punctuation:{color:"#116329"},"::selection":{background:"#C7E4FF"}}},34544:function(e,t,s){"use strict";s.d(t,{s:function(){return g}});var a=s(52155),r=s(88182),n=s(38109),i=s(98244),l=s(42262),o=s(17779),d=s(96895),c=s(99792),u=s(4578),m=s(70778),p=s(25649),h=s.n(p);let x=(0,i.memo)(e=>{let{children:t,className:s,components:r}=e;return(0,a.jsx)("div",{className:s,children:(0,a.jsx)(l.UG,{components:r,children:t})})});x.displayName="MemoizedReactMarkdown";let f=e=>{let{match:t,codeContent:s,prismTheme:r}=e,[n,l]=(0,i.useState)(!1),d=async()=>{await navigator.clipboard.writeText(String(s)),l(!0),setTimeout(()=>l(!1),2e3)};return(0,a.jsxs)("div",{className:"relative my-2 rounded-md bg-muted",children:[(0,a.jsx)("button",{className:"absolute right-2 top-2 rounded-md bg-secondary p-1 transition-colors hover:bg-muted-hover",onClick:d,children:(0,a.jsx)(c.Z,{name:n?"check":"content_copy",className:"h-4 w-4 text-primary transition-all duration-300"})}),(0,a.jsx)("div",{className:"max-w-full overflow-x-auto font-mono",children:(0,a.jsx)(o.Z,{children:String(s).replace(/\n$/,""),style:r,language:t[1],wrapLongLines:!0,PreTag:"div",customStyle:{padding:"1em",margin:0}})})]})},g=(0,i.memo)(e=>{let{children:t,displayCursor:s,persisted:l}=e,o=!(0,i.useRef)(l).current,c=(0,d.C)(t),{resolvedTheme:p}=(0,n.F)(),g=(0,i.useMemo)(()=>"dark"===p?m.A:m.g,[p]),v=(0,i.useMemo)(()=>({code(e){let{node:t,className:s,children:r}=e,n=/language-(\w+)/.exec(s||"");return n?(0,a.jsx)(f,{match:n,codeContent:r,prismTheme:g}):(0,a.jsx)("span",{className:"mx-px mb-1 inline-block -translate-y-px rounded-md bg-secondary px-1.5 py-1 font-mono text-[13.5px] leading-[13.5px]",children:r})}}),[g]);return(0,a.jsxs)(r.E.div,{initial:{opacity:o?0:1},animate:{opacity:1},transition:{duration:1,ease:"easeOut"},className:"relative max-w-full",children:[o?(0,a.jsx)(x,{className:(0,u.cn)("prose prose-zinc prose-markdown-mobile absolute inset-x-0 top-0 max-w-full dark:prose-invert md:prose-markdown prose-h1:mb-2 prose-h1:text-xl prose-h1:font-medium prose-h2:text-lg prose-h2:font-medium prose-h3:text-base prose-h3:font-medium prose-pre:my-2 prose-pre:whitespace-pre-wrap prose-pre:break-words prose-pre:bg-background prose-ol:my-2 prose-ul:my-2 prose-li:my-0",h().customProse,s&&h().cursor),components:v,children:c}):null,(0,a.jsx)(x,{className:(0,u.cn)("prose prose-zinc prose-markdown-mobile max-w-full dark:prose-invert md:prose-markdown prose-h1:mb-2 prose-h1:text-xl prose-h1:font-medium prose-h2:text-lg prose-h2:font-medium prose-h3:text-base prose-h3:font-medium prose-pre:my-2 prose-pre:whitespace-pre-wrap prose-pre:break-words prose-pre:bg-background prose-ol:my-2 prose-ul:my-2 prose-li:my-0",h().customProse,s&&h().cursor,o&&"pointer-events-none opacity-0"),components:v,children:t})]})});g.displayName="PromptBox"},96895:function(e,t,s){"use strict";s.d(t,{C:function(){return n}});var a=s(72371),r=s(98244);function n(e){let[t,s]=(0,r.useState)(0),[n,i]=(0,r.useState)(0),[l,o]=(0,r.useState)(e);return(0,r.useLayoutEffect)(()=>{l!==e&&(o(e),i(t))},[e,l,t]),(0,r.useEffect)(()=>{let t=e.split("").length-n,r=(0,a.j)(n,e.split("").length,{duration:Math.max(.1,Math.min(5,t/140)),bounce:0,onUpdate(e){s(Math.floor(e))}});return()=>r.stop()},[n,e]),e.split("").slice(0,t).join("")}},71131:function(e,t,s){"use strict";s.d(t,{N:function(){return n}});var a=s(29895),r=s(21517);function n(){var e,t;let s=(0,r.iZ)(e=>e.project),n=null==s?void 0:s.supabase_project_config,i=(0,a.S)({workspaceId:null!==(t=null==s?void 0:s.workspace_id)&&void 0!==t?t:""}),l=function(e,t){if(e.isLoading||!t||!e.supabaseOrganizations)return!1;if(e.noOrganizations)return!0;let s=e.supabaseOrganizations.find(e=>e.id===t.supabase_organization_id);return!s||"connected"!==s.status}(i,n),o=null===(e=i.supabaseOrganizations)||void 0===e?void 0:e.flatMap(e=>e.projects||[]);return!l&&o&&(null==n?void 0:n.supabase_project_id)&&o.find(e=>e.id===n.supabase_project_id)||null}},90163:function(e,t,s){"use strict";s.d(t,{U:function(){return d},b:function(){return o}});var a=s(95713),r=s(98244),n=s(92361),i=s(21198);let l=e=>{if(e.created_at&&!(e.created_at instanceof a.EK)){let{seconds:t,nanoseconds:s}=e.created_at;return{...e,created_at:new a.EK(t,s)}}return e},o=()=>{let e=(0,i.aK)(e=>e.latestStreamedMessage);return e?l(e):null},d=e=>{let{projectId:t,messageId:s}=e,[i,l]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(!t||!s)return;let e=(0,a.JU)(n.db,"projects",t,"trajectory",s);return(0,a.cf)(e,e=>{e.exists()?l(e.data()):l(null)})},[t,s]),i}},22136:function(e,t,s){"use strict";s.d(t,{I:function(){return p}});var a=s(56166),r=s(12703),n=s(77162),i=s(94671),l=s(84864),o=s(70766),d=s(70980),c=s(95713),u=s(98244),m=s(92361);let p=e=>{let{setIsSomeRevertMutationPending:t}=(0,d.Xr)(),s=(0,i.SJ)(),p=(0,n.D)(),{setActiveEditId:h}=(0,o.RA)(),{isRevertSafe:x}=function(e){let{projectId:t}=e,s=(0,u.useCallback)(async e=>{let{targetEditId:s}=e,a=await (0,c.QT)((0,c.JU)(m.db,"projects",t,"edits",s));if(!a.exists())return l.logging.warn("invalid_edit_id_for_supabase_revert_check",{editId:s}),!0;let r=a.data();return(await (0,c.PL)((0,c.IO)((0,c.hJ)(m.db,"projects",t,"trajectory"),(0,c.ar)("created_at",">",r.created_at),(0,c.ar)("sql_run_state","in",["running","succeeded"]),(0,c.Xo)("created_at","desc"),(0,c.b9)(1)))).empty},[t]);return{isRevertSafe:(0,u.useCallback)(e=>{let{targetEditId:t}=e;return s({targetEditId:t})},[s])}}({projectId:p}),{setEditIdToConfirmRestoreFor:f}=(0,d.Xr)(),g=async t=>{let{edit:a,dry_run:r,via_undo:n}=t,i=a.id;if(a.revert_target_edit_id&&(i=a.revert_target_edit_id),!(null==e?void 0:e.skipSafetyCheck)&&!await x({targetEditId:i}))return null;let l={edit_id:i,dry_run:r,via_undo:n};return s.post("/projects/".concat(p,"/revert-to-edit"),l)};return(0,a.D)({mutationFn:g,onMutate:()=>{t(!0)},onSuccess:(t,s)=>{var a;if(!t){f(s.edit.revert_target_edit_id||s.edit.id);return}if(!s.via_undo){let e=t.commit_message;void 0===e&&t.tags&&(e=t.tags.summary);let s=e?"Restored to earlier version: ".concat(e):"Restored to earlier version";r.Am.success("Success",{description:s})}null==e||null===(a=e.onSuccess)||void 0===a||a.call(e),h(t.id)},onError:e=>{var t;l.logging.error("could_not_revert_to_earlier_version",{error:e}),r.Am.error("Could not revert to earlier version",{description:null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.detail})},onSettled:()=>{t(!1)}})}},1176:function(e,t,s){"use strict";s.d(t,{v:function(){return l}});var a=s(56166),r=s(37156),n=s(13273),i=s(94671);let l=()=>{let{userData:e}=(0,r.SE)();return(0,a.D)({mutationFn:async t=>(0,i.SJ)().put("/user/".concat(e.id),{tips:t}),onError:e=>{(0,n.Eo)(e)}})}},10990:function(e,t,s){"use strict";s.d(t,{Y:function(){return n}});var a=s(21198),r=s(21517);let n=e=>{var t;let s=(0,r.iZ)(e=>e.project),n=(0,a.uO)(null!==(t=null==s?void 0:s.latest_commit_sha)&&void 0!==t?t:void 0);return e.commitSha===(null==s?void 0:s.latest_commit_sha)||(null==n?void 0:n.type)=="revert"&&n.revert_target_edit_id==e.editId}},35046:function(e,t,s){"use strict";s.d(t,{A7:function(){return m},TO:function(){return c},ag:function(){return u}});var a=s(52155),r=s(98244),n=s(67801),i=s(70786);let l=e=>({files:{},pendingChanges:{},isLoading:!1,isSyncing:!1,lastSyncTimestamp:void 0,syncError:void 0,uploads:[],projectId:e,searchQuery:"",expandedSearchFiles:new Set,sidebarTab:"files"}),o=e=>(0,n.Ue)()((0,i.n)((t,s)=>({...l(e),setFile:(e,s)=>t(t=>({files:{...t.files,[e]:s}})),removeFile:e=>t(t=>{let{[e]:s,...a}=t.files;return{files:a}}),updateFileContent:(e,s)=>t(t=>({files:{...t.files,[e]:s}})),setSyncing:e=>t({isSyncing:e,lastSyncTimestamp:e?void 0:Date.now()}),setSyncError:e=>t({syncError:e,isSyncing:!1}),setLoading:e=>t({isLoading:e}),addPendingChange:e=>{let{path:s,content:a}=e;return t(e=>({pendingChanges:{...e.pendingChanges,[s]:a}}))},removePendingChange:e=>t(t=>{let{[e]:s,...a}=t.pendingChanges;return{pendingChanges:a}}),clearPendingChanges:()=>t({pendingChanges:{}}),hasUnsavedChanges:()=>{let{pendingChanges:e}=s();return Object.keys(e).length>0},reset:()=>t({...l(s().projectId)}),addUpload:e=>t(t=>({uploads:[...t.uploads,e]})),clearUploads:()=>t({uploads:[]}),setSearchQuery:e=>t({searchQuery:e}),setExpandedSearchFiles:e=>t({expandedSearchFiles:e}),setSidebarTab:e=>t({sidebarTab:e})}))),d=(0,r.createContext)(null),c=e=>{let{children:t,projectId:s}=e,n=(0,r.useRef)(o(s)),i=(0,r.useCallback)(()=>n.current.getState().pendingChanges,[]),l=(0,r.useCallback)(()=>n.current.getState().files,[]),c={store:n.current,snapshot:{getPendingChanges:i,getFiles:l}};return(0,a.jsx)(d.Provider,{value:c,children:t})};function u(){let e=(0,r.useContext)(d);if(!e)throw Error("useCodeEditorContext must be used within a CodeEditorProvider");return e}function m(e){let{store:t}=u();return t(e)}},62970:function(e,t,s){"use strict";s.d(t,{VF:function(){return d},f6:function(){return o},z:function(){return c}});var a=s(52155),r=s(98244),n=s(67801);let i=()=>(0,n.Ue)(()=>({showHistory:!1})),l=(0,r.createContext)(null),o=e=>{let{children:t}=e,s=(0,r.useRef)(i()),n={store:s.current,setShowHistory:e=>{let t=s.current,a=t.getState(),r="function"==typeof e?e(a.showHistory):e;t.setState({showHistory:r})}};return(0,a.jsx)(l.Provider,{value:n,children:t})};function d(){let e=(0,r.useContext)(l);if(!e)throw Error("useHistoryContext must be used within a HistoryProvider");return e}function c(e){let{store:t}=d();return t(e)}},98260:function(e,t,s){"use strict";s.d(t,{P:function(){return x},v:function(){return f}});var a=s(52155),r=s(17195),n=s(98244),i=s(13273),l=s(94671),o=s(56792),d=s(30646),c=s(84864),u=s(35046),m=s(7287),p=s(21517);let h=(0,n.createContext)(null);function x(e){let{children:t}=e,{refreshPreview:s,startLiveMode:x}=(0,m.My)(),f=(0,u.A7)(e=>e.setFile),g=(0,u.A7)(e=>e.pendingChanges),v=(0,u.A7)(e=>e.reset),b=(0,u.A7)(e=>e.clearPendingChanges),j=(0,u.A7)(e=>e.addPendingChange),y=(0,n.useRef)(null),w=(0,p.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.id}),_=(0,u.A7)(e=>e.files),N=(0,n.useMemo)(()=>Object.entries(_),[_]),C=(0,u.A7)(e=>e.uploads),[k,S]=(0,n.useState)(!1),[E,I]=(0,n.useState)(null),[A,P]=(0,n.useState)([]),[z,M]=(0,n.useState)([]),{snapshot:Z}=(0,u.ag)(),D=(0,n.useCallback)(()=>{N&&P((0,o.x2)(N))},[N]);(0,n.useEffect)(()=>{D()},[D]);let[L,R]=(0,n.useState)(!1),T=(0,n.useCallback)(()=>{R(!0),x()},[x,R]),O=(0,m.vE)();(0,n.useEffect)(()=>{if(!L||!O)return;let e=new URL("/_sandbox/code/ws",O);return y.current=new WebSocket(e),y.current.onmessage=e=>{try{let{type:t,data:s}=JSON.parse(e.data);if("init_code"===t)v(),S(!0),s.forEach(e=>{let[t,s]=e;f(t,s)});else if("file_update"===t){let e=Z.getFiles();s.forEach(t=>{let[s,a]=t;e[s]!==a&&f(s,a)})}}catch(e){c.logging.error("Error processing WebSocket message",{project_id:w,error:e})}},y.current.onclose=e=>{e.wasClean||c.logging.error("Code WebSocket closed prematurely",{project_id:w,event:e})},y.current.onerror=e=>{c.logging.error("Code WebSocket error",{project_id:w,error:e})},()=>{var e;null===(e=y.current)||void 0===e||e.close(),y.current=null}},[O,w,v,f,L,Z]);let F=(0,n.useCallback)(async function(e){let{commitMessage:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.ZP.capture("visual_edits:sync_started");let s=Object.entries(e);if(!w)throw Error("No project id");if(0===s.length)throw Error("No changes to sync");try{let e=(0,l.SJ)(),a=await Promise.all(C.map(e=>(0,d.Sv)({dir_name:e.dir_name,file_name:e.id}).then(t=>({download_url:t.url,file_id:e.file_name})))),r=await e.post("/projects/".concat(w,"/edit-code"),{changes:s.map(e=>{let[t,s]=e;return{path:t,content:s}}),uploads:a,commit_message:t||null});if("error"in r&&r.error)throw Error("Failed to sync code");b()}catch(e){(0,i.Eo)(e),r.ZP.capture("visual_edits:sync_failed",{error:e instanceof Error?e.message:"Unknown error",changes:null==s?void 0:s.map(e=>{let[t,s]=e;return[t,s.length]}),project_id:w})}},[w,C,b]),U=Object.keys(g).length>0;return(0,a.jsx)(h.Provider,{value:{syncCode:F,ast:A,code:N,generateAst:D,refreshPreview:s,startLiveMode:T,history:z,setHistory:M,currentClassName:E,setCurrentClassName:I,addPendingChange:j,hasUnsavedChanges:U,hasInitialCode:k},children:t})}function f(){let e=(0,n.useContext)(h);if(!e)throw Error("useSandboxCode must be used within a SandboxCodeProvider");return{code:e.code,syncCode:e.syncCode,ast:e.ast,generateAst:e.generateAst,refreshPreview:e.refreshPreview,enableServer:e.startLiveMode,history:e.history,setHistory:e.setHistory,currentClassName:e.currentClassName,setCurrentClassName:e.setCurrentClassName,addPendingChange:e.addPendingChange,hasUnsavedChanges:e.hasUnsavedChanges,hasInitialCode:e.hasInitialCode}}},71919:function(e,t,s){"use strict";s.d(t,{NE:function(){return d},S9:function(){return c},UC:function(){return u}});var a=s(52155),r=s(98244),n=s(67801),i=s(70786);let l=()=>(0,n.Ue)()((0,i.n)(()=>({selectedElements:[],isVisualEditingActive:!1,isPickAndEditActive:!1,customPromptValue:"",isSaving:!1,activeEditContent:null,floatingInputState:{isVisible:!1,position:null},visualEditsPanelState:{isOpen:!1,position:null},lastPanelPosition:null}))),o=(0,r.createContext)(null),d=e=>{let{children:t}=e,s=(0,r.useRef)(l()),n={store:s.current,setSelectedElements:e=>{s.current.setState(t=>{t.selectedElements=e})},removeSelectedElement:e=>{s.current.setState(t=>{t.selectedElements=t.selectedElements.filter(t=>t.filePath!==e.filePath||t.lineNumber!==e.lineNumber)})},turnOffVisualEditing:()=>{s.current.setState(e=>{e.isVisualEditingActive=!1,e.isPickAndEditActive=!1,e.selectedElements=[],e.isSaving=!1,e.visualEditsPanelState={isOpen:!1,position:null},e.floatingInputState={isVisible:!1,position:null}})},setIsVisualEditorPanelOpen:e=>{let t=s.current;"function"==typeof e?t.setState(t=>{t.isVisualEditingActive=e(t.isVisualEditingActive)}):t.setState(t=>{t.isVisualEditingActive=e})},setIsPickAndEditActive:e=>{let t=s.current;"function"==typeof e?t.setState(t=>{t.isPickAndEditActive=e(t.isPickAndEditActive)}):t.setState(t=>{t.isPickAndEditActive=e})},showFloatingInput:e=>{s.current.setState(t=>{t.floatingInputState={isVisible:!0,position:e}})},showVisualEditsPanel:e=>{s.current.setState(t=>{t.visualEditsPanelState={isOpen:!0,position:e},t.lastPanelPosition=e})},closeVisualEditsPanel:()=>{s.current.setState(e=>{e.visualEditsPanelState={isOpen:!1,position:null},e.customPromptValue="",e.selectedElements=[]})},hideVisualEditsPanel:()=>{s.current.setState(e=>{e.visualEditsPanelState.isOpen&&(e.lastPanelPosition=e.visualEditsPanelState.position),e.visualEditsPanelState={isOpen:!1,position:null}})},setCustomPromptValue:e=>{s.current.setState(t=>{t.customPromptValue=e})},setIsSaving:e=>{s.current.setState(t=>{t.isSaving=e})},setActiveEditContent:e=>{s.current.setState(t=>{t.activeEditContent=e})}};return(0,a.jsx)(o.Provider,{value:n,children:t})};function c(){let e=(0,r.useContext)(o);if(!e)throw Error("useVisualEditorContext must be used within a VisualEditorProvider");return e}function u(e){let{store:t}=c();return t(e)}},52078:function(e,t,s){"use strict";s.d(t,{Ny:function(){return d},U1:function(){return n},fA:function(){return i},oo:function(){return o},pr:function(){return l}});var a=s(98689);let r=()=>"https://console.firebase.google.com/u/0/project/".concat(a.q.projectId,"/firestore/databases/-default-/data"),n=e=>"".concat(r(),"/~2Fprojects~2F").concat(e),i=e=>e?"".concat(r(),"/~2Fusers~2F").concat(e):"",l=(e,t)=>"".concat(n(e),"~2Ftrajectory~2F").concat(t),o=(e,t)=>"".concat(n(e),"~2Fedits~2F").concat(t),d=e=>"".concat(r(),"/~2Fworkspaces~2F").concat(e)},76647:function(e,t,s){"use strict";s.d(t,{G:function(){return n}});var a=s(26047),r=s(75748);let n=()=>{let{canEdit:e,isWorkspaceMember:t}=(0,r.t)(),s=(0,a.v)();return t&&e||s}},93946:function(e,t,s){"use strict";var a=s(52155);s(98244);var r=s(84183);t.Z=e=>{let{children:t,label:s,side:n="bottom"}=e;return(0,a.jsxs)(r.u,{children:[(0,a.jsx)(r.aJ,{asChild:!0,children:t}),(0,a.jsx)(r._v,{className:"z-[2001]",side:n,children:s})]})}},4918:function(e,t,s){"use strict";s.d(t,{w:function(){return n},z:function(){return r}});var a=s(32315);let r=a.fC,n=a.wy;a.Fw},52621:function(e,t,s){"use strict";s.d(t,{J:function(){return i}});var a=s(98244),r=s(52532),n=s(36803);let i=()=>{let[e]=(0,n.pQ)(),[t,s]=(0,r.Z)("bronzeage-message-count",{defaultValue:0}),[i,l]=(0,r.Z)("bronzeage-feedback-dismissed",{defaultValue:!1});return{messageCount:t,incrementMessageCount:(0,a.useCallback)(()=>{e&&s(e=>e+1)},[e,s]),shouldShowFeedbackNudge:t>9&&!i,dismissFeedback:(0,a.useCallback)(()=>{l(!0)},[l])}}},69130:function(e,t,s){"use strict";var a=s(98244);t.Z=()=>{let[e,t]=(0,a.useState)("");return(0,a.useEffect)(()=>{t(r())},[]),{isMac:"mac"===e,isWindows:"windows"===e,isLinux:"linux"===e}};let r=()=>{let e=window.navigator.userAgentData,t=window.navigator.userAgent,s={iphone:/iphone/,ipad:/ipad|macintosh/,android:/android/},a={windows:/win/,mac:/macintosh/,linux:/linux/};if(t){let e=t.toLowerCase().replace(/^mozilla\/\d\.\d\W/,""),r=Object.keys(s).find(t=>s[t].test(e)&&window.navigator.maxTouchPoints>=1),n=Object.keys(a).find(t=>a[t].test(e));return r||n}return e?e.platform.toLowerCase():""}},25871:function(e,t,s){"use strict";s.d(t,{g:function(){return p}});var a=s(56166),r=s(17195),n=s(98244),i=s(12703),l=s(21198),o=s(62970),d=s(35938),c=s(13273),u=s(94671),m=s(89671);let p=e=>{let{updateEdit:t}=(0,l.mx)(),{setShowHistory:s}=(0,o.VF)(),p=(0,a.D)({mutationFn:async t=>{let{editId:s,bookmarked:a,previousValue:r}=t;try{let t=(0,u.SJ)();return await t.put("/projects/".concat(e,"/bookmark/").concat(s),{bookmarked:a}),{editId:s,bookmarked:a}}catch(e){throw e}},onError:(e,s)=>{if(t(s.editId,{bookmarked:s.previousValue}),e instanceof d.H){let t=s.bookmarked?"bookmark":"unbookmark";i.Am.error("Failed to ".concat(t," edit"),{description:e.message||"Please try again"});return}(0,c.Eo)(e)},onSuccess:e=>{i.Am.success(e.bookmarked?"Bookmarked to history":"Bookmark removed from history",{action:{label:"View history",onClick:()=>s(!0)}})}});return{toggleBookmark:(0,n.useCallback)(function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!s;r.ZP.capture(a?m.SL.BOOKMARK.ADDED:m.SL.BOOKMARK.REMOVED),t(e,{bookmarked:a}),p.mutate({editId:e,bookmarked:a,previousValue:s})},[p,t]),isToggling:p.isPending}}},56792:function(e,t,s){"use strict";s.d(t,{EE:function(){return h},H2:function(){return u},R5:function(){return o},Rw:function(){return l},Xu:function(){return c},cB:function(){return m},x2:function(){return i},xA:function(){return x}});var a=s(91302),r=s(23519),n=s(8209);function i(e){let t=[];return e.map(e=>{let s,[r,n]=e;if(r.endsWith(".tsx")||r.endsWith(".ts")||r.endsWith(".jsx")||r.endsWith(".js")){try{s=(0,a.parse)(n,{sourceFilename:r,sourceType:"module",plugins:["jsx","typescript"],allowImportExportEverywhere:!0})}catch(e){return}t.push({filePath:r,ast:s})}}),t}function l(e,t){let s=e.children.find(e=>n.isJSXText(e));s?s.value=t:e.children.unshift(n.jsxText(t))}function o(e,t){Object.keys(t).forEach(s=>{e.openingElement.attributes=e.openingElement.attributes.filter(e=>{var t;return n.isJSXAttribute(e)&&(null===(t=e.name)||void 0===t?void 0:t.name)!==s}),e.openingElement.attributes.push(n.jsxAttribute(n.jsxIdentifier(s),n.stringLiteral(t[s])))})}let d=e=>n.isStringLiteral(e)?e.value:null;function c(e){let t=e.openingElement.attributes.find(e=>n.isJSXAttribute(e)&&"className"===e.name.name);return void 0===t?"":(null==t?void 0:t.value)?d(t.value):null}let u=(e,t)=>{let s=t.find(t=>t.filePath===e.filePath);if(!s)return!1;let a=!1;return(0,r.default)(s.ast,{JSXElement(t){var s;if((null===(s=t.node.loc)||void 0===s?void 0:s.start.line)===e.lineNumber&&n.isJSXElement(t.node)){let e=t.node.children;a=1===e.length&&n.isJSXText(e[0]),t.stop()}}}),a},m=(e,t,s)=>{let a=t.find(t=>t.filePath===e.filePath);if(!a)return!1;let i=!1;return(0,r.default)(a.ast,{JSXElement(t){var a;(null===(a=t.node.loc)||void 0===a?void 0:a.start.line)===e.lineNumber&&n.isJSXElement(t.node)&&(i=t.node.openingElement.attributes.some(e=>{var t;return n.isJSXAttribute(e)&&n.isStringLiteral(e.value)&&(null===(t=e.name)||void 0===t?void 0:t.name)===s}),t.stop())}}),i},p=(e,t,s)=>{let a=s.find(e=>e.filePath===t);if(!a)return null;let n=null;return(0,r.default)(a.ast,{JSXElement(t){var s;(null===(s=t.node.loc)||void 0===s?void 0:s.start.line)===e&&(n=t.node,t.stop())}}),n},h=(e,t)=>{let s=p(e.lineNumber,e.filePath,t);return s?c(s):null},x=(e,t)=>{let s=t.find(t=>t.filePath===e.filePath);if(!s)return null;let a=null,n=null;return((0,r.default)(s.ast,{JSXElement(t){var s;(null===(s=t.node.loc)||void 0===s?void 0:s.start.line)===e.lineNumber&&(a=t.node.loc.start.line,n=t.node.loc.end.line,t.stop())}}),null===a||null===n)?null:{startLine:a,endLine:n}}},36839:function(e,t,s){"use strict";s.d(t,{B:function(){return i},a:function(){return r}});let a={text:"format_size",img:"image",button:"crop_16_9",link:"link",div:"select"},r=e=>a[n(e)],n=e=>["p","span","h1","h2","h3","h4","h5","h6"].includes(e)?"text":"img"===e?"img":"button"===e?"button":"a"===e?"link":"div",i=e=>n(e.elementType)},25649:function(e){e.exports={cursor:"PromptBox_cursor__MuO9l",blink:"PromptBox_blink__F53p4",customProse:"PromptBox_customProse__C94Rw"}}}]);