try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="646228c6-1e0b-40e8-bdda-c6bbfdb709c5",e._sentryDebugIdIdentifier="sentry-dbid-646228c6-1e0b-40e8-bdda-c6bbfdb709c5")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6248],{10416:function(e,s,t){t.d(s,{g:function(){return u},s:function(){return x}});var a=t(52155),r=t(98244),n=t(5449),i=t(40248),l=t(14070),o=t(77658),c=t(75970),d=t(45776),m=t(33877);function u(e){let{dialogDescription:s}=e,t=(0,d.useCurrentWorkspaceStore)(e=>e.currentWorkspace),r=(0,d.useCurrentWorkspaceStore)(e=>e.hasFetchedCurrentWorkspace),n=(0,d.useCurrentWorkspaceStore)(e=>e.membership),{authUser:i}=(0,c.Eu)(),l=null==n?void 0:n.role;return(0,m.MD)()?(0,a.jsx)(h,{dialogDescription:s}):(0,a.jsx)(p,{hasFetchedWorkspace:r,dialogDescription:s,myWorkspaceRole:l,workspace:t,isLoggedIn:!!i})}function h(e){let{dialogDescription:s}=e,t=(0,m.hO)(e=>e.projectWorkspace),r=(0,m.hO)(e=>e.membership),n=null==r?void 0:r.role,{authUser:i}=(0,c.Eu)(),l=(0,m.hO)(e=>e.hasFetchedProjectWorkspace);return(0,a.jsx)(p,{dialogDescription:s,myWorkspaceRole:n,workspace:t,hasFetchedWorkspace:l,isLoggedIn:!!i})}function p(e){let{dialogDescription:s,myWorkspaceRole:t,workspace:c,hasFetchedWorkspace:d,isLoggedIn:m}=e,u=!!c,{title:h,description:p}=(0,r.useMemo)(()=>d&&!u?{title:"Error",description:"Something went wrong."}:{title:"Upgrade required",description:s||"Upgrade to Pro and unlock more features & usage"},[d,u,s]);return(0,a.jsxs)(l.cZ,{className:"max-h-[90vh] overflow-y-auto md:max-w-3xl",size:"lg",children:[(0,a.jsxs)(l.fK,{children:[(0,a.jsx)(o.xx,{className:"mb-1 size-9 shrink-0"}),(0,a.jsx)(l.$N,{className:"text-2xl",children:m?h:"Upgrade required"}),(0,a.jsx)(l.Be,{className:"text-sm",children:m?p:s||"Upgrade to Pro and unlock more features & usage"})]}),m?d?c?(0,a.jsx)(n.om,{planCardContext:"outOfCredits",workspace:c,myWorkspaceRole:t,children:(0,a.jsx)(i.S,{showEnterprise:!1})}):(0,a.jsx)(x,{}):(0,a.jsx)(n._M,{}):(0,a.jsx)(n.om,{planCardContext:"loggedOut",myWorkspaceRole:void 0,children:(0,a.jsx)(i.S,{showEnterprise:!1})})]})}let x=()=>(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"We couldn't load the data needed to upgrade your workspace."}),(0,a.jsxs)("p",{children:["Please refresh the page and try again. If the problem continues, contact our"," ",(0,a.jsx)("a",{href:"/support",className:"underline",children:"Support"}),"."]})]})},72124:function(e,s,t){t.d(s,{s:function(){return h}});var a=t(52155),r=t(98244),n=t(56551),i=t(12703),l=t(59561),o=t(53259),c=t(99792),d=t(45694),m=t(25483);let u=e=>{var s,t;let{selectedRole:n,onRoleChange:i,roleOptions:d,disabled:m=!1}=e,[u,h]=(0,r.useState)(!1);return m?(0,a.jsx)(l.z,{variant:"ghost",size:"sm",className:"flex-shrink-0 gap-1.5 font-normal",disabled:!0,children:null===(t=d.find(e=>e.value===n))||void 0===t?void 0:t.label}):(0,a.jsxs)(o.h_,{open:u,onOpenChange:h,children:[(0,a.jsx)(o.$F,{asChild:!0,children:(0,a.jsxs)(l.z,{variant:"ghost",size:"sm",className:"flex-shrink-0 gap-1.5 font-normal",children:[null===(s=d.find(e=>e.value===n))||void 0===s?void 0:s.label,(0,a.jsx)(c.Z,{name:"keyboard_arrow_down",size:"small"})]})}),(0,a.jsx)(o.AW,{children:(0,a.jsx)(o._x,{value:n,onValueChange:e=>{i(e),h(!1)},children:d.map(e=>(0,a.jsx)(o.qB,{value:e.value,className:"hover:bg-accent",children:e.label},e.value))})})]})},h=e=>{let{onInvite:s,isInviting:t,roleOptions:o,defaultRole:c,canSelectRoles:h=!0,placeholder:p="Add emails",completelyDisabled:x=!1,onInputChange:f}=e,[v,g]=(0,r.useState)([]),[j,b]=(0,r.useState)(""),[w,y]=(0,r.useState)(c),E=v.length>0||""!==j.trim(),_=async()=>{let e=[...v],t=j.trim();if(""===t||v.includes(t)||(e.push(t),g(e),b("")),0===e.length)return;if(e.length>0&&!e.every(e=>(0,d.Jh)(e))){1===e.length?i.Am.error("Invalid email address",{description:"Please check the email address and try again."}):i.Am.error("Invalid email address",{description:"One or more email addresses are invalid. Please check and try again."});return}let{success:a}=await s({emails:e,role:w});a&&(g([]),b(""),null==f||f(""))};(0,n.y1)("mod+enter",e=>{e.preventDefault(),t||_()},{enableOnFormTags:!0});let N=""===j.trim()&&0===v.length;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(m.B,{tags:v,setTags:g,inputValue:j,setInputValue:e=>{b(e),null==f||f(e)},placeholder:p,disabled:x,className:"min-w-0 flex-1"}),E&&(0,a.jsx)(u,{selectedRole:w,onRoleChange:y,roleOptions:o,disabled:!h||x}),(0,a.jsx)(l.z,{onClick:_,variant:"affirmative",className:"flex-shrink-0",disabled:t||N||x,loading:t,children:"Invite"})]})}},11515:function(e,s,t){t.d(s,{Q:function(){return l}});var a=t(52155),r=t(60468),n=t(26052),i=t(4578);let l=e=>{let{id:s,username:t,displayName:l,photoURL:o,avatarClassName:c,actionComponent:d,email:m,isCurrentUser:u=!1,isInvited:h=!1,showBadge:p=!0}=e;return(0,a.jsxs)("div",{className:"flex items-center justify-start gap-3 py-1 md:flex-nowrap",children:[(0,a.jsx)(r.Y,{className:(0,i.cn)(c,h&&"opacity-60"),user:{id:s,username:null!=l?l:m},photoURL:o,isInteractive:!1}),(0,a.jsx)("div",{className:"flex min-w-0 flex-shrink items-center gap-4 ".concat(h&&"opacity-60"),children:(0,a.jsxs)("div",{className:"flex min-w-0 flex-col gap-0",children:[(0,a.jsxs)("div",{className:"flex-shrink truncate text-sm font-medium leading-tight",children:[l," ",u&&(0,a.jsx)("span",{className:"font-normal",children:"(you)"})]}),(0,a.jsx)("span",{className:"max-w-[150px] flex-shrink truncate text-xs text-muted-foreground",children:m})]})}),h&&p&&(0,a.jsx)(n.C,{variant:"outline",className:"hidden gap-1 bg-muted text-xs font-medium text-muted-foreground md:flex",children:"Invite sent"}),d&&(0,a.jsx)("div",{className:"ml-auto flex-shrink-0",children:d})]})}},40248:function(e,s,t){t.d(s,{S:function(){return u}});var a=t(52155),r=t(17195),n=t(5449),i=t(81933),l=t(89671),o=t(35127),c=t(20018);let d=e=>{let{className:s,showEnterprise:t}=e;return(0,a.jsxs)(n.Or,{className:s,showEnterprise:t,children:[(0,a.jsx)(n.Or.Free,{}),(0,a.jsx)(n.Or.Ktlo,{}),(0,a.jsx)(n.Or.Pro,{}),(0,a.jsx)(n.Or.Enterprise,{})]})},m=e=>{let{className:s}=e;return(0,a.jsxs)(i.he,{className:s,children:[(0,a.jsx)(i.he.Free,{}),(0,a.jsx)(i.he.Ktlo,{}),(0,a.jsx)(i.he.Scheduled,{}),(0,a.jsx)(i.he.Pro,{}),(0,a.jsx)(i.he.Biz,{}),(0,a.jsx)(i.he.Enterprise,{})]})},u=e=>{let{className:s,showEnterprise:t}=e,n=(0,o.Kq)(),{planCardContext:i}=(0,c.tS)();return(r.ZP.capture(l.Fi.PLAN_VIEWED,{plan_context:i}),n)?(0,a.jsx)(m,{className:s,showEnterprise:t}):(0,a.jsx)(d,{className:s,showEnterprise:t})}},59882:function(e,s,t){var a=t(52155),r=t(98244),n=t(59561),i=t(14070);s.Z=e=>{let{title:s="Remove",targetName:t,descriptionTemplate:l="Are you sure you want to remove {name}? They will no longer have access.",confirmButtonText:o="Remove",cancelButtonText:c="Cancel",onConfirm:d,onCancel:m}=e,[u,h]=(0,r.useState)(!1),p=async()=>{h(!0);try{await d()}finally{h(!1)}},x=l.replace("{name}",t);return(0,a.jsxs)(i.cZ,{size:"sm",children:[(0,a.jsxs)(i.fK,{children:[(0,a.jsx)(i.$N,{children:s}),(0,a.jsx)(i.Be,{children:x})]}),(0,a.jsxs)(i.cN,{className:"gap-2 sm:justify-end",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:m,disabled:u,children:c}),(0,a.jsx)(n.z,{variant:"destructive",onClick:p,disabled:u,loading:u,children:u?"Removing...":o})]})]})}},31353:function(e,s,t){t.d(s,{I:function(){return es},C:function(){return et}});var a=t(52155),r=t(56852),n=t(33877),i=t(73517),l=t(68820),o=t(94671);let c=e=>(0,l.a)({queryKey:["workspace",e,"maxSeats"],queryFn:async()=>{let s=(0,o.SJ)();return(await s.get("/workspaces/".concat(e,"/max-seats"))).max_seats},enabled:!!e});var d=t(98244),m=t(12703),u=t(10416),h=t(75970),p=t(45776),x=t(72124),f=t(19214),v=t(59561),g=t(99792),j=t(3011),b=t(84183),w=t(47149),y=t(44647),E=t(16125),_=t(6065),N=t(14343),k=t(77721);let I=e=>new k.bO(e),C=e=>{let{workspace:s,authUserId:t,role:a,targetRole:r}=e;return(0,d.useMemo)(()=>{let e={workspace:s,isWorkspaceOwner:t===s.owner_id,role:a,targetRole:r},n=I(e);return{canEmailInvite:()=>n.canEmailInvite(),canSetInviteRole:()=>n.canSetInviteRole(),canEditRole:()=>n.canEditRole(),canSeeUsage:()=>n.canSeeUsage(),canCreateSecretLink:()=>n.canCreateSecretLink(),canManagePlan:()=>n.canManagePlan(),canRemoveMember:()=>n.canRemoveMember(),isWorkspaceOwner:e.isWorkspaceOwner}},[s,t,a,r])};var D=t(18587),R=t(60468),M=t(42690),S=t(33864);let A=e=>{let{workspace:s,memberships:t}=e,r=new Date().getMonth()+1,n=new Date().getFullYear(),{data:i}=(0,l.a)(M.t.workspaceUsage({workspaceId:null==s?void 0:s.id,month:r,year:n})),{data:o}=(0,l.a)(M.t.workspaceUserTotalUsage({workspaceId:null==s?void 0:s.id})),c=(0,d.useMemo)(()=>null==o?void 0:o.map(e=>{let s=t.find(s=>s.user_id===e.user_id);return s?{...e,membership:s}:null}).filter(e=>null!==e).sort((e,s)=>s.count-e.count),[o,t]),m=(0,d.useMemo)(()=>null==i?void 0:i.user_usages.map(e=>{let s=t.find(s=>s.user_id===e.user_id);return s?{...e,membership:s}:null}).filter(e=>null!==e).sort((e,s)=>s.count-e.count),[i,t]);return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("p",{className:"pb-2 text-sm text-muted-foreground",children:["Showing usage for"," ",(0,D.WU)(new Date(n,r-1),"MMMM yyyy"),"."]}),(0,a.jsx)("div",{className:"flex flex-col gap-2",children:(null==m?void 0:m.length)===0?(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"No usage data for this period. Usage will appear here once members begin using the workspace."}):null==m?void 0:m.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(R.Y,{user:{id:e.user_id,username:e.membership.display_name||e.membership.email},photoURL:e.membership.photo_url}),(0,a.jsx)("p",{className:"text-sm font-medium",children:e.membership.display_name||e.membership.email})]}),(0,a.jsxs)("div",{className:"text-muted-foreground",children:[(0,S.H)(e.count)," credit",1===e.count?"":"s"," used"]})]},e.user_id))}),c&&c.length>0&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("p",{className:"pb-2 text-sm text-muted-foreground",children:"Total usage across all months."}),(0,a.jsx)("div",{className:"flex flex-col gap-2",children:c.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(R.Y,{user:{id:e.user_id,username:e.membership.display_name||e.membership.email},photoURL:e.membership.photo_url}),(0,a.jsx)("p",{className:"text-sm font-medium",children:e.membership.display_name||e.membership.email})]}),(0,a.jsxs)("div",{className:"font-medium text-muted-foreground",children:[(0,S.H)(e.count)," credit",1===e.count?"":"s"," total"]})]},e.user_id))})]})})]})};var O=t(11515),P=t(59882),L=e=>{let{memberName:s,onConfirm:t,onCancel:r}=e;return(0,a.jsx)(P.Z,{title:"Remove workspace member",targetName:s,descriptionTemplate:"Are you sure you want to remove ".concat(s," from this workspace? They will no longer have access to any workspace projects or resources."),onConfirm:t,onCancel:r})},T=t(53259),V=t(7575),z=t(26195),W=t(35127),U=t(29605),q=t(56166),F=t(13273),K=t(7653),G=t(67005);let Z={owner:"Owner",admin:"Admin",member:"Editor",viewer:"Viewer"},J={owner:"Owners can manage all collaborators, projects, and integrations.",admin:"Admins can manage editors, projects, and integrations.",member:"Editors can only create and edit projects.",viewer:"Viewers can only view projects."},Q=e=>{var s,t;let{currentMembership:r,workspaceId:n,workspace:i}=e,[l,c]=(0,d.useState)(null!==(s=r.monthly_credit_limit)&&void 0!==s?s:void 0),[m,x]=(0,d.useState)(!1),w=(0,d.useRef)(null),{authUser:E}=(0,h.Eu)(),_=r.user_id===(null==E?void 0:E.uid),N=(0,f.z)(L),I=(0,p.useCurrentWorkspaceStore)(e=>e.membership),D=null==I?void 0:I.role,R=!r.joined_at||""===r.joined_at,M="free"!==(0,y.Ll)(i.plan),S=(0,f.z)(u.g),A=C({workspace:i,authUserId:null==E?void 0:E.uid,role:D,targetRole:r.role}),P=A.canEditRole()&&!_&&!R,{updateWorkspaceMemberRole:Q}=function(e){let{workspaceId:s}=e,t=(0,U.NL)(),a=(0,K.b)(),{mutateAsync:r}=(0,q.D)({mutationFn:async e=>{let{userId:t,role:a}=e,r=(0,o.SJ)();await r.put("/user/workspaces/".concat(s,"/memberships/").concat(t),{role:a})},onMutate:async e=>{await (0,G.dG)(t,s),(0,G.yt)(t,s,a,s=>s.map(s=>s.user_id===e.userId?{...s,role:e.role}:s))},onSettled:()=>{(0,G.T6)(t,s)}});return{updateWorkspaceMemberRole:r}}({workspaceId:n}),{updateWorkspaceMemberCreditLimit:B}=function(e){let{workspaceId:s}=e,t=(0,U.NL)(),a=(0,K.b)(),{mutateAsync:r}=(0,q.D)({mutationFn:async e=>{let{userId:t,monthlyCreditLimit:a}=e,r=(0,o.SJ)();await r.put("/user/workspaces/".concat(s,"/memberships/").concat(t),{monthly_credit_limit:null!=a?a:-1})},onMutate:async e=>{await (0,G.dG)(t,s),(0,G.yt)(t,s,a,s=>s.map(s=>s.user_id===e.userId?{...s,monthly_credit_limit:-1===e.monthlyCreditLimit?null:e.monthlyCreditLimit}:s))},onError:e=>{(0,F.Eo)(e)},onSettled:()=>{(0,G.T6)(t,s,a)}});return{updateWorkspaceMemberCreditLimit:r}}({workspaceId:n}),{removeWorkspaceMember:Y}=function(e){let{workspaceId:s}=e,t=(0,U.NL)(),a=(0,K.b)(),{mutateAsync:r}=(0,q.D)({mutationFn:async e=>{let{userId:t}=e,a=(0,o.SJ)();await a.delete("/workspaces/".concat(s,"/memberships/").concat(t))},onMutate:async e=>{await (0,G.dG)(t,s),(0,G.yt)(t,s,a,s=>s.filter(s=>s.user_id!==e.userId),void 0,e=>Math.max(0,e-1))},onError:e=>{(0,F.Eo)(e)},onSettled:()=>{(0,G.T6)(t,s,a)}});return{removeWorkspaceMember:r}}({workspaceId:n}),H=(0,d.useCallback)(async e=>{R||await B({userId:r.user_id,monthlyCreditLimit:isNaN(null!=e?e:0)?-1:e})},[r.user_id,R,B]);(0,d.useEffect)(()=>{let e=e=>{m&&w.current&&!w.current.contains(e.target)&&H(l).then(()=>{x(!1)})};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[m,l,B,H]);let $=async e=>{if(!R){if((0,k.Ct)(e)&&!M){S({childProps:{}});return}await Q({userId:r.user_id,role:e})}},X=()=>{N({childProps:{memberName:r.display_name||r.username,onConfirm:async()=>{await Y({userId:r.user_id}),N(!1)},onCancel:()=>N(!1)}})},ee=(0,W.Tj)(),es=(0,a.jsxs)(a.Fragment,{children:[["owner","admin"].includes(null!=D?D:"")&&ee&&(0,a.jsxs)(b.u,{delayDuration:600,children:[(0,a.jsx)(b.aJ,{children:(0,a.jsx)(a.Fragment,{children:m?(0,a.jsxs)("div",{ref:w,className:"relative flex items-center",children:[(0,a.jsx)(j.I,{placeholder:"Limit / month",value:l||"",className:"max-w-32 pr-8 text-xs",onChange:e=>c(parseInt(e.target.value)),onKeyDown:e=>{if("Enter"===e.key)H(l).then(()=>{x(!1)});else if("Escape"===e.key){var s;c(null!==(s=r.monthly_credit_limit)&&void 0!==s?s:void 0),x(!1)}},autoFocus:!0}),(0,a.jsx)(v.z,{variant:"ghost",size:"icon",className:"absolute right-0.5 h-8 w-8 shadow-none hover:bg-accent hover:shadow-none",onClick:()=>{H(l).then(()=>{x(!1)})},children:(0,a.jsx)(g.Z,{name:"check",size:"small"})})]}):(0,a.jsx)(v.z,{variant:"ghost",size:"sm",className:"text-xs shadow-none hover:bg-accent hover:shadow-none",onClick:()=>x(!0),children:(null==r?void 0:r.monthly_credit_limit)?"".concat(r.monthly_credit_limit," credits/mo"):"No limit"})})}),(0,a.jsx)(b._v,{className:"max-w-[30ch]",children:"Update credit limits for this member"})]}),(0,a.jsxs)(T.h_,{children:[(0,a.jsxs)(b.u,{children:[(0,a.jsx)(b.aJ,{children:(0,a.jsx)(T.$F,{asChild:!0,disabled:_||!A.canRemoveMember(),children:(0,a.jsxs)(v.z,{"aria-haspopup":"true",variant:"ghost",children:[R?"Pending":Z[r.role]," ",(0,a.jsx)(g.Z,{name:"keyboard_arrow_down",size:"small",className:"opacity-50"})]})})}),(0,a.jsx)(b._v,{className:"max-w-[30ch]",children:R?"This user has been invited to join as ".concat(Z[r.role]):J[r.role]})]}),(0,a.jsx)(T.AW,{align:"end",children:R?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(V.w,{label:"Pending",isSelected:!0,onClick:()=>{},disabled:!0}),(0,a.jsx)(V.w,{label:"Remove",destructive:!0,onClick:X})]}):(0,a.jsxs)(a.Fragment,{children:[A.canSetInviteRole()&&(0,a.jsx)(V.w,{label:"Admin",isSelected:(0,k.GJ)(r.role),onClick:()=>$("admin"),disabled:!P,tooltip:J.admin}),(0,a.jsx)(V.w,{label:"Editor",isSelected:(0,k.hz)(r.role),onClick:()=>$("member"),disabled:!P,tooltip:J.member}),(0,a.jsx)(V.w,{label:"Viewer",isSelected:(0,k.Ct)(r.role),onClick:()=>$("viewer"),disabled:!P,tooltip:M?J.viewer:"Viewer role requires a Pro plan. Click to upgrade.",rightElement:(0,a.jsx)(z.y,{workspace:i,requiredPlanId:"pro"})}),(0,a.jsx)(V.w,{label:_?"Leave":"Remove",destructive:!0,onClick:X})]})})]})]});return(0,a.jsx)(O.Q,{id:r.user_id,username:r.username,displayName:null!==(t=r.display_name)&&void 0!==t?t:r.email,photoURL:r.photo_url,avatarClassName:"h-8 w-8",actionComponent:es,isCurrentUser:_,email:r.email,isInvited:R})},B=[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Pending",value:"pending"}],Y=e=>{let{currentPage:s,totalPages:t,onPreviousPage:r,onNextPage:n,onFirstPage:i,onLastPage:l,totalCount:o,pageSize:c}=e;if(t<=1)return null;let d=Math.min(s*c,o);return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",(s-1)*c+1,"-",d," of ",o," members"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(v.z,{variant:"outline",size:"sm",onClick:i,disabled:1===s,children:(0,a.jsx)(g.Z,{name:"first_page",className:"h-4 w-4"})}),(0,a.jsx)(v.z,{variant:"outline",size:"sm",onClick:r,disabled:1===s,children:(0,a.jsx)(g.Z,{name:"chevron_left",className:"h-4 w-4"})}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[s," of ",t]}),(0,a.jsx)(v.z,{variant:"outline",size:"sm",onClick:n,disabled:s===t,children:(0,a.jsx)(g.Z,{name:"chevron_right",className:"h-4 w-4"})}),(0,a.jsx)(v.z,{variant:"outline",size:"sm",onClick:l,disabled:s===t,children:(0,a.jsx)(g.Z,{name:"last_page",className:"h-4 w-4"})})]})]})},H=e=>{var s;let{memberships:t,workspace:r,searchParams:n,search:i,total:l,isLoading:o,PAGE_SIZE:c}=e,{authUser:k}=(0,h.Eu)(),[I,D]=(0,d.useState)(n.status||"all"),[R,M]=(0,d.useState)(n.query||""),S=(0,w.N)(R,250);(0,d.useEffect)(()=>{let e=S;e.length<3&&(e=""),i({query:e,offset:0,status:I})},[S,I,i]);let O=(0,p.useCurrentWorkspaceStore)(e=>e.membership),P=null==O?void 0:O.role,L=C({workspace:r,authUserId:null==k?void 0:k.uid,role:P}),T="free"===(0,y.Ll)(r.plan),V=(0,f.z)(u.g),{inviteWorkspaceMember:z,isInvitingMember:W}=(0,E.B)({workspaceId:r.id}),{exportMembers:U,isExporting:q}=function(e){let[s,t]=(0,d.useState)(!1);return{exportMembers:async()=>{try{t(!0);let s=await N.g.getValidToken(),a={};s&&(a.Authorization="Bearer ".concat(s));let r=(0,_.t)(),n=await fetch("".concat(r,"/workspaces/").concat(e,"/memberships/export"),{method:"GET",headers:a,credentials:"include"});if(!n.ok)throw Error("Export failed: ".concat(n.statusText));let i=n.headers.get("Content-Disposition"),l=new Date,o=e=>String(e).padStart(2,"0"),c="workspace_members_".concat(l.getUTCFullYear(),"-").concat(o(l.getUTCMonth()+1),"-").concat(o(l.getUTCDate()),"_").concat(o(l.getUTCHours()),"-").concat(o(l.getUTCMinutes()),".csv");if(i){let e=i.match(/filename="([^"]+)"/i);(null==e?void 0:e[1])&&(c=e[1])}let d=await n.blob(),m=URL.createObjectURL(d),u=document.createElement("a");return u.href=m,u.download=c,u.style.visibility="hidden",document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(m),{success:!0}}catch(e){return console.error("Failed to export members:",e),{success:!1,error:e}}finally{t(!1)}},isExporting:s}}(r.id),F=async()=>{let e=m.Am.loading("Preparing CSV export..."),s=await U();(null==s?void 0:s.success)?m.Am.success("Export ready. Download should begin shortly.",{id:e,duration:4e3}):m.Am.error("Export failed. Please try again.",{id:e})},K=async e=>{let{emails:s,role:t}=e;if(0===s.length)return{success:!1};if("viewer"===t&&T)return V({childProps:{}}),{success:!1};let a=0,r=T?"member":t;for(let e of s)await z({email:e,role:r}),a++;return{success:a>0}},G=e=>{M(e)},Z=e=>{D(e)};return(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Invite new members"}),(0,a.jsx)(x.s,{onInvite:e=>{let{emails:s,role:t}=e;return K({emails:s,role:t})},isInviting:W,roleOptions:[{value:"admin",label:"Admin"},{value:"member",label:"Editor"},{value:"viewer",label:"Viewer"}],canSelectRoles:L.canSetInviteRole(),defaultRole:"member",placeholder:"Add emails",completelyDisabled:!L.canEmailInvite()})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Members"}),(R||"all"!==I)&&(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[l," members found"]})]}),L.canSeeUsage()&&(0,a.jsxs)(b.u,{children:[(0,a.jsx)(b.aJ,{asChild:!0,children:(0,a.jsx)(v.z,{variant:"outline",size:"sm",onClick:F,disabled:q,"aria-label":"Export members CSV",children:q?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.Z,{name:"refresh",className:"mr-1 h-4 w-4 animate-spin"}),"Exporting..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.Z,{name:"download",className:"mr-1 h-4 w-4"}),"Export"]})})}),(0,a.jsx)(b._v,{align:"end",children:"Exports all workspace members as a CSV, including monthly usage and credit limits."})]})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(g.Z,{name:"search",className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)(j.I,{type:"text",placeholder:"Search members by name or email...",value:R,onChange:e=>G(e.target.value),className:"pl-9"}),R&&(0,a.jsx)(v.z,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 h-6 w-6 -translate-y-1/2 p-0",onClick:()=>G(""),children:(0,a.jsx)(g.Z,{name:"close",className:"h-3 w-3"})})]}),(0,a.jsx)("div",{className:"flex gap-2",children:B.map(e=>{let{label:s,value:t}=e;return(0,a.jsx)(v.z,{variant:I===t?"default":"outline",size:"sm",onClick:()=>Z(t),className:"text-xs",children:s},t)})}),(0,a.jsx)("div",{className:"flex flex-col gap-2 border-b pb-3",children:o?(0,a.jsx)("div",{className:"flex items-center justify-center py-8 text-sm text-muted-foreground",children:"Loading members..."}):t.length>0?t.map(e=>e?(0,a.jsx)(Q,{currentMembership:e,workspaceId:r.id,workspace:r},"".concat(e.email,"-").concat(e.user_id)):null):(0,a.jsx)("div",{className:"flex items-center justify-center py-8 text-sm text-muted-foreground",children:R||"all"!==I?"No members found".concat(R?' for "'.concat(R,'"'):""):"No members found"})}),(0,a.jsx)(Y,{currentPage:Math.floor((null!==(s=n.offset)&&void 0!==s?s:0)/c)+1,totalPages:Math.ceil(l/c),onPreviousPage:()=>{var e;return i({offset:Math.max(0,(null!==(e=n.offset)&&void 0!==e?e:0)-c)})},onNextPage:()=>{var e;return i({offset:(null!==(e=n.offset)&&void 0!==e?e:0)+c})},onFirstPage:()=>i({offset:0}),onLastPage:()=>i({offset:Math.floor((l-1)/c)*c}),totalCount:l,pageSize:c})]}),L.canSeeUsage()&&t&&(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("h4",{children:"Usage"}),(0,a.jsx)(A,{workspace:r,memberships:t})]})]})};var $=t(21354);function X(e){let{data:s,isLoading:t}=c(e),{memberCount:a}=(0,$.qI)({workspaceId:e,status:"all"});return{maxSeats:s,isLoadingMaxSeats:t,memberCount:a}}function ee(e,s,t,n){return(0,a.jsxs)(a.Fragment,{children:["Inviting people to ",(0,a.jsx)("strong",{children:e.name||"the workspace"})," ","gives access to workspace shared projects and credits."," ",null!=t?(0,a.jsxs)(a.Fragment,{children:["You're using ",s,"/",n?"...":t," ","seats. Need more?"," ",(0,a.jsx)(r.default,{className:"underline",target:"_blank",href:"https://enterpriseform.lovable.app/",children:"Contact us"}),"."]}):(0,a.jsxs)(a.Fragment,{children:["You have ",s," people in this workspace."]})]})}let es=20,et=e=>{let{workspace:s}=e,t=(0,n.MD)(),{members:r,total:i,isLoading:l,search:o,searchParams:c}=(0,$.qB)({workspaceId:s.id});return t?(0,a.jsx)(er,{workspace:s,members:r,total:i,isLoading:l,search:o,searchParams:c}):(0,a.jsx)(ea,{workspace:s,members:r,total:i,isLoading:l,search:o,searchParams:c})};function ea(e){let{workspace:s,members:t,total:r,isLoading:n,search:l,searchParams:o}=e,{maxSeats:c,isLoadingMaxSeats:d,memberCount:m}=X(s.id),u=ee(s,m,c,d);return(0,a.jsx)(i.tM,{title:"People",value:"people",description:u,docsLink:"https://docs.lovable.dev/user-guides/teams",children:(0,a.jsx)(K.x,{searchParams:o,children:(0,a.jsx)(H,{memberships:t,workspace:s,searchParams:o,search:l,total:r,isLoading:n,PAGE_SIZE:es})})})}function er(e){let{workspace:s,members:t,total:r,isLoading:n,search:l,searchParams:o}=e,{maxSeats:c,isLoadingMaxSeats:d,memberCount:m}=X(s.id),u=ee(s,m,c,d);return(0,a.jsx)(i.tM,{title:"People",value:"people",description:u,children:(0,a.jsx)(H,{memberships:t,workspace:s,searchParams:o,search:l,total:r,isLoading:n,PAGE_SIZE:es})})}},7653:function(e,s,t){t.d(s,{b:function(){return i},x:function(){return l}});var a=t(52155),r=t(98244);let n=(0,r.createContext)(null),i=()=>(0,r.useContext)(n),l=e=>{let{children:s,searchParams:t}=e;return(0,a.jsx)(n.Provider,{value:t,children:s})}},16125:function(e,s,t){t.d(s,{B:function(){return d}});var a=t(29605),r=t(56166),n=t(13273),i=t(94671),l=t(42690),o=t(7653),c=t(67005);function d(e){let{workspaceId:s}=e,t=(0,a.NL)(),d=(0,o.b)(),{mutateAsync:m,isPending:u}=(0,r.D)({mutationFn:async e=>{let{email:t,role:a="member"}=e;return(0,i.SJ)().post("/workspaces/".concat(s,"/memberships"),{email:t,role:a})},onSuccess:async e=>{if(e){let r=l.t.workspaceMemberships({workspaceId:s}),n=t.getQueryData(r.queryKey);if(n&&!n.members.some(s=>s.user_id===e.user_id)){var a;t.setQueryData(r.queryKey,{...n,members:[...n.members,e],total:n.total+1,limit:n.limit,offset:null!==(a=n.offset)&&void 0!==a?a:0,has_more:n.has_more})}if(d&&(!d.query||""===d.query.trim())){let a=l.t.searchWorkspaceMemberships({workspaceId:s,params:d}),r=t.getQueryData(a.queryKey);r&&!r.members.some(s=>s.user_id===e.user_id)&&t.setQueryData(a.queryKey,{...r,members:[...r.members,e],total:r.total+1,limit:r.limit,offset:r.offset,has_more:r.has_more})}}(0,c.T6)(t,s,d)},onError:e=>{(0,n.Eo)(e)}});return{inviteWorkspaceMember:m,isInvitingMember:u}}},21354:function(e,s,t){t.d(s,{SD:function(){return o},qB:function(){return l},qI:function(){return c}});var a=t(68820),r=t(98244),n=t(42690),i=t(31353);function l(e){let{workspaceId:s}=e,[t,l]=(0,r.useState)({query:"",status:"all",limit:i.I,offset:0}),{data:o,isLoading:c,error:d}=(0,a.a)(n.t.searchWorkspaceMemberships({workspaceId:s,params:t})),m=(0,r.useCallback)(e=>{l(s=>{let t={...s,...e};return(void 0!==e.query||void 0!==e.status)&&(t.offset=0),t})},[]),u=(0,r.useCallback)(()=>{(null==o?void 0:o.has_more)&&l(e=>({...e,offset:(e.offset||0)+i.I}))},[null==o?void 0:o.has_more]);return{members:(null==o?void 0:o.members)||[],total:(null==o?void 0:o.total)||0,hasMore:(null==o?void 0:o.has_more)||!1,isLoading:c,error:d,search:m,loadMore:u,searchParams:t}}function o(e){let{workspaceId:s}=e,{data:t,isLoading:r,error:i}=(0,a.a)(n.t.searchWorkspaceMemberships({workspaceId:s,params:{query:"",status:"active",role:"owner",limit:1}}));return{owner:(null==t?void 0:t.members[0])||null,isLoading:r,error:i}}function c(e){let{workspaceId:s,status:t="active",enabled:r=!0}=e,{data:i}=(0,a.a)({...n.t.searchWorkspaceMemberships({workspaceId:s,params:{query:"",status:t,limit:1}}),enabled:r&&!!s});return{memberCount:(null==i?void 0:i.total)||0}}},77721:function(e,s,t){t.d(s,{Ct:function(){return l},GJ:function(){return n},bO:function(){return d},hz:function(){return i}});var a=t(44647);let r=e=>"owner"===e,n=e=>"admin"===e,i=e=>"member"===e,l=e=>"viewer"===e,o=e=>(0,a.Ll)(e.plan),c={ADD_VIEWER:"claim.workspace.add_viewer",ADD_EDITOR:"claim.workspace.add_editor",ADD_ADMIN:"claim.workspace.add_admin",SEE_USAGE:"claim.workspace.see_usage",MANAGE_PLAN:"claim.workspace.manage_plan",REMOVE_VIEWER:"claim.workspace.remove_viewer",REMOVE_EDITOR:"claim.workspace.remove_editor",REMOVE_ADMIN:"claim.workspace.remove_admin",PROJECT_MAGIC_LINK:"claim.project.magic_link"};class d{canEmailInvite(){return this.claims.has(c.ADD_EDITOR)}canSetInviteRole(){return this.claims.has(c.ADD_ADMIN)}canEditRole(){let{targetRole:e}=this.context;return n(e)?this.claims.has(c.REMOVE_ADMIN):l(e)?this.claims.has(c.REMOVE_VIEWER):this.claims.has(c.REMOVE_EDITOR)&&!r(e)}canSeeUsage(){return this.claims.has(c.SEE_USAGE)}canCreateSecretLink(){return this.claims.has(c.PROJECT_MAGIC_LINK)}canManagePlan(){return this.claims.has(c.MANAGE_PLAN)}canRemoveMember(){let{targetRole:e}=this.context;return n(e)?this.claims.has(c.REMOVE_ADMIN):l(e)?this.claims.has(c.REMOVE_VIEWER):this.claims.has(c.REMOVE_EDITOR)&&!r(e)}constructor(e){this.context=e,this.claims=new Set;let{role:s,workspace:t}=e,a=o(t);"free"===a?r(s)?(this.claims.add(c.ADD_EDITOR),this.claims.add(c.ADD_VIEWER),this.claims.add(c.SEE_USAGE),this.claims.add(c.MANAGE_PLAN),this.claims.add(c.REMOVE_EDITOR),this.claims.add(c.REMOVE_VIEWER),this.claims.add(c.PROJECT_MAGIC_LINK)):i(s)&&(this.claims.add(c.ADD_VIEWER),this.claims.add(c.REMOVE_VIEWER)):(r(s)?(this.claims.add(c.ADD_EDITOR),this.claims.add(c.ADD_ADMIN),this.claims.add(c.ADD_VIEWER),this.claims.add(c.SEE_USAGE),this.claims.add(c.MANAGE_PLAN),this.claims.add(c.REMOVE_EDITOR),this.claims.add(c.REMOVE_ADMIN),this.claims.add(c.REMOVE_VIEWER),this.claims.add(c.PROJECT_MAGIC_LINK)):n(s)?(this.claims.add(c.ADD_EDITOR),this.claims.add(c.ADD_VIEWER),this.claims.add(c.SEE_USAGE),this.claims.add(c.REMOVE_EDITOR),this.claims.add(c.REMOVE_VIEWER),this.claims.add(c.PROJECT_MAGIC_LINK)):i(s)&&(t.editor_can_invite&&this.claims.add(c.ADD_VIEWER),this.claims.add(c.ADD_VIEWER),this.claims.add(c.REMOVE_VIEWER)),"pro"!==a&&"ktlo"!==a||r(s)||this.claims.delete(c.PROJECT_MAGIC_LINK))}}},67005:function(e,s,t){t.d(s,{T6:function(){return i},dG:function(){return r},yt:function(){return n}});var a=t(42690);async function r(e,s){let t=a.t.workspaceMemberships({workspaceId:s});await e.cancelQueries({queryKey:t.queryKey})}function n(e,s,t,r,n,i){var l,o;let c=a.t.workspaceMemberships({workspaceId:s}),d=e.getQueryData(c.queryKey);if(d&&e.setQueryData(c.queryKey,{...d,members:r(d.members),total:i?i(d.total):d.total,limit:d.limit,offset:null!==(l=d.offset)&&void 0!==l?l:0,has_more:d.has_more}),t){let l=a.t.searchWorkspaceMemberships({workspaceId:s,params:t}),c=e.getQueryData(l.queryKey);if(c){let s=n?n(c.members):r(c.members);e.setQueryData(l.queryKey,{...c,members:s,total:i?i(c.total):c.total,limit:c.limit,offset:null!==(o=c.offset)&&void 0!==o?o:0,has_more:c.has_more})}}}function i(e,s,t){e.invalidateQueries({queryKey:a.t.workspaceMemberships({workspaceId:s}).queryKey}),t&&e.invalidateQueries({queryKey:a.t.searchWorkspaceMemberships({workspaceId:s,params:t}).queryKey})}},25483:function(e,s,t){t.d(s,{B:function(){return u}});var a=t(52155),r=t(26052),n=t(4578),i=t(45694),l=t(76332),o=t(99792);let c=/[,;\n\t]+/g,d=/\s+/g,m=e=>e.replace(c," ").replace(d," ").trim().split(" ").map(e=>e.trim()).filter(e=>""!==e),u=e=>{let{tags:s,setTags:t,inputValue:c,setInputValue:d,placeholder:u="Type and press Enter...",className:h="",...p}=e,x=e=>{s.includes(e)||""===e.trim()||t([...s,e]),d("")},f=e=>{t(s.filter((s,t)=>t!==e))};return(0,a.jsxs)("div",{className:(0,n.cn)("flex min-h-9 w-full min-w-0 flex-wrap items-center gap-1.5 overflow-hidden rounded-md border border-input bg-transparent p-2 py-1.5 text-sm shadow-sm transition-colors focus-within:ring-1 focus-within:ring-ring",h),children:[s.map((e,s)=>{let t=(0,i.Jh)(e);return(0,a.jsx)(l.b,{showTooltip:!t,tooltipContent:"This is not a valid email.",instant:!0,className:"min-w-0",children:(0,a.jsxs)(r.C,{variant:"secondary",className:"flex min-w-0 cursor-default items-center gap-1 rounded-sm px-1 py-0 text-xs font-medium",children:[!t&&(0,a.jsx)(o.Z,{name:"warning_fill",className:"text-destructive-primary",size:"small"}),(0,a.jsx)("span",{className:"min-w-0 max-w-[160px] overflow-hidden truncate md:whitespace-nowrap",children:e}),(0,a.jsx)("button",{type:"button",className:"flex-shrink-0 rounded-sm duration-100 ease-out hover:bg-muted-hover",onClick:()=>f(s),children:(0,a.jsx)(o.Z,{name:"close_small"})})]})},s)}),(0,a.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"!==e.key&&","!==e.key&&" "!==e.key||e.metaKey||""===c.trim()?"Backspace"===e.key&&""===c&&s.length>0&&f(s.length-1):(e.preventDefault(),x(c.trim()))},onPaste:e=>{e.preventDefault();let a=m(e.clipboardData.getData("text")),r=new Set(s),n=[...s];a.forEach(e=>{let s=""!==e.trim();!r.has(e)&&s&&(n.push(e),r.add(e))}),t(n)},placeholder:u,className:"min-w-[80px] flex-1 bg-transparent text-sm outline-none placeholder:text-muted-foreground",...p})]})};u.displayName="TagsInput"},26195:function(e,s,t){t.d(s,{y:function(){return o}});var a=t(52155);t(98244);var r=t(4578),n=t(44647),i=t(99792),l=t(84183);let o=e=>{let{workspace:s,requiredPlanId:t,className:o,...c}=e,d=(0,n.Cc)(t),m=(0,n.Ll)(s.plan),u=(0,n.Cc)(m),h="legacy"===m,p=(0,n.ZN)(s.plan),x=!(0,n.Aj)(m,t);return(0,a.jsxs)(l.u,{children:[(0,a.jsx)(l.aJ,{asChild:!0,children:(0,a.jsxs)("div",{className:(0,r.cn)("flex h-5 cursor-pointer items-center gap-1 rounded-sm bg-brand-twilight px-2 py-px text-xs font-medium text-brand-twilight-foreground hover:bg-brand-twilight/80",o),...c,children:[(0,a.jsx)(i.Z,{name:"lovable_icon",size:"xsmall"}),(0,a.jsx)("p",{className:(0,r.cn)("flex",{hidden:!x}),children:d})]})}),(0,a.jsx)(l._v,{children:x?(0,a.jsxs)("p",{children:["Upgrade to ",d," to access this feature."]}):(0,a.jsx)("p",{children:h?"Included in ".concat(p):"Included in ".concat(u)})})]})}},7575:function(e,s,t){t.d(s,{w:function(){return c}});var a=t(52155),r=t(98244),n=t(53259),i=t(99792),l=t(4578),o=t(84183);let c=e=>{let{label:s,isSelected:t,onClick:c,disabled:d,className:m,destructive:u,tooltip:h,rightElement:p}=e,[x,f]=(0,r.useState)(!1);return(0,a.jsxs)(o.u,{open:void 0!==h&&x,onOpenChange:f,children:[(0,a.jsx)(o.aJ,{asChild:!0,children:(0,a.jsxs)(n.Xi,{onClick:c,disabled:d,className:(0,l.cn)("flex items-center justify-between",{"bg-muted":t,"cursor-default":d,"text-destructive-primary focus:bg-destructive focus:text-destructive-foreground":u},m),children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[s,p]}),t&&(0,a.jsx)(i.Z,{name:"check",size:"small"})]})}),(0,a.jsx)(o._v,{side:"right",className:"max-w-[30ch]",children:h})]})}},47149:function(e,s,t){t.d(s,{N:function(){return r}});var a=t(98244);function r(e,s){let[t,r]=(0,a.useState)(e);return(0,a.useEffect)(()=>{let t=setTimeout(()=>{r(e)},s);return()=>{clearTimeout(t)}},[e,s]),t}},33864:function(e,s,t){function a(e){return Number.isInteger(e)?e.toString():e.toFixed(2)}function r(e,s){return"".concat(a(e),"/").concat(a(s))}t.d(s,{H:function(){return a},u:function(){return r}})},45694:function(e,s,t){t.d(s,{Jh:function(){return i},UM:function(){return o},hO:function(){return l}});var a=t(25243);let r=a.Z_().min(1,"Email is required").email("Please enter a valid email address"),n=a.IX(r).max(3,"You can invite up to 3 team members").refine(e=>new Set(e.map(e=>e.toLowerCase())).size===e.length,{message:"Duplicate email addresses are not allowed"});function i(e){return r.safeParse(e).success}function l(e){let s=e.filter(e=>""!==e.trim());return n.safeParse(s)}function o(e,s){let t=e.filter(e=>""!==e.trim()),a=n.safeParse(t),i=[null,null,null];for(let s=0;s<3;s++){let t=e[s];if(t&&t.trim()){let e=r.safeParse(t);if(!e.success){var l;i[s]=(null===(l=e.error.errors[0])||void 0===l?void 0:l.message)||"Invalid email address"}}}let o=[];return a.success||(o=a.error.errors.filter(e=>0===e.path.length).map(e=>e.message)),s&&t.some(e=>e.trim().toLowerCase()===s.trim().toLowerCase())&&o.push("You cannot invite yourself"),{globalErrors:o,fieldErrors:i}}}}]);