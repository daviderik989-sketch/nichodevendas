try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="cdeefe49-0546-48b2-965e-11987c12f88f",e._sentryDebugIdIdentifier="sentry-dbid-cdeefe49-0546-48b2-965e-11987c12f88f")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4536],{66520:function(e,t,s){s.d(t,{v:function(){return i}});var a=s(52155),n=s(4578),r=s(44647);let i=e=>{let{plan:t,className:s}=e,i=(0,r.ZN)(t);return(0,a.jsx)("span",{className:(0,n.cn)("rounded-full px-2 py-px text-[10px] font-medium uppercase transition-colors duration-150 ease-in-out","free"===t?"bg-muted text-muted-foreground":"bg-brand-twilight-primary text-brand-twilight-primary-foreground",s),children:i})}},9408:function(e,t,s){s.d(t,{E:function(){return f}});var a=s(52155),n=s(95713),r=s(98244),i=s(56852),l=s(99526),o=s(17195),c=s(4578),d=s(32766),u=s(59561),m=s(99792),x=s(92104),h=e=>{let{type:t,message:s,persistDismiss:n=!1,storageKey:h,bgColor:p,href:f,onClick:g,className:j,darkCloseIcon:v=!1}=e,b=(0,l.usePathname)(),y=(0,r.useRef)(null),[N,w]=(0,d.B)(h||"default-banner-key",{defaultValue:!0}),[_,k]=(0,r.useState)(!1),[C,S]=(0,r.useState)(!1);(0,r.useEffect)(()=>{S(!0),k(!0)},[]);let E=(null==b?void 0:b.startsWith("/projects/"))&&["ph-launch-banner","rebrand-banner"].includes(h||""),I=!E&&(n?N:_);if(E)return null;if(n&&!h)return console.error("storageKey is required when persistDismiss is true"),null;if(!I||x.env.TEST_E2E)return null;let D=(0,a.jsxs)("div",{ref:y,className:(0,c.cn)("z-[1050] hidden w-full items-center justify-between px-2 py-2 text-sm text-white transition-opacity duration-300 md:px-4 md:text-base",p||("error"===t?"bg-destructive-primary":"bg-background"),j,C&&"flex"),children:[(0,a.jsx)("div",{className:"flex flex-grow items-center justify-center space-x-4 pr-6 md:text-center",children:s}),(0,a.jsx)(u.z,{variant:"ghost",size:"icon",className:(0,c.cn)("hover:bg-transparent md:absolute md:right-2",v?"text-primary-foreground hover:text-primary-foreground":"text-primary"),onClick:e=>{e.stopPropagation(),n?w(!1):k(!1),o.ZP.capture("banner_dismissed",{banner_type:t,message:s,persisted:n})},children:(0,a.jsx)(m.Z,{name:"close_small"})})]});return f?(0,a.jsx)(i.default,{href:f,target:"_blank",rel:"noopener noreferrer",onClick:g,className:"w-full",children:D}):D},p=s(92361);let f=e=>{let{className:t}=e,[s,i]=(0,r.useState)({showStatusBanner:!1,statusBannerContent:"",statusBannerLink:""});return((0,r.useEffect)(()=>{(async()=>{try{let e=(0,n.JU)(p.db,"system","info"),t=await (0,n.QT)(e);t.exists()&&i(t.data())}catch(e){console.error("Failed to fetch system info:",e)}})()},[]),s.showStatusBanner&&s.statusBannerContent)?(0,a.jsx)(h,{message:s.statusBannerContent,type:"error",className:t,href:s.statusBannerLink}):null}},86818:function(e,t,s){s.d(t,{UL:function(){return x},hw:function(){return h},t6:function(){return f},v7:function(){return p}});var a,n=s(52155),r=s(48535),i=s(94127),l=s(26696),o=s(4578),c=s(10178),d=s(39230);(a||(a={})).AI_FIX="AI Fix";let{AI_FIX:u}=a;i.N.NO_CODE_CHANGE,i.N.CODE_DIFF,i.N.FILE_EDITED_WITHOUT_PERMISSION,i.N.EXCLUDED_FILE_EDITED,i.N.DEPENDENCY_INSTALL,i.N.IMMEDIATE_RUNTIME,i.N.RUNTIME,i.N.BUILD,i.N.HTTP_CLIENT_ERROR,i.N.HTTP_SERVER_ERROR,i.N.SUPABASE_EDGE_FUNCTION_ERROR,i.N.CORS_ERROR,i.N.DEPLOY_SUPABASE_FUNCTIONS,i.N.SUPABASE_SQL_ERROR,i.N.SEARCH_REPLACE_FAILED,i.N.SEARCH_REPLACE_MISSING_FILE,i.N.CHANGED_MISSING_FILE,i.N.RENAME_FAILED,i.N.DELETION_FAILED;let m=e=>{let t=(0,r.H$)(e),s=t.length>1?e=>"# Error number ".concat(e+1,":\n#################\n\n"):()=>"",a=t.map((e,t)=>"".concat(s(t)).concat(e.error_message,"\n").concat(e.meta_data?"\n"+JSON.stringify(e.meta_data,null,2):"")).join("\n\n").replace(/\x1B\[[0-9;]*[JKmsu]/g,"");return a.length>2e4?a.slice(0,2e4)+"... (truncated)":a},x=e=>{let{errors:t,roundedTop:s=!0}=e;return(0,n.jsx)("div",{className:s?"mt-4":"",children:(0,n.jsx)("pre",{className:(0,o.cn)("w-full rounded-xl border-[3px] border-warning bg-background p-3 text-sm text-foreground",s?"mt-2 rounded-t-md":""),children:(0,n.jsx)("code",{className:"block w-full overflow-x-auto overflow-y-auto whitespace-pre-wrap",children:m(t)})})})},h=e=>{let{projectId:t,errors:s}=e,{mutate:a,isPending:n}=(0,c.mo)({projectId:t});return{onClick:()=>{a({body:{id:(0,d.Fd)(),message:"For the code present, I get the error below.\n\nPlease think step-by-step in order to resolve it.\n```\n".concat(m(s),"\n```\n"),mode:l.S.INSTANT,contains_error:!0,error_ids:s.map(e=>e.id)},projectId:t})},isPending:n}},p={[i.N.BUILD]:"Build unsuccessful",[i.N.CODE_DIFF]:"Changes couldn't be applied",[i.N.DEPLOY_SUPABASE_FUNCTIONS]:"Couldn't deploy Supabase functions",[i.N.DEPENDENCY_INSTALL]:"Couldn't install dependency",[i.N.FILE_EDITED_WITHOUT_PERMISSION]:"Tried editing file without permission",[i.N.EXCLUDED_FILE_EDITED]:"Unwanted changes",[i.N.IMMEDIATE_RUNTIME]:"Oops, it looks like our AI had a bit of a hiccup and broke the app",[i.N.NO_CODE_CHANGE]:"Changes already applied",[i.N.RUNTIME]:"The app encountered an error",[i.N.HTTP_CLIENT_ERROR]:"The app encountered an error",[i.N.HTTP_SERVER_ERROR]:"The app encountered an error",[i.N.SUPABASE_EDGE_FUNCTION_ERROR]:"The app encountered an error",[i.N.CORS_ERROR]:"The app encountered an error",[i.N.SUPABASE_SQL_ERROR]:"An error occurred while applying the migration",[i.N.SEARCH_REPLACE_FAILED]:"Failed search-replace",[i.N.SEARCH_REPLACE_MISSING_FILE]:"Search-replace on missing file",[i.N.CHANGED_MISSING_FILE]:"Tried deleting or renaming non-existent file",[i.N.RENAME_FAILED]:"Failed to rename file",[i.N.DELETION_FAILED]:"Failed to delete file"},f={[i.N.BUILD]:!0,[i.N.CODE_DIFF]:!0,[i.N.SUPABASE_EDGE_FUNCTION_ERROR]:!0,[i.N.DEPENDENCY_INSTALL]:!0,[i.N.DEPLOY_SUPABASE_FUNCTIONS]:!0,[i.N.HTTP_CLIENT_ERROR]:!0,[i.N.HTTP_SERVER_ERROR]:!0,[i.N.CORS_ERROR]:!0,[i.N.FILE_EDITED_WITHOUT_PERMISSION]:!0,[i.N.EXCLUDED_FILE_EDITED]:!0,[i.N.IMMEDIATE_RUNTIME]:!0,[i.N.NO_CODE_CHANGE]:!0,[i.N.RUNTIME]:!0,[i.N.SUPABASE_SQL_ERROR]:!0,[i.N.SEARCH_REPLACE_FAILED]:!0,[i.N.SEARCH_REPLACE_MISSING_FILE]:!0,[i.N.CHANGED_MISSING_FILE]:!0,[i.N.RENAME_FAILED]:!0,[i.N.DELETION_FAILED]:!0}},45417:function(e,t,s){s.d(t,{C:function(){return l}});var a=s(54816),n=s(10178),r=s(96659),i=s(84864);let l=e=>{let{projectId:t,setIsOpen:s}=e,l=(0,r.C)(),o=(0,n.mo)({projectId:t,onSuccess:()=>{null==s||s(!1)}}),c=o.isPending,d=l||c;return{isSendingSecurityReview:c,isSecurityReviewDisabled:d,securityReviewDisabledReason:l?"Wait for Lovable to finish working":null,handleSecurityReview:()=>{if(!t){i.logging.error("project id is missing, can't start security review");return}d||o.mutate({body:{message:"Please perform a comprehensive security review of my project.",id:(0,a.Z)(),security_review:!0,chat_only:!0}})}}}},28287:function(e,t,s){s.d(t,{U:function(){return J}});var a=s(52155),n=s(68820),r=s(29605),i=s(98244),l=s(73517),o=s(59561),c=s(99792),d=s(35127),u=s(93846),m=s(32282),x=s(6233),h=s(21517),p=s(40796),f=s(18587),g=s(83633),j=s(15935),v=s(30094),b=s(11350),y=s(28968),N=s(62533),w=s(62196),_=s(71272);let k={totalVisits:{title:"Visitors",valueType:"number",timeSeriesKey:"visitors",description:"Total number of visitors to your app."},totalPageviews:{title:"Pageviews",valueType:"number",timeSeriesKey:"pageviews",description:"Total number of pages viewed by all visitors."},pageviewsPerVisit:{title:"Views Per Visit",valueType:"number",timeSeriesKey:"pageviewsPerVisit",description:"How many pages the average visitor viewed."},sessionDuration:{title:"Visit Duration",valueType:"time",timeSeriesKey:"sessionDuration",description:"How long the average visit to your app lasted."},bounceRate:{title:"Bounce Rate",valueType:"percentage",timeSeriesKey:"bounceRate",description:"Percentage of visitors who left after viewing only one page."}};var C=s(88795),S=s(12063),E=s(95257),I=s(84183);let D=()=>{let[e,t]=(0,E._)("temporary-analytics-banner",!0);return e?(0,a.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,a.jsx)("span",{className:"font-medium",children:"Note: "}),"We started tracking analytics between the 4th and 7th of July. Data before this period is not available."]}),(0,a.jsxs)(I.u,{instant:!0,children:[(0,a.jsx)(I.aJ,{children:(0,a.jsx)(o.z,{variant:"ghost",size:"icon-sm",onClick:()=>t(!1),children:(0,a.jsx)(c.Z,{name:"close",size:"small"})})}),(0,a.jsx)(I._v,{children:(0,a.jsx)("p",{children:"Don't show this message again"})})]})]}):null},P={value:{label:"Views"}},A=e=>{let{data:t,valueType:s="number",granularity:n,selectedMetric:r,isLoading:l,userTimezone:d,onRefresh:u}=e,m=(0,i.useCallback)((e,t)=>{let s=(0,p.D)(e+(e.includes(" ")?"":"T00:00:00")+"Z"),a=(0,g.zW)(s,(0,S.Sv)(d));return(0,f.WU)(a,t)},[d]);return(0,a.jsxs)("div",{className:"w-full rounded-xl border bg-muted p-4",children:[(0,a.jsx)(D,{}),0!==t.length||l?l?(0,a.jsx)("div",{className:"flex h-[200px] w-full items-center justify-center md:h-[400px]",children:(0,a.jsx)(w.$,{})}):(0,a.jsx)(_.BO,{config:P,className:"h-[200px] w-full max-w-full md:h-[400px]",children:(0,a.jsxs)(j.T,{data:t,margin:{left:"time"===s?0:-15,right:10,top:20,bottom:5},children:[(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"fillGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"5%",stopColor:"var(--chart-1)",stopOpacity:.2}),(0,a.jsx)("stop",{offset:"95%",stopColor:"var(--chart-1)",stopOpacity:.02})]})}),(0,a.jsx)(v.q,{horizontal:!0,vertical:!1,stroke:"hsl(var(--muted-border))"}),(0,a.jsx)(b.K,{dataKey:"date",tickLine:!1,tickMargin:10,interval:"equidistantPreserveStart",tickFormatter:e=>{switch(n){case"hourly":return m(e,"HH:mm");case"daily":return m(e,"d MMM")}}}),(0,a.jsx)(y.B,{dataKey:"value",tickLine:!1,axisLine:!1,tickMargin:10,tickCount:5,tickFormatter:e=>{switch(s){case"number":return(0,C.ZI)(e);case"percentage":return"".concat(e,"%");case"time":return(0,C.mr)(e)}}}),(0,a.jsx)(N.u,{dataKey:"value",strokeWidth:2,stroke:"var(--chart-1)",dot:!1,fill:"url(#fillGradient)",animationDuration:500,animationEasing:"ease-in-out"}),(0,a.jsx)(_.h7,{cursor:!1,content:(0,a.jsx)(_.dg,{formatter:e=>(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,a.jsx)("span",{className:"mr-1 h-3 w-3 rounded-full bg-chart-1"})," ",(0,a.jsx)("span",{className:"font-medium",children:(0,C.Bw)({value:e,valueType:s})})," ",(0,a.jsx)("span",{className:"",children:k[r].title})]}),labelFormatter:e=>{let t="";return t="hourly"===n?m(e,"d MMM, HH:mm"):m(e,"d MMM"),(0,a.jsx)("p",{className:"text-sm",children:t})}})})]})}):(0,a.jsxs)("div",{className:"flex h-[200px] w-full flex-col items-center justify-center gap-2 md:h-[400px]",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No data available"}),(0,a.jsxs)(o.z,{variant:"outline",size:"sm",onClick:u,children:[(0,a.jsx)(c.Z,{name:"refresh",size:"small"}),"Refresh"]})]})]})};var z=s(45145);let L=/./g,T=e=>e.toUpperCase().replace(L,e=>String.fromCodePoint(127397+e.charCodeAt(0))),O=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";try{return new Intl.DisplayNames([t],{type:"region"}).of(e.toUpperCase())||e}catch(t){return e}},F=e=>{let{type:t,label:s}=e;switch(t){case"country":return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"origin-left scale-[1.35] transform",children:T(s)}),(0,a.jsx)("span",{children:O(s)})]});case"device":if("mobile-ios"===s)return"Mobile - iOS";if("mobile-android"===s)return"Mobile - Android";return s.charAt(0).toUpperCase()+s.slice(1);default:return s}},R=e=>{switch(e){case"country":return"The top countries your visitors are from.";case"device":return"The most used devices by your visitors.";case"source":return"The most common sources of traffic to your app.";case"page":return"The most viewed pages in your app."}},M=e=>{let{type:t,value:s,total:a}=e;if("device"===t){let e=s/a*100;return"".concat(e.toFixed(1),"%")}return(0,C.ZI)(s)},Z=e=>{let{data:t,type:s,metric:n,color:r,isLoading:i}=e,l=Math.max(...t.map(e=>e.value)),o=t.sort((e,t)=>t.value-e.value),c=t.reduce((e,t)=>e+t.value,0);return(0,a.jsxs)("div",{className:"flex flex-col gap-4 rounded-xl border border-border bg-muted p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm font-medium",children:[(0,a.jsxs)(I.u,{instant:!0,children:[(0,a.jsx)(I.aJ,{children:(0,a.jsx)("p",{className:"capitalize",children:s})}),(0,a.jsx)(I._v,{children:R(s)})]}),(0,a.jsx)("p",{children:n})]}),!i&&o.length>0&&o.map(e=>{let t=e.value/l*100,i=F({type:s,label:e.label}),o=M({type:s,value:e.value,total:c});return"Unknown"===e.label?null:(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"relative flex-1 px-2 py-1",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 rounded-md bg-accent",style:{width:"".concat(t,"%"),minWidth:"10px",backgroundColor:r}}),(0,a.jsx)("p",{className:"relative z-10 flex items-center gap-3 break-all",children:i})]}),(0,a.jsxs)(I.u,{delayDuration:0,children:[(0,a.jsx)(I.aJ,{children:(0,a.jsx)("p",{children:o})}),(0,a.jsx)(I._v,{children:(0,a.jsxs)("p",{children:[e.value," ",n]})})]})]},e.label)}),!i&&0===o.length&&(0,a.jsx)("p",{className:"text-base text-muted-foreground md:text-sm",children:"No data found for this time period."}),i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsx)(z.O,{className:"h-6 flex-1"}),(0,a.jsx)(z.O,{className:"h-6 w-8"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsx)(z.O,{className:"h-6 w-1/2"}),(0,a.jsx)(z.O,{className:"h-6 w-8"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsx)(z.O,{className:"h-6 w-1/4"}),(0,a.jsx)(z.O,{className:"h-6 w-8"})]})]})]})};var U=s(4578);let W=e=>{let{title:t,value:s,valueType:n="number",changePercentage:r,onClick:i,isSelected:l,isLoading:o,description:d}=e,u=r&&r>0,m=r&&0===r;return(0,a.jsxs)(I.u,{delayDuration:0,children:[(0,a.jsx)(I.aJ,{asChild:!0,children:(0,a.jsxs)("div",{className:(0,U.cn)("group flex cursor-pointer flex-col gap-2 rounded-xl border bg-muted p-4",l&&"border-accent-primary/50"),onClick:i,children:[(0,a.jsx)("p",{className:(0,U.cn)("text-sm font-medium group-hover:text-accent-primary",l&&"text-accent-primary"),children:t}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("p",{className:"h-5 font-medium",children:o?(0,a.jsx)(z.O,{className:"h-full w-8"}):(0,C.Bw)({value:s,valueType:n})}),r&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:(0,U.cn)("flex items-center gap-1",u?"text-success-primary":m?"text-warning-primary":"text-destructive-primary"),children:[(0,a.jsx)(c.Z,{name:u?"trending_up":m?"trending_flat":"trending_down",size:"small"}),(0,a.jsxs)("p",{className:"text-sm",children:[r,"%"]})]})})]})]})}),(0,a.jsxs)(I._v,{className:"max-w-[35ch]",children:[(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:(0,C.Bw)({value:s,valueType:n,roundNumber:!1})})," ",(0,a.jsx)("span",{className:"",children:t.toLowerCase()})]}),d&&(0,a.jsx)("p",{className:"text-xs opacity-80",children:d})]})]})};var G=s(33635);let K=e=>{let{project:t}=e,{data:s,dataUpdatedAt:r,isLoading:i}=(0,n.a)({...u.W.analyticsTrend({projectId:t.id}),enabled:!t.is_analytics_disabled&&t.is_published}),l=(null==s?void 0:s.currentVisitors)&&s.currentVisitors>0,o=l?s.currentVisitors:0;return s||i?i?(0,a.jsx)(z.O,{className:"h-full w-8"}):(0,a.jsxs)(I.u,{instant:!0,children:[(0,a.jsx)(I.aJ,{asChild:!0,children:(0,a.jsxs)("div",{className:"hidden cursor-pointer items-center gap-1 text-foreground md:flex",children:[(0,a.jsx)("div",{className:(0,U.cn)("mr-1 size-2 shrink-0 rounded-full",l?"animate-pulse bg-success-primary":"bg-muted-foreground")}),(0,a.jsx)("p",{className:"text-sm",children:o}),(0,a.jsxs)("p",{className:"whitespace-nowrap text-sm",children:["current ",1===o?"visitor":"visitors"]})]})}),(0,a.jsx)(I._v,{children:(0,a.jsx)(B,{timestamp:r})})]}):null},B=e=>{let{timestamp:t}=e,[s,n]=(0,i.useState)(new Date);return(0,i.useEffect)(()=>{let e=setInterval(()=>{n(new Date)},1e3);return()=>clearInterval(e)},[]),(0,a.jsxs)("p",{children:["Last updated ",(0,G.c)(s,new Date(t))," seconds ago"]})};var q=s(53259),H=s(87294);let V=e=>{let{selectedTimePeriod:t,setSelectedTimePeriod:s,userTimezone:n}=e,r=(0,H.Z)("md"),l=(0,i.useMemo)(()=>Object.entries(S.fV).map(e=>{let[t,s]=e,a=s.getTimePeriod(n);return{key:t,label:s.label,timePeriod:a}}),[n]),d=S.fV[t.preset].label;return(0,a.jsxs)(q.h_,{children:[(0,a.jsx)(q.$F,{asChild:!0,children:(0,a.jsxs)(o.z,{variant:"outline",className:"justify-between text-foreground md:min-w-32 md:px-3",size:r?"sm":"default",children:[d,(0,a.jsx)(c.Z,{name:"chevron_right",size:"small",className:"rotate-90"})]})}),(0,a.jsx)(q.AW,{align:"end",className:"min-w-32",children:l.map(e=>(0,a.jsx)(q.Xi,{onClick:()=>s(e.timePeriod),children:e.label},e.key))})]})},J=e=>{var t,s,l,d,p;let{project:f}=e,[g,j]=(0,i.useState)("totalVisits"),[v,b]=(0,i.useState)(S.HX),{data:y,isLoading:N}=(0,n.a)({...u.W.analytics({projectId:f.id,timePeriod:v}),enabled:!f.is_analytics_disabled&&f.is_published}),w=!!f.url,{updateProject:_}=(0,h.d2)(),C=async()=>{_({is_analytics_disabled:!1});try{await (0,x.G)({projectId:f.id})}catch(e){console.error("Error updating deployment ID",e)}},E=(0,r.NL)(),I=async()=>{await E.invalidateQueries({queryKey:m.iZ.analytics(f.id,v)})};return!w||f.is_analytics_disabled?(0,a.jsx)(Y,{description:"Measure how your published project is performing.",children:(0,a.jsxs)("div",{className:"flex w-full flex-1 flex-col items-center justify-center gap-2 text-muted-foreground",children:[(0,a.jsx)(c.Z,{name:"bid_landscape",size:"large"}),w?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"text-base md:text-sm",children:"Tracking analytics is disabled for this project."}),(0,a.jsx)(o.z,{variant:"outline",size:"sm",className:"mt-4",onClick:C,children:"Enable Analytics"})]}):(0,a.jsx)("p",{className:"text-center text-base md:text-sm",children:"To view analytics, you first need to publish your project."})]})}):(0,a.jsxs)(Y,{description:(0,a.jsxs)("p",{children:["Measure how your"," ",(0,a.jsx)("a",{href:null!==(t=f.url)&&void 0!==t?t:"".concat(f.name,".lovable.app"),target:"_blank",rel:"noopener noreferrer",className:"font-medium hover:underline",children:"published project"})," ","is performing."]}),descriptionAction:(0,a.jsxs)("div",{className:"flex items-center gap-5 md:-mt-1.5",children:[(0,a.jsx)(K,{project:f}),(0,a.jsx)(V,{selectedTimePeriod:v,setSelectedTimePeriod:b})]}),children:[(0,a.jsx)("div",{className:"grid grid-cols-2 gap-6 md:grid-cols-3 lg:grid-cols-5",children:Object.entries(k).map(e=>{var t,s;let[n,r]=e,{title:i,valueType:l,timeSeriesKey:o,description:c}=r,d=null!==(s=null==y?void 0:null===(t=y.timeSeries[o])||void 0===t?void 0:t.total)&&void 0!==s?s:0;return(0,a.jsx)(W,{title:i,value:d,onClick:()=>{j(n)},isSelected:g===n,isLoading:N,valueType:l,description:c},n)})}),(0,a.jsx)(A,{data:(()=>{if(!y)return[];switch(g){case"totalVisits":default:return y.timeSeries.visitors.data;case"totalPageviews":return y.timeSeries.pageviews.data;case"pageviewsPerVisit":return y.timeSeries.pageviewsPerVisit.data;case"sessionDuration":return y.timeSeries.sessionDuration.data;case"bounceRate":return y.timeSeries.bounceRate.data}})(),valueType:k[g].valueType,granularity:v.granularity,selectedMetric:g,isLoading:N,onRefresh:I}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,a.jsx)(Z,{data:null!==(s=null==y?void 0:y.lists.source.data)&&void 0!==s?s:[],type:"source",metric:"Visitors",isLoading:N}),(0,a.jsx)(Z,{data:null!==(l=null==y?void 0:y.lists.page.data)&&void 0!==l?l:[],type:"page",metric:"Visitors",color:"hsl(var(--brand-twilight))",isLoading:N}),(0,a.jsx)(Z,{data:null!==(d=null==y?void 0:y.lists.country.data)&&void 0!==d?d:[],type:"country",metric:"Visitors",color:"hsl(var(--brand-twilight))",isLoading:N}),(0,a.jsx)(Z,{data:null!==(p=null==y?void 0:y.lists.device.data)&&void 0!==p?p:[],type:"device",metric:"Visitors",isLoading:N})]})]})},Y=e=>{let{children:t,description:s,descriptionAction:n}=e;return(0,d.A4)()?(0,a.jsxs)("div",{className:"flex min-h-full flex-col gap-6 p-4",children:[n&&(0,a.jsx)("div",{className:"flex justify-end",children:n}),t]}):(0,a.jsx)(l.tM,{title:"Analytics",value:"analytics",description:s,descriptionAction:n,children:t})}},88795:function(e,t,s){function a(e){let t=Math.floor(e/3600),s=Math.floor(e%3600/60),a="";return t>0&&(a+="".concat(t,"h ")),(s>0||t>0)&&(a+="".concat(s,"m ")),(a+="".concat(Math.floor(e%60),"s")).trim()}s.d(t,{Bw:function(){return r},ZI:function(){return n},mr:function(){return a}});let n=e=>e<1e3?e.toString():e<1e6?"".concat((e/1e3).toFixed(1).replace(/\.0$/,""),"k"):"".concat((e/1e6).toFixed(1).replace(/\.0$/,""),"m"),r=e=>{let{value:t,valueType:s,roundNumber:r=!0}=e;switch(s){case"number":return r?n(t):t.toString();case"percentage":return"".concat(t,"%");case"time":return a(t)}}},12063:function(e,t,s){s.d(t,{HX:function(){return m},Sv:function(){return o},fV:function(){return x}});var a=s(5068),n=s(6002),r=s(29717),i=s(40691),l=s(83633);let o=e=>{if(e)try{return Intl.DateTimeFormat(void 0,{timeZone:e}),e}catch(t){console.error("Invalid timezone: ".concat(e,", falling back to local timezone"))}return Intl.DateTimeFormat().resolvedOptions().timeZone},c=(e,t)=>(0,l.Nm)(e,t).toISOString(),d=(e,t)=>{let s=(0,l.zW)(e,t),n=(0,a.b)(s);return(0,l.Nm)(n,t)},u=(e,t)=>{let s=(0,l.zW)(e,t),a=(0,n.i)(s);return(0,l.Nm)(a,t)},m=e=>{let t=o(e),s=new Date;return{startDate:c(new Date(s.getTime()-6048e5),t),endDate:c(s,t),granularity:"daily",preset:"7d"}},x={today:{label:"Today",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c(d(s,t),t),endDate:c(u(s,t),t),granularity:"hourly",preset:"today"}}},yesterday:{label:"Yesterday",getTimePeriod:e=>{let t=o(e),s=(0,r.k)(new Date,1);return{startDate:c(d(s,t),t),endDate:c(u(s,t),t),granularity:"hourly",preset:"yesterday"}}},"24h":{label:"Last 24 hours",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c((0,r.k)(s,1),t),endDate:c(s,t),granularity:"hourly",preset:"24h"}}},"7d":{label:"Last 7 days",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c((0,r.k)(s,7),t),endDate:c(s,t),granularity:"daily",preset:"7d"}}},"14d":{label:"Last 14 days",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c((0,r.k)(s,14),t),endDate:c(s,t),granularity:"daily",preset:"14d"}}},"30d":{label:"Last 30 days",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c((0,r.k)(s,30),t),endDate:c(s,t),granularity:"daily",preset:"30d"}}},"90d":{label:"Last 90 days",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c((0,r.k)(s,90),t),endDate:c(s,t),granularity:"daily",preset:"90d"}}},month:{label:"This month",getTimePeriod:e=>{let t=o(e),s=new Date;return{startDate:c((0,i.N)(s),t),endDate:c(s,t),granularity:"daily",preset:"month"}}}}},12759:function(e,t,s){var a=s(52155),n=s(41455),r=s(98244),i=s(12703),l=s(59561),o=s(14070),c=s(99792),d=s(13273),u=s(94671),m=s(84864),x=s(21517);let h=e=>{try{return(0,n.xX)(e)}catch(t){return m.logging.error("Failed to get UTF-8 domain",{domain:e,error:t}),e}};t.Z=e=>{let{domain:t,showRemove:s,showIcon:n,refetchDomains:m}=e,[p,f]=(0,r.useState)(!1),[g,j]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),y=(0,x.iZ)(e=>e.project),N=async e=>{b(!0);try{let t=(0,u.SJ)();await t.delete("/projects/".concat(null==y?void 0:y.id,"/domains/").concat(e)),null==m||m(),b(!1),f(!1),i.Am.success("Domain removed",{description:'Your custom domain "'.concat(e,'" was successfully removed from the project.')})}catch(e){b(!1),(0,d.Eo)(e)}},w=()=>{j(!0),null==m||m(),setTimeout(()=>j(!1),1e3)},_=h(t.domain);return(0,a.jsxs)("li",{className:"flex h-auto min-h-8 w-full items-center gap-2 text-sm",children:["active"!==t.status?(0,a.jsxs)("span",{className:"flex min-w-0 flex-grow items-center truncate text-muted-foreground",title:"The domain ".concat(_," is still being configured..."),onClick:()=>w(),children:[n&&(0,a.jsx)(c.Z,{name:"language",className:"mr-2 inline w-4",size:"small"}),(0,a.jsx)("span",{className:"min-w-0 truncate",children:_}),(0,a.jsxs)("span",{className:"relative ml-2 mr-1 inline-flex size-2",children:[(0,a.jsx)("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-primary opacity-75"}),(0,a.jsx)("span",{className:"relative inline-flex size-2 rounded-full bg-primary"})]})]}):(0,a.jsxs)("a",{href:"https://".concat(t.domain),target:"_blank",rel:"noopener noreferrer",className:"flex-grow truncate underline-offset-4 hover:underline",title:t.domain,children:[n&&(0,a.jsx)(c.Z,{name:"language",className:"mr-2 inline w-4",size:"small"}),_]}),s&&(0,a.jsxs)(o.Vq,{open:p,onOpenChange:f,children:[(0,a.jsx)(o.hg,{asChild:!0,children:(0,a.jsx)(l.z,{variant:"ghost",size:"icon-sm",type:"button",className:"ml-auto",children:(0,a.jsx)(c.Z,{name:"delete",size:"small"})})}),(0,a.jsxs)(o.cZ,{children:[(0,a.jsxs)(o.fK,{children:[(0,a.jsxs)(o.$N,{children:["Remove ",_,"?"]}),(0,a.jsx)(o.Be,{children:"This will disconnect the domain from this project. You will need to reconfigure it if you will want to use it with this project in the future."})]}),(0,a.jsxs)(o.cN,{children:[(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>{f(!1)},children:"Cancel"}),(0,a.jsx)(l.z,{variant:"destructive",size:"sm",onClick:()=>N(t.domain),loading:v,children:"Remove"})]})]})]}),"active"!==t.status?(0,a.jsx)("span",{title:"Refresh status",className:"ml-auto cursor-pointer",onClick:()=>w(),children:(0,a.jsx)(c.Z,{name:"refresh",size:"small",className:g?"animate-spin":""})}):(0,a.jsx)("a",{href:"https://".concat(t.domain),target:"_blank",title:"Open in a new tab",rel:"noopener noreferrer",className:"ml-auto text-muted-foreground",children:(0,a.jsx)(c.Z,{name:"arrow_outward",size:"small"})})]})}},44347:function(e,t,s){s.d(t,{E:function(){return q}});var a=s(52155),n=s(17195),r=s(98244),i=s(73517),l=s(59561),o=s(89671),c=s(35127),d=s(4578),u=s(62196),m=s(99792),x=s(68820),h=s(75922),p=s(94671);let f={error:0,warning:1,minor:2,info:3},g=e=>[...e].sort((e,t)=>{let s=f[e.severity]-f[t.severity];return 0!==s?s:e.title.localeCompare(t.title)}),j=["error"],v=e=>e.filter(e=>j.includes(e.severity)),b=e=>v(e).length,y={all:["pageSpeed"],project:e=>[...y.all,e],combination:(e,t,s)=>[...y.project(e),t,s]},N=e=>{var t,s;if(!(null==e?void 0:null===(s=e.results)||void 0===s?void 0:null===(t=s.lighthouseResult)||void 0===t?void 0:t.audits))return[];let a=e.results.lighthouseResult.audits,n=[];return Object.entries(a).forEach(e=>{let[t,s]=e;if("number"!=typeof s.score||s.score>=1)return;let a="info";s.score<.5?a="error":s.score<.7?a="warning":s.score<.9&&(a="minor"),n.push({id:s.id||t,severity:a,title:s.title||t,description:s.description||s.explanation||"No description available",score:s.score,scoreDisplayMode:s.scoreDisplayMode,displayValue:s.displayValue,explanation:s.explanation,errorMessage:s.errorMessage,warnings:s.warnings,details:s.details,savings:s.displayValue})}),n},w=(e,t)=>{var s,a;let n=null==e?void 0:null===(a=e.results)||void 0===a?void 0:null===(s=a.lighthouseResult)||void 0===s?void 0:s.categories;if(!n)return null;let r=n[({performance:"performance",accessibility:"accessibility","best-practices":"best-practices",seo:"seo"})[t]];return r?{label:({performance:"Performance",accessibility:"Accessibility","best-practices":"Best Practices",seo:"SEO"})[t],score:Math.round(100*(r.score||0)),category:t}:null},_=(e,t,s)=>{var a,n,r,i,l;let o=w(e,s);return o?{strategy:t,category:s,score:o,audits:N(e),screenshot:null==e?void 0:null===(l=e.results)||void 0===l?void 0:null===(i=l.lighthouseResult)||void 0===i?void 0:null===(r=i.audits)||void 0===r?void 0:null===(n=r["final-screenshot"])||void 0===n?void 0:null===(a=n.details)||void 0===a?void 0:a.data,timestamp:Date.now()}:null},k=function(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return{queryKey:y.combination(e,t,s),queryFn:async()=>{let a=(0,p.SJ)();return _(await a.post("/projects/".concat(e,"/preview-page-speed"),{url_source:"publish",strategy:t,categories:[s]}),t,s)},staleTime:a?0:9e5,gcTime:36e5,enabled:!!e}},C=function(e,t,s){var a;let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=(0,x.a)(k(e,t,s,n)),l=(0,r.useCallback)(async()=>i.refetch(),[i]),o=(0,r.useCallback)(async()=>i.refetch(),[i]);return{data:i.data,isLoading:i.isLoading,error:i.error,runAnalysis:l,forceRefresh:o,isStale:i.isStale,lastUpdated:null===(a=i.data)||void 0===a?void 0:a.timestamp}},S=(e,t)=>{var s;let a=(0,h.h)({queries:t.map(t=>{let{strategy:s,category:a}=t;return k(e,s,a)})}),n=a.map(e=>e.data).filter(Boolean),i=a.some(e=>e.isLoading);return{data:n,isLoading:i,error:null===(s=a.find(e=>e.error))||void 0===s?void 0:s.error,runAnalysis:(0,r.useCallback)(async(e,s)=>{let n=t.findIndex(t=>t.strategy===e&&t.category===s);if(-1!==n)return a[n].refetch()},[a,t]),forceRefresh:(0,r.useCallback)(async(e,s)=>{let n=t.findIndex(t=>t.strategy===e&&t.category===s);if(-1!==n)return a[n].refetch()},[a,t]),queries:a}},E=(e,t)=>{let{data:s,isLoading:a,error:n,runAnalysis:r,forceRefresh:i}=S(e,["performance","accessibility","best-practices","seo"].map(e=>({strategy:t,category:e})));return{scores:s.map(e=>e.score),data:s,isLoading:a,error:n,runAnalysis:r,forceRefresh:i}};var I=s(45145),D=s(84183);let P=e=>{let{label:t,score:s,lastUpdated:n,issueCount:r=0,isSelected:i=!1,isLoading:o=!1,onClick:c,onRun:u,onForceRefresh:x}=e,h=(0,a.jsxs)("div",{className:(0,d.cn)("group relative flex cursor-pointer flex-col gap-2 rounded-xl border bg-muted p-4",i&&"border-accent-primary/50"),onClick:c,children:[void 0!==s&&x&&(0,a.jsx)(l.z,{size:"sm",variant:"ghost",className:"absolute right-1 top-1 h-6 w-6 p-0 opacity-0 transition-opacity group-hover:opacity-60 hover:!opacity-100",onClick:e=>{e.stopPropagation(),x()},disabled:o,title:"Force refresh",children:(0,a.jsx)(m.Z,{name:"refresh",size:"small"})}),(0,a.jsx)("p",{className:(0,d.cn)("text-sm font-medium group-hover:text-accent-primary",i&&"text-accent-primary"),children:t}),(0,a.jsx)("div",{className:"flex items-center justify-between gap-2",children:void 0!==s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:(0,d.cn)("h-5 font-medium","text-foreground"),children:o?(0,a.jsx)(I.O,{className:"h-full w-12"}):"".concat(Math.round(s),"%")}),r>0&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-muted-foreground",children:[(0,a.jsx)(m.Z,{name:"warning",size:"small"}),(0,a.jsx)("p",{className:"text-xs font-medium",children:r})]})]}):(0,a.jsx)(l.z,{size:"sm",variant:"outline",className:"h-8 gap-1.5 px-3",onClick:e=>{e.stopPropagation(),null==u||u()},disabled:o,children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.O,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"text-xs",children:"Running..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Z,{name:"play_circle",size:"small"}),(0,a.jsx)("span",{className:"text-xs",children:"Run"})]})})})]});return void 0===s&&u?h:(0,a.jsxs)(D.u,{delayDuration:0,children:[(0,a.jsx)(D.aJ,{asChild:!0,children:h}),(0,a.jsxs)(D._v,{children:[(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:t}),void 0!==s&&(0,a.jsxs)(a.Fragment,{children:[" ","score:"," ",(0,a.jsxs)("span",{className:"font-semibold text-foreground",children:[Math.round(s),"%"]})]})]}),r>0&&(0,a.jsxs)("p",{className:"text-xs opacity-80",children:[r," issue",1!==r?"s":""," found"]}),n&&(0,a.jsxs)("p",{className:"text-xs opacity-60",children:["Updated ",(e=>{let t=Math.floor((Date.now()-e)/6e4);if(t<1)return"Just now";if(t<60)return"".concat(t,"m ago");let s=Math.floor(t/60);return s<24?"".concat(s,"h ago"):"".concat(Math.floor(s/24),"d ago")})(n)]})]})]})};var A=s(95713),z=s(12703),L=s(39230),T=s(77162),O=s(84864),F=s(94127),R=s(70980),M=s(86818);let Z=(e,t,s)=>{let a=(0,T.D)(),[i,l]=(0,r.useState)(!1),{onClick:c,isPending:d}=(0,M.hw)({projectId:a,errors:[{id:(0,L.Fd)(),type:F.N.BUILD,error_message:"SEO Audit Issue (".concat(e.severity,"): ").concat(e.title,"\n\nDescription: ").concat(e.description).concat(e.explanation&&e.explanation!==e.description?"\n\nExplanation: ".concat(e.explanation):"").concat(void 0!==e.score?"\n\nCurrent Score: ".concat(e.score):"").concat(e.savings?"\n\nEstimated savings: ".concat(e.savings):"").concat(e.errorMessage?"\n\nError: ".concat(e.errorMessage):"").concat(e.details?"\n\nAdditional Details: ".concat(JSON.stringify(e.details,null,2)):"","\n\nIMPORTANT INSTRUCTIONS FOR FIXING THIS SEO ISSUE:\n- STRICTLY preserve the existing functional behavior, design, and UX of the application\n- ONLY make changes that are absolutely necessary to fix this specific SEO issue\n- DO NOT modify the application's visual design, layout, or user experience unless it's essential for the SEO fix\n- If the audit requires changes that might affect functionality or UX, be extremely cautious and make minimal changes\n- If you cannot clearly determine how to fix this issue safely without risking application functionality, simply provide the analysis in chat mode instead of making code changes\n- Focus on technical SEO fixes like meta tags, HTML structure, accessibility attributes, etc. that don't affect the user experience\n\nPlease analyze this SEO issue and implement only the minimal necessary changes to improve the website's SEO performance without affecting the application's functionality or user experience."),occurred_at:new Date().toISOString(),created_at:A.EK.now()}]}),u=(0,R.bk)(e=>e.isSendChatMessageMutationPending);return{handleFix:(0,r.useCallback)(async()=>{if(!i)try{l(!0),n.ZP.capture(o.Md.TRY_FIX,{strategy:t,category:s,auditId:e.id,auditSeverity:e.severity,auditTitle:e.title}),await c(),z.Am.success("SEO fix attempt initiated successfully")}catch(e){O.logging.error("Failed to initiate SEO fix:",{error:e}),z.Am.error("Failed to initiate SEO fix. Please try again.")}finally{l(!1)}},[c,i,t,s,e.id,e.severity,e.title]),isFixing:d||u||i}};var U=e=>{let{audit:t,strategy:s,category:n}=e,{handleFix:i,isFixing:l}=Z(t,s,n),o=(0,r.useCallback)(async()=>{await i()},[i]);return(0,a.jsx)("button",{onClick:o,disabled:l,className:"inline-flex h-9 items-center justify-center gap-2 rounded-md bg-black px-4 py-2 text-sm font-medium leading-tight text-white shadow-sm ".concat(l?"cursor-not-allowed opacity-50":"cursor-pointer hover:opacity-90"),children:l?"Fixing...":"Try to fix"})},W=e=>{let{audit:t,strategy:s,category:n}=e;return(0,a.jsx)("div",{className:"rounded-lg border bg-muted p-4",children:(0,a.jsxs)("div",{className:"flex flex-col items-start justify-between gap-3 md:flex-row md:items-center md:gap-0",children:[(0,a.jsxs)("div",{className:"flex w-full flex-1 flex-col items-start gap-3 md:flex-row md:gap-0",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(m.Z,{name:(e=>{switch(e){case"error":return"error";case"warning":return"warning";case"info":default:return"info";case"minor":return"help"}})(t.severity),size:"small",className:"mt-1 text-muted-foreground"})}),(0,a.jsxs)("div",{className:"w-full flex-1 md:ml-3",children:[(0,a.jsx)("h5",{className:"font-medium text-foreground",children:t.title}),(0,a.jsxs)("p",{className:"mt-1 w-full break-words text-sm text-muted-foreground",children:[t.description,t.savings&&(0,a.jsxs)("span",{children:[" Est. savings: ",t.savings]})]})]})]}),(0,a.jsx)("div",{className:"flex-shrink-0 md:ml-4",children:(0,a.jsx)(U,{audit:t,strategy:s,category:n})})]})})},G=s(37298),K=e=>{let{screenshotData:t}=e;return t?(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h4",{className:"mb-4 text-base font-medium",children:"Page Screenshot"}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"relative",style:{maxHeight:"400px",width:"100%",height:"400px"},children:(0,a.jsx)(G.default,{src:t,alt:"Page screenshot",fill:!0,className:"rounded-lg border object-contain shadow-sm",unoptimized:!0})})})]}):null};let B=e=>{var t;let{isProjectPublished:s,isOutdated:n,strategy:i,selectedCategory:o,categories:c,scores:d,allData:x,selectedData:h,filteredAndSortedAudits:p,isAnyLoading:f,isSelectedCategoryLoading:g,hasError:j,scoresError:y,selectedError:N,scoresLoading:w,refreshingCategories:_,onCategorySelect:k,onRunAnalysis:C,onForceRefresh:S,onRegenerateAll:E}=e,[I,D]=(0,r.useState)(!1);(0,r.useEffect)(()=>{D(!1)},[o]);let A=e=>{let t=d.find(t=>t.category===e);return null==t?void 0:t.score},z=e=>x.some(t=>t.category===e),L=e=>{let t=x.find(t=>t.category===e);return null==t?void 0:t.timestamp},T=e=>w||_.has(e);return s?(0,a.jsxs)(a.Fragment,{children:[n&&(0,a.jsx)("div",{className:"mb-6 rounded-lg border border-amber-200 bg-amber-50 p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(m.Z,{name:"warning",className:"mt-0.5 text-amber-500",size:"small"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-amber-800",children:"Results may be outdated"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-amber-700",children:"Your latest changes haven't been published yet. The current analysis is based on the previously published version."})]})]}),(0,a.jsxs)(l.z,{size:"sm",variant:"outline",onClick:E,disabled:f,className:"gap-2",children:[(0,a.jsx)(m.Z,{name:"refresh",size:"small"}),"Regenerate"]})]})}),(0,a.jsx)("div",{className:"mb-6 grid grid-cols-2 gap-4 md:grid-cols-4",children:c.map(e=>{let t=A(e.key),s=z(e.key),n=L(e.key),r=T(e.key);return(0,a.jsx)(P,{label:e.label,score:t,lastUpdated:n,isSelected:o===e.key,isLoading:r,onClick:()=>k(e.key),onRun:s?void 0:()=>C(e.key),onForceRefresh:()=>S(e.key)},"".concat(i,"-").concat(e.key))})}),j&&(0,a.jsxs)("div",{className:"mb-6 rounded-lg border border-red-200 bg-red-50 p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-red-700",children:(null===(t=y||N)||void 0===t?void 0:t.message)||"Failed to fetch page speed data"})]}),g&&(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)(u.$,{size:"large"}),(0,a.jsxs)("p",{className:"text-lg text-muted-foreground",children:["Loading ",o," data for ",i,"..."]})]})}),h&&!g&&(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h4",{className:"mb-4 text-base font-medium",children:[h.score.label," Issues",(()=>{let e=b(p);return e>0&&(0,a.jsx)("div",{className:"ml-2 inline-block",children:(0,a.jsx)("div",{className:"inline-flex h-5 flex-col items-center justify-center gap-2.5 rounded bg-warning px-2 py-1",children:(0,a.jsxs)("div",{className:"justify-start text-xs font-medium leading-3 text-warning-primary",children:[e," ",1===e?"issue":"issues"]})})})})()]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(I?v(p):v(p).slice(0,3)).map((e,t)=>(0,a.jsx)(W,{audit:e,strategy:i,category:o},"".concat(e.id,"-").concat(t))),(()=>{let e=v(p);return e.length>3&&(0,a.jsx)("div",{className:"pt-4 text-center",children:(0,a.jsx)(l.z,{variant:"outline",onClick:()=>D(!I),className:"gap-2",children:I?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Z,{name:"chevron_right",size:"small",className:"-rotate-90"}),"Show Less"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Z,{name:"chevron_right",size:"small",className:"rotate-90"}),"Show More (",e.length-3," ","more)"]})})})})(),0===v(p).length&&(0,a.jsx)("div",{className:"py-8 text-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,a.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-green-100",children:(0,a.jsx)(m.Z,{name:"check",className:"text-green-600",size:"small"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"mb-1 text-lg font-medium text-foreground",children:"No Issues Found!"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[h.score.label," category is performing excellently. Great job!"]})]})]})})]})]}),h.screenshot&&"performance"===o&&(0,a.jsx)(K,{screenshotData:h.screenshot})]}),!h&&!g&&!j&&(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("p",{className:"mb-4 text-muted-foreground",children:['Select a category above and click "Run" to analyze your project\'s'," ",o," performance"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Analysis results are cached for each strategy and category combination"})]})})]}):(0,a.jsxs)("div",{className:"flex w-full flex-1 flex-col items-center justify-center gap-2 text-muted-foreground",children:[(0,a.jsx)(m.Z,{name:"trending_up",size:"large"}),(0,a.jsx)("p",{className:"text-center text-base md:text-sm",children:"To view page speed analysis, you first need to publish your project."})]})},q=e=>{var t;let{project:s}=e,[i,c]=(0,r.useState)("mobile"),[u,m]=(0,r.useState)("performance"),[x,h]=(0,r.useState)(new Set),p=!!(null==s?void 0:s.url),f=(null==s?void 0:s.latest_commit_sha)!==(null==s?void 0:null===(t=s.published_deployment)||void 0===t?void 0:t.commit_sha),{scores:j,data:v,isLoading:b,error:y,runAnalysis:N,forceRefresh:w}=E(s.id,i),{data:_,isLoading:k,error:S,forceRefresh:I}=C(s.id,i,u),D=(0,r.useMemo)(()=>(null==_?void 0:_.audits)?g(_.audits):[],[null==_?void 0:_.audits]),P=e=>{c(e),n.ZP.capture(o.Md.STRATEGY_SELECTED,{strategy:e})},A=async e=>{h(t=>new Set([...t,e]));try{await N(i,e)}finally{h(t=>{let s=new Set(t);return s.delete(e),s})}},z=async e=>{h(t=>new Set([...t,e]));try{e===u&&await I(),await w(i,e)}finally{h(t=>{let s=new Set(t);return s.delete(e),s})}},L=async()=>{let e=["performance","accessibility","best-practices","seo"];n.ZP.capture(o.Md.REGENERATE,{strategy:i,categories:e,context:"all"}),h(new Set(e));try{await Promise.all(e.map(e=>w(i,e))),e.includes(u)&&await I()}finally{h(new Set)}},T=b||k||x.size>0,O=k||x.has(u),F=!!(y||S),R=(()=>{if(0!==v.length)return Math.max(...v.map(e=>e.timestamp||0))})();return(0,a.jsx)(H,{description:"Check what improvements you can undertake.",descriptionAction:(0,a.jsxs)("div",{className:"flex items-center gap-5 md:-mt-1.5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:(0,d.cn)("size-2 rounded-full",R&&5>Math.floor((Date.now()-R)/6e4)?"bg-muted-foreground":"border-2 border-muted-foreground bg-transparent")}),(0,a.jsx)("p",{className:"text-sm text-foreground",children:(e=>{if(!e)return"Never updated";let t=Math.floor((Date.now()-e)/6e4);if(t<1)return"Updated just now";if(t<60)return"Updated ".concat(t,"m ago");let s=Math.floor(t/60);return s<24?"Updated ".concat(s,"h ago"):"Updated ".concat(Math.floor(s/24),"d ago")})(R)})]}),(0,a.jsxs)("div",{className:"flex h-8 items-center rounded-md border bg-background p-0.5 shadow-sm",children:[(0,a.jsx)(l.z,{variant:"ghost",size:"sm",onClick:()=>P("mobile"),className:(0,d.cn)("h-7 rounded-sm px-3 py-1 text-sm","mobile"===i?"bg-muted text-foreground":"text-muted-foreground hover:text-foreground"),children:"Mobile"}),(0,a.jsx)(l.z,{variant:"ghost",size:"sm",onClick:()=>P("desktop"),className:(0,d.cn)("h-7 rounded-sm px-3 py-1 text-sm","desktop"===i?"bg-muted text-foreground":"text-muted-foreground hover:text-foreground"),children:"Desktop"})]})]}),children:(0,a.jsx)(B,{isProjectPublished:p,isOutdated:f,strategy:i,selectedCategory:u,categories:[{key:"performance",label:"Performance"},{key:"accessibility",label:"Accessibility"},{key:"best-practices",label:"Best Practices"},{key:"seo",label:"SEO"}],scores:j,allData:v,selectedData:_||null,filteredAndSortedAudits:D,isAnyLoading:T,isSelectedCategoryLoading:O,hasError:F,scoresError:y,selectedError:S,scoresLoading:b,refreshingCategories:x,onCategorySelect:e=>{m(e),n.ZP.capture(o.Md.CATEGORY_SELECTED,{category:e,strategy:i})},onRunAnalysis:A,onForceRefresh:z,onRegenerateAll:L})})},H=e=>{let{children:t,description:s,descriptionAction:n}=e;return(0,c.A4)()?(0,a.jsxs)("div",{className:"flex min-h-full flex-col gap-6 p-4",children:[n&&(0,a.jsx)("div",{className:"flex justify-end",children:n}),t]}):(0,a.jsx)(i.tM,{title:"Page Speed",value:"page_speed",description:s,descriptionAction:n,children:t})}},30703:function(e,t,s){s.d(t,{M:function(){return D},I:function(){return P}});var a=s(52155),n=s(98244),r=s(10178),i=s(72163),l=s(21517);let o=e=>{let{activeFilter:t}=e;return(0,a.jsx)("div",{className:"rounded-lg border p-8 text-center",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("h3",{className:"font-medium",children:["No ",t," issues found."]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Try selecting a different filter."})]})})},c=e=>{let{error:t}=e;return(0,a.jsxs)("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4",children:[(0,a.jsx)("h3",{className:"mb-2 text-sm font-medium text-red-800",children:"Error Loading Security Data"}),(0,a.jsx)("p",{className:"text-sm text-red-700",children:t})]})};var d=s(45145);let u=()=>(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(d.O,{className:"h-32 w-full"}),(0,a.jsx)("div",{className:"space-y-2",children:[void 0,void 0,void 0].map((e,t)=>(0,a.jsx)(d.O,{className:"h-12 w-full"},t))})]}),m=()=>(0,a.jsx)("div",{className:"rounded-lg border p-8 text-center",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-medium",children:"No Security Issues Found"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"All clear—no issues spotted. Keep in mind our scan can't catch every possible risk."})]})});var x=s(94446),h=s(26052),p=s(4494);let f=e=>{try{let t=/(https?:\/\/[^\s]+)/g;return e.split(t).map((e,s)=>e.match(t)?(0,a.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline hover:text-blue-800",children:e},s):e)}catch(t){return e}},g=e=>{let{finding:t,source:s}=e;return(0,a.jsx)(x.SC,{children:(0,a.jsx)(x.pj,{colSpan:4,className:"bg-muted/30",children:(0,a.jsxs)("div",{className:"space-y-3 px-2 py-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"mb-1 text-sm font-medium text-muted-foreground",children:"Issue Description"}),(0,a.jsx)("p",{className:"text-sm text-foreground",children:f(t.description)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,a.jsx)(h.C,{variant:"secondary",children:(0,p.X7)(s)}),(0,a.jsx)(h.C,{variant:"secondary",children:t.id})]})]})})})};var j=s(59561),v=s(99792),b=s(89671),y=s(4578);let N=e=>{let{source:t,finding:s,rowKey:n,isExpanded:r,onToggleExpansion:l,onTryFix:o,isLoading:c}=e,{captureSecurityEvent:d}=(0,i.y)();return(0,a.jsxs)(x.SC,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>l(n),children:[(0,a.jsx)(x.pj,{className:"w-[32px] pl-3",children:r?(0,a.jsx)(v.Z,{name:"chevron_down",className:"h-4 w-4"}):(0,a.jsx)(v.Z,{name:"chevron_right",className:"h-4 w-4"})}),(0,a.jsx)(x.pj,{children:(0,a.jsx)(h.C,{variant:(0,p.M$)(s.level),children:(0,a.jsx)("span",{className:(0,y.cn)("capitalize",(0,p.b2)(s.level)),children:s.level})})}),(0,a.jsx)(x.pj,{className:"font-medium",children:s.name}),(0,a.jsx)(x.pj,{children:"error"===s.level&&(0,a.jsx)(j.z,{size:"sm",variant:"default",onClick:e=>{e.stopPropagation(),d(b.SL.SECURITY.VIEW_TRY_FIX_CLICKED,{finding_id:s.id,finding_name:s.name,finding_level:s.level,source:t}),o(s,t)},disabled:c,children:"Try to Fix"})})]},n)},w=e=>{let{findings:t,expandedRows:s,onToggleExpansion:n,onTryFix:r,isLoading:i}=e;return(0,a.jsx)("div",{className:"rounded-lg border",children:(0,a.jsxs)(x.iA,{className:"table-fixed",children:[(0,a.jsx)(x.xD,{children:(0,a.jsxs)(x.SC,{children:[(0,a.jsx)(x.ss,{className:"w-[32px]"}),(0,a.jsx)(x.ss,{className:"w-[100px]",children:"Level"}),(0,a.jsx)(x.ss,{children:"Issue"}),(0,a.jsx)(x.ss,{className:"w-[100px]",children:"Actions"})]})}),(0,a.jsx)(x.RM,{children:t.map((e,t)=>{let{source:l,finding:o}=e,c="".concat(l,"-").concat(o.id,"-").concat(t),d=s.has(c);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N,{source:l,finding:o,rowKey:c,isExpanded:d,onToggleExpansion:n,onTryFix:r,isLoading:i},c),d&&(0,a.jsx)(g,{finding:o,source:l})]})})})]})})};var _=s(45417),k=s(76332),C=s(69628);let S=e=>{let{projectId:t,onClose:s}=e,{captureSecurityEvent:n}=(0,i.y)(),{isSendingSecurityReview:r,isSecurityReviewDisabled:l,securityReviewDisabledReason:o,handleSecurityReview:c}=(0,_.C)({projectId:t,setIsOpen:s});return(0,a.jsxs)("div",{className:"flex flex-col items-end justify-between rounded-lg border bg-muted p-6 lg:flex-row",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Review Security"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Ask Lovable to review the security of your project. The AI will analyze your code, configurations, and dependencies to identify potential security vulnerabilities and provide recommendations."})]}),(0,a.jsx)(k.b,{showTooltip:!!o,tooltipContent:o,children:(0,a.jsxs)(j.z,{variant:"affirmative",onClick:()=>{n(b.SL.SECURITY.VIEW_REVIEW_CLICKED),c(),null==s||s()},disabled:l,loading:r,className:"ml-6 mt-4 flex-shrink-0 gap-1.5 lg:mt-0",children:["Security Review ",(0,a.jsx)(C.L,{})]})})]})},E=e=>{let{summary:t,activeFilter:s,onFilterChange:n}=e;return(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[(0,a.jsx)("div",{className:(0,y.cn)("cursor-pointer rounded-lg border p-4 transition-colors hover:bg-muted","error"===s&&"bg-muted"),onClick:()=>n("error"===s?"all":"error"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-sm font-medium",children:"Errors"}),(0,a.jsxs)(h.C,{variant:"destructive",className:"text-sm",children:[t.errorCount," Issues"]})]})}),(0,a.jsx)("div",{className:(0,y.cn)("cursor-pointer rounded-lg border p-4 transition-colors hover:bg-muted","warn"===s&&"bg-muted"),onClick:()=>n("warn"===s?"all":"warn"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-sm font-medium",children:"Warnings"}),(0,a.jsxs)(h.C,{variant:"warning",className:"text-sm",children:[t.warnCount," Issues"]})]})}),(0,a.jsx)("div",{className:(0,y.cn)("cursor-pointer rounded-lg border p-4 transition-colors hover:bg-muted","info"===s&&"bg-muted"),onClick:()=>n("info"===s?"all":"info"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-sm font-medium",children:"Info"}),(0,a.jsxs)(h.C,{variant:"secondary",className:"text-sm",children:[t.infoCount," Issues"]})]})})]})};var I=s(48588);let D=e=>{let{onClose:t}=e,s=(0,l.iZ)(e=>e.project),d=null==s?void 0:s.id,{securitySummary:x,scanData:h,isUpdating:p,isLoading:f,error:g,triggerScan:j}=(0,i.y)(),[v,b]=(0,n.useState)(new Set),[y,N]=(0,n.useState)("all"),_=(0,r.OU)({projectId:d||""});(0,n.useEffect)(()=>{j()},[j]);let k=((null==h?void 0:h.results)?Object.entries(h.results).flatMap(e=>{var t;let[s,a]=e;return(null!==(t=a.items)&&void 0!==t?t:[]).map(e=>({source:s,finding:e}))}):[]).filter(e=>{if("all"===y)return!0;let t=e.finding.level;switch(y){case"error":return"error"===t;case"warn":return"warn"===t;case"info":return"info"===t;default:return!0}}).sort((e,t)=>{let s={error:0,warn:1,info:2};return s[e.finding.level]-s[t.finding.level]}),C=async e=>{let s=(0,I.IT)(),a=(0,I.xK)(e);_.mutateAsync({body:{id:s,message:a,chat_only:!1,agent_mode:"enabled",security_review:!1}}).catch(e=>{console.error("Failed to send security fix request:",e)}),null==t||t()};return f||p?(0,a.jsx)(u,{}):g?(0,a.jsx)(c,{error:g}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(E,{summary:x,activeFilter:y,onFilterChange:e=>{N(e),b(new Set)}}),(0,a.jsx)(S,{projectId:d,onClose:t}),k.length>0?(0,a.jsx)(w,{findings:k,expandedRows:v,onToggleExpansion:e=>{let t=new Set(v);t.has(e)?t.delete(e):t.add(e),b(t)},onTryFix:C,isLoading:_.isPending}):"all"!==y?(0,a.jsx)(o,{activeFilter:y}):(0,a.jsx)(m,{})]})},P=()=>(0,a.jsx)("div",{className:"flex min-h-full flex-col gap-6 p-4",children:(0,a.jsx)(D,{})})},4494:function(e,t,s){s.d(t,{M$:function(){return a},X7:function(){return l},_s:function(){return r},b2:function(){return n}});let a=e=>{switch(e){case"error":return"destructive";case"warn":return"warning";default:return"outline"}},n=e=>{switch(e){case"error":return"text-destructive-foreground";case"warn":return"text-warning-foreground";default:return"text-muted-foreground"}},r=e=>{switch(e.toLowerCase()){case"warn":return"Warning";case"error":return"Error";case"info":return"Info";default:return e.charAt(0).toUpperCase()+e.slice(1)}},i={open_table:"Database Schema",supabase:"Supabase",supabase_lov:"LLM Database Check"},l=e=>{var t;return null!==(t=i[e])&&void 0!==t?t:e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}},48588:function(e,t,s){s.d(t,{IT:function(){return i},Oh:function(){return n},xK:function(){return r}});let a=e=>["info","warn","error"].includes(e.toLowerCase()),n=e=>{try{let t=e.match(RegExp("^Security Finding:\\s*\\[(\\w+)\\]\\s*([^\\n\\r]+)(?:[\\n\\r]+(.+))?$","s"));if(!t)return null;let[,s,n,r=""]=t,i=s.toLowerCase();if(!a(i))return null;return{id:"parsed-".concat(Date.now()),level:i,name:n.trim(),description:r.trim()}}catch(e){return null}},r=e=>"Security Finding: [".concat(e.level.toUpperCase(),"] ").concat(e.name,"\n\nI found a security issue that needs to be analyzed and fixed:\n\nIssue: ").concat(e.name,"\nLevel: ").concat(e.level,"\nDescription: ").concat(e.description,"\n\nPlease analyze this security issue in my project and provide a fix if possible. Make sure the fix doesn't break existing functionality and follows security best practices. If you need to modify files, please do so carefully and explain the changes."),i=()=>crypto.randomUUID?crypto.randomUUID():"msg_".concat(Date.now(),"_").concat(Math.random())},22114:function(e,t,s){s.d(t,{W:function(){return r}});var a=s(68820),n=s(94671);let r=e=>{let{projectId:t,enabled:s=!0}=e;return(0,a.a)({queryKey:["projects",t,"integrations","ai_gateway"],queryFn:async()=>(0,n.SJ)().get("/projects/".concat(t,"/integrations/ai_gateway")),enabled:s&&!!t})}},96659:function(e,t,s){s.d(t,{C:function(){return i}});var a=s(98244),n=s(21517);let r=e=>{try{if(null==e)return!1;let t=e.toDate();if(new Date().getTime()-t.getTime()>6e4)return!1;return!0}catch(e){return!1}},i=()=>{let e=(0,n.iZ)(e=>e.project),t=null==e?void 0:e.locked_at,[s,i]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if(!t||!r(t)){i(!1);return}let e=setInterval(()=>{let s=r(t);i(s),s||clearInterval(e)},250);return()=>clearInterval(e)},[t]),s}},13592:function(e,t,s){s.d(t,{H:function(){return p}});var a=s(52155),n=s(76816),r=s(99792),i=s(33563),l=s(4578),o=s(1178),c=s(1523);let d=e=>{let{workspace:t,isOwnerOfWorkspace:s}=e,d=(0,i.t)(t),{openSettings:u}=(0,n.r)(),m=(0,c.Ss)(d.currentlyConsuming,d.sources);return(0,a.jsxs)("div",{className:"flex flex-col gap-2.5 rounded-xl bg-muted p-4 md:rounded-md md:p-3",children:[(0,a.jsxs)("div",{className:(0,l.cn)("flex items-center justify-between",{"cursor-pointer transition-all duration-150 ease-in-out hover:opacity-80":s}),onClick:s?()=>{u("billing")}:void 0,children:[(0,a.jsx)("p",{className:"text-base font-medium text-foreground md:text-sm",children:"Credits"}),(0,a.jsxs)("div",{className:"flex items-center gap-px",children:[(0,a.jsx)("p",{className:(0,l.cn)("text-base font-normal md:text-sm",0===d.totalRemaining&&s?"text-foreground":"text-muted-foreground"),children:0===d.totalRemaining&&s?"Upgrade":0===d.totalRemaining?"0 left":"".concat((0,o.H)(d.totalRemaining)," left")}),s&&(0,a.jsx)(r.Z,{name:"chevron_right",size:"small",className:(0,l.cn)(0===d.totalRemaining?"text-foreground":"text-muted-foreground")})]})]}),(0,a.jsx)(c.jT,{progressData:d}),(d.currentlyConsuming||0===d.totalRemaining)&&(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("div",{className:"h-2 w-2 rounded-full ".concat(m)}),(0,a.jsx)("p",{className:"text-base text-muted-foreground md:text-sm",children:(0,c.qk)(d.currentlyConsuming)})]})]})};var u=s(26047),m=s(61504),x=s(33864),h=s(44647);let p=e=>{let{workspace:t,membership:s,className:n}=e,{userMonthlyUsage:r,maxUserMonthlyUsage:i}=(0,m.O)(t),o=(0,u.v)();if("inactive"===t.plan)return null;let c=(null==s?void 0:s.role)==="owner"||(null==s?void 0:s.role)==="admin",p=(0,h.gG)(t.plan)||(0,h.Qx)(t.plan);return(0,a.jsxs)("div",{className:(0,l.cn)("flex flex-col gap-1",n),children:[(!(p&&!c)||o)&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(d,{workspace:t,isOwnerOfWorkspace:(null==s?void 0:s.role)==="owner"})}),i>0&&(0,a.jsx)("div",{className:(0,l.cn)("flex items-center justify-between gap-2 rounded-md bg-muted p-3 text-base md:text-sm"),children:(0,a.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,a.jsxs)("div",{className:"",children:[(0,a.jsx)("p",{className:"font-medium",children:"Personal usage"}),(null==s?void 0:s.role)!=="owner"&&(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Ask your workspace admin",(0,a.jsx)("br",{})," to increase the limit"]})]}),(0,a.jsxs)("p",{children:[(0,x.H)(r)," /"," ",(0,x.H)(i)]})]})})]})}},1523:function(e,t,s){s.d(t,{Ss:function(){return d},jT:function(){return h},qk:function(){return u}});var a=s(52155),n=s(98244),r=s(84183),i=s(1178);let l={GAP_SCALE_FACTOR:.002,MIN_GAP_WIDTH:2,MIN_INDICATOR_WIDTH:7,PROGRESS_BAR_HEIGHT:11,FALLBACK_MIN_WIDTH_PERCENTAGE:2},o=["bg-blue-800","bg-blue-600","bg-blue-400","bg-blue-200","bg-blue-50"],c=(e,t)=>{if(!e)return"bg-muted-foreground";let s=t.findIndex(t=>t.name===e);return -1===s?"bg-muted-foreground":o[Math.min(s,o.length-1)]},d=(e,t)=>(0,n.useMemo)(()=>c(e,t),[e,t]),u=e=>{switch(e){case"daily":return"Daily credits used first";case"rollover":return"Using rollover credits";case"billing":return"Using monthly credits";case"granted":return"Using bonus credits";case null:return"You are out of credits"}},m={granted:"Bonus",billing:"Monthly",rollover:"Rollover",daily:"Daily"},x=e=>m[e],h=e=>{let{progressData:t}=e,s=(0,n.useRef)(null),[c,d]=(0,n.useState)(0);(0,n.useLayoutEffect)(()=>{let e=()=>{s.current&&d(s.current.offsetWidth)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let u=Math.max(l.MIN_GAP_WIDTH,c*l.GAP_SCALE_FACTOR),m=l.MIN_INDICATOR_WIDTH,h=(0,n.useMemo)(()=>t.hasCredits?t.sources.map((e,s)=>{let a=t.totalAllocation>0?e.remaining/t.totalAllocation*100:0,n=c>0?m/c*100:l.FALLBACK_MIN_WIDTH_PERCENTAGE,r=s===t.sources.length-1,i=o[Math.min(s,o.length-1)];return{...e,widthPercentage:Math.max(a,n),isFirst:0===s,isLast:r,colorClass:i}}):[],[t.hasCredits,t.sources,t.totalAllocation,c,m]),p=(0,n.useMemo)(()=>{if(!t.hasCredits||0===h.length)return[];let e=c>0?u/c*100:.4,s=Math.max(0,h.length-1)*e,a=h.reduce((e,t)=>e+t.widthPercentage,0)+s,n=a>100?100/a:1,r=e*n,i=0;return h.map(e=>{let t=e.widthPercentage*n,s=i;return i+=t+(e.isLast?0:r),{...e,widthPercentage:t,leftOffset:s}})},[t.hasCredits,h,c,u]);return t.hasCredits?(0,a.jsx)("div",{className:"flex w-full items-center gap-2",children:(0,a.jsx)("div",{ref:s,className:"relative flex-1 overflow-hidden rounded-lg bg-muted-active",style:{height:"".concat(l.PROGRESS_BAR_HEIGHT,"px")},children:p.map(e=>(0,a.jsxs)(r.u,{delayDuration:0,children:[(0,a.jsx)(r.aJ,{asChild:!0,children:(0,a.jsx)("div",{className:"absolute h-full cursor-pointer ".concat(e.colorClass," transition-all ").concat(e.isFirst?"rounded-bl-lg rounded-tl-lg":""," ").concat(e.isLast?"rounded-br-lg rounded-tr-lg":""),style:{left:"".concat(e.leftOffset,"%"),width:"".concat(e.widthPercentage,"%")}})}),(0,a.jsx)(r._v,{className:"border border-gray-200 bg-white shadow-lg",children:(0,a.jsx)("div",{className:"justify-center text-xs font-normal leading-none text-black",children:"granted"===e.name?"".concat((0,i.H)(e.remaining)," ").concat(x(e.name)," credits"):"".concat((0,i.H)(e.remaining),"/").concat((0,i.H)(e.limit)," ").concat(x(e.name)," credits")})})]},e.name))})}):(0,a.jsx)("div",{className:"flex w-full items-center gap-2",children:(0,a.jsx)("div",{className:"relative h-2.5 flex-1 overflow-hidden rounded-lg bg-muted-active"})})}},97940:function(e,t,s){s.d(t,{r:function(){return u}});var a=s(52155),n=s(81858),r=s(17195),i=s(2247),l=s(19214),o=s(99792),c=s(89671),d=s(53259);let u=()=>{let e=(0,n.T_)("EarnFreeCredits"),t=(0,l.z)(i.A);return(0,a.jsxs)(d.Xi,{onClick:()=>{r.ZP.capture(c.PU.OPENED_DIALOG,{button_used:"menu_item"}),t({childProps:{onSuccess:()=>t(!1)}})},children:[(0,a.jsx)(o.Z,{name:"featured_seasonal_and_gifts",size:"small"}),(0,a.jsx)("span",{children:e("getFreeCredits")})]})}},33353:function(e,t,s){s.d(t,{O:function(){return C}});var a=s(52155),n=s(98244),r=s(66520),i=s(82259),l=s(21517),o=s(33877),c=s(59561),d=s(14070),u=s(31194),m=s(29605),x=s(56166),h=s(12703),p=s(75970),f=s(13273),g=s(94671),j=s(84864),v=s(32282);let b=e=>{let{onSettled:t}=e,{authUser:s}=(0,p.Eu)(),a=(0,m.NL)(),{mutate:n,isPending:r}=(0,x.D)({mutationFn:async e=>{let{projectId:t,workspaceId:a}=e;if(!s)throw Error("User must be logged in to move projects");let n=(0,g.SJ)();await n.put("/projects/".concat(t,"/move-to-workspace"),{workspace_id:a})},onSuccess:async(e,t)=>{a.invalidateQueries({queryKey:v.iZ.detail(t.projectId)}).catch(e=>{j.logging.error("Failed to invalidate project query after transfer",{error:e})}),h.Am.success("Project moved successfully",{description:"Moved project to ".concat(t.workspaceName||"new workspace")})},onError:e=>{(0,f.Eo)(e)},onSettled:()=>{null==t||t()}});return{moveProjectToWorkspace:n,isMovingProject:r}};var y=s(4578),N=s(44647),w=s(43115),_=s(57602),k=s(99792);function C(e){let{trigger:t,projectId:s,projectName:m,open:x,setOpen:h,isRootDialog:p=!1}=e,f=(0,i.Q)(e=>e.workspaces),{moveProjectToWorkspace:g,isMovingProject:j}=b({onSettled:()=>{E(!1),P("")}}),v=(0,o.hO)(e=>e.projectWorkspace),[C,S]=(0,n.useState)(!1),E=h||S,I=async e=>{s&&g({projectId:s,workspaceId:e.id,workspaceName:e.name})},[D,P]=(0,n.useState)(""),A=(0,i.Q)(e=>e.setShowCreateWorkspaceDialog),z=f.find(e=>e.id===D),L=(0,l.iZ)(e=>e.project);if(!v)return null;let T=(0,N.XB)(null==z?void 0:z.plan)?"private":(null==z?void 0:z.plan)==="free"?"public":null;return(0,a.jsxs)(d.Vq,{open:h?x:C,onOpenChange:E,children:[!p&&(0,a.jsx)(d.hg,{asChild:!0,children:t||(0,a.jsx)(c.z,{variant:"default",children:"Transfer"})}),(0,a.jsxs)(d.cZ,{size:"sm",children:[(0,a.jsxs)(d.fK,{children:[(0,a.jsxs)(d.$N,{className:"text-left",children:["Transfer ",m||"Project"]}),(0,a.jsxs)(d.Be,{className:"text-left",children:[(0,a.jsx)("p",{children:z?(0,a.jsxs)("span",{children:["Moving this project to"," ",(0,a.jsx)("span",{className:"font-medium",children:z.name})," ","will:"]}):(0,a.jsx)("span",{children:"Moving this project to a new workspace will:"})}),(0,a.jsxs)("ul",{className:"list-disc pl-4 text-sm",children:[(0,a.jsxs)("li",{children:["Remove access for members of"," ",(0,a.jsx)("span",{className:"font-medium",children:v.name})]}),(0,a.jsxs)("li",{children:["Grant access to members of"," ",z?(0,a.jsx)("span",{className:"font-medium",children:null==z?void 0:z.name}):(0,a.jsx)("span",{children:"the new workspace"})]}),(0,a.jsx)("li",{children:"Preserve access for anyone directly invited to the project"}),(0,a.jsx)("li",{children:"May require you to re-link GitHub and Supabase organizations/projects"})]}),(0,a.jsxs)(_.bZ,{className:(0,y.cn)((!T||T===(null==L?void 0:L.visibility))&&"hidden","text-sm","mt-4"),children:[(0,a.jsx)(k.Z,{name:"info",className:"h-4 w-4"}),(0,a.jsx)(_.Cd,{children:"Warning"}),(0,a.jsxs)(_.X,{className:"text-sm",children:["This action will turn the project"," ",(0,a.jsx)("span",{className:"font-medium",children:"private"===T?"private":"public"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"min-w-[60px] text-sm font-medium",children:"From"}),(0,a.jsxs)("div",{className:"flex w-full items-center gap-2 rounded-md border px-2 py-1.5 opacity-70",children:[(0,a.jsx)(w.z,{workspace:v,className:"h-5 w-5 rounded-[6px]"}),(0,a.jsx)("p",{className:"text-sm",children:null==v?void 0:v.name}),(0,a.jsx)(r.v,{plan:null==v?void 0:v.plan})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"min-w-[60px] text-sm font-medium",children:"To"}),(0,a.jsxs)(u.Ph,{value:D,onValueChange:P,children:[(0,a.jsx)(u.i4,{className:"px-2 py-1.5",children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(u.ki,{placeholder:"Select a workspace",className:"mr-auto"})})}),(0,a.jsxs)(u.Bw,{children:[f.map(e=>{var t,s,n,i,l,o;return(0,a.jsx)(u.Ql,{value:e.id,disabled:e.id===v.id||(null===(t=e.membership)||void 0===t?void 0:t.role)!=="owner"&&(null===(s=e.membership)||void 0===s?void 0:s.role)!=="admin"&&(null===(n=e.membership)||void 0===n?void 0:n.role)!=="member",className:"focus:bg-accent/50",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.z,{workspace:e,className:"h-5 w-5 rounded-[6px]"}),(0,a.jsx)("p",{children:e.name}),e.plan&&(0,a.jsx)(r.v,{plan:e.plan}),(null===(i=e.membership)||void 0===i?void 0:i.role)!=="owner"&&(null===(l=e.membership)||void 0===l?void 0:l.role)!=="admin"&&(null===(o=e.membership)||void 0===o?void 0:o.role)!=="member"&&(0,a.jsx)("span",{className:"text-sm text-destructive-foreground",children:"(Not an editor)"})]})},e.id)}),(0,a.jsxs)("button",{className:"flex w-full items-center gap-2 rounded-sm px-2 py-1.5 text-sm hover:bg-accent",onClick:()=>{A(!0)},children:[(0,a.jsx)("div",{className:"flex h-5 w-5 items-center justify-center",children:(0,a.jsx)(k.Z,{name:"add",size:"small"})}),"Create new"]})]})]})]})]}),(0,a.jsxs)(d.cN,{className:"gap-2",children:[(0,a.jsx)(c.z,{size:"sm",variant:"outline",onClick:()=>E(!1),children:"Cancel"}),(0,a.jsx)(c.z,{disabled:!z,variant:"affirmative",size:"sm",onClick:()=>{z&&I(z)},loading:j,children:j?"Transferring...":"Confirm transfer"})]})]})]})}},63651:function(e,t,s){s.d(t,{H:function(){return i}});var a=s(52155),n=s(26052),r=s(4578);let i=e=>{let{status:t}=e;return(0,a.jsxs)(n.C,{className:"flex w-auto items-center gap-1.5 bg-secondary text-xs text-foreground shadow-none hover:bg-secondary",children:[(0,a.jsx)("span",{className:(0,r.cn)("h-1.5 w-1.5 rounded-full","connected"===t?"bg-success-primary":"bg-warning-primary")}),"connected"===t?"Connected":"Not connected"]})}},80962:function(e,t,s){s.d(t,{default:function(){return av}});var a,n,r=s(52155),i=s(98244),l=s(56551),o=s(75970),c=s(45776),d=s(13018),u=s(73517),m=s(22114),x=s(68820),h=s(94671);let p=e=>{let{projectId:t,start:s,end:a,enabled:n=!0}=e;return(0,x.a)({queryKey:["projects",t,"integrations","ai_gateway","usage",{start:s,end:a}],queryFn:async()=>{let e=(0,h.SJ)(),n=new URLSearchParams;s&&n.append("start",s),a&&n.append("end",a);let r=n.toString(),i="/projects/".concat(t,"/integrations/ai_gateway/usage").concat(r?"?".concat(r):"");return e.get(i)},enabled:n&&!!t})};var f=s(59561),g=s(53259),j=s(99792),v=s(87294);let b=()=>{let e=new Date,t=[];return t.push({label:"Last 24 hours",value:"24h",start:new Date(e.getTime()-864e5).toISOString(),end:e.toISOString()}),t.push({label:"Last 7 days",value:"7d",start:new Date(e.getTime()-6048e5).toISOString(),end:e.toISOString()}),t.push({label:"Last 30 days",value:"30d",start:new Date(e.getTime()-2592e6).toISOString(),end:e.toISOString()}),t},y=e=>{let{selectedPeriod:t,onPeriodChange:s}=e,a=(0,v.Z)("md"),n=b();return(0,r.jsxs)(g.h_,{children:[(0,r.jsx)(g.$F,{asChild:!0,children:(0,r.jsxs)(f.z,{variant:"outline",className:"justify-between text-foreground md:min-w-32 md:px-3",size:a?"sm":"default",children:[t.label,(0,r.jsx)(j.Z,{name:"chevron_right",size:"small",className:"rotate-90"})]})}),(0,r.jsx)(g.AW,{align:"end",className:"min-w-32",children:n.map(e=>(0,r.jsx)(g.Xi,{onClick:()=>s(e),children:e.label},e.value))})]})};var N=s(40796),w=s(79042),_=s(41443),k=s(5068),C=s(59069),S=s(73274),E=s(72391),I=s(18587),D=s(36963),P=s(1e4),A=s(30094),z=s(11350),L=s(28968),T=s(49802),O=s(21177),F=s(62196),R=s(71272);let M=e=>{let t=e=>"hsl(".concat(120+137.508*e%360/360*200,", ").concat(70+e%3*10,"%, ").concat(50+e%4*5,"%)"),s={};return e.forEach((e,a)=>{s[e]={label:e,color:t(a)}}),s},Z=e=>{let{active:t,payload:s,label:a}=e;return t&&s&&s.length?(0,r.jsxs)("div",{className:"rounded-lg border bg-background p-3 shadow-md",children:[(0,r.jsx)("p",{className:"mb-2 font-medium text-foreground",children:a}),(0,r.jsx)("div",{className:"space-y-1",children:s.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"h-3 w-3 rounded-sm",style:{backgroundColor:e.color}}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:e.dataKey})]}),(0,r.jsx)("span",{className:"text-sm font-medium text-foreground",children:e.value})]},t))})]}):null},U=e=>{let{data:t,isLoading:s,granularity:a="day"}=e,{chartData:n,chartConfig:l}=(0,i.useMemo)(()=>{if(!t||0===t.length)return{chartData:[],chartConfig:{}};let e=new Set,s=null,n=null,r={};return(t.forEach(t=>{try{var i;let l=null===(i=t.timestamp)||void 0===i?void 0:i.trim();if(!l)return;let o=(0,N.D)(l);if(isNaN(o.getTime()))return;(!s||o<s)&&(s=o),(!n||o>n)&&(n=o);let c=("minute"===a?(0,w.F)(o):"hour"===a?(0,_.o)(o):(0,k.b)(o)).toISOString(),d=t.model||"Unknown";e.add(d),r[c]||(r[c]={}),r[c][d]=(r[c][d]||0)+(t.count||1)}catch(e){}}),s&&n)?{chartData:("minute"===a?(0,C.z)({start:(0,w.F)(s),end:(0,w.F)(n)}):"hour"===a?(0,S.e)({start:(0,_.o)(s),end:(0,_.o)(n)}):(0,E.D)({start:(0,k.b)(s),end:(0,k.b)(n)})).map(t=>{let s=t.toISOString(),n={timeKey:"minute"===a?(0,I.WU)(t,"HH:mm"):"hour"===a?(0,I.WU)(t,"MMM dd, HH:mm"):(0,I.WU)(t,"MMM dd")};return e.forEach(e=>{n[e]=0}),r[s]&&Object.entries(r[s]).forEach(e=>{let[t,s]=e;n[t]=s}),n}),chartConfig:M(Array.from(e))}:{chartData:[],chartConfig:{}}},[t,a]);if(s)return(0,r.jsx)("div",{className:"flex h-80 w-full items-center justify-center",children:(0,r.jsx)(F.$,{})});if(0===n.length)return(0,r.jsx)("div",{className:"flex h-80 w-full items-center justify-center rounded-lg border border-dashed",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"No AI Gateway usage data available for the selected period."})});let o=Object.keys(l);return(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(R.BO,{config:l,className:"h-80 w-full",children:(0,r.jsx)(D.h,{width:"100%",height:"100%",children:(0,r.jsxs)(P.v,{data:n,width:void 0,height:void 0,margin:{top:20,right:5,left:0,bottom:20},children:[(0,r.jsx)(A.q,{strokeDasharray:"3 3"}),(0,r.jsx)(z.K,{dataKey:"timeKey",tick:!1,axisLine:!1,tickLine:!1}),(0,r.jsx)(L.B,{axisLine:!1,tickLine:!1,tick:{fontSize:12},width:30}),(0,r.jsx)(R.h7,{content:(0,r.jsx)(Z,{})}),(0,r.jsx)(T.D,{}),o.map(e=>(0,r.jsx)(O.$,{dataKey:e,stackId:"models",fill:l[e].color,radius:[0,0,0,0]},e))]})})})})};var W=s(45145);let G=e=>{let{data:t,isLoading:s}=e,a=t.reduce((e,t)=>e+t.count,0);return(0,r.jsx)("div",{className:"rounded-lg border p-4",children:(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Requests"}),s?(0,r.jsx)(W.O,{className:"h-8 w-20"}):(0,r.jsx)("p",{className:"font-bold text-3xl",children:a.toLocaleString()})]})})},K=e=>{let{project:t}=e,[s,a]=(0,i.useState)(b()[1]),n="24h"===s.value?"minute":"day",{data:l}=(0,m.W)({projectId:t.id}),{data:o,isLoading:c}=p({projectId:t.id,start:s.start,end:s.end});return(0,r.jsx)(u.tM,{title:"AI Gateway",value:"ai_gateway",description:"Monitor your project's AI Gateway usage and performance.",docsLink:"https://docs.lovable.dev/features/ai-gateway",children:(0,r.jsxs)("div",{className:"flex w-full flex-col gap-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-5",children:[(0,r.jsx)("p",{className:"font-medium",children:"AI Gateway Status"}),(0,r.jsxs)("div",{className:"flex items-center gap-3 rounded-lg border border-border p-4",children:[(0,r.jsx)("div",{className:"h-3 w-3 rounded-full ".concat((null==l?void 0:l.is_used)?"bg-green-500":"bg-gray-400")}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm font-medium",children:["Status: ",(null==l?void 0:l.is_used)?"Active":"Not in use"]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:(null==l?void 0:l.is_used)?"Your project is using Lovable's AI Gateway for secure API communication.":"Your project is not currently using the AI Gateway. Lovable will automatically activate it when you implement a feature that uses AI."})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-5",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"font-medium",children:"Usage Statistics"}),(0,r.jsx)(y,{selectedPeriod:s,onPeriodChange:a})]}),(0,r.jsx)(G,{data:o||[],isLoading:c})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-5",children:(0,r.jsx)(U,{data:o||[],isLoading:c,granularity:n})})]})})};var B=s(28287),q=s(34550),H=s(12849),V=s.n(H),J=s(56852),Y=s(17195),Q=s(12703),$=s(10416),X=s(37156),ee=s(12759),et=s(19214),es=s(62483);let ea=e=>{let t="development"===e?"185.158.133.10":"185.158.133.1";return{domain:[{type:"A",host:"@",value:t,ttl:300},{type:"A",host:"www",value:t,ttl:300}],subDomain:[{type:"A",host:"{SUBDOMAIN}",value:t,ttl:300}]}};var en=s(84864),er=s(50484),ei=s(39592),el=s(13063),eo=s(6233),ec=s(33877),ed=e=>{let{project:t}=e,{userData:s}=(0,X.SE)(),{data:a,refetch:n}=(0,x.a)(ei.c.domains({projectId:t.id})),l=(0,ec.hO)(e=>e.projectWorkspace),[o,c]=(0,i.useState)(null);(0,i.useEffect)(()=>{(async()=>{let e=(0,h.SJ)();c(await e.get("/entri/token"))})(),V().load()},[]);let u=(0,et.z)($.g),m=async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("free"===(null==l?void 0:l.plan)){u({childProps:{dialogDescription:"You need to be on a pro plan to connect a domain."}});return}if(!(null==t?void 0:t.url)){let e=(0,h.SJ)();try{let s=await e.post("/projects/".concat(null==t?void 0:t.id,"/deployments"),{});(null==s?void 0:s.deployment_id)&&await (0,eo.G)({projectId:null==t?void 0:t.id,deploymentId:s.deployment_id})}catch(e){en.logging.error("Error publishing project",e),Q.Am.error("Error when publishing your project",{description:e.message}),q.Tb(e)}}if(null===o)return;let a={...o,dnsRecords:ea("production"),userId:null==t?void 0:t.id,monitor:!0,sellVersion:"v3",whiteLabel:{customCopy:{initialScreen:{title:{en:"Use your domain with Lovable"}}},theme:{primary:"#000000",secondary:"#000000",onSecondary:"#FFFFFF",headerBackground:"#000000"},logo:"https://lovable.dev/apple-icon.png",sell:{partnerName:"Lovable",partnerLogo:"https://lovable.dev/img/lovable-logo-text-nav.png",partnerUrl:"https://lovable.dev",overlayScreenHeight:"75%",flowTarget:"_blank"}}};try{"buy"===e?(a.prefilledDomain=(null==t?void 0:t.name)+".com",V().purchaseDomain(a)):V().showEntri(a)}catch(t){if(!s){let t=(0,h.SJ)();c(await t.get("/entri/token")),m(e,!0)}}Y.ZP.capture("domain_connecting_attempt",{mode:e})},p=async e=>{if(e.detail.success){let s=Q.Am.success("Connecting domain...",{description:"Hold on while we were mapping ".concat(e.detail.domain," to your project.")});try{let s=(0,h.SJ)();await s.post("/projects/".concat(null==t?void 0:t.id,"/domains"),{domain:e.detail.domain}),n(),Q.Am.success("Domain connected!",{description:"The domain ".concat(e.detail.domain," is now mapped to your project. It might take a few minutes to propagate.")}),Y.ZP.capture("domain_connected",{mode:"purchase"===e.detail.setupType?"buy":"connect"})}catch(e){Q.Am.info("Domain not connected",{description:"There was an error while connecting your domain. Please try again."}),q.Tb(e)}Q.Am.dismiss(s)}};(0,i.useEffect)(()=>(window.addEventListener("onEntriClose",p,!1),()=>{window.removeEventListener("onEntriClose",p)}),[]);let g=(0,d.dl)(er.P.CustomDomainsBuy)||!1;return(0,r.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,r.jsx)(es.P,{label:"Connected Domains",description:"View or remove domains linked to your project.",justify:"end",children:(0,r.jsxs)("ul",{className:"flex flex-col gap-2",children:[(null==t?void 0:t.url)?(0,r.jsx)(ee.Z,{showRemove:!1,showIcon:!0,domain:{domain:(0,el.P)(null==t?void 0:t.url),status:"active"}}):(0,r.jsx)("li",{className:"flex items-center",children:(0,r.jsxs)("span",{className:"flex-grow text-sm text-muted-foreground",title:"You have to publish your project for this domain to work",children:[null==t?void 0:t.name,".lovable.app"]})}),null==a?void 0:a.map((e,t)=>(0,r.jsx)(ee.Z,{domain:e,showRemove:!0,showIcon:!0,refetchDomains:n},t))]})}),(0,r.jsx)(es.P,{label:"Add Existing Domain",description:"Connect a domain you already own.",mobileLayout:"horizontal",justify:"end",children:(0,r.jsx)(f.z,{variant:"outline",size:"sm",type:"button",onClick:()=>m("connect"),className:"whitespace-nowrap",children:a&&0===a.length?"Connect Domain":"Connect Another Domain"})}),g&&(0,r.jsx)(es.P,{label:"Purchase New Domain",description:"Buy a new domain through Ionos.",mobileLayout:"horizontal",justify:"end",children:(0,r.jsx)(f.z,{variant:"outline",size:"sm",type:"button",onClick:()=>m("buy"),className:"whitespace-nowrap",children:"Buy Domain"})}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(f.z,{variant:"outline",size:"sm",type:"button",asChild:!0,children:(0,r.jsxs)(J.default,{href:"https://docs.lovable.dev/tips-tricks/custom-domain",target:"_blank",children:["How Domains Work ",(0,r.jsx)(j.Z,{name:"arrow_outward",size:"small"})]})})})]})},eu=s(52465),em=s(89671),ex=s(4578),eh=s(21517),ep=()=>{let[e,t]=(0,i.useState)(""),s=(0,eh.iZ)(e=>e.project);(0,i.useEffect)(()=>{(null==s?void 0:s.custom_instructions)&&t(s.custom_instructions)},[s]);let{updateProject:a}=(0,eh.d2)(),n=async()=>{try{a({custom_instructions:e},{onSuccess:()=>{Y.ZP.capture(em.SL.KNOWLEDGE.SAVED),Q.Am.success("Custom instructions updated",{description:"Your custom instructions have been saved successfully."})}}),o(!1)}catch(e){Q.Am.error("Error",{description:"Failed to update custom instructions. Please try again."})}},[l,o]=(0,i.useState)(!1),c=e.length,d=c>1e5;return(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"mb-2 flex flex-col gap-2",children:[(0,r.jsx)("p",{className:"text-base font-medium",children:"Instructions & Guidelines"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Provide guidelines and context to improve your project’s edits. Use this space to:"}),(0,r.jsxs)("ul",{className:"list-disc pl-6 text-sm text-muted-foreground",children:[(0,r.jsx)("li",{children:"Set project-specific rules or best practices."}),(0,r.jsx)("li",{children:"Set coding style preferences (e.g. indentation, naming conventions)."}),(0,r.jsx)("li",{children:"Include external documentation or style guides."})]})]}),(0,r.jsx)(eu.g,{value:e,onChange:e=>{t(e.target.value),e.target.value!==(null==s?void 0:s.custom_instructions)?o(!0):o(!1)},placeholder:"Enter your instructions here...",className:(0,ex.cn)("resize-none"),rows:14}),(0,r.jsx)("div",{className:(0,ex.cn)("flex justify-end",l&&"mb-12"),children:(0,r.jsx)(f.z,{variant:"outline",size:"sm",type:"button",asChild:!0,children:(0,r.jsxs)(J.default,{href:"https://docs.lovable.dev/features/knowledge",target:"_blank",children:["Get Inspiration ",(0,r.jsx)(j.Z,{name:"arrow_outward",size:"small"})]})})}),l&&(0,r.jsxs)(es.j,{className:"justify-end gap-3",children:[d&&(0,r.jsxs)("div",{className:"mr-auto text-sm text-destructive-foreground",children:["Message is too long. Exceeded by ",c-1e5," ","characters."]}),(0,r.jsx)(f.z,{variant:"outline",onClick:()=>{t((null==s?void 0:s.custom_instructions)||""),o(!1)},children:"Cancel"}),(0,r.jsx)(f.z,{onClick:n,variant:"affirmative",disabled:d,children:"Save"})]})]})},ef=s(44347),eg=s(29605),ej=s(31194);let ev=e=>{let{project:t,onCategoryChange:s,disabled:a=!1}=e;return(0,r.jsx)(es.P,{label:"Project Category",description:"Categorize your project to help others find it.",mobileLayout:"horizontal",justify:"end",children:(0,r.jsxs)(ej.Ph,{defaultValue:(null==t?void 0:t.category)||"",onValueChange:e=>{s(e)},disabled:a,children:[(0,r.jsx)(ej.i4,{className:"w-[180px]",children:(0,r.jsx)(ej.ki,{placeholder:"Select category"})}),(0,r.jsxs)(ej.Bw,{children:[(0,r.jsx)(ej.Ql,{value:"internal_tools",children:"Internal Tools"}),(0,r.jsx)(ej.Ql,{value:"website",children:"Website"}),(0,r.jsx)(ej.Ql,{value:"personal",children:"Personal"}),(0,r.jsx)(ej.Ql,{value:"consumer_app",children:"Consumer App"}),(0,r.jsx)(ej.Ql,{value:"b2b_app",children:"B2B App"}),(0,r.jsx)(ej.Ql,{value:"prototype",children:"Prototype"})]})]})})};var eb=s(82259),ey=s(85365);let eN={Title:e=>{let{title:t,description:s,className:a,...n}=e;return(0,r.jsxs)("div",{className:(0,ex.cn)("flex flex-col",a),...n,children:[(0,r.jsx)("h2",{children:t}),s&&(0,r.jsx)("p",{className:"text-muted-foreground",children:s})]})},Entry:e=>{let{label:t,value:s}=e;return(0,r.jsxs)("div",{className:"flex flex-col gap-1 text-sm",children:[(0,r.jsx)("p",{className:"font-medium",children:t}),"string"==typeof s?(0,r.jsx)("p",{className:"text-muted-foreground",children:s}):s]})},Separator:ey.Separator};var ew=s(33353),e_=s(87161),ek=s(32870),eC=s(76332),eS=s(62369),eE=s(26195),eI=s(75748),eD=s(32282),eP=s(44647),eA=s(96659),ez=s(76816);let eL=e=>{let{visibility:t,setVisibility:s,redirectToSubscription:a=!1,workspacePlan:n,workspace:i,className:l,disabled:o,disabledTooltipContent:c}=e,d=(0,X.DM)({workspacePlan:n}),u=(0,X.dF)({workspacePlan:n}),{openSettings:m}=(0,ez.r)(),x=(0,et.z)($.g),h=(0,v.Z)("md");return(0,r.jsx)(eC.b,{showTooltip:!!(o&&c),tooltipContent:(0,r.jsx)("p",{children:c}),children:(0,r.jsxs)(ej.Ph,{value:t,onValueChange:e=>{"private"!==e||u?"draft"!==e||d?s(e):a?m("billing"):x({childProps:{dialogDescription:"You need to be on a business plan to make your project personal."}}):a?m("billing"):x({childProps:{dialogDescription:"You need to be on a pro plan to make your project private."}})},disabled:o,children:[(0,r.jsx)(ej.i4,{className:(0,ex.cn)("w-[180px] [&_.plan-badge]:hidden",l),children:(0,r.jsx)(ej.ki,{placeholder:"Select visibility",className:""})}),(0,r.jsxs)(ej.Bw,{align:h?"start":"end",children:[(0,r.jsx)(ej.Ql,{value:"public",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(j.Z,{name:"globe",size:"small"}),(0,r.jsx)("span",{children:"Public"})]})}),(0,r.jsx)(ej.Ql,{value:"private",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(j.Z,{name:"workspaces",size:"small"}),(0,r.jsx)("span",{children:"Workspace"}),i&&(0,r.jsx)(eE.y,{workspace:i,requiredPlanId:"pro",className:"plan-badge"})]})}),(0,r.jsx)(ej.Ql,{value:"draft",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(j.Z,{name:"draft",size:"small"}),(0,r.jsx)("span",{children:"Personal"}),i&&(0,r.jsx)(eE.y,{workspace:i,requiredPlanId:"biz",className:"plan-badge"})]})})]})]})})},eT=e=>{let{className:t,isAdmin:s}=e,a=(0,ec.hO)(e=>e.projectWorkspace),n=(null==a?void 0:a.plan)||null,l=(0,eh.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.visibility}),[o,c]=(0,i.useState)(void 0),{setVisibilityMutation:d}=(0,eh.d2)(),{disableChangeVisibility:u,disabledTooltipContent:m}=(0,i.useMemo)(()=>s?{disableChangeVisibility:!1,disabledTooltipContent:void 0}:{disableChangeVisibility:!0,disabledTooltipContent:"You need to be an admin to change the visibility of your project."},[s]);return(0,i.useEffect)(()=>{l&&c(l)},[l]),(0,r.jsx)(eL,{disabled:u||d.isPending,disabledTooltipContent:m,workspacePlan:n,workspace:a,visibility:o||l||void 0,setVisibility:e=>{c(e),d.mutateAsync(e)},className:t})},eO=e=>{var t;let{isPaidUser:s,className:a}=e,{setBadgeVisibility:n}=(0,eh.d2)(),l=(0,eh.iZ)(e=>e.project),o=(0,et.z)($.g),[c,d]=(0,i.useState)(null!==(t=null==l?void 0:l.hide_badge)&&void 0!==t&&t);return(0,r.jsx)(eS.r,{checked:c,onCheckedChange:e=>{if(!s){o({childProps:{dialogDescription:'You need to be on a pro plan to hide the "Edit with Lovable" badge.'}});return}n(e),d(e)},disabled:!1,className:(0,ex.cn)("",a)})};var eF=s(56166),eR=s(13273);let eM=e=>{let{projectId:t,initialFeatured:s,className:a}=e,[n,l]=(0,i.useState)(s),o=(0,eF.D)({mutationFn:e=>{let{featured:s}=e;return(0,h.SJ)().put("/projects/".concat(t,"/featured"),{featured:s})},onSuccess:(e,t)=>{let{featured:s}=t;l(s),Q.Am.success("Featured status updated",{description:"Project is now ".concat(s?"featured":"not featured",".")})},onError:e=>{(0,eR.Eo)(e)}});return(0,r.jsx)(eS.r,{disabled:o.isPending,checked:n,onCheckedChange:e=>{o.mutate({featured:e})},className:(0,ex.cn)("",a)})};var eZ=s(55717);let eU=e=>(null==e?void 0:e.seconds)?(0,I.WU)(new Date(1e3*e.seconds),"yyyy-MM-dd HH:mm:ss"):void 0;var eW=e=>{var t,s,a,n;let{projectId:l}=e,{isProjectAdmin:o,canEdit:c}=(0,eI.t)(),[d,u]=(0,i.useState)(!1),[m,x]=(0,i.useState)(!1),h=(0,eA.C)(),p=(0,ec.hO)(e=>e.projectWorkspace),g=(0,ec.hO)(e=>{var t;return(null===(t=e.projectWorkspace)||void 0===t?void 0:t.plan)||null}),j=(0,eh.iZ)(e=>e.project),{userData:v}=(0,X.SE)(),b=!!(null==j?void 0:j.is_supabase_enabled)||!!(null==j?void 0:j.supabase_project_config),y=c||!b,{updateProject:N,setIsRemixDialogOpen:w}=(0,eh.d2)(),_=(0,eg.NL)(),k=(0,eP.Qx)(null!=g?g:void 0)||(0,eP.gG)(null!=g?g:void 0),C=(0,et.z)($.g),S=async e=>{if(k){if((null==j?void 0:j.visibility)==="draft"&&e){Q.Am.error("Personal projects cannot be used as templates",{description:"Change the project visibility to Public or Workspace to use it as a template."});return}N({is_template:e},{onSuccess:()=>{_.invalidateQueries({queryKey:eD.E.templates((null==p?void 0:p.id)||"")})}})}else{C({childProps:{dialogDescription:"You need to be on a business plan to use templates."}});return}},E=(null==j?void 0:j.is_analytics_disabled)||!1,I=async e=>{N({is_analytics_disabled:e},{onSuccess:()=>{(0,eo.G)({projectId:l}).catch(e=>{console.error("Error updating deployment ID",e)})}})};(0,et.z)($.g);let D=(0,eb.Q)(e=>e.workspaces).length>1,P=(0,eP.XB)(null!=g?g:void 0);return(0,r.jsxs)("div",{className:"flex w-full flex-col gap-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-5",children:[(0,r.jsx)("p",{className:"col-span-full font-medium",children:"Overview"}),(0,r.jsx)(eN.Entry,{label:"Project name",value:null==j?void 0:j.name}),(0,r.jsx)(eN.Entry,{label:"Owner",value:(null==j?void 0:j.created_by)&&(0,r.jsxs)(J.default,{className:"break-words text-sm text-muted-foreground underline",target:"_blank",href:"/@".concat(j.created_by),children:["@",j.created_by]})}),(0,r.jsx)(eN.Entry,{label:"Created at",value:eU(null==j?void 0:j.created_at)}),(null==j?void 0:null===(t=j.creation_options)||void 0===t?void 0:t.tech_stack)&&(0,r.jsx)(eN.Entry,{label:"Tech stack",value:null==j?void 0:null===(s=j.creation_options)||void 0===s?void 0:s.tech_stack}),(0,r.jsx)(eN.Entry,{label:"Messages count",value:(null==j?void 0:null===(a=j.user_message_count)||void 0===a?void 0:a.toString())||"0"}),(0,r.jsx)(eN.Entry,{label:"AI Edits count",value:(null==j?void 0:null===(n=j.edit_count)||void 0===n?void 0:n.toString())||"0"})]}),(0,r.jsx)(eN.Separator,{}),(0,r.jsx)(es.P,{label:"Project Visibility",description:P?"Keep your project hidden and prevent others from remixing it.":(0,r.jsxs)("p",{children:[(0,r.jsx)(eZ.$,{})," to keep your project hidden and prevent others from remixing it."]}),mobileLayout:"vertical",justify:"end",customBadge:p&&(0,r.jsx)(eE.y,{workspace:p,requiredPlanId:"pro"}),children:(0,r.jsx)(eT,{isAdmin:o})}),j&&(0,r.jsx)(ev,{project:j,onCategoryChange:e=>N({category:e}),disabled:!c}),(0,r.jsx)(es.P,{label:'Hide "Lovable" Badge',description:P?'Remove the "Edit with Lovable" badge from your published work.':(0,r.jsxs)("p",{children:[(0,r.jsx)(eZ.$,{}),' to remove the "Edit with Lovable" badge from your published work.']}),mobileLayout:"horizontal",justify:"end",customBadge:p&&(0,r.jsx)(eE.y,{workspace:p,requiredPlanId:"pro"}),children:(0,r.jsx)(eO,{isPaidUser:P})}),j&&(null==v?void 0:v.is_admin)&&(0,r.jsx)(es.P,{label:"Feature Project",description:"Highlight this project on the homepage.",mobileLayout:"horizontal",justify:"end",children:(0,r.jsx)(eM,{projectId:l,initialFeatured:!!j.featured})}),k&&(0,r.jsx)(es.P,{label:"Use as a Template",description:(0,r.jsxs)("p",{children:["Use this project as a template in"," ",(0,r.jsx)("span",{className:"font-medium",children:(null==p?void 0:p.name)?p.name:"your workspace"})," ","to reference when starting new projects."]}),mobileLayout:"horizontal",justify:"end",customBadge:p&&(0,r.jsx)(eE.y,{workspace:p,requiredPlanId:"biz"}),children:(0,r.jsx)(eC.b,{showTooltip:(null==j?void 0:j.visibility)==="draft",tooltipContent:"Change project visibility to Public or Workspace to use it as a template.",delayDuration:0,children:(0,r.jsx)(eS.r,{checked:(null==j?void 0:j.is_template)||!1,onCheckedChange:S,disabled:(null==j?void 0:j.visibility)==="draft"})})}),j&&c&&(0,r.jsx)(es.P,{label:"Rename Project",description:"Update your project's title.",mobileLayout:"horizontal",justify:"end",children:(0,r.jsx)(f.z,{onClick:()=>u(!0),children:"Rename"})}),j&&(0,r.jsx)(es.P,{label:"Remix Project",description:"Duplicate this app in a new project.",mobileLayout:"horizontal",justify:"end",children:(0,r.jsxs)(f.z,{onClick:()=>w(!0),disabled:!y,children:["Remix",!y&&(0,r.jsx)("span",{className:"ml-2 text-xs text-muted-foreground",children:"Unavailable for projects connected to Supabase"})]})}),o&&D&&(0,r.jsx)(es.P,{label:"Transfer",description:"Move this project to a different workspace.",mobileLayout:"horizontal",justify:"end",children:(0,r.jsx)(ew.O,{projectId:l,currentWorkspaceId:null==j?void 0:j.workspace_id})}),j&&o&&(0,r.jsx)(es.P,{label:"Disable Analytics",description:"Disable collecting analytics data for this project.",mobileLayout:"horizontal",justify:"end",children:(0,r.jsx)(eS.r,{checked:E,onCheckedChange:I})}),j&&o&&(0,r.jsx)(es.P,{label:"Delete Project",description:"Permanently delete this project.",mobileLayout:"horizontal",justify:"end",children:(0,r.jsx)(f.z,{variant:"destructive",onClick:()=>x(!0),children:"Delete"})}),j&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ek.i,{project:j,isOpen:d,onClose:()=>u(!1)}),(0,r.jsx)(e_.p,{project:j,isOpen:m,onClose:()=>x(!1),hasActiveLock:h})]})]})},eG=s(30703),eK=s(71286),eB=s(94214),eq=s(14070),eH=s(27139);let eV=e=>{let{shouldScaleBackground:t=!0,...s}=e;return(0,r.jsx)(eH.dy.Root,{shouldScaleBackground:t,...s})};eV.displayName="Drawer",eH.dy.Trigger;let eJ=eH.dy.Portal;eH.dy.Close;let eY=i.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(eH.dy.Overlay,{ref:t,className:(0,ex.cn)("fixed inset-0 z-[10000] bg-black/80",s),...a})});eY.displayName=eH.dy.Overlay.displayName;let eQ=i.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(eJ,{children:[(0,r.jsx)(eY,{}),(0,r.jsxs)(eH.dy.Content,{ref:t,className:(0,ex.cn)("fixed inset-x-0 bottom-0 z-[10000] mt-24 flex h-auto flex-col rounded-t-[24px] border bg-background",s),...n,children:[(0,r.jsx)("div",{className:"mx-auto mt-4 h-1.5 w-[60px] rounded-full bg-muted"}),a]})]})});eQ.displayName="DrawerContent";let e$=i.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(eH.dy.Title,{ref:t,className:(0,ex.cn)("text-lg font-medium leading-none tracking-tight",s),...a})});e$.displayName=eH.dy.Title.displayName;let eX=i.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(eH.dy.Description,{ref:t,className:(0,ex.cn)("text-sm text-muted-foreground",s),...a})});eX.displayName=eH.dy.Description.displayName;let e0=e=>{let{children:t,open:s,onOpenChange:a}=e;return(0,v.Z)("md")?(0,r.jsx)(eV,{open:s,onOpenChange:a,children:(0,r.jsx)(e2,{children:t})}):(0,r.jsx)(eq.Vq,{open:s,onOpenChange:a,children:(0,r.jsx)(e1,{children:t})})},e1=e=>{let{children:t,className:s,...a}=e;return(0,r.jsxs)(eq.cZ,{hideCloseButton:!0,className:(0,ex.cn)("flex h-[90dvh] max-h-[800px] w-[95dvw] flex-1 flex-col items-start px-0 py-0",s),size:"2xl",...a,"aria-describedby":"Settings dialog",children:[(0,r.jsxs)(eB.TX,{children:[(0,r.jsx)(eq.Be,{children:"Settings dialog"}),(0,r.jsx)(eK.$N,{children:"Settings dialog"})]}),(0,r.jsx)(eK.GG,{asChild:!0,children:(0,r.jsx)(f.z,{variant:"ghost",size:"icon-sm",className:"absolute right-2 top-2 z-10 hover:bg-transparent hover:opacity-75",children:(0,r.jsx)(j.Z,{name:"close",size:"small"})})}),t]})},e2=e=>{let{children:t,className:s,...a}=e;return(0,r.jsxs)(eQ,{className:(0,ex.cn)("flex h-[90dvh] flex-col items-start px-0 py-0",s),...a,children:[(0,r.jsxs)(eB.TX,{children:[(0,r.jsx)(eX,{children:"Settings drawer"}),(0,r.jsx)(e$,{children:"Settings drawer"})]}),t]})};var e4=s(26047),e5=s(35127),e3=s(43115),e6=s(77658),e8=s(86338),e7=s(54494),e9=s(45178),te=s(25437);function tt(e){let{title:t,description:s,featureKey:a,checked:n}=e,{authUser:i}=(0,o.Eu)(),l=(0,e9.U0)(),c=(0,eg.NL)(),{mutate:d}=(0,eF.D)({mutationFn:async e=>{let t=(0,h.SJ)();return await t.patch("/users/".concat(null==i?void 0:i.uid,"/experimental-features"),{feature:a,enabled:e})},onMutate:e=>{c.cancelQueries({queryKey:te.V.experimentalFeatures({user:i}).queryKey});let t=c.getQueryData(te.V.experimentalFeatures({user:i}).queryKey);return c.setQueryData(te.V.experimentalFeatures({user:i}).queryKey,t=>t?{...t,[a]:e}:null),{previousFeatures:t}},onSuccess:(e,t)=>{l.capture("lab-feature-toggled",{feature:a,checked:n})},onError:(e,t,s)=>{c.setQueryData(te.V.experimentalFeatures({user:i}).queryKey,e=>{var t;return e?{...e,[a]:null==s?void 0:null===(t=s.previousFeatures)||void 0===t?void 0:t[a]}:null}),(0,eR.Eo)(e)}});return(0,r.jsx)(es.P,{label:t,description:s,mobileLayout:"horizontal",children:(0,r.jsx)(eS.r,{checked:n,onCheckedChange:d,disabled:!i,className:"ml-auto"})})}let ts=()=>{let{userData:e}=(0,X.SE)();return(0,eF.D)({mutationFn:async t=>(0,h.SJ)().put("/user/".concat(e.id),{suggestions_enabled:t}),onSuccess:(e,t)=>{Q.Am.success("Suggestions settings updated",{description:"Suggestions are now ".concat(t?"enabled":"disabled")})},onError:e=>{(0,eR.Eo)(e)}})},ta=()=>{let{userData:e}=(0,X.SE)(),t=ts(),s=(null==e?void 0:e.suggestions_enabled)===!0;return(0,r.jsx)(es.P,{label:"Chat Suggestions",description:"Show helpful suggestions in the chat interface to enhance your experience.",mobileLayout:"horizontal",isLast:!1,children:e?(0,r.jsx)(eS.r,{checked:s,onCheckedChange:e=>{t.mutate(e)},className:"ml-auto"}):(0,r.jsx)(W.O,{className:"h-5 w-9"})})},tn=()=>{let{isLoading:e,features:t}=(0,e7.G)(),s=(0,e5.so)(),a=(0,e5.fs)(),n=(0,e5.zq)(),i=(0,e5.aI)(),{isAgentModeDefault:l,setAgentMode:o}=(0,e8.v)();return(0,r.jsx)(u.tM,{value:"labs",title:"Labs",description:"These are experimental features, that might be modified or removed.",docsLink:"https://docs.lovable.dev/features/labs",children:e?(0,r.jsx)(W.O,{className:"h-10 w-full"}):(0,r.jsxs)(r.Fragment,{children:[n&&(0,r.jsx)(es.P,{label:"Legacy Mode",description:(0,r.jsxs)(r.Fragment,{children:["Disables advanced agent features and adaptive pricing."," ",(0,r.jsx)(J.default,{href:"https://lovable.dev/blog/agent",target:"_blank",className:"inline-flex items-center gap-1 underline hover:text-foreground",children:(0,r.jsx)("span",{children:"Learn more"})})]}),mobileLayout:"horizontal",children:(0,r.jsx)(eS.r,{checked:!l,onCheckedChange:e=>{o(!e)},className:"ml-auto"})}),(0,r.jsx)(tt,{title:"GitHub Branch Switching",description:"Select the branch to make edits to in your GitHub repository.",featureKey:"git_branch_switching",checked:!!(null==t?void 0:t.git_branch_switching)}),i&&(0,r.jsx)(ta,{}),s&&!a&&(0,r.jsx)(tt,{title:"Lovable Backend",description:(0,r.jsxs)("p",{children:["Build full-stack apps natively in Lovable — no Supabase account needed, everything runs inside Lovable. Try it by selecting"," ",(0,r.jsx)("span",{className:"font-medium",children:"Backend → Lovable (Labs)"})," ","when creating a project."]}),featureKey:"lovable_backend",checked:!!(null==t?void 0:t.lovable_backend)})]})})};var tr=s(99526),ti=s(54140),tl=s(92887);let to=e=>{var t;let{isInteractive:s=!1,className:a,authUser:n,userData:i,...l}=e,o=(0,tl.Q)(null==i?void 0:i.id),c=(null==i?void 0:null===(t=i.attributes)||void 0===t?void 0:t.display_name)||(null==n?void 0:n.email)||i.username;return(0,r.jsx)(ti.N,{name:c,isInteractive:s,photoSrc:void 0,userColor:o,className:a,...l})},tc=e=>{let{userData:t,authUser:s}=e;return(0,r.jsx)(es.P,{label:"Your Avatar",description:"Your avatar is automatically generated based on your account.",mobileLayout:"horizontal",children:(0,r.jsx)(to,{className:"ml-auto h-10 w-10 md:ml-0",userData:t,authUser:s})})};var td=s(3011);let tu=e=>{var t;let{authUser:s}=e;return(0,r.jsx)(es.P,{label:"Email",description:"Your email address associated with your account.",children:(0,r.jsx)(td.I,{value:null!==(t=null==s?void 0:s.email)&&void 0!==t?t:"",disabled:!0,className:"w-full",placeholder:"No email available"})})};var tm=s(72602),tx=s(96869),th=s(25243),tp=s(8782),tf=s(7815);let tg=th.Ry({display_name:th.Z_().optional(),bio:th.Z_().optional(),location:th.Z_().optional(),link:th.Z_().optional(),hide_profile_pictures:th.O7().optional()}),tj=e=>{var t,s,a,n,i,l,o,c,d,u;let{userData:m,avatarExists:x}=e,p=(0,tx.cI)({defaultValues:{display_name:null!==(l=null===(t=m.attributes)||void 0===t?void 0:t.display_name)&&void 0!==l?l:"",bio:null!==(o=null===(s=m.attributes)||void 0===s?void 0:s.bio)&&void 0!==o?o:"",location:null!==(c=null===(a=m.attributes)||void 0===a?void 0:a.location)&&void 0!==c?c:"",link:null!==(d=null===(n=m.attributes)||void 0===n?void 0:n.link)&&void 0!==d?d:"",hide_profile_pictures:null!==(u=null===(i=m.attributes)||void 0===i?void 0:i.hide_profile_pictures)&&void 0!==u&&u},resolver:(0,tm.F)(tg)}),g=(0,eg.NL)(),{mutate:j,isPending:v}=(0,eF.D)({mutationFn:async e=>(0,h.SJ)().put("/user/".concat(m.id),{attributes:e}),onSuccess:(e,t)=>{Q.Am.success("Success",{description:"Account settings updated successfully"}),p.reset(t),g.invalidateQueries({queryKey:eD.E.all})},onError:e=>{(0,eR.Eo)(e)}});return(0,r.jsx)(tf.l0,{...p,children:(0,r.jsxs)("form",{className:"flex w-full flex-col gap-6",onSubmit:p.handleSubmit(e=>{let t=p.formState.defaultValues,s=Object.keys(e).filter(s=>e[s]!==(null==t?void 0:t[s]));Y.ZP.capture(em.gg.SETTINGS_UPDATED,{changedFields:s,fieldsCount:s.length,hasDisplayName:!!e.display_name,hasBio:!!e.bio,hasLocation:!!e.location,hasLink:!!e.link,hideProfilePictures:!!e.hide_profile_pictures}),j(e)}),children:[(0,r.jsx)(es.P,{label:"Name",description:"Your full name, as visible to others.",children:(0,r.jsx)(tf.Wi,{control:p.control,name:"display_name",render:e=>{let{field:t}=e;return(0,r.jsxs)(tf.xJ,{className:"w-full",children:[(0,r.jsx)(tf.NI,{children:(0,r.jsx)(td.I,{...t})}),(0,r.jsx)(tf.zG,{})]})}})}),(0,r.jsx)(es.P,{label:"Description",description:"A short description of yourself or your work.",children:(0,r.jsx)(tf.Wi,{control:p.control,name:"bio",render:e=>{let{field:t}=e;return(0,r.jsxs)(tf.xJ,{className:"w-full",children:[(0,r.jsx)(tf.NI,{children:(0,r.jsx)(eu.g,{className:"resize-none border bg-background",rows:3,...t})}),(0,r.jsx)(tf.zG,{})]})}})}),(0,r.jsx)(es.P,{label:"Location",description:"Where you're based.",children:(0,r.jsx)(tf.Wi,{control:p.control,name:"location",render:e=>{let{field:t}=e;return(0,r.jsxs)(tf.xJ,{className:"w-full",children:[(0,r.jsx)(tf.NI,{children:(0,r.jsx)(td.I,{...t})}),(0,r.jsx)(tf.zG,{})]})}})}),(0,r.jsx)(es.P,{label:"Link",description:"Add a link to your personal website or portfolio.",children:(0,r.jsx)(tf.Wi,{control:p.control,name:"link",render:e=>{let{field:t}=e;return(0,r.jsxs)(tf.xJ,{className:"w-full",children:[(0,r.jsx)(tf.NI,{children:(0,r.jsx)(td.I,{...t})}),(0,r.jsx)(tf.zG,{})]})}})}),x&&(0,r.jsx)(es.P,{label:"Hide Profile Picture",mobileLayout:"horizontal",className:"last:border-b",children:(0,r.jsx)(tf.Wi,{control:p.control,name:"hide_profile_pictures",render:e=>{let{field:t}=e;return(0,r.jsxs)(tf.xJ,{className:"ml-auto flex flex-row items-center space-x-2 space-y-0",children:[(0,r.jsx)(tf.NI,{children:(0,r.jsx)(tp.X,{checked:t.value,onCheckedChange:t.onChange})}),(0,r.jsx)(tf.zG,{})]})}})}),p.formState.isDirty&&(0,r.jsxs)(es.j,{className:"justify-end gap-2",children:[(0,r.jsx)(f.z,{type:"button",variant:"secondary",onClick:()=>{Y.ZP.capture(em.gg.SETTINGS_CANCELLED),p.reset()},children:"Cancel"}),(0,r.jsx)(f.z,{type:"submit",loading:v,variant:"affirmative",children:"Update"})]})]})})},tv=th.Ry({username:th.Z_().min(3,{message:"Username must be at least 3 characters"}).max(16,{message:"Username must be at most 16 characters"}).regex(/^[a-z]/,{message:"Username must start with a letter"}).regex(/^[a-z0-9_]+$/,{message:"Username can only contain lowercase letters, numbers, and underscores"})}),tb=e=>{let t=(0,tx.cI)({resolver:(0,tm.F)(tv)}),s=(0,eF.D)({mutationFn:async e=>{let{username:t}=e;return(0,h.SJ)().put("/user/username",{username:t})},onSuccess:()=>{var t;Q.Am.success("Success",{description:"Username updated successfully"}),null===(t=e.onOpenChange)||void 0===t||t.call(e,!1)},onError:e=>{(0,eR.Eo)(e)}});return(0,r.jsx)(eq.Vq,{...e,children:(0,r.jsxs)(eq.cZ,{children:[(0,r.jsx)(eq.$N,{children:"Set Username"}),(0,r.jsx)(eq.Be,{children:"Please enter your desired username. You can not change your username once you have set it."}),(0,r.jsx)("form",{onSubmit:t.handleSubmit(e=>{s.mutate(e)}),children:(0,r.jsxs)(tf.l0,{...t,children:[(0,r.jsx)(tf.Wi,{control:t.control,name:"username",render:e=>{let{field:t}=e;return(0,r.jsxs)(tf.xJ,{className:"w-full",children:[(0,r.jsx)(tf.lX,{children:"Username"}),(0,r.jsx)(tf.NI,{children:(0,r.jsx)(td.I,{...t})}),(0,r.jsx)(tf.zG,{})]})}}),(0,r.jsx)(eq.cN,{className:"mt-4",children:(0,r.jsx)(f.z,{loading:s.isPending,type:"submit",children:"Save"})})]})})]})})},ty=e=>{let{username:t,userId:s}=e,[a,n]=(0,i.useState)(!1),l=!!s&&t===s;return(0,r.jsxs)(es.P,{label:"Username",description:"Your public identifier and profile URL.",children:[(0,r.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-start gap-2",children:(0,r.jsx)(td.I,{placeholder:"Username",className:"w-full",value:null!=t?t:"",disabled:!l,onClick:()=>{t&&n(!0)}})}),(0,r.jsxs)("p",{className:"flex items-center gap-1 break-all text-sm text-muted-foreground underline transition-colors duration-150 ease-in-out hover:text-muted-foreground/80",children:[t?(0,r.jsxs)(J.default,{className:"",href:"".concat(window.location.origin,"/@").concat(t),target:"_blank",rel:"noreferrer",children:["lovable.dev/@",t]}):"lovable.dev/@<username>",(0,r.jsx)(j.Z,{name:"arrow_outward",size:"small"})]})]}),(0,r.jsx)(tb,{open:a,onOpenChange:n})]})};var tN=s(29717);let tw=e=>{let{data:t={}}=(0,x.a)({...te.V.contributions({userData:e}),enabled:!!(null==e?void 0:e.username)});return new Map(Object.entries(t))};var t_=s(84183);let tk=Math.ceil(365/7),tC=e=>{let{}=e,{userData:t}=(0,X.SE)(),s=tw(t),a=(0,i.useMemo)(()=>{let e=new Date,t=[];for(let a=0;a<tk;a++){let n=[];for(let t=0;t<7;t++){let r=(0,tN.k)(e,(tk-a-1)*7+(7-t-1)),i=(0,I.WU)(r,"yyyy-MM-dd"),l=s.get(i)||0;n.push({date:r,count:l})}t.push(n)}return t},[s]),n=(0,i.useRef)(null),[l,o]=(0,i.useState)(!1),[c,d]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=()=>{let e=n.current;e&&(o(e.scrollLeft>0),d(e.scrollLeft+e.clientWidth<e.scrollWidth-1))},t=n.current;if(t)return t.scrollLeft=t.scrollWidth,o(t.scrollLeft>0),d(t.scrollWidth>t.clientWidth&&t.scrollLeft+t.clientWidth<t.scrollWidth-1),t.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{t.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[]);let u=(0,i.useMemo)(()=>Math.max(...Array.from(s.values()),0),[s]),m=(0,i.useMemo)(()=>e=>{if(0===e||0===u)return"bg-muted";let t=e/u;return t<=.25?"bg-muted-hover":t<=.5?"bg-muted-active":t<=.75?"bg-muted-foreground":"bg-foreground"},[u]);return(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("p",{className:"text-base font-medium",children:"Your Activity"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{ref:n,className:"overflow-x-auto pb-2",children:(0,r.jsx)("div",{className:"inline-block min-w-[600px] max-w-[760px] rounded-xl border border-input bg-card p-2",children:(0,r.jsx)("div",{className:"flex gap-[2px]",children:a.map((e,t)=>(0,r.jsx)("div",{className:"flex flex-col gap-[2px]",children:e.map((e,t)=>(0,r.jsxs)(t_.u,{children:[(0,r.jsx)(t_.aJ,{asChild:!0,children:(0,r.jsx)("div",{className:(0,ex.cn)("size-2.5 rounded-[2px] transition-colors duration-200",m(e.count))})}),(0,r.jsxs)(t_._v,{side:"top",align:"center",children:["".concat((0,I.WU)(e.date,"MMM d, yyyy"),": ").concat(e.count>0?e.count:"No"," activity"),(0,r.jsx)(t_.Ce,{})]})]},t))},t))})})}),l&&(0,r.jsx)("div",{className:"pointer-events-none absolute left-0 top-0 h-full w-6 bg-gradient-to-r from-background via-background/80 to-transparent"}),c&&(0,r.jsx)("div",{className:"pointer-events-none absolute right-0 top-0 h-full w-6 bg-gradient-to-l from-background via-background/80 to-transparent"})]})]})},tS=()=>{let{userData:e}=(0,X.SE)();return(0,eF.D)({mutationFn:async t=>{let s=(0,h.SJ)();return await s.put("/user/".concat(e.id),{sound_effect_active:t})},onSuccess:(e,t)=>{Q.Am.success("Sound effect settings updated",{description:"Sound effects will now play ".concat("firstgen"===t?"on first generation":"always"===t?"on all generations":"never")})},onError:e=>{(0,eR.Eo)(e)}})};var tE=s(30335),tI=s(65744);let tD=e=>{let{active:t,setActive:s,onClick:a,disabled:n}=e;return(0,r.jsxs)(tI.E,{className:"flex w-full flex-col gap-4",disabled:n,defaultValue:t,onValueChange:e=>{s(e)},children:[(0,r.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,r.jsx)(tI.m,{value:"firstgen",id:"firstgen",onClick:()=>{null==a||a()}}),(0,r.jsx)(tE.Label,{htmlFor:"firstgen",className:"flex w-full cursor-pointer flex-col gap-2",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,r.jsx)(j.Z,{size:"small",name:"stacked_line_chart",className:"text-muted-foreground"}),"First Generation"]})})]}),(0,r.jsxs)("div",{className:"flex w-full items-start space-x-2",children:[(0,r.jsx)(tI.m,{value:"always",id:"always",onClick:()=>{null==a||a()}}),(0,r.jsx)(tE.Label,{htmlFor:"always",className:"flex w-full cursor-pointer flex-col gap-2",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,r.jsx)(j.Z,{size:"small",name:"volume_up",className:"text-muted-foreground"}),"Always"]})})]}),(0,r.jsxs)("div",{className:"flex w-full items-start space-x-2",children:[(0,r.jsx)(tI.m,{value:"never",id:"never",onClick:()=>{null==a||a()}}),(0,r.jsx)(tE.Label,{htmlFor:"never",className:"flex w-full cursor-pointer flex-col gap-2",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,r.jsx)(j.Z,{size:"small",name:"volume_off",className:"text-muted-foreground"}),"Never"]})})]})]})},tP=()=>{var e;let{userData:t}=(0,X.SE)(),s=tS(),a=null!==(e=null==t?void 0:t.sound_effect_active)&&void 0!==e?e:"firstgen";return(0,r.jsx)(es.P,{label:"Generation complete sound",description:"Plays a satisfying sound notification when a generation is finished.",isLast:!0,children:t?(0,r.jsx)(tD,{active:a,setActive:e=>{s.mutate(e)}}):(0,r.jsx)(W.O,{className:"h-10 w-full"})})};var tA=()=>{var e;let{authUser:t}=(0,o.Eu)(),{userData:s}=(0,X.SE)(),a=null!==(e=(0,d.dl)(er.P.GithubContribution))&&void 0!==e&&e,n=(0,tr.useRouter)();return s?(0,r.jsxs)(u.tM,{value:"account",title:"Account Settings",description:"Personalize how others see and interact with you on Lovable.",children:[a&&(0,r.jsx)(tC,{}),(0,r.jsx)(tc,{userData:s,authUser:t}),(0,r.jsx)(ty,{userId:s.id,username:s.username}),(0,r.jsx)(tu,{authUser:t}),(0,r.jsx)(tj,{userData:s,avatarExists:!!(null==t?void 0:t.photoURL)}),(0,r.jsx)(tP,{}),(0,r.jsx)(es.P,{label:"Link SSO",description:"Connect your account to company SSO.",children:(0,r.jsx)(f.z,{variant:"outline",onClick:()=>n.push("/sso-login/"),children:"Link SSO"})}),(0,r.jsx)("div",{className:"mb-12"})]}):null},tz=s(94284),tL=s(34841),tT=s(42690);let tO=e=>{var t,s,a;let{userData:n}=(0,X.SE)(),r=null==n?void 0:null===(t=n.github)||void 0===t?void 0:t.encrypted_access_token,l=(0,i.useRef)(r),o=(0,x.a)(tT.t.workspaceGithubInstallations({workspaceId:e}));return(0,i.useEffect)(()=>{l.current!==r&&(o.refetch().catch(()=>{}),l.current=r)},[r,o]),{installations:null===(s=o.data)||void 0===s?void 0:s.installations,requiredAction:null===(a=o.data)||void 0===a?void 0:a.required_action}};var tF=s(54775);let tR=e=>{let{isLoading:t,hasAccessToken:s,hasValidAccessToken:a,githubUsername:n,onGithubConnected:l,isWorkspaceAdmin:o}=e;return(0,i.useEffect)(()=>{let e=e=>{"githubAppAuthenticated"===e.data&&l()};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[l]),(0,r.jsx)(es.P,{label:"Connected Account",description:"Add your GitHub account to manage connected organizations.",justify:"end",badges:["admin"],children:t?(0,r.jsx)(W.O,{className:"h-7 w-32"}):s&&a?(0,r.jsxs)(f.z,{disabled:!0,variant:"outline",size:"sm",children:[(0,r.jsx)(e6.xR.GitHub,{className:"h-4 w-4"}),null!=n?n:"Connected"]}):(0,r.jsx)(tM,{isWorkspaceAdmin:o})})},tM=e=>{let{isWorkspaceAdmin:t}=e;return(0,r.jsxs)(f.z,{variant:"default",size:"sm",onClick:tF.Hp,disabled:!t,children:[(0,r.jsx)(e6.xR.GitHub,{className:"h-4 w-4"}),"Connect GitHub"]})};var tZ=s(58915),tU=s(29306);function tW(e){let{projectId:t,main_branch:s,searchTerm:a,setSearchTerm:n,switchBranchMutation:l}=e,{data:o,isPending:c,error:d}=(0,x.a)({queryKey:eD.iZ.branches(t),queryFn:async()=>(0,h.SJ)().get("/projects/".concat(t,"/github/branches"))}),u=(0,i.useMemo)(()=>null==o?void 0:o.some(e=>e.name===s),[o,s]),{branchesWithCurrentFirst:m,filteredBranches:p}=(0,i.useMemo)(()=>{if(!o)return{branchesWithCurrentFirst:[],filteredBranches:[]};let e=o.filter(e=>e.name.toLowerCase().includes(a.toLowerCase())),t=e.find(e=>e.name===s);return t?{branchesWithCurrentFirst:[t,...e.filter(e=>e.name!==s)],filteredBranches:e}:{branchesWithCurrentFirst:e,filteredBranches:e}},[o,s,a]);return(0,r.jsxs)("div",{className:"relative flex flex-col gap-3 p-4",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,r.jsx)("h4",{children:"Switch or create branch"}),(0,r.jsx)(tZ.xp,{className:"absolute right-2 top-2",asChild:!0,children:(0,r.jsx)(f.z,{variant:"ghost",size:"icon-sm",children:(0,r.jsx)(j.Z,{name:"close",size:"small"})})})]}),(0,r.jsx)("div",{children:c?(0,r.jsx)(tU.T,{text:"Loading branches from GitHub..."}):d?(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-destructive-primary",children:[(0,r.jsx)(j.Z,{name:"warning_fill",size:"small"}),d.message]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"",children:(0,r.jsx)(td.I,{type:"text",placeholder:"Find or create a branch...",value:a,onChange:e=>n(e.target.value)})}),(0,r.jsxs)("div",{className:"branches-list flex max-h-[40vh] flex-col gap-2 overflow-y-auto pt-2",children:[m.map(e=>(0,r.jsxs)(f.z,{className:"branch-item flex w-full items-center justify-between px-3 text-left",onClick:()=>l.mutate(e.name),variant:e.name===s?"default":"ghost",disabled:l.isPending||e.name===s,loading:l.isPending&&l.variables===e.name,children:[(0,r.jsx)("span",{children:l.isPending&&l.variables===e.name?"Switching to "+e.name:e.name}),e.name===s&&(0,r.jsx)(j.Z,{name:"check"})]},e.name)),a&&!p.some(e=>e.name===a)&&(0,r.jsx)(eC.b,{showTooltip:!u,tooltipContent:"Your current branch does not exist on GitHub. Please switch to an existing branch first, then create your new branch.",children:(0,r.jsxs)(f.z,{className:(0,ex.cn)("h-auto w-full items-center justify-start"),onClick:()=>l.mutate(a),variant:"outline",disabled:l.isPending||!u,loading:l.isPending,children:[(0,r.jsx)(j.Z,{name:"add",className:"text-muted-foreground",size:"small"}),(0,r.jsxs)("p",{className:"text-wrap text-left",children:["Create branch ",(0,r.jsx)("strong",{children:a})," from"," ",(0,r.jsx)("strong",{children:s})]})]})})]})]})})]})}let tG=e=>{let{mainBranch:t,projectId:s}=e,[a,n]=(0,i.useState)(""),[l,o]=(0,i.useState)(!1),c=(0,eh.iZ)(e=>{var t;return(null===(t=e.project)||void 0===t?void 0:t.main_branch)||"main"}),d=(0,v.Z)("md"),u=(0,eg.NL)(),m=(0,eF.D)({mutationFn:async e=>{await (0,h.SJ)().post("/projects/".concat(s,"/github/branches"),{branch_name:e})},onSuccess:(e,t)=>{u.invalidateQueries({queryKey:eD.iZ.branches(s)}),Q.Am.success("Lovable is now using branch: ".concat(t)),n(""),o(!1)},onError:e=>{(0,eR.Eo)(e)}});return(0,r.jsx)(es.P,{label:"Branch",description:"Choose the GitHub branch you want to work on inside Lovable.",justify:"end",badges:["labs"],children:(0,r.jsxs)(tZ.J2,{open:l,onOpenChange:o,children:[(0,r.jsx)(tZ.xo,{asChild:!0,children:(0,r.jsxs)(f.z,{variant:"outline",size:"sm",loading:m.isPending,children:[(0,r.jsx)(j.Z,{name:"graph_1",className:"h-4 w-4"}),t,(0,r.jsx)(j.Z,{name:"chevron_right",size:"small",className:"rotate-90"})]})}),(0,r.jsx)(tZ.yk,{className:"p-0",align:d?"start":"end",children:(0,r.jsx)(tW,{projectId:s,main_branch:c,searchTerm:a,setSearchTerm:n,switchBranchMutation:m})})]})})};var tK=s(25938),tB=s(47684);let tq=e=>{let{label:t,value:s}=e;return(0,r.jsx)(tK.SP,{className:"rounded-none border-b border-transparent px-0 py-0.5 text-xs data-[state=active]:border-b-border data-[state=active]:font-medium data-[state=active]:shadow-none",value:s,children:t})},tH=e=>{let{url:t}=e,s=(0,i.forwardRef)((e,t)=>(0,r.jsx)(f.z,{ref:t,...e,variant:"ghost",className:"-mr-2 h-8 hover:text-primary",size:"icon-sm",children:(0,r.jsx)(j.Z,{name:"content_copy",className:"h-4 w-4"})}));s.displayName="TriggerComponent";let a=(0,tB.F)()({TriggerComponent:s,textToCopy:t});return(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(td.I,{className:"h-8 flex-1 p-2 font-mono text-muted-foreground focus:text-primary md:text-xs",value:t,onFocus:e=>e.target.select(),readOnly:!0}),(0,r.jsxs)(t_.u,{children:[(0,r.jsx)(t_.aJ,{children:a}),(0,r.jsx)(t_._v,{children:"Copy to clipboard"})]})]})},tV=e=>{var t,s;let{project:a}=e,n=(null==a?void 0:a.github_repo_name)?(0,tz.c_)(a.github_repo_name,null==a?void 0:null===(t=a.github_owner)||void 0===t?void 0:t.name):"#",i=(null==a?void 0:null===(s=a.github_owner)||void 0===s?void 0:s.name)+"/"+(null==a?void 0:a.github_repo_name);return(0,r.jsx)(es.P,{label:"Clone",description:"Copy this repository to your local environment.",justify:"end",children:(0,r.jsxs)(tK.mQ,{defaultValue:"https",className:"w-full pb-2",children:[(0,r.jsxs)(tK.dr,{className:"gap-2 px-0 pb-0 pt-0",children:[(0,r.jsx)(tq,{value:"https",label:"HTTPS"}),(0,r.jsx)(tq,{value:"ssh",label:"SSH"}),(null==a?void 0:a.is_github)&&(0,r.jsx)(tq,{value:"githubcli",label:"GitHub CLI"})]}),(0,r.jsx)(tK.nU,{value:"https",className:"mt-0",children:(0,r.jsx)(tH,{url:"".concat(n,".git")})}),(0,r.jsx)(tK.nU,{value:"ssh",className:"mt-0",children:(0,r.jsx)(tH,{url:"git@github.com:".concat(i,".git")})}),(0,r.jsx)(tK.nU,{value:"githubcli",className:"mt-0",children:(0,r.jsx)(tH,{url:"gh repo clone ".concat(i)})})]})})};var tJ=s(43487),tY=s(3415);let tQ=e=>{let t=(0,eg.NL)(),{mutate:s,isPending:a}=(0,eF.D)({mutationFn:async t=>{let{githubInstallation:s}=t,a=(0,h.SJ)();return await a.post("/workspaces/".concat(e,"/github-installations"),{github_installation_id:s.id})},onSuccess:async(s,a)=>{let n=eD.E.workspaceGithubInstallations(e),r=t.getQueryData(n);r&&t.setQueryData(n,{...r,installations:[...r.installations,a.githubInstallation]}),Q.Am.success("Added GitHub Organization",{description:"You can now transfer projects in this workspace to ".concat(a.githubInstallation.account.login)})},onError:e=>{(0,eR.Eo)(e)},onSettled:()=>{t.invalidateQueries({queryKey:eD.E.workspaceGithubInstallations(e)})}});return{addGithubTarget:s,isAddGithubTargetLoading:a}},t$=e=>{let t=(0,eg.NL)(),{mutate:s,isPending:a}=(0,eF.D)({mutationFn:async t=>{let{githubInstallation:s}=t;return(0,h.SJ)().delete("/workspaces/".concat(e,"/github-installations/").concat(s.id))},onSuccess:async(s,a)=>{let n=eD.E.workspaceGithubInstallations(e),r=t.getQueryData(n);r&&t.setQueryData(n,{...r,installations:r.installations.filter(e=>e.id!==a.githubInstallation.id)}),Q.Am.success("Removed GitHub Organization",{description:"You can no longer transfer projects in this workspace to ".concat(a.githubInstallation.account.login)})},onError:e=>{(0,eR.Eo)(e)},onSettled:()=>{t.invalidateQueries({queryKey:eD.E.workspaceGithubInstallations(e)})}});return{deleteGithubTarget:s,isDeleteGithubTargetLoading:a}},tX=e=>{let{setStep:t,installations:s,workspaceInstallations:a,workspace:n}=e,i=a.filter(e=>!s.some(t=>t.id===e.id)),{addGithubTarget:l,isAddGithubTargetLoading:o}=tQ(n.id),c=e=>{l({githubInstallation:e})},{deleteGithubTarget:d,isDeleteGithubTargetLoading:u}=t$(n.id),m=e=>{d({githubInstallation:e})},x=a.length>0;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tJ.Nj,{title:"Link your workspace to GitHub",description:"Anyone in your Lovable workspace can add Lovable projects to GitHub organizations.",badge:"admin"}),(0,r.jsx)(ey.Separator,{}),(0,r.jsxs)("div",{className:"grid min-h-[200px] grid-cols-1 gap-3 px-6 py-6 md:grid-cols-2",children:[(0,r.jsx)(tJ.NZ,{workspace:n}),(0,r.jsxs)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"GitHub Organizations"}),s.map(e=>{let t=a.find(t=>t.id===e.id);return(0,r.jsx)(t0,{installation:e,workspaceInstallation:t,addWorkspaceInstallation:c,disabled:o||u,deleteGithubTarget:m},e.id)}),i.length>0&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:"Other users have added the following organizations:"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"If unlinked, you can not add them back."}),(0,r.jsx)("div",{className:"flex flex-col gap-2",children:i.map(e=>(0,r.jsx)(t0,{installation:e,workspaceInstallation:e,addWorkspaceInstallation:c,disabled:o||u,deleteGithubTarget:m},e.id))})]})}),(0,r.jsx)(f.z,{variant:s.length>0?"outline":"default",size:"sm",onClick:()=>(0,tF.Mn)({githubOwner:null,workspaceId:n.id}),className:"mt-auto",children:"Add Organizations"})]})]}),(0,r.jsx)(ey.Separator,{}),(0,r.jsx)(tJ.Ff,{children:(0,r.jsx)(eC.b,{tooltipContent:"Please add and enable at least one organization to continue.",showTooltip:!x,className:"ml-auto",children:(0,r.jsx)(f.z,{disabled:!x,onClick:()=>t("transfer"),size:"sm",className:"ml-auto",children:"Continue"})})})]})},t0=e=>{let{installation:t,workspaceInstallation:s,addWorkspaceInstallation:a,disabled:n,deleteGithubTarget:i}=e,l=(null==s?void 0:s.id)===t.id;return(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(tY.qE,{className:"h-7 w-7 border",children:(0,r.jsx)(tY.F$,{src:t.account.avatar_url})}),(0,r.jsx)("span",{className:"font-medium",children:t.account.login})]}),(0,r.jsx)(eS.r,{disabled:n,onCheckedChange:e=>{e?a(t):i(t)},checked:l})]})};var t1=s(26052);let t2=e=>{let{setStep:t,installations:s,isTransferProjectLoading:a,isWorkspaceAdmin:n,onTransfer:i}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tJ.Nj,{title:"Connect Project",description:"Connect your project to your GitHub organization in a 2-way sync."}),(0,r.jsx)(ey.Separator,{}),(0,r.jsxs)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto px-6 py-6",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"GitHub Organizations"}),s.map(e=>(0,r.jsx)(t4,{installation:e,disabled:a||!n&&!!e.suspended_at,onTransfer:i,isWorkspaceAdmin:n,isLoading:a},e.account.login))]}),(0,r.jsx)(ey.Separator,{}),(0,r.jsx)(tJ.Ff,{children:(0,r.jsx)(f.z,{disabled:a,variant:"secondary",onClick:()=>t("organizations"),size:"sm",children:"Back"})})]})},t4=e=>{let{installation:t,disabled:s,onTransfer:a,isWorkspaceAdmin:n,isLoading:l}=e,[o,c]=(0,i.useState)(!1),d=l&&o;return(0,r.jsxs)("div",{className:"flex w-full items-center justify-start gap-2",children:[(0,r.jsx)(tY.qE,{className:"h-7 w-7 border",children:(0,r.jsx)(tY.F$,{src:t.account.avatar_url})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("p",{className:"truncate font-medium",children:t.account.login}),t.suspended_at&&(0,r.jsxs)(t_.u,{children:[(0,r.jsx)(t_.aJ,{asChild:!0,children:(0,r.jsx)("div",{className:"",children:(0,r.jsx)(t1.C,{className:"inline",variant:"destructive",children:"Suspended"})})}),(0,r.jsx)(t_._v,{children:n?(0,r.jsx)("p",{children:"This account is suspended. Reconnect to continue."}):(0,r.jsx)("p",{children:"This account is suspended. Talk to your workspace owner to reconnect."})})]})]}),(0,r.jsx)(f.z,{onClick:()=>{if(t.suspended_at){window.open(t.html_url,"_blank");return}a(t),c(!0)},disabled:s,className:"ml-auto",size:"sm",variant:t.suspended_at?"outline":"default",loading:d,children:t.suspended_at?"Reconnect":d?"Connecting":"Connect"})]},t.account.login)},t5=e=>{let{isTransferProjectLoading:t,installations:s,isWorkspaceAdmin:a,onTransfer:n,showConnectDialog:l,setShowConnectDialog:o,workspace:c}=e,{installations:d}=tO(c.id),[u,m]=(0,i.useState)("organizations");return(0,r.jsxs)(eq.Vq,{open:l,onOpenChange:e=>{e||m("organizations"),o(e)},children:[(0,r.jsx)(eq.hg,{asChild:!0,className:"hidden",children:(0,r.jsx)(f.z,{size:"sm",children:"Connect Project"})}),(0,r.jsx)(tJ.p4,{children:"organizations"===u?(0,r.jsx)(tX,{setStep:m,installations:null!=s?s:[],workspaceInstallations:null!=d?d:[],workspace:c}):(0,r.jsx)(t2,{setStep:m,installations:null!=d?d:[],isTransferProjectLoading:t,isWorkspaceAdmin:a,onTransfer:n})})]})};var t3=s(1080);let t6=e=>{let{isTransferProjectLoading:t,workspaceInstallations:s,onTransfer:a,isWorkspaceAdmin:n,setShowConnectDialog:l}=e,o=(0,v.Z)("md"),c=(0,eA.C)(),[d,u]=(0,i.useState)(!1),m=(null==s?void 0:s.length)===0,{disabled:x,disabledReason:h}=(0,i.useMemo)(()=>c?{disabled:!0,disabledReason:"Cannot transfer project while there is an active operation in progress."}:!n&&m?{disabled:!0,disabledReason:"Ask a workspace admin to add GitHub Organizations."}:{disabled:!1,disabledReason:null},[c,n,m]);return(0,r.jsxs)(g.h_,{open:d,onOpenChange:e=>{m?l(!0):u(e)},children:[(0,r.jsx)(eC.b,{showTooltip:x,tooltipContent:h,children:(0,r.jsx)(g.$F,{asChild:!0,children:(0,r.jsx)(f.z,{disabled:x,className:"justify-start",size:"sm",loading:t,children:t?"Connecting":(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e6.xR.GitHub,{className:"h-4 w-4"}),"Connect Project"]})})})}),(0,r.jsxs)(g.AW,{className:"min-w-[200px]",align:o?"start":"end",children:[(0,r.jsx)(g.Ju,{className:"text-xs font-medium text-muted-foreground",children:"GitHub Organizations"}),null==s?void 0:s.map(e=>(0,r.jsx)(t8,{installation:e,disabled:t||!n&&!!e.suspended_at,onTransfer:a,isWorkspaceAdmin:n},e.account.login)),(0,r.jsx)(eC.b,{showTooltip:!n,tooltipContent:"Only workspace admins can add organizations.",side:"left",instant:!0,children:(0,r.jsxs)(g.Xi,{disabled:!n,onClick:()=>l(!0),children:[(0,r.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full border bg-background",children:(0,r.jsx)(j.Z,{name:"add",size:"small"})}),m?"Add Organization":"Manage Organizations",(0,r.jsx)(t3.p,{badge:"admin",className:"flex md:hidden"})]})})]})]})},t8=e=>{let{installation:t,disabled:s,onTransfer:a,isWorkspaceAdmin:n}=e;return(0,r.jsx)(eC.b,{showTooltip:!!t.suspended_at,tooltipContent:n?"This account is suspended. Click to reconnect.":"This account is suspended. Talk to your workspace owner to reconnect.",side:"left",children:(0,r.jsxs)(g.Xi,{className:"flex w-full items-center justify-start gap-2",onClick:()=>{if(t.suspended_at){window.open(t.html_url,"_blank");return}a(t)},disabled:s,children:[(0,r.jsx)(tY.qE,{className:"h-6 w-6 border",children:(0,r.jsx)(tY.F$,{src:t.account.avatar_url})}),(0,r.jsx)("p",{className:"truncate text-sm font-medium",children:t.account.login}),t.suspended_at&&(0,r.jsx)(t1.C,{className:"inline",variant:"destructive",children:"Suspended"})]},t.account.login)})};var t7=s(77162);let t9=e=>{let t=(0,t7.D)(),{mutate:s,isPending:a}=(0,eF.D)({mutationFn:async e=>{let s={new_owner:{id:e.account.id,name:e.account.login,type:e.target_type}},a=(0,h.SJ)();return await a.post("/projects/".concat(t,"/github/transfer"),s)},onSuccess:async(t,s)=>{Q.Am.success("A GitHub Repository is now under your account ".concat(s.account.login),{description:t.new_repo_url,action:(0,r.jsx)(f.z,{size:"sm",asChild:!0,children:(0,r.jsx)("a",{target:"_blank",href:t.new_repo_url,children:"View"})}),duration:2e4}),null==e||e()},onError:e=>{(0,eR.Eo)(e)}});return{transferProject:s,isTransferProjectLoading:a}},se=e=>{let{isWorkspaceAdmin:t,workspace:s,showConnectDialog:a,setShowConnectDialog:n}=e,{transferProject:i,isTransferProjectLoading:l}=t9(()=>{n(!1)}),o=e=>{i(e)},{installations:c}=(0,tL.D)({enabled:null!=t&&t}),{installations:d}=tO(s.id);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t6,{isTransferProjectLoading:l,workspaceInstallations:null!=d?d:[],onTransfer:o,isWorkspaceAdmin:t,setShowConnectDialog:n}),(0,r.jsx)(t5,{installations:c,isTransferProjectLoading:l,isWorkspaceAdmin:t,onTransfer:o,setShowConnectDialog:n,showConnectDialog:a,workspace:s})]})};var st=s(63651);let ss=e=>{let{githubRepoName:t,workspace:s,isWorkspaceAdmin:a,showConnectDialog:n,setShowConnectDialog:i}=e;return t?(0,r.jsx)(es.P,{label:"Project",description:"Connect your project to your GitHub organization in a 2-way sync.",justify:"end",customBadge:(0,r.jsx)(st.H,{status:"connected"}),children:(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)(f.z,{asChild:!0,variant:"outline",size:"sm",children:(0,r.jsxs)(J.default,{href:"https://github.com/".concat(t),target:"_blank",rel:"noopener noreferrer",children:["View on GitHub",(0,r.jsx)(j.Z,{size:"small",name:"arrow_outward",className:"ml-auto"})]})})})}):(0,r.jsx)(es.P,{label:"Connect Project",description:"Connect your project to your GitHub organization in a 2-way sync.",justify:"end",customBadge:(0,r.jsx)(st.H,{status:"not-connected"}),children:(0,r.jsx)(se,{isWorkspaceAdmin:a,workspace:s,showConnectDialog:n,setShowConnectDialog:i})})},sa=e=>{let{workspace:t,isInsideEditor:s,myWorkspaceRole:a}=e,[n,l]=(0,i.useState)(!1);return(0,r.jsxs)(u.tM,{value:"github",title:"GitHub",description:"Sync your project 2-way with GitHub to collaborate at source.",docsLink:"https://docs.lovable.dev/integrations/git-integration",children:[s&&(0,r.jsx)(sr,{workspace:t,myWorkspaceRole:a,showConnectDialog:n,setShowConnectDialog:l}),(0,r.jsx)(sn,{myWorkspaceRole:a,setShowConnectDialog:l,isInsideEditor:s})]})},sn=e=>{var t,s;let{myWorkspaceRole:a,setShowConnectDialog:n,isInsideEditor:i}=e,l="admin"===a||"owner"===a,{hasValidAccessToken:o,isLoading:c}=(0,tL.D)({enabled:null!=l&&l}),{userData:d}=(0,X.SE)();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(tR,{isLoading:c||!d,hasAccessToken:!!(null==d?void 0:null===(t=d.github)||void 0===t?void 0:t.new_encrypted_access_token),githubUsername:null==d?void 0:null===(s=d.github)||void 0===s?void 0:s.username,hasValidAccessToken:null!=o&&o,onGithubConnected:()=>{i&&n(!0)},isWorkspaceAdmin:l})})};function sr(e){var t,s,a,n;let{workspace:i,myWorkspaceRole:l,showConnectDialog:o,setShowConnectDialog:c}=e,d=(0,eh.iZ)(e=>e.project),{installations:u}=tO(i.id),{userData:m}=(0,X.SE)(),x=null===(t=(0,e7.G)().features)||void 0===t?void 0:t.git_branch_switching;if(!d)return null;let h=(0,tz.gU)(d),p=(null==m?void 0:null===(s=m.github)||void 0===s?void 0:s.new_encrypted_access_token)!==null&&(null==m?void 0:null===(a=m.github)||void 0===a?void 0:a.new_encrypted_access_token)!==void 0;return(0,r.jsxs)(r.Fragment,{children:[(p||u&&(null==u?void 0:u.length)>0)&&(0,r.jsx)(ss,{isWorkspaceAdmin:!!("admin"===l||"owner"===l),workspace:i,githubRepoName:h&&(null==d?void 0:d.github_repo_name)&&(null===(n=d.github_owner)||void 0===n?void 0:n.name)?"".concat(d.github_owner.name,"/").concat(d.github_repo_name):void 0,showConnectDialog:o,setShowConnectDialog:c}),h&&(0,r.jsx)(tV,{project:d}),h&&x&&(0,r.jsx)(tG,{mainBranch:d.main_branch||"main",projectId:d.id})]})}var si=s(93386),sl=s(57602);let so=e=>{var t,s;let{workspace:a,open:n,onOpenChange:l,shouldRefreshAfterOAuth:o,onRefreshComplete:c}=e,[d,u]=(0,i.useState)(""),[m,x]=(0,i.useState)(""),[p,g]=(0,i.useState)(null),[v,b]=(0,i.useState)(!1),[y,N]=(0,i.useState)(!1),[w,_]=(0,i.useState)(""),[k,C]=(0,i.useState)(!1),[S,E]=(0,i.useState)(null),I=(0,eg.NL)(),D=(0,eF.D)({mutationFn:async e=>{let t=await (0,h.SJ)();return await t.post("/workspaces/".concat(a.id,"/integrations/mcp/test"),{...(null==e?void 0:e.serverId)?{server_id:e.serverId}:{url:m,...w&&{manual_token:w}}})},onSuccess:e=>{if(g(e),e.success){var t;Q.Am.success("Connected! Found ".concat((null===(t=e.tools)||void 0===t?void 0:t.length)||0," tools"))}else e.requires_oauth?Q.Am.info("This server requires OAuth authentication"):Q.Am.error(e.error||"Connection failed")},onError:e=>{var t,s,a,n;Q.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to test connection"),g({success:!1,error:(null===(n=e.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.error)||"Failed to test connection"})}}),P=(0,eF.D)({mutationFn:async()=>{let e=await (0,h.SJ)();if(k&&S)return console.log("[AddMCPServerDialog] OAuth server already created:",S.server_id),{alreadyCreated:!0};await e.post("/workspaces/".concat(a.id,"/integrations/connect"),{type:"mcp",name:d,url:m,...w&&{manual_token:w}})},onSuccess:()=>{I.invalidateQueries({queryKey:["mcp-servers",a.id]}),Q.Am.success("MCP server added successfully"),l(!1),u(""),x(""),g(null),_(""),N(!1),C(!1),E(null)},onError:e=>{var t,s;Q.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to add MCP server")}}),A=(0,eF.D)({mutationFn:async()=>{let e=await (0,h.SJ)();return await e.post("/workspaces/".concat(a.id,"/integrations/mcp/oauth/start"),{name:d,url:m,redirect_uri:"".concat(window.location.origin,"/mcp-callback")})},onSuccess:e=>{let t="".concat(window.location.origin,"/mcp-callback"),s={workspaceId:a.id,serverId:e.server_id,codeVerifier:e.code_verifier,redirectUri:t};E({server_id:e.server_id,name:d,url:m}),console.log("[OAuth Debug] Storing OAuth data in localStorage:",s),localStorage.setItem(si.G,JSON.stringify(s)),console.log("[OAuth Debug] Verified stored data:",localStorage.getItem(si.G)),console.log("[OAuth Debug] All localStorage keys:",Object.keys(localStorage)),console.log("[OAuth Debug] Opening OAuth window with URL:",e.authorization_url);let n=window.open(e.authorization_url,"_blank","width=600,height=700,left=200,top=100");n?n.focus():window.location.href=e.authorization_url,n&&setTimeout(()=>{n.closed&&console.error("[OAuth Debug] OAuth window closed within 1 second - possible redirect or error")},1e3)},onError:e=>{var t,s;Q.Am.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to start OAuth flow")}});(0,i.useEffect)(()=>{o&&S&&(console.log("[AddMCPServerDialog] Testing connection after OAuth success"),C(!0),D.mutate({serverId:S.server_id}),null==c||c())},[o,S,D,c]);let z=()=>{l(!1),setTimeout(()=>{u(""),x(""),g(null),b(!1),_(""),N(!1),C(!1),E(null)},200)};return(0,r.jsx)(eq.Vq,{open:n,onOpenChange:z,children:(0,r.jsx)(eq.cZ,{className:"sm:max-w-[525px]",children:(0,r.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!d.trim()||!m.trim()){Q.Am.error("Please fill in all fields");return}if(!(null==p?void 0:p.success)&&!k){Q.Am.error("Please test the connection first");return}P.mutate()},children:[(0,r.jsxs)(eq.fK,{children:[(0,r.jsx)(eq.$N,{children:"Add MCP Server"}),(0,r.jsx)(eq.Be,{children:"Connect to a remote MCP server to extend the AI's capabilities."})]}),(0,r.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(tE.Label,{htmlFor:"name",children:"Server Name"}),(0,r.jsx)(td.I,{id:"name",placeholder:"My MCP Server",value:d,onChange:e=>u(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(tE.Label,{htmlFor:"url",children:"Server URL"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(td.I,{id:"url",type:"url",placeholder:"https://mcp.example.com",value:m,onChange:e=>{x(e.target.value),g(null)},required:!0,className:"flex-1"}),(0,r.jsx)(f.z,{type:"button",variant:"secondary",onClick:()=>{if(!m.trim()){Q.Am.error("Please enter a URL");return}g(null),D.mutate(void 0)},disabled:D.isPending||!m.trim(),children:D.isPending?"Testing...":"Test"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(f.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>N(!y),className:"flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground",children:[(0,r.jsx)(j.Z,{name:y?"keyboard_arrow_up":"keyboard_arrow_down",className:"h-4 w-4"}),"Advanced Settings"]}),y&&(0,r.jsx)("div",{className:"grid gap-2 pl-6",children:(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(tE.Label,{htmlFor:"manual-token",children:"Bearer Token (Optional)"}),(0,r.jsx)(td.I,{id:"manual-token",type:"password",placeholder:"Enter Bearer token or API key",value:w,onChange:e=>{_(e.target.value),g(null)}}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Some MCP servers use API keys as Bearer tokens instead of OAuth. If your server requires a token, enter it here."})]})})]}),D.isPending&&(0,r.jsx)("div",{className:"rounded-lg border p-4",children:(0,r.jsx)(tU.T,{text:"Testing connection..."})}),p&&!D.isPending&&(0,r.jsxs)(sl.bZ,{className:(0,ex.cn)("transition-all",p.success||k?"border-green-600/20 bg-green-50/50 dark:bg-green-950/20":p.requires_oauth?"border-blue-600/20 bg-blue-50/50 dark:bg-blue-950/20":"border-destructive/20 bg-destructive/5"),children:[(0,r.jsx)(j.Z,{name:p.success||k?"check_circle":p.requires_oauth?"lock":"error",className:(0,ex.cn)("h-4 w-4",p.success||k?"text-green-600":p.requires_oauth?"text-blue-600":"text-destructive")}),(0,r.jsxs)(sl.X,{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex-1",children:p.success?k?"OAuth authenticated successfully! Found ".concat((null===(t=p.tools)||void 0===t?void 0:t.length)||0," tools"):"Connection successful! Found ".concat((null===(s=p.tools)||void 0===s?void 0:s.length)||0," tools"):p.requires_oauth?"This server requires OAuth authentication":p.error||"Connection failed"}),p.success&&p.tools&&p.tools.length>0&&!k&&(0,r.jsx)(f.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>b(!v),children:(0,r.jsx)(j.Z,{name:v?"keyboard_arrow_up":"keyboard_arrow_down",className:"h-4 w-4"})}),p.requires_oauth&&(0,r.jsx)(f.z,{type:"button",size:"sm",onClick:()=>{if(!d.trim()||!m.trim()){Q.Am.error("Please fill in server name and URL first");return}A.mutate()},disabled:A.isPending,children:A.isPending?"Starting...":"Authorize"})]})]}),(null==p?void 0:p.success)&&p.tools&&v&&!k&&(0,r.jsx)("div",{className:"max-h-[200px] overflow-y-auto rounded-lg border p-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("h4",{className:"mb-2 text-sm font-medium",children:["Available Tools (",p.tools.length,")"]}),p.tools.map((e,t)=>(0,r.jsxs)("div",{className:"border-l-2 border-muted py-1 pl-3",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:e.name}),e.description&&(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:e.description})]},t))]})})]}),(0,r.jsxs)(eq.cN,{children:[(0,r.jsx)(f.z,{type:"button",variant:"outline",onClick:z,children:"Cancel"}),(0,r.jsx)(f.z,{type:"submit",disabled:P.isPending||!(null==p?void 0:p.success)&&!k,children:P.isPending?"Adding...":"Add Server"})]})]})})})},sc=e=>{let{workspace:t,isWorkspaceAdmin:s,shouldRefresh:a,onRefreshComplete:n}=e,l=(0,eg.NL)(),[o,c]=(0,i.useState)(new Set);(0,i.useEffect)(()=>{a&&(l.invalidateQueries({queryKey:["mcp-servers",t.id]}),null==n||n())},[a,t.id,l,n]);let d=e=>{let t=new Set(o);t.has(e)?t.delete(e):t.add(e),c(t)},{data:u,isLoading:m}=(0,x.a)({queryKey:["mcp-servers",t.id],queryFn:async()=>{let e=await (0,h.SJ)();return(await e.get("/workspaces/".concat(t.id,"/integrations/mcp"))).servers||[]}}),p=(0,eF.D)({mutationFn:async e=>{let s=await (0,h.SJ)();await s.delete("/workspaces/".concat(t.id,"/integrations/mcp/").concat(e))},onSuccess:()=>{l.invalidateQueries({queryKey:["mcp-servers",t.id]}),Q.Am.success("MCP server removed successfully")},onError:()=>{Q.Am.error("Failed to remove MCP server")}});return m?(0,r.jsx)("div",{className:"flex justify-center py-8",children:(0,r.jsx)(tU.T,{text:"Loading MCP servers..."})}):u&&0!==u.length?(0,r.jsx)("div",{className:"space-y-4",children:u.map(e=>{let t=o.has(e.id),a=e.tools&&e.tools.length>0;return(0,r.jsxs)("div",{className:"overflow-hidden rounded-lg border",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,r.jsxs)("div",{className:"flex flex-1 items-center gap-3",children:[(0,r.jsx)(j.Z,{name:"cloud",className:"h-5 w-5 flex-shrink-0 text-muted-foreground"}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)("p",{className:"font-medium",children:e.name}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,r.jsx)("span",{className:"truncate",children:e.url}),a&&(0,r.jsxs)("span",{className:"flex-shrink-0",children:["• ",e.tools.length," tools"]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[a&&(0,r.jsx)(f.z,{variant:"ghost",size:"sm",onClick:()=>d(e.id),children:(0,r.jsx)(j.Z,{name:t?"keyboard_arrow_up":"keyboard_arrow_down",className:"h-4 w-4"})}),s&&(0,r.jsx)(f.z,{variant:"ghost",size:"sm",onClick:()=>p.mutate(e.id),disabled:p.isPending,children:(0,r.jsx)(j.Z,{name:"delete"})})]})]}),t&&a&&(0,r.jsx)("div",{className:"border-t bg-muted/30 px-4 py-3",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h5",{className:"mb-2 text-sm font-medium",children:"Available Tools"}),(0,r.jsx)("div",{className:"space-y-1",children:e.tools.map((e,t)=>(0,r.jsxs)("div",{className:"border-l-2 border-muted py-1 pl-3",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:e.name}),e.description&&(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:e.description})]},t))})]})})]},e.id)})}):(0,r.jsxs)("div",{className:"rounded-lg border border-dashed p-8 text-center",children:[(0,r.jsx)(j.Z,{name:"cloud",className:"mx-auto h-12 w-12 text-muted-foreground/50"}),(0,r.jsx)("h3",{className:"mt-4 text-sm font-medium",children:"No MCP servers connected"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Get started by adding your first MCP server connection."})]})},sd=e=>{let{workspace:t,isInsideEditor:s,myWorkspaceRole:a}=e,[n,l]=(0,i.useState)(!1),[o,c]=(0,i.useState)(!1),d="admin"===a||"owner"===a,m=(0,i.useCallback)(()=>{console.log("[MCPTab] OAuth success, dialog stays open to show tools"),c(!0)},[]);return(0,si.d)({workspaceId:t.id,onConnectSuccess:m}),(0,r.jsxs)(u.tM,{value:"mcp",title:"MCP",description:"Connect to Model Context Protocol servers for enhanced AI capabilities.",docsLink:"https://docs.lovable.dev/integrations/mcp",children:[(0,r.jsx)(so,{workspace:t,open:n,onOpenChange:l,shouldRefreshAfterOAuth:o,onRefreshComplete:()=>c(!1)}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"rounded-lg border p-6",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"MCP Servers"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Connect to remote MCP servers to extend the AI's capabilities with custom tools and integrations."})]}),d&&(0,r.jsx)(f.z,{onClick:()=>l(!0),className:"w-full sm:w-auto",children:"Add MCP Server"})]})}),(0,r.jsx)(sc,{workspace:t,isWorkspaceAdmin:d,shouldRefresh:o,onRefreshComplete:()=>c(!1)})]})]})},su=e=>{let{workspace:t,isInsideEditor:s,myWorkspaceRole:a,project:n}=e,[l,o]=(0,i.useState)([]),[c,d]=(0,i.useState)(!1),m=(0,eA.C)(),[x,p]=(0,i.useState)(!1),[g,v]=(0,i.useState)(null),[b,y]=(0,i.useState)({}),[N,w]=(0,i.useState)(""),[_,k]=(0,i.useState)("");(0,i.useEffect)(()=>{(null==n?void 0:n.id)&&C()},[null==n?void 0:n.id]);let C=async()=>{if(null==n?void 0:n.id){d(!0);try{let e=(0,h.SJ)(),t=(await e.get("/projects/".concat(n.id,"/integrations/memory"))||[]).sort((e,t)=>new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime());o(t)}catch(e){console.error("Failed to load memories:",e),Q.Am.error("Failed to load memories")}finally{d(!1)}}},S=async e=>{if(null==n?void 0:n.id)try{let t=(0,h.SJ)();await t.post("/projects/".concat(n.id,"/integrations/memory"),e);let s=e.sort((e,t)=>new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime());o(s),Q.Am.success("Memories updated successfully")}catch(e){throw console.error("Failed to save memories:",e),Q.Am.error("Failed to save memories"),e}},E=async()=>{if(!N||!_){Q.Am.error("Path and content are required");return}if(l.some(e=>e.path===N)){Q.Am.error("A memory with this path already exists");return}let e={path:N,content:_,updated_at:new Date().toISOString()};try{await S([...l,e]),w(""),k("")}catch(e){}},I=e=>{y({[e.path]:{path:e.path,content:e.content,originalPath:e.path,originalContent:e.content}})},D=e=>{let t=b[e];return!!t&&(t.path!==t.originalPath||t.content!==t.originalContent)},P=async e=>{let t=b[e];if(t){if(t.path!==e&&l.some(e=>e.path===t.path)){Q.Am.error("A memory with this path already exists");return}try{let s=l.map(s=>s.path===e?{path:t.path,content:t.content,updated_at:new Date().toISOString()}:s);await S(s);let a={...b};delete a[e],y(a)}catch(e){}}},A=e=>{let t={...b};delete t[e],y(t)},z=async()=>{if(g)try{let e=l.filter(e=>e.path!==g);await S(e),v(null),p(!1)}catch(e){}};return(0,r.jsx)(t_.pn,{children:(0,r.jsx)(u.tM,{value:"memory",title:"Memory",description:"Manage memory files that help Lovable remember important context about your project.",children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsxs)("div",{className:"flex w-full flex-col gap-0",children:[(0,r.jsx)(td.I,{placeholder:"Untitled Memory",value:N,onChange:e=>w(e.target.value),disabled:m,className:"h-10 rounded-b-none border-border font-medium placeholder:text-foreground/50 focus-visible:ring-0 focus-visible:ring-offset-0"}),(0,r.jsx)(eu.g,{placeholder:"Remember that...",className:"min-h-40 resize-none rounded-b-lg rounded-t-none border border-t-0 border-border bg-background p-3 font-mono text-[13px] placeholder:text-foreground/50 focus-visible:ring-0 focus-visible:ring-offset-0",value:_,onChange:e=>k(e.target.value),disabled:m})]}),(0,r.jsxs)(t_.u,{children:[(0,r.jsx)(t_.aJ,{asChild:!0,children:(0,r.jsx)("span",{className:"cursor-not-allowed",children:(0,r.jsx)(f.z,{size:"icon-sm",variant:"ghost",disabled:m||!N||!_,onClick:E,children:(0,r.jsx)(j.Z,{name:"add_2",size:"default"})})})}),(0,r.jsx)(t_._v,{children:m?"Wait for Lovable to finish working":"Add a title and content to save the memory"})]})]}),c?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)(j.Z,{name:"progress_activity",className:"h-6 w-6 animate-spin"}),(0,r.jsx)("span",{className:"ml-2",children:"Loading memories..."})]}):(0,r.jsx)(r.Fragment,{children:l.map(e=>{var t,s;let a=b[e.path],n=null!==(t=null==a?void 0:a.path)&&void 0!==t?t:e.path,i=null!==(s=null==a?void 0:a.content)&&void 0!==s?s:e.content;return(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsxs)("div",{className:"flex w-full flex-col gap-0",children:[(0,r.jsx)(td.I,{value:n,onChange:a?t=>y({...b,[e.path]:{...b[e.path],path:t.target.value}}):void 0,className:"h-10 rounded-b-none border-border font-medium placeholder:text-foreground/50 focus-visible:ring-0 focus-visible:ring-offset-0 ".concat(a?"":"cursor-text"),disabled:m,readOnly:!a,onClick:()=>!m&&!a&&I(e)}),(0,r.jsx)(eu.g,{value:i,onChange:a?t=>y({...b,[e.path]:{...b[e.path],content:t.target.value}}):void 0,className:"min-h-40 resize-none rounded-b-lg rounded-t-none border border-t-0 border-border bg-background p-3 font-mono text-[13px] placeholder:text-foreground/50 focus-visible:ring-0 focus-visible:ring-offset-0 ".concat(a?"":"cursor-text"),disabled:m,readOnly:!a,onClick:()=>!m&&!a&&I(e)})]}),a&&D(e.path)?(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)(t_.u,{children:[(0,r.jsx)(t_.aJ,{asChild:!0,children:(0,r.jsx)(f.z,{variant:"ghost",size:"icon-sm",onClick:()=>P(e.path),disabled:m,children:(0,r.jsx)(j.Z,{name:"check",size:"default"})})}),(0,r.jsx)(t_._v,{children:m?"Wait for Lovable to finish working":"Save changes"})]}),(0,r.jsxs)(t_.u,{children:[(0,r.jsx)(t_.aJ,{asChild:!0,children:(0,r.jsx)(f.z,{variant:"ghost",size:"icon-sm",onClick:()=>A(e.path),disabled:m,children:(0,r.jsx)(j.Z,{name:"close",size:"default"})})}),(0,r.jsx)(t_._v,{children:m?"Wait for Lovable to finish working":"Discard changes"})]})]}):(0,r.jsxs)(t_.u,{children:[(0,r.jsx)(t_.aJ,{asChild:!0,children:(0,r.jsx)(f.z,{variant:"ghost",size:"icon-sm",onClick:()=>{v(e.path),p(!0)},disabled:m,children:(0,r.jsx)(j.Z,{name:"delete",size:"default"})})}),(0,r.jsx)(t_._v,{children:m?"Can't delete memories while Lovable is working":"Delete memory"})]})]},e.path)})}),(0,r.jsx)(eq.Vq,{open:x,onOpenChange:p,children:(0,r.jsxs)(eq.cZ,{children:[(0,r.jsxs)(eq.fK,{children:[(0,r.jsx)(eq.$N,{children:"Delete Memory"}),(0,r.jsxs)(eq.Be,{children:['Are you sure you want to delete "',g,'"? This action cannot be undone.']})]}),(0,r.jsxs)(eq.cN,{children:[(0,r.jsx)(f.z,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),(0,r.jsx)(f.z,{variant:"destructive",onClick:z,children:"Delete"})]})]})})]})})})};var sm=s(19227),sx=s(5449),sh=s(20018),sp=s(40248),sf=s(45614),sg=s(72954),sj=s(5620),sv=s(89927);let sb=i.forwardRef((e,t)=>{let{className:s,value:a,...n}=e;return(0,r.jsx)(sv.fC,{ref:t,className:(0,ex.cn)("relative h-4 w-full overflow-hidden rounded-full bg-muted-active",s),...n,children:(0,r.jsx)(sv.z$,{className:"h-full w-full flex-1 bg-brand-twilight-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});sb.displayName=sv.fC.displayName;var sy=s(61504),sN=s(33864);let sw=e=>{let{workspace:t,myWorkspaceRole:s}=e,{billingPeriodCreditLimit:a,billingPeriodCreditsUsed:n,dailyCreditLimit:i,dailyCreditsUsed:l,rolloverCredits:o,billingPeriodEndDate:c}=(0,sy.O)(t),d=t.plan,u=(0,eP.fA)(d),m="ambassador"===d,x=(0,eP.XB)(d),h=(u||m)&&0===t.billing_period_credits_limit,p=h?null!=l?l:0:null!=n?n:0,f=h?null!=i?i:0:null!=a?a:0,g=(0,eP.Iw)(d),j=(0,sg.oW)({id:d,type:"monthly"});return x?(0,r.jsxs)(sj.Zb,{className:"flex w-full flex-col gap-4 bg-muted p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"font-medium text-foreground",children:"Credits"}),(0,r.jsx)("span",{className:"text-sm font-medium text-foreground",children:(0,sN.u)(p,f)})]}),(0,r.jsx)(sb,{value:p/f*100,className:"h-[11px] w-full"}),void 0!==o&&o>0&&(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,sN.H)(o)," rollover credits available"]}),("admin"===s||"owner"===s)&&(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[u?(0,r.jsxs)(r.Fragment,{children:["You're currently on a legacy plan:"," ",(0,r.jsx)("span",{className:"font-medium capitalize",children:g})," ","charged at $",j,"/mo. You're welcome to stay on this plan — but if you're curious to explore our new plans, you'll get 20% off for the first 3 months."," ",(0,r.jsx)(s_,{workspace:t,children:"Manage your payment preferences"}),", or change to one of our new plans below."]}):(0,r.jsxs)(r.Fragment,{children:["You're currently subscribed to plan:"," ",(0,r.jsx)("span",{className:"font-medium capitalize",children:g})," ","charged at $",j,"/mo."," ",(0,r.jsx)(s_,{workspace:t,children:"Manage your payment preferences"}),", or change your plan below."]})," ",!h&&(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:c?"Your monthly credits will renew on ".concat((0,I.WU)(c,"MMMM d")," at ").concat((0,I.WU)(c,"HH:mm"),"."):"Your credits will renew each month (at midnight UTC)."})]})]}):"inactive"!==d?(0,r.jsx)(sj.Zb,{className:"flex w-full flex-col gap-4 bg-muted p-4",children:(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,r.jsxs)("span",{children:["You're currently on plan:"," ",(0,r.jsx)("span",{className:"font-medium capitalize",children:g}),". "]})," ",(0,r.jsx)(s_,{workspace:t,children:"Manage your payment preferences and view past invoices"}),", or change your plan below."]})}):void 0},s_=e=>{let{workspace:t,children:s}=e,{createPortalSession:a,isCreatePortalSessionLoading:n}=(0,sf.m)();return(0,r.jsx)("span",{role:"button",tabIndex:0,onClick:()=>{n||a({workspaceId:t.id})},onKeyDown:e=>{n||"Enter"!==e.key&&" "!==e.key||a({workspaceId:t.id})},className:"inline cursor-pointer underline disabled:opacity-50","aria-disabled":n,children:s})},sk=[{value:"technical_issues",label:"I am having too many technical issues"},{value:"too_expensive",label:"It's too expensive"},{value:"not_using",label:"I'm not using Lovable enough"},{value:"missing_features",label:"It's missing features"},{value:"switched_to_competitor",label:"I switched to a competitor"},{value:"other",label:"Other reason"}],sC=[{id:"custom-domains",name:"Custom domains",description:"Connect your own domain to your projects",icon:"link"},{id:"team-collab",name:"Team collaboration",description:"Invite team members to work together",icon:"group"},{id:"visual-editor",name:"Visual editor",description:"Edit the frontend of your project instantly",icon:"draw"},{id:"code-editor",name:"Code editor",description:"Edit the backend of your project in code",icon:"code"},{id:"chat-mode",name:"Chat mode",description:"Plan your next step with AI",icon:"chat"},{id:"security-checks",name:"Security checks",description:"Run checks when publishing with Supabase to find and fix vulnerabilities",icon:"security"}];var sS=s(84492);(a=n||(n={})).SUGGEST_LOWER_PLAN="SUGGEST_LOWER_PLAN",a.FEATURES_TO_TRY="FEATURES_TO_TRY",a.KTLO_OFFER="KTLO_OFFER",a.FEEDBACK="FEEDBACK",a.FINAL_CONFIRMATION="FINAL_CONFIRMATION";let sE=(0,i.createContext)(void 0),sI=e=>{var t;let{children:s,targetPlan:a,onCancel:l,workspace:o}=e,c=(0,e5.f7)(),d=o.plan!==sS.It.KTLO&&c&&(null==a?void 0:a.id)===eP.tJ.FREE,u=(0,e5.$d)(),m=(0,i.useMemo)(()=>u?(null==a?void 0:a.id)!==eP.tJ.FREE||o.plan.endsWith("_1")?n.FEATURES_TO_TRY:n.SUGGEST_LOWER_PLAN:n.FEATURES_TO_TRY,[a,o.plan,u]),[x,h]=(0,i.useState)(m),[p,f]=(0,i.useState)({reason:""}),[g,j]=(0,i.useState)(!1),v=(0,sh.tS)(),{toCheckout:b}=(0,sf.m)(),y=async e=>{j(!0);let t=null!=e?e:a;(null==o?void 0:o.id)&&(t&&t.id!==eP.tJ.FREE?await b({plan:t,workspaceId:o.id,grandfatheredDiscount:!1,planType:v.planType,changeType:"downgrade"}):await v.createPortalSession())},N=async()=>{j(!0);try{(null==o?void 0:o.id)&&await b({plan:sg.Ds,workspaceId:o.id,grandfatheredDiscount:!1,planType:"monthly",changeType:"upgrade"})}catch(e){console.error("Error switching to KTLO plan:",e),j(!1)}},w={currentStep:x,feedback:p,currentPlan:o.plan,targetPlan:null!==(t=null==a?void 0:a.id)&&void 0!==t?t:eP.tJ.FREE,shouldShowKtloOffer:d,setCurrentStep:h,setFeedback:f,onCancel:l,onConfirm:y,onSwitchToKtlo:N,isLoading:g,getNextStepAfterSuggestLowerPlan:()=>n.FEATURES_TO_TRY,getNextStepAfterFeatures:()=>d?n.KTLO_OFFER:n.FEEDBACK,getNextStepAfterKtlo:()=>n.FEEDBACK,getNextStepAfterFeedback:()=>n.FINAL_CONFIRMATION,getPreviousStepBeforeFeedback:()=>d?n.KTLO_OFFER:n.FEATURES_TO_TRY,getPreviousStepBeforeFinalConfirmation:()=>n.FEEDBACK};return(0,r.jsx)(sE.Provider,{value:w,children:s})},sD=()=>{let e=(0,i.useContext)(sE);if(void 0===e)throw Error("useDowngrade must be used within a DowngradeProvider");return e},sP=()=>{let{onCancel:e,setCurrentStep:t,getNextStepAfterFeatures:s}=sD();return(0,r.jsx)(sj.Zb,{className:"bg-muted p-4 md:p-6",children:(0,r.jsxs)("div",{className:"flex flex-col md:gap-6",children:[(0,r.jsx)("div",{className:"flex flex-col gap-3 md:gap-4",children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(tE.Label,{className:"text-lg md:text-xl",children:"Have you tried these features yet?"}),(0,r.jsx)("div",{className:"flex flex-col gap-1.5 md:gap-2",children:sC.map(e=>(0,r.jsxs)("div",{className:"flex items-start gap-3 rounded-lg px-2 py-2 transition-colors md:gap-4 md:px-3",children:[(0,r.jsx)("span",{className:"mt-1.5 select-none text-base md:mt-2 md:text-lg",children:"•"}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-0.5",children:[(0,r.jsx)(tE.Label,{htmlFor:e.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.id))})]})}),(0,r.jsxs)("div",{className:"flex flex-col justify-end gap-3 sm:flex-row",children:[(0,r.jsx)(f.z,{variant:"outline",onClick:()=>{Y.ZP.capture(em.f8.FEATURE_USAGE.KEEP_PLAN_CLICKED),e()},className:"w-full sm:w-auto",children:"Keep Current Plan"}),(0,r.jsx)(f.z,{onClick:()=>{Y.ZP.capture(em.f8.FEATURE_USAGE.CONTINUE_CLICKED),t(s())},className:"w-full sm:w-auto",children:"Continue Downgrading"})]})]})})},sA=()=>{var e;let{feedback:t,setFeedback:s,setCurrentStep:a,getPreviousStepBeforeFeedback:i}=sD();return(0,r.jsx)(sj.Zb,{className:"bg-muted p-6",children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,r.jsx)(tE.Label,{className:"text-2xl",children:"Why are you downgrading?"}),(0,r.jsx)(tI.E,{value:t.reason,onValueChange:e=>s({...t,reason:e}),className:"flex flex-col gap-1",children:sk.map(e=>(0,r.jsxs)("div",{className:(0,ex.cn)("flex items-center gap-4 rounded-lg px-3 py-3","cursor-pointer transition-colors",t.reason===e.value?"bg-primary/5":"hover:bg-muted/50"),onClick:()=>s({...t,reason:e.value}),children:[(0,r.jsx)(tI.m,{value:e.value,id:e.value}),(0,r.jsx)("div",{className:"flex flex-1 flex-col gap-0.5",children:(0,r.jsx)(tE.Label,{htmlFor:e.value,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.label})})]},e.value))})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,r.jsx)(tE.Label,{htmlFor:"additional-feedback",className:"text-base",children:"Additional feedback (optional)"}),(0,r.jsx)(eu.g,{id:"additional-feedback",placeholder:"Tell us more about your decision...",value:t.additionalNotes,onChange:e=>s({...t,additionalNotes:e.target.value}),maxLength:500,className:"min-h-[80px] resize-none border-muted-foreground/20 bg-background placeholder:text-muted-foreground/50 focus:border-primary focus:ring-1 focus:ring-primary"}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null===(e=t.additionalNotes)||void 0===e?void 0:e.length)||0,"/500 characters"]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3 pt-1",children:[(0,r.jsx)(f.z,{variant:"outline",onClick:()=>{a(i())},children:"Back"}),(0,r.jsx)(f.z,{variant:"default",onClick:()=>{Y.ZP.capture(em.f8.FEEDBACK.CONTINUE_CLICKED,{reason:t.reason,has_additional_notes:!!t.additionalNotes,additional_notes:t.additionalNotes||""}),a(n.FINAL_CONFIRMATION)},children:"Continue"})]})]})})};var sz=s(35067);let sL=(e,t)=>{var s,a;let n=(0,eP.Ll)(e),r=(0,eP.Ll)(t),i=null!==(s=(0,sg.z_)(e))&&void 0!==s?s:0,l=null!==(a=(0,sg.z_)(t))&&void 0!==a?a:0;if("pro"===n){if("pro"===r)return["Credits will decrease from ".concat(i," to ").concat(l," per month"),"Credit rollover maximum will be adjusted to the new plan","Same pro features will be maintained at a lower tier"];if("free"===r)return["All new projects will be public","A Lovable badge will be added to all new projects","You will lose team management features","Custom domains will be removed","Credits will reset to 5 per day","No credit rollovers"]}if("biz"===n){if("biz"===r)return["Credits will decrease from ".concat(i," to ").concat(l," per month"),"Credit rollover maximum will be adjusted to the new plan","Same business features will be maintained at a lower tier"];if("pro"===r)return["No SSO","No design templates","No data opt out","No personal projects"];if("free"===r)return["No SSO","No design templates","No data opt out","No personal projects","All new projects will be public","A Lovable badge will be added to all new projects","You will lose team management features","Custom domains will be removed","Credits will reset to 5 per day","No credit rollovers"]}return"ktlo"===r?["Credits will change from ".concat(i," per month to freemium (5 per day, up to 30 per month)"),"No credit rollovers","You keep: Pro features: Private Projects, No Lovable Badge, Roles and Permissions, Custom Domains"]:[]},sT=th.Ry({reason:th.Z_().optional(),additional_notes:th.Z_().max(500,"Additional notes must be less than 500 characters").optional()}),sO=()=>{let{currentPlan:e,targetPlan:t,onConfirm:s,isLoading:a,setCurrentStep:n,feedback:i,getPreviousStepBeforeFinalConfirmation:l}=sD(),o=(0,h.SJ)(),c=(0,eF.D)({mutationFn:async()=>{let e=sT.parse({reason:i.reason,additional_notes:i.additionalNotes});await o.post("/user/cancellation",e),await s()},onSuccess:()=>{Y.ZP.capture(em.f8.FINAL_CONFIRMATION.CONFIRM_CLICKED,{from_plan:e,to_plan:t})},onError:e=>{if(en.logging.error("Error submitting feedback:",e),e instanceof sz.jm){let t=e.errors[0];Q.Am.error("Validation Error",{description:t.message})}else{var t;Q.Am.error("Error",{description:(null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to submit feedback"})}}}),d=sL(e,t);return(0,r.jsx)(sj.Zb,{className:"bg-muted",children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 text-amber-500",children:[(0,r.jsx)(j.Z,{name:"warning_fill",size:"small"}),(0,r.jsx)("h2",{className:"text-lg font-medium",children:"Confirm Plan Downgrade"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"mb-4 text-muted-foreground",children:d.length>0?"By downgrading to the ".concat((0,eP.Ll)(t)," plan, you will lose access to the following features:"):"By downgrading to the ".concat((0,eP.Ll)(t)," plan, you will lose access to some features of your current plan.")}),d.length>0&&(0,r.jsx)("ul",{className:"list-disc space-y-2 pl-6",children:d.map((e,t)=>(0,r.jsx)("li",{className:"text-foreground",children:e},t))})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,r.jsx)(f.z,{variant:"outline",onClick:()=>{n(l())},children:"Back"}),(0,r.jsx)(f.z,{variant:"destructive",onClick:()=>{c.mutate()},disabled:c.isPending||a,children:c.isPending||a?"Processing...":"Confirm Downgrade"})]})]})})};var sF=s(37298);let sR=()=>{let{setCurrentStep:e,feedback:t,onSwitchToKtlo:s,isLoading:a,getNextStepAfterKtlo:i}=sD(),l=async()=>{Y.ZP.capture(em.f8.KTLO_OFFER.SWITCH_CLICKED,{reason:t.reason}),await s()};return(0,r.jsxs)(sj.Zb,{className:"border-border bg-muted",children:[(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-8 lg:flex-row lg:gap-12",children:[(0,r.jsxs)("div",{className:"flex max-w-md flex-col justify-center",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h2",{className:"mb-3 text-3xl font-medium text-foreground",children:"Switch to Lite"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Try our new Lite plan and retain important features that keep your project going."})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("p",{className:"mb-2 font-medium text-foreground",children:"What's included:"}),(0,r.jsx)("ul",{className:"flex flex-col gap-2",children:["5 daily credits up to a maximum of 30 per month","Keep custom domains","No Lovable badge","Team settings stay in place","Access to private projects"].map((e,t)=>(0,r.jsxs)("li",{className:"flex items-center gap-3",children:[(0,r.jsx)(j.Z,{name:"check",size:"small",className:"flex-shrink-0 text-success-primary"}),(0,r.jsx)("span",{className:"text-foreground",children:e})]},t))})]}),(0,r.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,r.jsx)("span",{className:"text-5xl font-medium text-foreground",children:"$15"}),(0,r.jsx)("span",{className:"text-lg text-muted-foreground",children:"/month"})]})]}),(0,r.jsx)("div",{className:"flex w-full flex-1 items-center justify-center",children:(0,r.jsx)("div",{className:"h-full max-h-80 w-full max-w-lg overflow-hidden rounded-2xl lg:max-h-96",children:(0,r.jsx)(sF.default,{src:"/img/lovable-lite.webp",alt:"Lite Plan",className:"h-full w-full object-cover",width:500,height:400})})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:justify-between",children:[(0,r.jsx)(f.z,{variant:"outline",onClick:()=>{e(n.FEATURES_TO_TRY)},children:"Back"}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row",children:[(0,r.jsx)(f.z,{variant:"outline",onClick:()=>{Y.ZP.capture(em.f8.KTLO_OFFER.CONTINUE_DOWNGRADE_CLICKED,{reason:t.reason}),e(i())},children:"No, thank you"}),(0,r.jsx)(f.z,{onClick:l,disabled:a,className:"bg-foreground text-background hover:bg-foreground/90",children:a?"Switching...":"Switch to Lite"})]})]})]})},sM=()=>{let{currentStep:e}=sD();switch(e){case n.FEATURES_TO_TRY:return(0,r.jsx)(sP,{});case n.KTLO_OFFER:return(0,r.jsx)(sR,{});case n.FEEDBACK:return(0,r.jsx)(sA,{});case n.FINAL_CONFIRMATION:return(0,r.jsx)(sO,{});default:return null}};sM.displayName="DowngradeContent";let sZ=e=>{let{targetPlan:t,onCancel:s,workspace:a}=e;return(0,r.jsx)(sI,{targetPlan:t,onCancel:s,workspace:a,children:(0,r.jsx)(sM,{})})},sU=e=>{let{title:t,description:s}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-start gap-4",children:[(0,r.jsx)(e6.xx,{className:"h-9"}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(eq.$N,{className:"text-2xl font-medium md:text-3xl",children:t}),s&&(0,r.jsx)(eq.Be,{className:"text-base text-muted-foreground",children:s})]})]})},sW=()=>{let e=sD();return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,r.jsx)(sU,{title:"Why are you canceling?",description:"We use this information to improve our product."}),(0,r.jsx)(tI.E,{value:e.feedback.reason,onValueChange:t=>e.setFeedback({...e.feedback,reason:t}),className:"flex flex-col gap-1",children:sk.map(t=>(0,r.jsxs)("div",{className:(0,ex.cn)("flex cursor-pointer items-center gap-3 rounded-lg px-4 py-3 transition-colors",e.feedback.reason===t.value?"bg-primary/5":"hover:bg-muted/50"),onClick:()=>e.setFeedback({...e.feedback,reason:t.value}),children:[(0,r.jsx)(tI.m,{value:t.value,id:t.value}),(0,r.jsx)(tE.Label,{htmlFor:t.value,className:"text-base font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:t.label})]},t.value))}),(0,r.jsx)(td.I,{placeholder:"Tell us more about your decision...",className:"h-12",maxLength:500,value:e.feedback.additionalNotes,onChange:t=>e.setFeedback({...e.feedback,additionalNotes:t.target.value})}),(0,r.jsxs)("div",{className:"flex flex-col gap-4 pt-2",children:[(0,r.jsxs)(f.z,{variant:"affirmative",className:"w-full",onClick:()=>{Y.ZP.capture(em.f8.FEEDBACK.KEEP_PLAN_CLICKED),e.onCancel()},children:["Keep Lovable ",(0,eP.Iw)(e.currentPlan||"unknown")]}),(0,r.jsx)(f.z,{variant:"outline",className:"w-full",onClick:()=>{Y.ZP.capture(em.f8.FEEDBACK.CONTINUE_CLICKED,{reason:e.feedback.reason}),e.setCurrentStep(e.getNextStepAfterFeedback())},children:"Downgrade plan"})]})]})})},sG=e=>{let{children:t,className:s}=e;return(0,r.jsx)("div",{className:(0,ex.cn)("rounded-xl border bg-background p-5",s),children:t})},sK=th.Ry({reason:th.Z_().optional(),additional_notes:th.Z_().max(500,"Additional notes must be less than 500 characters").optional()}),sB=()=>{let e=sD(),t=(0,h.SJ)(),s=(0,eF.D)({mutationFn:async()=>{let s=sK.parse({reason:e.feedback.reason,additional_notes:e.feedback.additionalNotes});await t.post("/user/cancellation",s),await e.onConfirm()},onSuccess:()=>{Y.ZP.capture(em.f8.FINAL_CONFIRMATION.CONFIRM_CLICKED,{from_plan:e.currentPlan,to_plan:e.targetPlan})},onError:e=>{if(en.logging.error("Error submitting feedback:",e),e instanceof sz.jm){let t=e.errors[0];Q.Am.error("Validation Error",{description:t.message})}else{var t;Q.Am.error("Error",{description:(null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to submit feedback"})}}}),a=sL(e.currentPlan,e.targetPlan);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(sU,{title:"Continue downgrading?",description:"Your projects are live. Your team is set up. Don't lose it all."}),(0,r.jsxs)(sG,{children:[(0,r.jsx)("div",{className:"mb-4 text-lg font-medium",children:"Here is what will change:"}),(0,r.jsxs)("ul",{className:"flex flex-col gap-4",children:[0===a.length&&(0,r.jsxs)("li",{className:"flex items-start gap-3",children:[(0,r.jsx)(j.Z,{name:"close",className:"size-5"}),(0,r.jsx)("span",{children:"Features of your current plan"})]}),a.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-start gap-3",children:[(0,r.jsx)(j.Z,{name:"close",className:"size-5 text-muted-foreground"}),(0,r.jsx)("span",{children:e})]},t))]}),(0,r.jsx)(f.z,{variant:"destructive",className:"mt-4 w-full",onClick:()=>s.mutate(),loading:s.isPending,children:"Confirm cancellation"})]}),(0,r.jsxs)(f.z,{variant:"outline",className:"w-full",onClick:()=>{Y.ZP.capture(em.f8.FINAL_CONFIRMATION.KEEP_PLAN_CLICKED),e.onCancel()},children:["Keep Lovable ",(0,eP.Iw)(e.currentPlan||"unknown")]})]})},sq=()=>{let e=sD(),t=async()=>{Y.ZP.capture(em.f8.KTLO_OFFER.SWITCH_CLICKED),await e.onSwitchToKtlo()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(sU,{title:"Switch to Lite",description:"Try our new Lite plan and retain important features that keep your project going."}),(0,r.jsxs)(sG,{children:[(0,r.jsx)("div",{className:"mb-2 text-lg font-medium",children:"Lite plan"}),(0,r.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-3xl font-medium md:text-4xl",children:"$15"}),(0,r.jsx)("span",{className:"text-base font-medium text-muted-foreground",children:"per month"}),(0,r.jsx)("span",{className:"rounded bg-success px-2 py-0.5 text-xs text-success-foreground",children:"40% off"})]}),(0,r.jsx)("ul",{className:"mt-4 flex flex-col gap-3",children:["5 daily credits up to a max of 30/month","Keep custom domains","No Lovable badge","Team settings stay in place","Access to private projects"].map((e,t)=>(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[(0,r.jsx)(j.Z,{name:"check",className:"size-5"}),(0,r.jsx)("span",{children:e})]},t))}),(0,r.jsx)(f.z,{className:"mt-6 w-full",variant:"affirmative",onClick:t,loading:e.isLoading,children:"Switch to Lite"})]}),(0,r.jsx)(f.z,{variant:"outline",className:"w-full",onClick:()=>{Y.ZP.capture(em.f8.KTLO_OFFER.CONTINUE_DOWNGRADE_CLICKED),e.setCurrentStep(e.getNextStepAfterKtlo())},children:"Downgrade plan"})]})},sH=()=>{let e=sD();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(sU,{title:"Have you tried these features?"}),(0,r.jsxs)(sG,{children:[(0,r.jsx)("div",{className:"flex flex-col gap-1.5 md:gap-2",children:sC.map(e=>(0,r.jsxs)("div",{className:"flex items-start gap-3 rounded-lg px-2 py-2 transition-colors md:gap-4 md:px-3",children:[(0,r.jsx)("span",{className:"mt-1.5 select-none text-base md:mt-2 md:text-lg",children:(0,r.jsx)(j.Z,{name:e.icon,className:"h-4 w-4"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-0.5",children:[(0,r.jsx)(tE.Label,{htmlFor:e.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.id))}),(0,r.jsxs)(f.z,{variant:"affirmative",className:"mt-4 w-full",onClick:()=>{Y.ZP.capture(em.f8.FEATURE_USAGE.KEEP_PLAN_CLICKED),e.onCancel()},children:["Keep Lovable ",(0,eP.Iw)(e.currentPlan||"unknown")]})]}),(0,r.jsx)(f.z,{variant:"outline",onClick:()=>{Y.ZP.capture(em.f8.FEATURE_USAGE.CONTINUE_CLICKED),e.setCurrentStep(e.getNextStepAfterFeatures())},children:"Downgrade plan"})]})};var sV=s(7666);let sJ=()=>{let e=sD(),t=(0,sh.tS)(),s=(0,c.useCurrentWorkspaceStore)(e=>e.currentWorkspace),a=t.allPlanOptions.find(t=>t.id===e.currentPlan),n=a?t.getDisplayPrice(a):0,l=(0,i.useMemo)(()=>t.allPlanOptions.filter(s=>"string"==typeof s.id&&s.id.includes(e.currentPlan.startsWith(eP.$k)?eP.$k:eP.Rq)&&t.getDisplayPrice(s)<n).sort((e,s)=>t.getDisplayPrice(s)-t.getDisplayPrice(e)),[t.allPlanOptions,t.getDisplayPrice,n]),o=(0,i.useMemo)(()=>(null==s?void 0:s.plan)&&l.length>0&&!l.some(e=>e.id===(null==s?void 0:s.plan))?l[0]:null,[l,null==s?void 0:s.plan,t.setPlanType]),[d,u]=(0,i.useState)(o);(0,i.useEffect)(()=>{t.setPlanType("monthly")},[t.setPlanType]),(0,i.useEffect)(()=>{(null==s?void 0:s.plan)&&!d&&e.setCurrentStep(e.getNextStepAfterSuggestLowerPlan())},[null==s?void 0:s.plan,d,e]);let m=async()=>{d&&(Y.ZP.capture(em.f8.SUGGEST_LOWER_PLAN.DOWNGRADE_CREDITS_CLICKED,{current_plan_id:e.currentPlan,target_plan_id:d.id,target_plan_type:t.planType,plan_price:t.getDisplayPrice(d)}),await e.onConfirm(d))};return d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(sU,{title:"Downgrade now",description:"Do you want to downgrade by changing your monthly credits?"}),(0,r.jsxs)(sG,{children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("div",{className:"text-lg font-medium",children:"Reduce monthly credits"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-3xl font-medium md:text-4xl",children:["$",t.getDisplayPrice(d)]}),(0,r.jsx)("span",{className:"text-base font-medium text-muted-foreground",children:t.getPriceSuffix()})]}),(0,r.jsx)(sV.z,{options:l,selectedOption:d,disabled:t.shouldDisableWorkspaceAdminActions,onSelect:u})]}),(0,r.jsx)(f.z,{className:"mt-4 w-full",variant:"affirmative",disabled:(null==d?void 0:d.id)===e.currentPlan||t.isEnterprisePlan||t.shouldDisableWorkspaceAdminActions,onClick:m,loading:e.isLoading,children:"Downgrade credits"})]}),(0,r.jsx)(f.z,{variant:"outline",onClick:()=>{Y.ZP.capture(em.f8.SUGGEST_LOWER_PLAN.CONTINUE_CLICKED),e.setCurrentStep(e.getNextStepAfterSuggestLowerPlan())},children:"Downgrade plan"})]}):(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)(W.O,{className:"h-16 w-full"})})},sY=()=>{let e=sD();return(0,r.jsx)(r.Fragment,{children:(()=>{switch(e.currentStep){case n.SUGGEST_LOWER_PLAN:return(0,r.jsx)(sJ,{});case n.FEATURES_TO_TRY:return(0,r.jsx)(sH,{});case n.KTLO_OFFER:return(0,r.jsx)(sq,{});case n.FEEDBACK:return(0,r.jsx)(sW,{});case n.FINAL_CONFIRMATION:return(0,r.jsx)(sB,{});default:return null}})()})};var sQ=s(1523),s$=s(33563),sX=s(1178),s0=s(58010);let s1=e=>{let{workspace:t}=e,s=(0,eP.Iw)(t.plan),a=t.billing_period_end_date?(0,I.WU)((0,s0.ZU)(t.billing_period_end_date),"MMM d, yyyy"):"";return(0,r.jsxs)("div",{className:"flex items-center justify-start gap-4",children:[(0,r.jsx)(sF.default,{src:"/img/logo/lovable-logo-icon.svg",alt:"Lovable",width:36,height:36,className:"h-9 w-9"}),(0,r.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,r.jsxs)("p",{className:"text-base font-medium text-foreground",children:["You're on ",s," Plan"]}),(0,r.jsxs)("p",{className:"text-base text-muted-foreground",children:[t.plan_scheduled?"Cancels":"Renews"," ",a]})]})]})},s2=e=>{let{workspace:t,open:s,onOpenChange:a}=e,{createPortalSession:n,isCreatePortalSessionLoading:i,setFreePlanAsTarget:l,onDowngradeClick:o}=(0,sh.tS)(),c=async()=>{await n()},d=async()=>{await n()},u="free"===t.plan_scheduled;return(0,r.jsx)(eq.Vq,{open:s,onOpenChange:()=>{a(!1)},children:(0,r.jsxs)(eq.cZ,{className:"sm:max-w-[500px]",children:[(0,r.jsxs)(eq.fK,{children:[(0,r.jsx)(eq.$N,{children:"Manage Plan"}),(0,r.jsx)(eq.Be,{children:"Subscription & Billing Settings"})]}),(0,r.jsx)("div",{className:"flex flex-col gap-4 border-y py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4 rounded-xl bg-muted p-4",children:[(0,r.jsx)(s1,{workspace:t}),u?(0,r.jsx)(f.z,{onClick:d,disabled:i,variant:"outline",children:i?"Opening...":"Cancel Downgrade"}):(0,r.jsx)(f.z,{variant:"outline",onClick:()=>{l(),null==o||o(),a(!1)},children:"Downgrade to Free"})]})}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(f.z,{variant:"secondary",onClick:c,disabled:i,className:"w-5/6",children:i?"Opening...":"View Invoices"}),(0,r.jsx)(f.z,{onClick:c,disabled:i,className:"w-full",children:i?"Opening...":"Payment Preferences"})]})]})})},s4=e=>{let{workspace:t,shouldDisableWorkspaceAdminActions:s}=e,{createPortalSession:a,isCreatePortalSessionLoading:n}=(0,sh.tS)();if(!t.plan_scheduled)return null;let i=(0,eP.Iw)(t.plan),l=(0,eP.Iw)(t.plan_scheduled),o=t.billing_period_end_date?(0,I.WU)((0,s0.ZU)(t.billing_period_end_date),"MMM d, yyyy"):"";return(0,r.jsx)("div",{className:"space-y-3",children:(0,r.jsx)("div",{className:"space-y-3 rounded-md bg-warning p-3",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(j.Z,{name:"info",size:"small",className:"mt-0.5 flex-shrink-0 text-warning-primary"}),(0,r.jsxs)("div",{className:"flex w-full flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-warning-primary",children:["Pending changes scheduled for ",o]}),(0,r.jsxs)("p",{className:"text-sm text-warning-primary",children:[i," → ",l]})]}),(0,r.jsx)("div",{children:(0,r.jsx)(f.z,{variant:"warning",size:"default",disabled:n||s,onClick:()=>{a()},children:n?"Opening...":"Cancel changes"})})]})]})})})},s5=e=>{let{workspace:t,myWorkspaceRole:s}=e,[a,n]=(0,i.useState)(!1),l=(0,s$.t)(t),{currentPlan:o,shouldDisableWorkspaceAdminActions:c}=(0,sh.tS)(),d=(0,sQ.Ss)(l.currentlyConsuming,l.sources),u=(0,eP.Iw)(o.id),m=t.plan,x=(0,eP.XB)(m),h=()=>{let e=(0,eP.fA)(t.plan),s="ambassador"===t.plan;return(!e&&!s||(null==t?void 0:t.billing_period_credits_limit)!==0&&(null==t?void 0:t.billing_period_credits_limit)!==void 0)&&"free"!==t.plan&&!!t.billing_period_credits_limit&&!(t.billing_period_credits_limit<=0)},p=(()=>{if(!h())return null;if("free"===t.plan_scheduled)return{text:"No credits will rollover",icon:"close"};let e="annual"===t.plan_type,s=t.billing_period_credits_limit;return{text:"Up to ".concat((0,sX.H)(e?12*s:s)," credits rollover"),icon:"check"}})(),g=(()=>{if(!h()||!l.creditsResetDate||(null==t?void 0:t.plan_scheduled)==="free")return null;let e=(0,I.WU)(l.creditsResetDate,"do MMMM"),s=null==t?void 0:t.billing_period_credits_limit;return s?"".concat((0,sX.H)(s)," monthly credits reset on ").concat(e):"Monthly credits reset on ".concat(e)})();return x?(0,r.jsxs)("div",{className:"mx-auto flex w-full flex-col gap-4 lg:max-w-[888px]",children:[(0,r.jsx)(s4,{workspace:t,shouldDisableWorkspaceAdminActions:c}),(0,r.jsxs)("div",{className:"flex flex-col gap-6 lg:grid lg:grid-cols-3",children:[(0,r.jsx)(sj.Zb,{className:"rounded-xl bg-muted p-4 shadow-sm",children:(0,r.jsxs)("div",{className:"flex h-full flex-col justify-between gap-4",children:[(0,r.jsx)(s1,{workspace:t}),(0,r.jsx)("div",{className:"flex justify-start",children:(0,r.jsx)(f.z,{variant:"outline",size:"default",disabled:c,onClick:()=>n(!0),children:"Manage"})})]})}),(0,r.jsx)(sj.Zb,{className:"col-span-2 rounded-xl bg-muted p-4 shadow-sm outline outline-1 outline-offset-[-1px] outline-border",children:(0,r.jsxs)("div",{className:"flex h-full flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-base font-medium text-foreground",children:"Credits"}),(0,r.jsxs)("p",{className:"text-sm font-normal text-muted-foreground",children:[(0,sX.H)(l.totalRemaining)," of"," ",(0,sX.H)(l.totalAllocation)," left"]})]}),(0,r.jsx)(sQ.jT,{progressData:l}),(l.currentlyConsuming||0===l.totalRemaining)&&(0,r.jsx)("div",{className:"flex flex-col gap-2",children:(0,r.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 sm:order-2",children:[(0,r.jsx)("div",{className:"ml-1 mr-0.5 h-2 w-2 rounded-full ".concat(d)}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:(0,sQ.qk)(l.currentlyConsuming)})]}),(p||g)&&(0,r.jsxs)("div",{className:"flex flex-col gap-2 sm:order-1",children:[p&&(0,r.jsxs)("div",{className:"flex items-start gap-1.5",children:[(0,r.jsx)(j.Z,{name:p.icon,size:"small",className:"mt-0.5 text-foreground"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:p.text})]}),g&&(0,r.jsxs)("div",{className:"flex items-start gap-1.5",children:[(0,r.jsx)(j.Z,{name:"check",size:"small",className:"mt-0.5 text-foreground"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:g})]})]})]})})]})})]}),(0,r.jsx)(s2,{workspace:t,myWorkspaceRole:s,open:a,onOpenChange:n})]}):"inactive"!==m?(0,r.jsx)(sj.Zb,{className:"flex w-full flex-col gap-4 bg-muted p-4",children:(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,r.jsxs)("span",{children:["You're currently on plan:"," ",(0,r.jsx)("span",{className:"font-medium capitalize",children:u}),". "]})," ",(0,r.jsx)(s3,{workspace:t,children:"Manage your payment preferences and view past invoices"}),", or change your plan below."]})}):void 0},s3=e=>{let{workspace:t,children:s}=e,{createPortalSession:a,isCreatePortalSessionLoading:n}=(0,sf.m)();return(0,r.jsx)("span",{role:"button",tabIndex:0,onClick:()=>{n||a({workspaceId:t.id})},onKeyDown:e=>{n||"Enter"!==e.key&&" "!==e.key||a({workspaceId:t.id})},className:"inline cursor-pointer underline disabled:opacity-50","aria-disabled":n,children:s})},s6=e=>{var t,s;let{workspace:a,showDowngradeConfirmation:n,setShowDowngradeConfirmation:i}=e,l=(0,sh.tS)(),o=(0,e5.$d)(),c=()=>{l.setTargetDowngradePlan(null),i(!1)};return o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eq.Vq,{open:n,onOpenChange:e=>{e||c()},children:(0,r.jsx)(eq.cZ,{className:"pointer-events-auto flex max-h-[95vh] flex-col gap-4 overflow-y-auto outline-none",children:(0,r.jsx)(sI,{targetPlan:null!==(s=l.targetDowngradePlan)&&void 0!==s?s:void 0,onCancel:c,workspace:a,children:(0,r.jsx)(sY,{})})})}),(0,r.jsx)(sp.S,{className:"w-full",showEnterprise:!0})]}):n?(0,r.jsx)(sZ,{workspace:a,targetPlan:null!==(t=l.targetDowngradePlan)&&void 0!==t?t:void 0,onCancel:c}):(0,r.jsx)(sp.S,{className:"w-full",showEnterprise:!0})},s8=e=>{let{workspace:t,myWorkspaceRole:s}=e,a="inactive"===t.plan,[n,l]=(0,i.useState)(!1),[o,c]=(0,i.useState)(!1),[d,m]=(0,i.useState)(null),x=(0,tr.useSearchParams)();(0,i.useEffect)(()=>{let e=x.get("planChanged"),t=x.get("planName");if("true"===e&&t){m({planName:t}),c(!0);let e=new URL(window.location.href);e.searchParams.delete("planChanged"),e.searchParams.delete("planName"),window.history.replaceState({},"",e.toString())}},[x]);let h=(0,e5.Kq)();return(0,r.jsxs)(u.tM,{title:"Plans & Billing",value:"billing",docsLink:"https://docs.lovable.dev/user-guides/messaging-limits",children:[(0,r.jsxs)(sx.om,{planCardContext:"billing",workspace:t,myWorkspaceRole:s,onDowngradeClick:()=>l(!0),children:[a?(0,r.jsxs)("span",{children:["Your subscription is currently"," ",(0,r.jsx)("span",{className:"font-medium",children:"inactive"}),". You can select a new plan below to restore full functionality to your workspace."]}):null,!n&&(h?(0,r.jsx)(s5,{workspace:t,myWorkspaceRole:s}):(0,r.jsx)(sw,{workspace:t,myWorkspaceRole:s})),(0,r.jsx)(s6,{workspace:t,showDowngradeConfirmation:n,setShowDowngradeConfirmation:l})]}),(0,r.jsx)(eq.Vq,{open:o,onOpenChange:c,children:(0,r.jsxs)(eq.cZ,{className:"gap-4 outline-none focus:ring-0",size:"md",hideCloseButton:!0,blurOverlay:!0,onInteractOutside:e=>{e.preventDefault(),e.stopPropagation()},children:[(0,r.jsxs)("div",{className:"flex flex-col items-start gap-4",children:[(0,r.jsx)(e6.xx,{className:"h-9"}),(0,r.jsxs)(eq.fK,{children:[(0,r.jsxs)(eq.$N,{className:"text-2xl md:text-3xl",children:["Plan successfully changed to ",null==d?void 0:d.planName,"!"]}),(0,r.jsx)(eq.Be,{children:"Your new plan will be activated at the start of the next billing cycle."})]})]}),(0,r.jsx)(eq.cN,{fullWidthButtons:!0,className:"flex-col gap-2",children:(0,r.jsxs)(f.z,{onClick:e=>{e.preventDefault(),e.stopPropagation(),c(!1),m(null),l(!1)},className:"w-full",children:[(0,r.jsx)(j.Z,{name:"check",size:"small",className:"mr-2"}),"Got it!"]})})]})})]})};var s7=s(21835);let s9=s7.fC;s7.xz;let ae=s7.h_,at=i.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(s7.aV,{className:(0,ex.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t})});at.displayName=s7.aV.displayName;let as=i.forwardRef((e,t)=>{let{className:s,overlayClassName:a,...n}=e;return(0,r.jsxs)(ae,{children:[(0,r.jsx)(at,{className:a}),(0,r.jsx)(s7.VY,{ref:t,className:(0,ex.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...n})]})});as.displayName=s7.VY.displayName;let aa=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,ex.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};aa.displayName="AlertDialogHeader";let an=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,ex.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};an.displayName="AlertDialogFooter";let ar=i.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(s7.Dx,{ref:t,className:(0,ex.cn)("font-semibold text-lg",s),...a})});ar.displayName=s7.Dx.displayName;let ai=i.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(s7.dk,{ref:t,className:(0,ex.cn)("text-sm text-muted-foreground",s),...a})});ai.displayName=s7.dk.displayName;let al=i.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(s7.aU,{ref:t,className:(0,ex.cn)((0,f.d)(),s),...a})});al.displayName=s7.aU.displayName;let ao=i.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(s7.$j,{ref:t,className:(0,ex.cn)((0,f.d)({variant:"outline"}),"mt-2 sm:mt-0",s),...a})});ao.displayName=s7.$j.displayName;var ac=s(54816);let ad=e=>{let{workspace:t,onSuccess:s,onCancel:a,initialData:n,domainOnly:l=!1}=e,[o,c]=(0,i.useState)("domain"),[d,u]=(0,i.useState)((null==n?void 0:n.domain)||""),[m,x]=(0,i.useState)(!1),[p,g]=(0,i.useState)(""),{register:v,handleSubmit:b,formState:{errors:y,isSubmitting:N},getValues:w}=(0,tx.cI)({defaultValues:{clientId:(null==n?void 0:n.clientId)||"",clientSecret:(null==n?void 0:n.clientSecret)||"",issuer:(null==n?void 0:n.issuer)||""},mode:"onBlur"}),{mutateAsync:_,isPending:k}=(0,eF.D)({mutationFn:async()=>{let e=(0,h.SJ)();return await e.post("/workspaces/".concat(t.id,"/identity/verify-domain"),{domain:d}),x(!0),g(""),!0},onError:e=>{g(e.message),Q.Am.error(e.message)}}),{mutateAsync:C}=(0,eF.D)({mutationFn:async e=>{let s=(0,h.SJ)(),a=(0,ac.Z)().replace(/-/g,"").slice(0,8);return await s.post("/workspaces/".concat(t.id,"/identity/add-oidc-provider"),{displayName:a,oidc:{clientId:e.clientId,clientSecret:e.clientSecret,issuer:e.issuer}})},onSuccess:()=>{c("complete"),Q.Am.success("SSO provider added successfully!"),null==s||s()},onError:e=>{Q.Am.error(e.message,{description:"Please check your OIDC provider settings and try again."})}}),S=async()=>{if("domain"===o&&m)l?(c("complete"),null==s||s()):c("oidc");else if("oidc"===o){let e=w();await C({clientId:e.clientId,clientSecret:e.clientSecret,issuer:e.issuer}).then(()=>{c("verification")}).catch(()=>{})}};return"complete"===o?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(j.Z,{name:"check",className:"mx-auto h-16 w-16 text-success-primary"}),(0,r.jsx)("h3",{className:"mt-4 text-lg font-medium",children:l?"Domain Added Successfully!":"SSO Provider Added Successfully!"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:l?"Your domain has been verified and is ready to use for SSO authentication.":"Your SSO provider has been configured and is ready to use."})]}),(0,r.jsxs)(sj.Zb,{children:[(0,r.jsx)(sj.Ol,{children:(0,r.jsx)(sj.ll,{className:"text-sm",children:l?"Domain Details":"Provider Details"})}),(0,r.jsxs)(sj.aY,{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"Domain:"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:d})]}),!l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"Provider Type:"}),(0,r.jsx)(t1.C,{variant:"outline",children:"OIDC"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"Status:"}),(0,r.jsx)(t1.C,{variant:"default",className:"bg-green-100 text-green-800",children:"Active"})]})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,r.jsx)(f.z,{variant:"outline",onClick:a,children:"Close"}),!l&&(0,r.jsx)(f.z,{onClick:()=>c("domain"),children:"Add Another Provider"})]})]}):(0,r.jsxs)("div",{className:"space-y-6",children:["domain"===o&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(tE.Label,{htmlFor:"domain",children:"Domain"}),(0,r.jsx)(td.I,{id:"domain",value:d,onChange:e=>u(e.target.value),placeholder:"yourdomain.com",disabled:m,className:"mt-1"})]}),!m&&(0,r.jsxs)(sl.bZ,{children:[(0,r.jsx)(j.Z,{name:"info",size:"small"}),(0,r.jsx)(sl.Cd,{children:"Domain Verification Required"}),(0,r.jsxs)(sl.X,{children:["To verify your domain, add the following TXT record to your DNS provider:",(0,r.jsxs)("div",{className:"mt-2 flex gap-2 rounded bg-muted p-2 font-mono text-sm text-foreground",children:[(0,r.jsx)("div",{children:"TXT"}),(0,r.jsx)("div",{children:"@"}),(0,r.jsxs)("div",{className:"break-all",children:["lovable_verification=",t.id]})]}),(0,r.jsx)("p",{className:"mt-2 text-xs",children:"DNS changes may take a few minutes to propagate."})]})]}),p&&(0,r.jsxs)(sl.bZ,{variant:"destructive",children:[(0,r.jsx)(j.Z,{name:"info",size:"small"}),(0,r.jsx)(sl.Cd,{children:"Verification Failed"}),(0,r.jsx)(sl.X,{children:p})]}),m&&(0,r.jsxs)(sl.bZ,{variant:"success",children:[(0,r.jsx)(j.Z,{name:"check"}),(0,r.jsx)(sl.Cd,{children:"Domain Verified!"}),(0,r.jsx)(sl.X,{children:"Your domain has been successfully verified."})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)(f.z,{variant:"outline",onClick:a,children:"Cancel"}),(0,r.jsxs)("div",{className:"space-x-2",children:[!m&&(0,r.jsx)(f.z,{onClick:()=>_(),disabled:k||!d,loading:k,children:k?"Verifying...":"Verify Domain"}),m&&(0,r.jsx)(f.z,{onClick:S,children:"Continue"})]})]})]}),"oidc"===o&&(0,r.jsxs)("form",{className:"space-y-4",onSubmit:b(async e=>{await C({clientId:e.clientId,clientSecret:e.clientSecret,issuer:e.issuer}).then(()=>c("verification")).catch(()=>{})}),noValidate:!0,children:[(0,r.jsxs)(sl.bZ,{children:[(0,r.jsx)(j.Z,{name:"info",size:"small"}),(0,r.jsx)(sl.Cd,{children:"OIDC Configuration"}),(0,r.jsx)(sl.X,{children:"Configure your OIDC provider settings. You'll need to obtain these values from your identity provider."})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(tE.Label,{htmlFor:"clientId",children:"Client ID"}),(0,r.jsx)(td.I,{id:"clientId",...v("clientId",{required:"Client ID is required"}),placeholder:"Enter your OIDC client ID",className:y.clientId?"mt-1 border-destructive-foreground":"mt-1","aria-invalid":!!y.clientId,"aria-describedby":"clientId-error"}),y.clientId&&(0,r.jsx)("p",{className:"mt-1 text-xs text-destructive-foreground",id:"clientId-error",children:y.clientId.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(tE.Label,{htmlFor:"clientSecret",children:"Client Secret"}),(0,r.jsx)(td.I,{id:"clientSecret",type:"password",...v("clientSecret",{required:"Client Secret is required"}),placeholder:"Enter your OIDC client secret",className:y.clientSecret?"mt-1 border-destructive-foreground":"mt-1","aria-invalid":!!y.clientSecret,"aria-describedby":"clientSecret-error"}),y.clientSecret&&(0,r.jsx)("p",{className:"mt-1 text-xs text-destructive-foreground",id:"clientSecret-error",children:y.clientSecret.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(tE.Label,{htmlFor:"issuer",children:"Issuer URL"}),(0,r.jsx)(td.I,{id:"issuer",...v("issuer",{required:"Issuer URL is required",pattern:{value:/^https?:\/\/.+/,message:"Must be a valid URL (starting with http(s)://)"},validate:e=>{try{return new URL(e),!0}catch(e){return"Must be a valid URL"}}}),placeholder:"https://your-identity-provider.com",className:y.issuer?"mt-1 border-destructive-foreground":"mt-1","aria-invalid":!!y.issuer,"aria-describedby":"issuer-error"}),y.issuer&&(0,r.jsx)("p",{className:"mt-1 text-xs text-destructive-foreground",id:"issuer-error",children:y.issuer.message})]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)(f.z,{variant:"outline",onClick:()=>{"oidc"===o?c("domain"):"verification"===o&&c("oidc")},type:"button",children:[(0,r.jsx)(j.Z,{name:"arrow_left_alt",size:"small"}),"Back"]}),(0,r.jsx)(f.z,{type:"submit",disabled:N,children:"Configure Provider"})]})]}),"verification"===o&&(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(F.$,{size:"large"}),(0,r.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"Configuring SSO Provider"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Please wait while we configure your SSO provider..."})]})})]})},au=e=>{let{workspace:t}=e,[s,a]=(0,i.useState)([{type:"list",title:"Identity & Access"}]),[n,l]=(0,i.useState)(null),[o,c]=(0,i.useState)(null),d=(0,eg.NL)(),m=(0,h.SJ)(),{data:p=[],isLoading:g,error:v}=(0,x.a)({queryKey:["sso-providers",t.id],queryFn:async()=>await m.get("/workspaces/".concat(t.id,"/identity/sso-providers"))}),{data:b=[],isLoading:y,error:N}=(0,x.a)({queryKey:["verified-domains",t.id],queryFn:async()=>(await m.get("/workspaces/".concat(t.id,"/identity/verified-domains"))).domains}),w=(0,eF.D)({mutationFn:async e=>{await m.delete("/workspaces/".concat(t.id,"/identity/sso-providers/").concat(e))},onSuccess:()=>{d.invalidateQueries({queryKey:["sso-providers",t.id]}),l(null),Q.Am.success("SSO provider deleted successfully")},onError:e=>{l(null),Q.Am.error(e.message||"Failed to delete SSO provider")}}),_=(0,eF.D)({mutationFn:async e=>{await m.delete("/workspaces/".concat(t.id,"/identity/verified-domains/").concat(e))},onSuccess:()=>{d.invalidateQueries({queryKey:["verified-domains",t.id]}),c(null),Q.Am.success("Domain deleted successfully")},onError:e=>{Q.Am.error(e.message||"Failed to delete domain"),c(null)}}),k=s[s.length-1],C=()=>{if(!F){O();return}l(null),c(null),a(e=>[...e,{type:"add-provider",title:"Add SSO Provider"}])},S=()=>{l(null),c(null),a(e=>e.slice(0,-1))},E=()=>{l(null),c(null),a([{type:"list",title:"Identity & Access"}])},I=e=>(0,r.jsx)(t1.C,{variant:"affirmative",children:"Active"}),D=e=>{switch(e){case"oidc":return(0,r.jsx)(j.Z,{name:"security"});case"saml":return(0,r.jsx)(j.Z,{name:"key"});default:return(0,r.jsx)(j.Z,{name:"settings"})}},P=e=>{l(e)},A=()=>{l(null)},z=e=>{c(e)},L=()=>{c(null)},T=(0,et.z)($.g),O=()=>{T({childProps:{dialogDescription:"You need to be on a business plan to add SSO providers."}})},F=(0,eP.Qx)(t.plan)||(0,eP.gG)(t.plan);return v?(0,r.jsx)(u.tM,{value:"identity",title:"Identity",description:"Manage your workspace identity and SSO.",children:(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsx)(sj.Zb,{children:(0,r.jsx)(sj.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"text-center text-destructive-primary",children:["Error loading SSO providers: ",v.message]})})})})}):(0,r.jsxs)(u.tM,{value:"identity",title:"Identity",description:"Manage your workspace identity and SSO.",customBadge:(0,r.jsx)(eE.y,{workspace:t,requiredPlanId:"biz"}),children:[s.length<=1?null:(0,r.jsx)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:s.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[t>0&&(0,r.jsx)(j.Z,{name:"chevron_right",size:"small"}),t===s.length-1?(0,r.jsx)("span",{className:"font-medium text-foreground",children:e.title}):(0,r.jsx)("button",{onClick:()=>a(e=>e.slice(0,t+1)),className:"transition-colors hover:text-foreground",children:e.title})]},t))}),"list"===k.type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between border-b pb-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h2",{className:"text-xl font-medium",children:"SSO Providers"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Configure single sign-on providers for your workspace"})]}),(0,r.jsx)(eC.b,{showTooltip:p.length>0,tooltipContent:"Only one SSO provider can be configured at a time. Delete the existing provider to add a new one.",children:(0,r.jsxs)(f.z,{onClick:C,variant:"secondary",disabled:p.length>0,children:[(0,r.jsx)(j.Z,{name:"add",size:"small"}),"Add Provider",p.length>0&&(0,r.jsx)(j.Z,{name:"info",size:"small"})]})})]}),g?(0,r.jsxs)("div",{className:"py-8 text-center",children:[(0,r.jsx)(j.Z,{name:"security",className:"mx-auto h-12 w-12 animate-pulse text-muted-foreground"}),(0,r.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"Loading SSO providers..."})]}):0===p.length?(0,r.jsxs)("div",{className:"py-8 text-center",children:[(0,r.jsx)(j.Z,{name:"security",className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,r.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"No SSO providers configured"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Get started by adding your first SSO provider to enable single sign-on for your workspace."}),(0,r.jsxs)(f.z,{className:"mt-4",onClick:C,disabled:p.length>0,children:[(0,r.jsx)(j.Z,{name:"add",size:"small"}),"Add Provider"]})]}):(0,r.jsx)("div",{className:"space-y-4",children:p.map(e=>{let t="https://lovable.dev/sso-login/"+e.provider_id;return(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-4 transition-colors hover:bg-muted/50",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted",children:D(e.type)}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"font-medium",children:[e.provider_id," "]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("h5",{className:"text-xs text-muted-foreground",children:["Login URL:"," ",(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:t})]}),(0,r.jsxs)(t_.u,{delayDuration:0,children:[(0,r.jsx)(t_.aJ,{children:(0,r.jsx)(f.z,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-muted",onClick:async()=>{await navigator.clipboard.writeText(t),Q.Am.success("Login URL copied to clipboard")},children:(0,r.jsx)(j.Z,{name:"content_copy",size:"small"})})}),(0,r.jsx)(t_._v,{children:"Copy Login URL"})]})]}),(0,r.jsxs)("div",{className:"mt-1 flex items-center space-x-2",children:[I(e),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Added"," ",new Date(e.created_at).toLocaleDateString()]})]})]})]}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsx)(f.z,{variant:"ghost",size:"sm",className:"hover:bg-destructive-foreground/10 hover:text-destructive-foreground",onClick:()=>P(e.id),children:"Delete"})})]},e.id)})}),(0,r.jsx)(s9,{open:!!n,onOpenChange:e=>{e||A()},children:(0,r.jsxs)(as,{overlayClassName:"z-[11000]",className:"z-[11000]",children:[(0,r.jsxs)(aa,{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(j.Z,{name:"delete",className:"text-destructive-foreground"}),(0,r.jsx)(ar,{children:"Delete SSO Provider"})]}),(0,r.jsx)(ai,{children:"Are you sure you want to delete this SSO provider? This action cannot be undone and will disable SSO authentication for this provider."})]}),(0,r.jsxs)(an,{children:[(0,r.jsx)(ao,{asChild:!0,children:(0,r.jsx)(f.z,{variant:"outline",size:"sm",disabled:w.isPending,children:"Cancel"})}),(0,r.jsx)(al,{asChild:!0,children:(0,r.jsx)(f.z,{variant:"destructive",size:"sm",onClick:()=>{n&&(w.mutate(n),l(null))},disabled:w.isPending,children:w.isPending?"Deleting...":"Delete"})})]})]})}),(0,r.jsxs)("div",{className:"flex items-center justify-between border-b pb-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h2",{className:"text-xl font-medium",children:"Verified Domains"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Domains that are verified for SSO authentication"})]}),(0,r.jsxs)(f.z,{onClick:()=>{if(!F){O();return}l(null),c(null),a(e=>[...e,{type:"add-domain",title:"Add Verified Domain"}])},variant:"secondary",children:[(0,r.jsx)(j.Z,{name:"add",size:"small"}),"Add Domain"]})]}),y?(0,r.jsxs)("div",{className:"py-8 text-center",children:[(0,r.jsx)(j.Z,{name:"link",className:"mx-auto h-12 w-12 animate-pulse text-muted-foreground"}),(0,r.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"Loading verified domains..."})]}):N?(0,r.jsxs)("div",{className:"py-8 text-center",children:[(0,r.jsx)(j.Z,{name:"error",className:"mx-auto h-12 w-12 text-destructive"}),(0,r.jsx)("h3",{className:"mt-4 text-lg font-medium text-destructive",children:"Error loading verified domains"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:N.message})]}):0===b.length?(0,r.jsxs)("div",{className:"py-8 text-center",children:[(0,r.jsx)(j.Z,{name:"link",className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,r.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"No verified domains"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Add a verified domain to enable SSO authentication for your workspace."})]}):(0,r.jsx)("div",{className:"space-y-4",children:b.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-4 transition-colors hover:bg-muted/50",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted",children:(0,r.jsx)(j.Z,{name:"link"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium",children:e}),(0,r.jsx)("div",{className:"mt-1 flex items-center space-x-2",children:(0,r.jsx)(t1.C,{variant:"affirmative",children:"Verified"})})]})]}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsx)(f.z,{variant:"ghost",size:"sm",className:"hover:bg-destructive-foreground/10 hover:text-destructive-foreground",onClick:()=>z(e),children:"Delete"})})]},e))}),(0,r.jsx)(s9,{open:!!o,onOpenChange:e=>{e||L()},children:(0,r.jsxs)(as,{overlayClassName:"z-[11000]",className:"z-[11000]",children:[(0,r.jsxs)(aa,{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(j.Z,{name:"delete",className:"text-destructive-foreground"}),(0,r.jsx)(ar,{children:"Delete Verified Domain"})]}),(0,r.jsx)(ai,{children:"Are you sure you want to delete this verified domain? This action will disable SSO authentication for this domain."})]}),(0,r.jsxs)(an,{children:[(0,r.jsx)(ao,{asChild:!0,children:(0,r.jsx)(f.z,{variant:"outline",size:"sm",disabled:_.isPending,children:"Cancel"})}),(0,r.jsx)(al,{asChild:!0,children:(0,r.jsx)(f.z,{variant:"destructive",size:"sm",onClick:()=>{o&&_.mutate(o)},disabled:_.isPending,children:_.isPending?"Deleting...":"Delete"})})]})]})}),(0,r.jsxs)("div",{className:"flex flex-col gap-1 border-b pb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-medium",children:"Security & Access Control"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Features that help you secure your workspace and control access to your projects"})]}),(0,r.jsx)(es.P,{label:"Just-in-Time Provisioning",description:"Automatically creates user accounts when they sign in via SSO",justify:"end"}),(0,r.jsx)(es.P,{label:"Enforce SSO",description:"Require all workspace members to use SSO for authentication",justify:"end",children:(0,r.jsx)(t1.C,{variant:"outline",children:"Coming Soon"})})]}),"add-provider"===k.type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1 border-b pb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-medium",children:"Add SSO Provider"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Configure a new single sign-on provider for your workspace"})]}),(0,r.jsx)(ad,{workspace:t,onSuccess:()=>{d.invalidateQueries({queryKey:["sso-providers",t.id]}),E()},onCancel:S})]}),"add-domain"===k.type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1 border-b pb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-medium",children:"Add Verified Domain"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Add a new domain for SSO authentication"})]}),(0,r.jsx)(ad,{workspace:t,onSuccess:()=>{d.invalidateQueries({queryKey:["verified-domains",t.id]}),E()},onCancel:S,domainOnly:!0})]})]})};var am=s(31353),ax=s(60504),ah=s(20702);let ap=e=>{let{workspace:t}=e,{data:s,isLoading:a}=(0,x.a)(tT.t.templates({workspaceId:t.id})),n=(0,eP.Qx)(t.plan)||(0,eP.gG)(t.plan),{openSettings:i}=(0,ez.r)();return n?(0,r.jsx)(u.tM,{title:"Templates",value:"templates",description:"Browse and manage team templates, used to start new projects. Publish new templates from settings.",badge:"business",children:(0,r.jsxs)("div",{className:"grid flex-1 grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:[a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ax.R,{mainSkeletonClassName:"h-auto"}),(0,r.jsx)(ax.R,{mainSkeletonClassName:"h-auto"}),(0,r.jsx)(ax.R,{mainSkeletonClassName:"h-auto"}),(0,r.jsx)(ax.R,{mainSkeletonClassName:"h-auto"}),(0,r.jsx)(ax.R,{mainSkeletonClassName:"h-auto"}),(0,r.jsx)(ax.R,{mainSkeletonClassName:"h-auto"})]}),!a&&(s&&s.length>0?s.map(e=>(0,r.jsx)(ah.t,{project:e,subtitleType:"created-by",isCommunityProject:!1,positionIndex:0,isTemplate:!0},e.id)):(0,r.jsxs)("div",{className:"col-span-full flex h-full flex-col items-center justify-center gap-2 text-muted-foreground",children:[(0,r.jsx)(j.Z,{name:"file_export",size:"large"}),(0,r.jsx)("p",{className:"text-center text-sm",children:"No templates found. Mark projects as templates to get started."})]}))]})}):(0,r.jsx)(u.tM,{title:"Templates",value:"templates",description:"Browse and manage team templates, used to start new projects. Publish new templates from settings.",customBadge:t&&(0,r.jsx)(eE.y,{workspace:t,requiredPlanId:"biz"}),children:(0,r.jsxs)("div",{className:"flex h-full flex-col items-center justify-center gap-2 text-muted-foreground",children:[(0,r.jsx)(j.Z,{name:"file_export",size:"large"}),(0,r.jsx)("p",{className:"text-center text-sm",children:"To start using templates, upgrade to a Business or Enterprise plan."}),(0,r.jsx)(f.z,{onClick:()=>i("billing"),variant:"twilight",className:"mt-2",children:"Upgrade"})]})})};var af=s(39987);let ag=()=>{let e=(0,eh.iZ)(e=>e.project),t=(0,ec.hO)(e=>e.projectWorkspace),s=(0,ec.hO)(e=>e.membership),a=null==s?void 0:s.role;return(0,r.jsx)(aj,{project:e,workspace:null!=t?t:void 0,isMemberOfWorkspace:!!s,myWorkspaceRole:a})},aj=e=>{let{project:t,workspace:s,myWorkspaceRole:a,isMemberOfWorkspace:n}=e,[c,m]=(0,i.useState)(!0),x=(0,i.useRef)(null),h=(0,e4.v)(),p=h?"admin":a,{supabaseIntegrationData:f}=(0,sm.v7)(null==t?void 0:t.id),g=null==f?void 0:f.is_managed_by_lovable,{activeTab:v,openSettings:b,closeSettings:y}=(0,ez.r)();(0,i.useEffect)(()=>{null!==v?m(!0):m(!1)},[v]),(0,l.y1)("mod+.",()=>{null===v?b(t?"project":"account"):y()});let{authUser:N}=(0,o.Eu)(),w=(null==N?void 0:N.displayName)||"Your Account",_=h||n,k=h||"admin"===a||"owner"===a,C=null==s?void 0:s.name,S=(0,eP.Qx)(null==s?void 0:s.plan)||(0,eP.gG)(null==s?void 0:s.plan),E=(0,e5.Hj)(),I=(0,e5.wf)(),D=(0,e5.ty)(),P=(0,e5.ZG)(),A=(0,d.dl)(er.P.IntegrationConnection),z=(0,e5.A4)();return(0,r.jsx)(e0,{open:c,onOpenChange:e=>{e?b():y()},children:(0,r.jsxs)(u.v_,{value:v||"settings",onValueChange:e=>b(e,!0),children:[(0,r.jsxs)(u.eD,{hasActiveTab:!!v,children:[t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.yf,{title:"Project"}),(0,r.jsxs)(u.QK,{value:"project",children:[(0,r.jsx)(j.Z,{name:"settings"}),(0,r.jsx)("p",{children:"Project Settings"})]}),(0,r.jsxs)(u.QK,{value:"domains",children:[(0,r.jsx)(j.Z,{name:"language"}),(0,r.jsx)("p",{children:"Domains"})]}),!z&&(0,r.jsxs)(u.QK,{value:"analytics",children:[(0,r.jsx)(j.Z,{name:"bid_landscape"}),(0,r.jsx)("p",{children:"Analytics"})]}),!z&&D&&(0,r.jsxs)(u.QK,{value:"page_speed",children:[(0,r.jsx)(j.Z,{name:"trending_up"}),(0,r.jsx)("p",{children:"Page Speed"})]}),(0,r.jsxs)(u.QK,{value:"knowledge",children:[(0,r.jsx)(j.Z,{name:"school"}),(0,r.jsx)("p",{children:"Knowledge"})]}),E&&(0,r.jsxs)(u.QK,{value:"memory",children:[(0,r.jsx)(j.Z,{name:"neurology"}),(0,r.jsx)("p",{children:"Memory"})]}),I&&(0,r.jsxs)(u.QK,{value:"ai_gateway",children:[(0,r.jsx)(j.Z,{name:"smart_toy"}),(0,r.jsx)("p",{children:"AI Gateway"})]}),g&&!z&&(0,r.jsxs)(u.QK,{value:"supabase",onClick:()=>{x.current&&x.current()},children:[(0,r.jsx)(j.Z,{name:"database",className:"h-4 w-4"}),(0,r.jsx)("p",{children:"Backend"})]}),!z&&P&&(0,r.jsxs)(u.QK,{value:"security",children:[(0,r.jsx)(j.Z,{name:"security"}),(0,r.jsx)("p",{children:"Security"})]})]}),s&&_&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.yf,{title:"Workspace"}),(0,r.jsxs)(u.QK,{value:"workspace",className:"-ml-0.5",children:[(0,r.jsx)(e3.z,{className:(0,ex.cn)("h-6 w-6 !rounded-[6px] md:h-5 md:w-5"),workspace:s}),(0,r.jsx)("p",{className:"-ml-0.5",children:C})]}),(0,r.jsxs)(u.QK,{value:"people",children:[(0,r.jsx)(j.Z,{name:"group"}),(0,r.jsx)("p",{children:"People"})]}),S&&(0,r.jsxs)(u.QK,{value:"templates",children:[(0,r.jsx)(j.Z,{name:"browse"}),(0,r.jsx)("p",{children:"Templates"})]}),(0,r.jsxs)(u.QK,{value:"billing",children:[(0,r.jsx)(j.Z,{name:"credit_card"}),(0,r.jsx)("p",{children:"Plans & Billing"})]}),!!(0,eP.Qx)(null==s?void 0:s.plan)&&k&&(0,r.jsxs)(u.QK,{value:"identity",children:[(0,r.jsx)(j.Z,{name:"security"}),(0,r.jsx)("p",{children:"Identity"})]})]}),(0,r.jsx)(u.yf,{title:"Account"}),(0,r.jsxs)(u.QK,{value:"account",children:[(0,r.jsx)(j.Z,{name:"account_circle"}),(0,r.jsx)("p",{children:w})]}),(0,r.jsxs)(u.QK,{value:"labs",children:[(0,r.jsx)(j.Z,{name:"science"}),(0,r.jsx)("p",{children:"Labs"})]}),_&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.yf,{title:"Integrations"}),!g&&!z&&(0,r.jsxs)(u.QK,{value:"supabase",children:[(0,r.jsx)(e6.xR.Supabase,{className:"h-4 w-4"}),(0,r.jsx)("p",{children:"Supabase"})]}),(t||s)&&(0,r.jsxs)(u.QK,{value:"github",children:[(0,r.jsx)(e6.xR.GitHub,{className:"h-4 w-4"}),(0,r.jsx)("p",{children:"GitHub"})]}),A&&s&&(0,r.jsxs)(u.QK,{value:"mcp",children:[(0,r.jsx)(j.Z,{name:"cloud"}),(0,r.jsx)("p",{children:"MCP"})]})]})]}),(0,r.jsxs)("div",{className:(0,ex.cn)("relative h-full w-full flex-1 overflow-x-auto md:w-auto",v?"flex":"hidden md:flex"),children:[t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.tM,{value:"project",title:"Project Settings",description:"Manage your project details, visibility, and preferences.",children:(0,r.jsx)(eW,{projectId:t.id})}),(0,r.jsx)(u.tM,{value:"knowledge",title:"Knowledge",description:"Add custom knowledge to your project.",docsLink:"https://docs.lovable.dev/features/knowledge",children:(0,r.jsx)(ep,{})}),(0,r.jsx)(u.tM,{value:"domains",title:"Domains",description:"Publish your project to custom domains.",docsLink:"https://docs.lovable.dev/tips-tricks/custom-domain",children:(0,r.jsx)(ed,{project:t})}),"analytics"===v&&!z&&(0,r.jsx)(B.U,{project:t}),!z&&D&&"page_speed"===v&&(0,r.jsx)(ef.E,{project:t}),E&&(0,r.jsx)(su,{workspace:s,isInsideEditor:!!t,myWorkspaceRole:p,project:t}),I&&(0,r.jsx)(K,{project:t}),!z&&P&&(0,r.jsx)(u.tM,{value:"security",title:"Security",description:"Monitor and manage security settings for your project.",children:(0,r.jsx)(eG.M,{onClose:y})})]}),s&&n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(af.r,{workspace:s,myWorkspaceRole:p}),(0,r.jsx)(am.C,{workspace:s}),(0,r.jsx)(s8,{workspace:s,myWorkspaceRole:a}),S&&(0,r.jsx)(ap,{workspace:s}),!!(0,eP.Qx)(null==s?void 0:s.plan)&&k&&(0,r.jsx)(au,{workspace:s})]}),(0,r.jsx)(tA,{}),(0,r.jsx)(tn,{}),_&&s&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(sa,{workspace:s,isInsideEditor:!!t,myWorkspaceRole:p}),!z&&(0,r.jsx)(sm.QD,{workspace:s,isInsideEditor:!!t,project:t,myWorkspaceRole:p,resetCallbackRef:x}),A&&(0,r.jsx)(sd,{workspace:s,isInsideEditor:!!t,myWorkspaceRole:p})]})]})]})})};var av=()=>{let e=(0,ec.MD)(),t=(0,c.useCurrentWorkspaceStore)(e=>e.currentWorkspace),s=(0,c.useCurrentWorkspaceStore)(e=>!!e.membership),a=(0,c.useCurrentWorkspaceStore)(e=>e.membership);if(e)return(0,r.jsx)(ag,{});let n=null==a?void 0:a.role;return(0,r.jsx)(aj,{workspace:null!=t?t:void 0,isMemberOfWorkspace:s,myWorkspaceRole:n})}},39987:function(e,t,s){s.d(t,{r:function(){return U},Y:function(){return W}});var a=s(52155),n=s(72602),r=s(29605),i=s(56166),l=s(96869),o=s(12703),c=s(25243),d=s(75970),u=s(82259),m=s(43115),x=s(62483),h=s(73517),p=s(59561),f=s(76332),g=s(14070),j=s(7815),v=s(3011),b=s(52465),y=s(62369),N=s(13273),w=s(94671),_=s(35127),k=s(42690),C=s(44647),S=s(99526),E=s(45776),I=s(98244),D=s(99792),P=s(30646),A=s(32282),z=s(4578),L=s(37355);let T=["image/png","image/jpeg","image/jpg","image/webp"],O=e=>{let{workspace:t,className:s}=e,{authUser:n}=(0,d.Eu)(),l=(0,w.SJ)(),{upload:c}=(0,L.F)(),u=(0,r.NL)(),m=(0,I.useRef)(null),x=()=>{m.current&&(m.current.value="")},{mutateAsync:h,isPending:f}=(0,i.D)({mutationFn:async e=>{let{file:s,workspaceId:a}=e;if(!n)throw Error("You must be logged in to upload files");await c({fileName:s.name,file:s,options:{maxFileSize:10240,maxDimension:200},continueOnError:!1});let{url:r}=await (0,P._c)({dir_name:n.uid,file_name:s.name});return await l.put("/user/workspaces/".concat(t.id),{image_url:r})},onSuccess:(e,t)=>{o.Am.success("Updated workspace avatar",{description:"Succesfully uploaded new workspace avatar"}),u.invalidateQueries({queryKey:A.E.all}),x()},onError:()=>{o.Am.error("Failed to update workspace avatar",{description:"Please try again"}),x()}}),g=async e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];a&&await h({file:a,workspaceId:t.id})};return(0,a.jsxs)(p.z,{variant:"secondary",size:"icon-sm",className:(0,z.cn)("absolute -bottom-1 -right-2 h-5 w-5 rounded-sm border disabled:opacity-100",s),type:"button",disabled:f,onClick:()=>{var e;null===(e=m.current)||void 0===e||e.click()},children:[(0,a.jsx)("input",{type:"file",className:"hidden",accept:T.join(","),onChange:g,disabled:f,ref:m}),(0,a.jsx)(D.Z,{name:f?"progress_activity":"edit_square",size:"xsmall",className:f?"animate-spin":""})]})};var F=s(55717),R=s(19214),M=s(10416);let Z=c.Ry({name:c.Z_().min(1,"Workspace name is required"),description:c.Z_().optional(),dataOptOut:c.O7().optional(),defaultMonthlyMemberCreditLimit:c.G0([c.Rx().positive("Credit limit must be a positive number"),c.lB(),c.S1()]).optional(),editorCanInvite:c.O7().optional()}),U=e=>{var t,s,r,o,c;let{workspace:d,myWorkspaceRole:u}=e,N=(0,l.cI)({defaultValues:{name:null!==(t=d.name)&&void 0!==t?t:"",description:null!==(s=d.description)&&void 0!==s?s:"",dataOptOut:null!==(r=d.data_opt_out)&&void 0!==r?r:void 0,defaultMonthlyMemberCreditLimit:null!==(o=d.default_monthly_member_credit_limit)&&void 0!==o?o:void 0,editorCanInvite:null!==(c=d.editor_can_invite)&&void 0!==c&&c},resolver:(0,n.F)(Z)}),k="owner"===u,I="member"===u,D="free"===(0,C.Ll)(d.plan),{leaveWorkspace:P,isLeavingWorkspace:A}=function(){let{setCurrentWorkspaceId:e}=(0,E.J1)(),t=(0,S.useRouter)(),{mutateAsync:s,isPending:a}=(0,i.D)({mutationFn:async e=>(0,w.SJ)().post("/user/workspaces/".concat(e,"/leave")),onSuccess:async()=>{e(null),t.push("/")}});return{leaveWorkspace:s,isLeavingWorkspace:a}}(),{updateWorkspace:z,isUpdatingWorkspace:L}=W({form:N,workspaceId:d.id}),T=(0,C.Qx)(d.plan),U=(0,_.Tj)(),G=(0,R.z)(M.g);return(0,a.jsx)(h.tM,{title:"Workspace Settings",value:"workspace",description:"Workspaces allow you to collaborate on projects in real time.",docsLink:"https://docs.lovable.dev/user-guides/teams",children:(0,a.jsx)(j.l0,{...N,children:(0,a.jsxs)("form",{className:"flex w-full flex-col gap-6",onSubmit:N.handleSubmit(e=>{z({...e,editor_can_invite:e.editorCanInvite})}),children:[(0,a.jsx)(x.P,{label:"Workspace Avatar",description:"Set an avatar for your workspace.",mobileLayout:"horizontal",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(m.z,{className:"h-10 w-10",workspace:d}),("admin"===u||k)&&(0,a.jsx)(O,{workspace:d})]})}),(0,a.jsx)(x.P,{label:"Workspace Name",description:"Your full workspace name, as visible to others.",children:(0,a.jsx)(j.Wi,{control:N.control,name:"name",render:e=>{let{field:t}=e;return(0,a.jsxs)(j.xJ,{className:"w-full",children:[(0,a.jsx)(j.NI,{children:(0,a.jsx)(f.b,{showTooltip:I,tooltipContent:"You need to be a workspace admin to modify this field",children:(0,a.jsx)(v.I,{...t,placeholder:"Enter workspace name",disabled:I})})}),(0,a.jsx)(j.zG,{})]})}})}),(0,a.jsx)(x.P,{label:"Workspace Description",description:"A short description about your workspace or team.",isLast:!U&&k&&!T,children:(0,a.jsx)(j.Wi,{control:N.control,name:"description",render:e=>{let{field:t}=e;return(0,a.jsxs)(j.xJ,{className:"w-full",children:[(0,a.jsx)(j.NI,{children:(0,a.jsx)(f.b,{showTooltip:I,tooltipContent:"You need to be a workspace admin to modify this field",children:(0,a.jsx)(b.g,{rows:3,className:"border bg-background",placeholder:"Description",disabled:I,...t})})}),(0,a.jsx)(j.zG,{})]})}})}),U&&(0,a.jsx)(x.P,{isLast:k&&!T,label:"Default Monthly Member Credit Limit",description:"The default monthly credit limit for members of this workspace. Leave empty to use no limit.",children:(0,a.jsx)(j.Wi,{control:N.control,name:"defaultMonthlyMemberCreditLimit",render:e=>{var t,s;let{field:n}=e;return(0,a.jsxs)(j.xJ,{className:"w-full",children:[(0,a.jsx)(j.NI,{children:(0,a.jsx)(v.I,{...n,type:"number",placeholder:"Enter default monthly member credit limit (optional)",disabled:I,onChange:e=>{let t=e.target.value;if(""===t)n.onChange(null),N.setValue("defaultMonthlyMemberCreditLimit",null,{shouldDirty:!0});else{let e=Number(t);!isNaN(e)&&e>0&&n.onChange(e)}},onBlur:n.onBlur,name:n.name,value:null===n.value?"":null!==(s=null===(t=n.value)||void 0===t?void 0:t.toString())&&void 0!==s?s:""})}),(0,a.jsx)(j.zG,{})]})}})}),!!T&&(0,a.jsx)(x.P,{label:"Data Collection Opt Out",description:"Opt out of data collection for this workspace.",isLast:k,badges:["business"],children:(0,a.jsx)(j.Wi,{control:N.control,name:"dataOptOut",render:e=>{var t;let{field:s}=e;return(0,a.jsx)(j.xJ,{className:"w-full",children:(0,a.jsx)(j.NI,{children:(0,a.jsx)(y.r,{disabled:!k,checked:null!==(t=s.value)&&void 0!==t&&t,onCheckedChange:s.onChange})})})}})}),k&&(0,a.jsx)(x.P,{label:"Allow editors to invite workspace members",description:D?(0,a.jsxs)("p",{children:[(0,a.jsx)(F.$,{})," to allow editors to invite other users to this workspace."]}):(0,a.jsx)("p",{children:"When enabled, editors can invite other users to this workspace as editors."}),mobileLayout:"horizontal",badges:["pro"],children:(0,a.jsx)(j.Wi,{control:N.control,name:"editorCanInvite",render:e=>{let{field:t}=e;return(0,a.jsx)(y.r,{checked:t.value||!1,onCheckedChange:e=>{if(D){G({childProps:{dialogDescription:"Editor invitation permissions are available on Pro plans and above. Upgrade to unlock this feature and more."}});return}t.onChange(e)},disabled:!1,className:""})}})}),!k&&(0,a.jsx)(x.P,{label:"Leave Workspace",description:"Leave the workspace (you will lose all access to projects inside this workspace).",isLast:!0,children:(0,a.jsx)("div",{className:"flex items-center justify-end gap-2",children:(0,a.jsxs)(g.Vq,{children:[(0,a.jsx)(g.hg,{asChild:!0,children:(0,a.jsx)(p.z,{variant:"destructive",type:"button",loading:A,children:"Leave Workspace"})}),(0,a.jsxs)(g.cZ,{size:"sm",children:[(0,a.jsxs)(g.fK,{children:[(0,a.jsx)(g.$N,{children:"Leave Workspace"}),(0,a.jsx)(g.Be,{children:"Are you sure you want to leave this workspace?"})]}),(0,a.jsxs)(g.cN,{children:[(0,a.jsx)(g.GG,{asChild:!0,children:(0,a.jsx)(p.z,{variant:"outline",children:"Cancel"})}),(0,a.jsx)(p.z,{variant:"destructive",type:"button",loading:A,onClick:()=>P(d.id),children:"Leave Workspace"})]})]})]})})}),N.formState.isDirty&&(0,a.jsx)(x.j,{children:(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,a.jsx)(p.z,{variant:"secondary",type:"button",onClick:()=>{N.reset()},children:"Cancel"}),(0,a.jsx)(p.z,{variant:"affirmative",type:"submit",loading:L,children:"Update"})]})})]})})})};function W(e){let{form:t,workspaceId:s}=e,a=(0,r.NL)(),{authUser:n}=(0,d.Eu)(),{store:l}=(0,u.bm)(),{mutate:c,isPending:m}=(0,i.D)({mutationFn:async e=>{var t,a;return(0,w.SJ)().put("/user/workspaces/".concat(s),{name:e.name,description:null!==(t=e.description)&&void 0!==t?t:"",...void 0!==e.dataOptOut&&{data_opt_out:e.dataOptOut},...void 0!==e.defaultMonthlyMemberCreditLimit&&{default_monthly_member_credit_limit:null===e.defaultMonthlyMemberCreditLimit?-1:e.defaultMonthlyMemberCreditLimit},editor_can_invite:null!==(a=e.editor_can_invite)&&void 0!==a&&a})},onSuccess:e=>{var r,i,c,d,u,m;o.Am.success("Success",{description:"Workspace settings updated successfully"});let x=k.t.detail({workspaceId:s,projectId:void 0}).queryKey;a.setQueryData(x,t=>t?{...t,workspace:e}:{workspace:e,projects:[],is_member:!0,current_member:null});let h=k.t.workspaces({userId:null==n?void 0:n.uid}).queryKey;a.setQueryData(h,t=>t?{workspaces:t.workspaces.map(t=>t.id===e.id?e:t)}:{workspaces:[e]});let p=(null!==(r=null==l?void 0:l.getState().workspaces)&&void 0!==r?r:[]).map(t=>t.id===e.id?e:t);null==l||l.setState({workspaces:p}),t.reset({name:null!==(i=e.name)&&void 0!==i?i:"",description:null!==(c=e.description)&&void 0!==c?c:"",dataOptOut:null!==(d=e.data_opt_out)&&void 0!==d?d:void 0,defaultMonthlyMemberCreditLimit:null!==(u=e.default_monthly_member_credit_limit)&&void 0!==u?u:null,editorCanInvite:null!==(m=e.editor_can_invite)&&void 0!==m&&m})},onError:e=>{(0,N.Eo)(e)}});return{updateWorkspace:c,isUpdatingWorkspace:m}}},35020:function(e,t,s){s.d(t,{O:function(){return o}});var a=s(52155),n=s(38109),r=s(53259),i=s(99792),l=s(87294);let o=()=>{let e=(0,l.Z)("md"),{theme:t,setTheme:s}=(0,n.F)();return e?null:(0,a.jsxs)(r.Ph,{children:[(0,a.jsxs)(r.kt,{children:[(0,a.jsx)(i.Z,{name:"contrast"}),(0,a.jsx)("p",{children:"Appearance"})]}),(0,a.jsx)(r.cq,{children:(0,a.jsx)(r.TG,{children:(0,a.jsxs)(r._x,{value:t,onValueChange:e=>{("light"===e||"dark"===e||"system"===e)&&s(e)},children:[(0,a.jsx)(r.qB,{value:"light",children:"Light"}),(0,a.jsx)(r.qB,{value:"dark",children:"Dark"}),(0,a.jsx)(r.qB,{value:"system",children:"System theme"})]})})})]})}},66151:function(e,t,s){var a=s(52155),n=s(85238),r=s(56852),i=s(99526);s(98244);var l=s(76222),o=s(44647),c=s(59561),d=s(99792);t.Z=e=>{let{plan:t,withWrapper:s=!1,className:u,...m}=e,x=(0,i.usePathname)(),h=(0,l.c)();return(0,o.XB)(t)||!h?null:s?(0,a.jsxs)("div",{className:"flex w-full items-center justify-between rounded-md bg-muted px-3 py-2 text-foreground",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1 text-sm",children:[(0,a.jsx)(d.Z,{name:"crown",size:"small"}),"Turn Pro"]}),(0,a.jsx)(c.z,{size:"sm",className:(0,n.Z)("bg-brand-twilight text-brand-twilight-foreground hover:bg-brand-twilight/80",u),asChild:!0,...m,children:(0,a.jsx)(r.default,{href:"".concat(x,"?settings=billing"),children:"Upgrade"})})]}):(0,a.jsx)(c.z,{size:"sm",className:(0,n.Z)("bg-brand-twilight text-brand-twilight-foreground hover:bg-brand-twilight/80",u),asChild:!0,...m,children:(0,a.jsxs)(r.default,{href:"".concat(x,"?settings=billing"),children:[(0,a.jsx)(d.Z,{name:"crown",size:"small"}),"Upgrade"]})})}},50474:function(e,t,s){s.d(t,{CreateWorkspaceDialog:function(){return C}});var a=s(52155),n=s(98244),r=s(12703),i=s(82259),l=s(59561),o=s(3011),c=s(30335),d=s(15699),u=s(35127),m=s(4578),x=s(5449),h=s(81933),p=s(20018),f=s(29605),g=s(56166),j=s(75970),v=s(45776),b=s(45614),y=s(13273),N=s(94671),w=s(42690);let _=e=>{let{closeDialog:t}=e,s=(0,f.NL)(),{setCurrentWorkspaceId:a}=(0,v.J1)(),{store:n}=(0,i.bm)(),{authUser:l}=(0,j.Eu)(),{toCheckout:o}=(0,b.m)(),{mutate:c,isPending:d}=(0,g.D)({mutationFn:async e=>{let{name:t}=e;return(0,N.SJ)().post("/user/workspaces",{name:t})},onSuccess:async(e,i)=>{var c;let{plan:d,planType:u}=i,m=w.t.workspaces({userId:null==l?void 0:l.uid}).queryKey;s.setQueryData(m,t=>({workspaces:[...(null==t?void 0:t.workspaces)||[],e]}));let x=w.t.detail({workspaceId:e.id,projectId:void 0}).queryKey;s.setQueryData(x,{workspace:e,is_member:!0,current_member:null}),null==n||n.setState({workspaces:[...null!==(c=null==n?void 0:n.getState().workspaces)&&void 0!==c?c:[],e]}),a(e.id);try{if(!e.id)throw Error("Workspace ID is required");await o({plan:d,workspaceId:e.id,changeType:"upgrade",planType:u}),r.Am.success("Workspace created successfully",{description:e.name})}finally{t()}},onSettled:e=>{e&&(s.invalidateQueries({queryKey:w.t.workspaces({userId:null==l?void 0:l.uid}).queryKey}),s.invalidateQueries({queryKey:w.t.detail({workspaceId:e.id,projectId:void 0}).queryKey}))},onError:e=>{(0,y.Eo)(e)}});return{createWorkspace:c,isCreatingWorkspace:d}},k={name:{title:"Create a Workspace",description:"Create a new place to make projects or collaborate with others."},plan:{title:"Select a Plan",description:"Select a plan for your new workspace."}},C=()=>{let e=(0,i.Q)(e=>e.showCreateWorkspaceDialog),t=(0,i.Q)(e=>e.setShowCreateWorkspaceDialog);(0,u.Kq)();let[s,r]=(0,n.useState)("name"),{title:l,description:o}=k[s];return(0,a.jsx)(d.v,{title:l,description:o,open:e,onOpenChange:e=>{e||r("name"),t(e)},className:"plan"===s?"max-w-[600px] md:px-6":"",children:(0,a.jsx)(x.om,{planCardContext:"newWorkspace",children:(0,a.jsx)(S,{closeDialog:()=>{r("name"),t(!1)},step:s,setStep:r})})})},S=e=>{let{closeDialog:t,step:s,setStep:i}=e,[l,o]=(0,n.useState)(""),{createWorkspace:c,isCreatingWorkspace:d}=_({closeDialog:t}),u=(0,p.tS)();return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)(E,{step:s,workspaceName:l,setWorkspaceName:o,closeDialog:t,setStep:i}),(0,a.jsx)(I,{step:s,handleSubmit:()=>{if("name"===s){if(""===l){r.Am.error("Workspace name is required");return}i("plan");return}null!==u.newWorkspaceSelectedPlan&&c({name:l,plan:u.newWorkspaceSelectedPlan,planType:u.planType})},setStep:i,workspaceName:l,isCreatingWorkspace:d})]})},E=e=>{let{step:t,workspaceName:s,setWorkspaceName:n,closeDialog:r,setStep:i}=e;return(0,a.jsxs)("div",{className:(0,m.cn)("hidden flex-col gap-4","name"===t&&"flex"),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2 px-1",children:[(0,a.jsx)(c.Label,{children:"Workspace Name"}),(0,a.jsx)(o.I,{id:"workspaceName",value:s,onChange:e=>n(e.target.value),placeholder:"Enter workspace name",required:!0})]}),(0,a.jsxs)("div",{className:"mt-2 flex w-full gap-6 px-1 pb-1",children:[(0,a.jsx)(l.z,{type:"button",className:"flex-1",variant:"secondary",onClick:r,children:"Go Back"}),(0,a.jsx)(l.z,{className:"flex-1",disabled:!s,type:"button",onClick:()=>i("plan"),children:"Continue to Plan"})]})]})},I=e=>{let{step:t,setStep:s,workspaceName:n,isCreatingWorkspace:r,handleSubmit:i}=e,o=(0,u.Kq)();return(0,a.jsxs)("div",{className:(0,m.cn)("hidden flex-col gap-4","plan"===t&&"flex"),children:[(0,a.jsxs)("div",{className:(0,m.cn)("grid grid-cols-1 gap-4",2==(o?2:1)?"md:grid-cols-2":"md:grid-cols-2 lg:grid-cols-3"),children:[(0,a.jsx)(h.he.Pro,{}),(0,a.jsx)(h.he.Biz,{})]}),(0,a.jsxs)("div",{className:"sticky bottom-0 mt-2 flex w-full gap-6 border-t bg-background px-1 py-3",children:[(0,a.jsx)(l.z,{type:"button",className:"flex-1",variant:"secondary",onClick:()=>s("name"),children:"Go Back"}),(0,a.jsx)(l.z,{className:"flex-1",onClick:i,disabled:!n||r,loading:r,children:r?"Creating...":"Create Workspace"})]})]})}},15699:function(e,t,s){s.d(t,{v:function(){return u}});var a=s(52155),n=s(71286),r=s(94214),i=s(98244),l=s(59561),o=s(99792),c=s(77658),d=s(4578);let u=e=>{let{title:t,description:s,children:u,open:m,onOpenChange:x,className:h}=e;return(0,i.useEffect)(()=>(m?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[m]),(0,a.jsx)(n.Vq,{open:m,onOpenChange:x,children:(0,a.jsx)(n.PK,{children:(0,a.jsxs)(n.cZ,{className:"fixed inset-0 z-[10000] flex items-center justify-center overflow-y-auto bg-background",onCloseAutoFocus:e=>{e.preventDefault(),document.body.style.pointerEvents=""},children:[(0,a.jsxs)(r.TX,{children:[(0,a.jsx)(n.$N,{children:t}),(0,a.jsx)(n.Be,{children:s})]}),(0,a.jsxs)("div",{className:(0,d.cn)("flex max-h-full w-full max-w-96 flex-col gap-6 px-4 py-4 md:px-1",h),children:[(0,a.jsx)(c.xx,{className:"size-9 shrink-0"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("h2",{className:"mr-auto text-2xl md:text-3xl",children:t}),(0,a.jsx)("p",{className:"w-full",children:s})]}),u]}),(0,a.jsx)("div",{className:"absolute right-2 top-2 md:right-8 md:top-8",children:(0,a.jsx)(n.GG,{asChild:!0,children:(0,a.jsx)(l.z,{className:"hover:bg-transparent hover:opacity-75",variant:"ghost",children:(0,a.jsx)(o.Z,{name:"close",size:"small"})})})})]})})})}},8782:function(e,t,s){s.d(t,{X:function(){return o}});var a=s(52155),n=s(67386),r=s(98244),i=s(4578),l=s(99792);let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.fC,{ref:t,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),...r,children:(0,a.jsx)(n.z$,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(l.Z,{name:"check",className:"h-4 w-4"})})})});o.displayName=n.fC.displayName},69628:function(e,t,s){s.d(t,{L:function(){return r}});var a=s(52155),n=s(4578);let r=e=>{let{className:t,text:s="Free"}=e;return(0,a.jsxs)("span",{className:(0,n.cn)("align-baseline text-xs opacity-70",t),children:["(",s,")"]})}},65744:function(e,t,s){s.d(t,{E:function(){return l},m:function(){return o}});var a=s(52155),n=s(44571),r=s(98244),i=s(4578);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.fC,{className:(0,i.cn)("grid gap-2",s),...r,ref:t})});l.displayName=n.fC.displayName;let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.ck,{ref:t,className:(0,i.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),...r,children:(0,a.jsx)(n.z$,{className:"flex items-center justify-center",children:(0,a.jsx)("div",{className:"aspect-square h-2.5 w-2.5 shrink-0 rounded-full bg-primary"})})})});o.displayName=n.ck.displayName},25938:function(e,t,s){s.d(t,{SP:function(){return c},dr:function(){return o},mQ:function(){return l},nU:function(){return d}});var a=s(52155),n=s(41932),r=s(98244),i=s(4578);let l=n.fC,o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.aV,{ref:t,className:(0,i.cn)("inline-flex h-9 items-center justify-center rounded-lg p-1 text-muted-foreground",s),...r})});o.displayName=n.aV.displayName;let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.xz,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",s),...r})});c.displayName=n.xz.displayName;let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.VY,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});d.displayName=n.VY.displayName},55717:function(e,t,s){s.d(t,{$:function(){return i}});var a=s(52155),n=s(19214),r=s(10416);let i=e=>{let{dialogDescription:t="Upgrade to Pro to unlock this feature.",className:s="cursor-pointer text-sm text-muted-foreground underline transition-opacity duration-150 ease-in-out hover:opacity-75",children:i="Upgrade your plan"}=e,l=(0,n.z)(r.g);return(0,a.jsx)("span",{onClick:()=>{l({childProps:{dialogDescription:t}})},className:s,children:i})}},76222:function(e,t,s){s.d(t,{c:function(){return o}});var a=s(75970),n=s(45776),r=s(33877);let i=(e,t)=>!!e&&!!t&&t.owner_id===e,l=()=>{let e=(0,r.MD)(),t=(0,r.q$)(t=>e?t.projectWorkspace:null),s=(0,n.i7)(t=>e?null:t.currentWorkspace);return t||s},o=()=>{let{authUser:e}=(0,a.Eu)(),t=l();return i(null==e?void 0:e.uid,t)}},47684:function(e,t,s){s.d(t,{F:function(){return i}});var a=s(52155),n=s(84183),r=s(98244);let i=e=>{let[t,s]=(0,r.useState)(!1),i=(0,r.useRef)(),l=(0,r.useCallback)(e=>{e&&(clearTimeout(i.current),navigator.clipboard.writeText(e),s(!0),i.current=setTimeout(()=>{s(!1)},1e3))},[]);return s=>{let{TriggerComponent:r,textToCopy:i,copiedFeedbackText:o="Copied!"}=s;return(0,a.jsx)(n.pn,{children:(0,a.jsxs)(n.u,{open:t,children:[(0,a.jsx)(n.aJ,{onClick:t=>{(null==e||!e.altKey||t.altKey)&&i&&l(i)},asChild:!0,className:"hello",children:(0,a.jsx)(r,{})}),(0,a.jsx)(n._v,{children:(0,a.jsx)("p",{children:o})})]})})}}},33563:function(e,t,s){s.d(t,{t:function(){return c}});var a=s(61504),n=s(1178),r=s(44647);let i=e=>{if(!e)return!1;let t=(0,r.fA)(e.plan),s="ambassador"===e.plan;return(t||s)&&(0===e.billing_period_credits_limit||void 0===e.billing_period_credits_limit)},l=e=>e?"string"==typeof e?new Date(e):e.toDate():null,o=e=>{if(!e)return null;if("annual"===e.plan_type){let t=l(e.last_rollover_period||e.billing_period_start_date||e.billing_period_end_date);if(t){let e=t.getMonth()+1,s=t.getFullYear(),a=t.getDate(),n=new Date(s,e+1,0).getDate();return new Date(s,e,Math.min(a,n))}return null}return e.billing_period_end_date?l(e.billing_period_end_date):null},c=e=>{var t,s;let{billingPeriodCreditLimit:l,billingPeriodCreditsUsed:c,dailyCreditLimit:d,dailyCreditsUsed:u,bonusCredits:m,billingPeriodEndDate:x,totalCreditsUsedInBillingPeriod:h}=(0,a.O)(e),p=(null==e?void 0:e.plan)==="free"?Math.max(0,Math.min(r.dv-(null!=h?h:0),null!=d?d:0)):null!=d?d:0,f={granted:(0,n.G)(null!=m?m:0),billing:(0,n.G)(null!=l?l:0),rollover:(0,n.G)(null!==(t=null==e?void 0:e.rollover_credits_limit)&&void 0!==t?t:0),daily:(0,n.G)(p)},g={granted:0,billing:(0,n.G)(Math.min(null!=c?c:0,f.billing)),rollover:(0,n.G)(Math.min(null!==(s=null==e?void 0:e.rollover_credits_used)&&void 0!==s?s:0,f.rollover)),daily:(0,n.G)(Math.min(null!=u?u:0,f.daily))},j=i(e),v={granted:(0,n.G)(f.granted-g.granted),billing:j?0:(0,n.G)(f.billing-g.billing),rollover:(0,n.G)(f.rollover-g.rollover),daily:(0,n.G)(f.daily-g.daily)},b=(0,n.G)(v.granted+v.billing+v.rollover+v.daily),y=(0,n.G)(g.billing+g.rollover+g.daily),N=(0,n.G)(j?f.granted+f.rollover+f.daily:f.granted+f.billing+f.rollover+f.daily);return{totalRemaining:b,totalAllocation:N,totalUsed:y,sources:[{name:"granted",remaining:v.granted,limit:f.granted},{name:"billing",remaining:v.billing,limit:f.billing},{name:"rollover",remaining:v.rollover,limit:f.rollover},{name:"daily",remaining:v.daily,limit:f.daily}].filter(e=>e.remaining>0),hasCredits:N>0,currentlyConsuming:v.daily>0?"daily":v.rollover>0?"rollover":v.billing>0?"billing":v.granted>0?"granted":null,billingPeriodEndDate:x,creditsResetDate:o(e)}}},54775:function(e,t,s){s.d(t,{GD:function(){return o},Zl:function(){return c},Hp:function(){return x},Mn:function(){return m}});var a=s(12703),n=s(25243),r=s(84864);let i="https://github.com/login/oauth/authorize?client_id=".concat("Iv1.365d6a195dbca85b"),l="https://github.com/apps/".concat("lovable-dev","/installations/new"),o="githubOAuthNonce",c=n.Ry({nonce:n.Z_(),workspaceId:n.Z_().optional()}),d=e=>(null==e?void 0:e.id)?"".concat(l,"/permissions?target_id=").concat(e.id,"&target_type=").concat(e.type):l,u=(e,t)=>{let s=crypto.randomUUID();try{localStorage.setItem(o,s)}catch(e){r.logging.error("Failed to set state in GitHub OAuth popup"),a.Am.error("Failed to initiate GitHub OAuth flow",{description:"Try clearing browser local storage and try again."});return}let n=(null==t?void 0:t.workspaceId)?{nonce:s,workspaceId:t.workspaceId}:{nonce:s,workspaceId:void 0},i=new URL(e);i.searchParams.set("state",btoa(JSON.stringify(n))),e=i.toString();let l=window.open(e,"_blank","width=600,height=700,left=100,top=100");if(!l){r.logging.error("Failed to open GitHub OAuth popup");return}l.focus()},m=e=>{let{githubOwner:t,workspaceId:s}=e;u(d(t),{workspaceId:s})},x=()=>{u(i)}},34841:function(e,t,s){s.d(t,{D:function(){return l}});var a=s(68820),n=s(98244),r=s(37156),i=s(46724);let l=e=>{var t,s,l,o;let{enabled:c}=e,{userData:d}=(0,r.SE)(),u=(0,a.a)(i.V.installations({enabled:c})),m=null==d?void 0:null===(t=d.github)||void 0===t?void 0:t.encrypted_access_token,x=(0,n.useRef)(m);return(0,n.useEffect)(()=>{x.current!==m&&(u.refetch(),x.current=m)},[m,u]),{isLoading:u.isLoading,installations:null===(s=u.data)||void 0===s?void 0:s.installations,hasAccessToken:null===(l=u.data)||void 0===l?void 0:l.has_access_token,hasValidAccessToken:null===(o=u.data)||void 0===o?void 0:o.has_valid_access_token}}},93386:function(e,t,s){s.d(t,{G:function(){return l},d:function(){return c}});var a=s(29605),n=s(98244),r=s(12703),i=s(25243);let l="mcp_oauth_data",o=i.Ry({type:i.i0("mcpAuth"),success:i.O7(),error:i.Z_().optional()}),c=e=>{let{workspaceId:t,onConnectSuccess:s,onConnectError:i,enabled:l=!0}=e,c=(0,a.NL)();(0,n.useEffect)(()=>{if(!l)return;let e=async e=>{if(e.origin!==window.location.origin)return;let a=o.safeParse(e.data);a.success&&(a.data.success?(r.Am.success("Authorization successful!"),await c.invalidateQueries({queryKey:["mcp-servers",t]}),s&&s()):(r.Am.error(a.data.error||"OAuth authorization failed"),i&&i()))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[c,t,s,i,l])}},61504:function(e,t,s){s.d(t,{O:function(){return o}});var a=s(68820),n=s(98244),r=s(75970),i=s(94671),l=s(32282);let o=e=>{var t,s,o,d,u;let{isAuthenticated:m,authUser:x}=(0,r.Eu)(),{data:h}=(0,a.a)({queryKey:[...l.E.detail(null!==(t=null==e?void 0:e.id)&&void 0!==t?t:""),"users",null!==(s=null==x?void 0:x.uid)&&void 0!==s?s:"","monthly-usage"],queryFn:async()=>(null==e?void 0:e.id)&&(null==x?void 0:x.uid)?(0,i.SJ)().get("/workspaces/".concat(null==e?void 0:e.id,"/user-monthly-usage")):{user_monthly_usage:0,max_usage:0},enabled:!!(null==e?void 0:e.id)&&!!(null==x?void 0:x.uid)}),p=(0,n.useMemo)(()=>{var t;if(e&&m)return(null!==(t=e.credits_granted)&&void 0!==t?t:0)-e.credits_used>0||e.daily_credits_used<e.daily_credits_limit||(e.billing_period_credits_used||0)<e.billing_period_credits_limit},[e,m]),f=null==e?void 0:e.daily_credits_limit,g=null==e?void 0:e.daily_credits_used;return{dailyCreditLimit:f,dailyCreditsUsed:g,billingPeriodCreditLimit:null==e?void 0:e.billing_period_credits_limit,billingPeriodCreditsUsed:null==e?void 0:e.billing_period_credits_used,totalCreditsUsedInBillingPeriod:null==e?void 0:e.total_credits_used_in_billing_period,rolloverCredits:(null==e?void 0:e.rollover_credits_limit)!==void 0&&(null==e?void 0:e.rollover_credits_used)!==void 0?e.rollover_credits_limit-e.rollover_credits_used:void 0,bonusCredits:(null==e?void 0:e.credits_granted)!==void 0?e.credits_granted-(null!==(o=e.credits_used)&&void 0!==o?o:0):void 0,areCreditsAvailable:p,billingPeriodEndDate:c(null==e?void 0:e.billing_period_end_date),userMonthlyUsage:null!==(d=null==h?void 0:h.user_monthly_usage)&&void 0!==d?d:0,maxUserMonthlyUsage:null!==(u=null==h?void 0:h.max_usage)&&void 0!==u?u:0}},c=e=>e?"string"==typeof e?new Date(e):e.toDate():null},48535:function(e,t,s){s.d(t,{H$:function(){return p},hT:function(){return j},qV:function(){return f}});var a=s(56166),n=s(95713),r=s(98244),i=s(43456),l=s(7287),o=s(94671),c=s(92361),d=s(84864),u=s(94127),m=s(66813),x=s(17138);function h(e){var t,s,a;let n=e.meta_data?"|".concat(null===(t=e.meta_data)||void 0===t?void 0:t.colno,"|").concat(null===(s=e.meta_data)||void 0===s?void 0:s.lineno,"|").concat(null===(a=e.meta_data)||void 0===a?void 0:a.filename):"";return"".concat(e.error_message,"|").concat(e.type).concat(n)}function p(e){return e.filter((e,t,s)=>t===s.findIndex(t=>h(t)===h(e)))}function f(e){let{projectId:t,errorIds:s,setErrors:n}=e;return(0,a.D)({mutationFn:async()=>(n([]),(0,o.SJ)().patch("/projects/".concat(t,"/handle-errors"),{error_ids:s})),onError:e=>{d.logging.error("failed_to_submit_handled_errors",{error:e})}})}let g=e=>{e.sort((e,t)=>e.type===u.N.RUNTIME&&t.type!==u.N.RUNTIME?-1:t.created_at.seconds-e.created_at.seconds);let t={uniqueErrors:[],runtimeErrorMessages:new Set};return e.reduce((e,t)=>{if(t.type===u.N.IMMEDIATE_RUNTIME||t.type===u.N.RUNTIME){let s=t.error_message.replace(/\?v=[a-z0-9]{8}/,"?'");e.runtimeErrorMessages.has(s)||(e.runtimeErrorMessages.add(s),e.uniqueErrors.push(t))}else e.uniqueErrors.push(t);return e},t).uniqueErrors},j=e=>{let{projectId:t}=e,[s,a]=(0,r.useState)([]),u=(0,o.SJ)(),h=(0,l.vE)();(0,i.ZP)(h,{protocols:"vite-hmr",share:!0,onMessage:e=>{try{let a=JSON.parse(e.data);if((null==a?void 0:a.type)==="error"){var s;d.logging.info("build_error_from_devserver",{message:null==a?void 0:null===(s=a.err)||void 0===s?void 0:s.message});let e=m.p.safeParse(null==a?void 0:a.err);e.success?(0,x.e)(e.data,t,u):(d.logging.error("error_parsing_devserver_error",{error:e}),(0,x.e)(null==a?void 0:a.err,t,u))}}catch(e){d.logging.error("error_parsing_devserver_error",{error:e})}},onOpen:e=>{d.logging.debug("devserver_websocket_open")},onClose:e=>{d.logging.debug("devserver_websocket_close")},onError:e=>{d.logging.error("devserver_websocket_error",{event:e})},shouldReconnect:()=>!0,reconnectInterval:1e3});let p=f({projectId:t,errorIds:s.map(e=>e.id),setErrors:a});return(0,r.useEffect)(()=>{let e=function(e,t){let s=(0,n.hJ)(c.db,"projects/".concat(e,"/errors")),a=(0,n.IO)(s,(0,n.ar)("handled_at","==",null));return(0,n.cf)(a,e=>{e.empty?t([]):t(e.docs.map(e=>({...e.data(),id:e.id})))})}(t,a);return()=>e()},[t]),{errors:(0,r.useMemo)(()=>0===s.length?null:g(s),[s]),setErrors:a,handleErrorMutation:s.length>0?p:null}}},39592:function(e,t,s){s.d(t,{c:function(){return i}});var a=s(36424),n=s(94671),r=s(32282);let i={domains:e=>{let{projectId:t,enabled:s=!0}=e;return(0,a.C)({queryKey:r.iZ.domains(t),queryFn:async()=>(0,n.SJ)().get("/projects/".concat(t,"/domains")),refetchOnMount:!1,refetchOnWindowFocus:!1,enabled:s&&!!t,staleTime:3e5,retry:!1})}}},13063:function(e,t,s){s.d(t,{P:function(){return a}});let a=e=>e.replace(/(^\w+:|^)\/\//,"")},58010:function(e,t,s){s.d(t,{LJ:function(){return r},ZU:function(){return l},sb:function(){return i}});var a=s(18587),n=s(72353);function r(e){return{absolute:(0,a.WU)(e,"h:mm a"),relative:(0,a.WU)(e,"h:mm a")}}function i(e){let t=!(0,n.X)(e),s="MMM d";return t&&(s+=", yyyy"),s+=", h:mm a",{absolute:(0,a.WU)(e,s),relative:(0,a.WU)(e,s)}}function l(e){return"string"==typeof e?new Date(e):e.toDate()}},1178:function(e,t,s){s.d(t,{G:function(){return a},H:function(){return n}});let a=e=>Number.isFinite(e)?Math.round(100*e)/100:0,n=e=>{if(!Number.isFinite(e)||e<0)return"0";let t=Math.round(10*e)/10;return t===Math.floor(t)?t.toLocaleString():t.toLocaleString(void 0,{minimumFractionDigits:1,maximumFractionDigits:1})}}}]);