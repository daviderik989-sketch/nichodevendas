try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="d6cfb047-29e0-462c-9af3-0549d12d4cfe",e._sentryDebugIdIdentifier="sentry-dbid-d6cfb047-29e0-462c-9af3-0549d12d4cfe")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[113],{86338:function(e,t,n){n.d(t,{v:function(){return m}});var r=n(56166),a=n(17195),s=n(98244),i=n(37156),l=n(3989),o=n(13273),c=n(94671),d=n(89671),u=n(35127);let m=()=>{let e=(0,u.zq)(),t=(0,c.SJ)(),{userData:n}=(0,i.SE)(),m=(0,l.hT)(e=>e.chatMode),{setChatMode:p}=(0,l.VK)(),g=(0,s.useRef)(!1);(0,s.useEffect)(()=>{if(!e||g.current||!n)return;g.current=!0;let t=!0!==n.disable_agent_mode;t&&m===l.jE.DEFAULT?p(l.jE.AGENT):t||m!==l.jE.AGENT||p(l.jE.DEFAULT)},[e,n,m,p]);let{mutate:f}=(0,r.D)({onError:()=>{(0,o.Eo)("Error saving agent mode setting")},onMutate:e=>{p(e?l.jE.AGENT:l.jE.DEFAULT)},mutationFn:async e=>{if(!n)throw Error("Error setting agent mode");a.ZP.capture(d.SL.SETTINGS.AGENT_MODE_DISABLED,{agent_mode_disabled:!e}),await t.put("/user/".concat(n.id),{disable_agent_mode:!e})}});return{agentModeEnabled:e&&m===l.jE.AGENT,isAgentModeDefault:e&&(null==n?void 0:n.disable_agent_mode)!==!0,setAgentMode:f}}},36803:function(e,t,n){n.d(t,{SS:function(){return l},pQ:function(){return c},zF:function(){return o}});var r=n(13018),a=n(50484),s=n(32766),i=n(3989);let l="goodmodel",o=()=>(0,r.dl)(a.P.Bronzeage),c=()=>{let e=o(),t=(0,i.hT)(e=>e.chatMode)===i.jE.DEFAULT,[n,r]=(0,s.B)("isBronzeageEnabled",{defaultValue:!1});return[n&&!!e&&!t,r]}},32766:function(e,t,n){n.d(t,{B:function(){return a}});var r=n(52532);let a=function(e){let{defaultValue:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{defaultValue:!1},[n,a]=(0,r.Z)(e,{defaultValue:t});return[n,a]}},54494:function(e,t,n){n.d(t,{G:function(){return d},h:function(){return c}});var r=n(52155),a=n(68820),s=n(98244),i=n(25437),l=n(75970);let o=(0,s.createContext)(null);function c(e){let{children:t}=e,{authUser:n}=(0,l.Eu)(),{data:c,isLoading:d}=(0,a.a)(i.V.experimentalFeatures({user:n})),u=(0,s.useMemo)(()=>({features:c||null,isLoading:d}),[c,d]);return(0,r.jsx)(o.Provider,{value:u,children:t})}function d(){let e=(0,s.useContext)(o);if(!e)throw Error("LabsFeaturesContext not found");return e}},51817:function(e,t,n){n.d(t,{L6:function(){return c},Rc:function(){return o},fm:function(){return i}});var r=n(52155),a=n(98244);let s="editor-mode-store",i=["auto","gpt-4.1","gpt-4.1-mini","bronzeage-l","bronzeage-m","goodmodel","bronzeage-h","o4-mini","gemini-2.5-pro","gemini-2.5-flash","claude-3.5-sonnet","claude-3.7-sonnet","claude-4-sonnet","claude-4-opus","kimi-k2","grok-4"],l=(0,a.createContext)(null),o=e=>{let{children:t}=e,[n,i]=(0,a.useState)(()=>null);return(0,a.useEffect)(()=>{null===n?localStorage.removeItem(s):localStorage.setItem(s,JSON.stringify(n))},[n]),(0,r.jsx)(l.Provider,{value:{selectedModel:n,setSelectedModel:i},children:t})},c=()=>{let e=(0,a.useContext)(l);if(!e)throw Error("useGetSelectedChatModel must be used within a ModelSelectorProvider");return e}},44854:function(e,t,n){n.d(t,{Cg:function(){return l},hP:function(){return x},zL:function(){return h}});var r=n(22774),a=n(25243),s=n(84864);let i=new r.XMLParser({ignoreAttributes:!1,preserveOrder:!0,trimValues:!0}),l=e=>null!=e&&"object"==typeof e&&"type"in e&&"tool_use"===e.type&&"name"in e&&"data"in e&&"done"in e;a.Ry({type:a.i0("lov-sql"),lovSql:a.Z_(),done:a.O7()}),a.Ry({type:a.i0("lov-mermaid"),mermaidCode:a.Z_(),done:a.O7()});let o=a.Ry({type:a.i0("lov_action__link"),url:a.Z_(),text:a.Z_()}),c=a.Ry({type:a.i0("lov_action__migrate"),toolUseId:a.Z_().optional(),done:a.O7()}),d=a.Ry({type:a.i0("lov_action__message_prompt"),message:a.Z_(),text:a.Z_()}),u=a.Ry({type:a.i0("lov_action__knowledge")}),m=a.Ry({type:a.i0("lov_action__secret_form"),name:a.Z_()}),p=a.Ry({type:a.i0("lov_action__suggestion"),message:a.Z_(),text:a.Z_()}),g=a.Ry({type:a.i0("lov_action__provider_card"),provider:a.Z_()}),f=a.G0([o,c,d,u,m,p,g]);function h(e){return e.parts.filter(e=>"done"in e&&e.done&&("search_replace_parts"in e||"content"in e)).length}function x(e){let t=[],n=[],r=null,a=!1,o=!1,c=!1,d=!1,u=!1,m=!1,p=!1,g=!1,h=!1,x="",b="",_="",y="",j=null,w="",S="";function N(){var e,N,E,C,k,T,I;let A=_.trim();if("<lov-plan>"===A||"</lov-plan>"===A){_="";return}if(_.trim().startsWith("<lov-tool-use")){let i;h=!0;let l=(y=_).match(/id="([^"]*)"/),o=y.match(/name="([^"]*)"/),c=y.match(/data="((?:[^"\\]|\\.)*)"(?=\s|\/|>)/),d=y.match(/data="(.*)$/),u=y.match(/failed="([^"]*)"/),m=(null==u?void 0:u[1])==="true",p=y.match(/requires-approval="([^"]*)"/),g=(null==p?void 0:p[1])==="true",f=y.match(/user-input="((?:[^"\\]|\\.)*)"/);if(null==f?void 0:f[1])try{let e=f[1].replace(/\\"/g,'"');e=e.replace(/\\\\/g,"\\"),i=JSON.parse(e)}catch(e){s.logging.error("Failed to parse user input",{error:e,userInput:f[1]})}let x=y.match(/duration="([^"]*)"/),b=x?Math.floor(parseFloat(x[1])):void 0;if(void 0!==b&&b<=0&&(b=1),o&&r){let s=c?c[1]:d?d[1]:"",u=s?v(s):{};a&&r&&"parts"in r?r.parts.push({type:"tool_use",id:null!==(e=null==l?void 0:l[1])&&void 0!==e?e:null,name:o[1],data:s,parsedData:u,done:!1,failed:m,duration:b,requiresApproval:g,userInput:i}):(t.push(r),t.push({type:"tool_use",id:null!==(N=null==l?void 0:l[1])&&void 0!==N?N:null,name:o[1],data:s,parsedData:u,done:!1,failed:m,duration:b,requiresApproval:g,userInput:i}),r={type:"text",content:""}),l&&("lov-supabase-migration"===o[1]||"supabase--migration"===o[1])&&!n.find(e=>"lov_action__migrate"===e.type)&&n.push({type:"lov_action__migrate",done:!1,toolUseId:l[1]})}}else if(h){if(y+=_,_.includes("</lov-tool-use>")){if(h=!1,a&&r&&"parts"in r){let e=r.parts.findLastIndex(e=>"tool_use"===e.type);if(e>=0){let t=r.parts[e];if(t.done=!0,t.id&&("lov-supabase-migration"===t.name||"supabase--migration"===t.name)){let e=n.find(e=>"lov_action__migrate"===e.type&&e.toolUseId===t.id);e&&"lov_action__migrate"===e.type&&(e.done=!0)}}}else{let e=t.findLastIndex(e=>l(e));if(e>=0){let r=t[e];if(r.done=!0,r.id&&("lov-supabase-migration"===r.name||"supabase--migration"===r.name)){let e=n.find(e=>"lov_action__migrate"===e.type&&e.toolUseId===r.id);e&&"lov_action__migrate"===e.type&&(e.done=!0)}}}}}else if("<thinking>"===_.trim())a&&r&&"parts"in r?r.parts.push({type:"tool_use",id:null,name:"lov-think",data:"",parsedData:{},done:!1,failed:!1,requiresApproval:!1}):(r&&t.push(r),t.push({type:"tool_use",id:null,name:"lov-think",data:"",parsedData:{},done:!1,failed:!1,requiresApproval:!1}),r={type:"text",content:""}),p=!0,_="";else if("</thinking>"===_.trim()){let e=S.trim(),n={content:e};if(a&&r&&"parts"in r){let t=r.parts.findLastIndex(e=>"tool_use"===e.type&&"lov-think"===e.name);if(t>=0){let a=r.parts[t];a.done=!0,a.data=e,a.parsedData=n}}else{let r=t.findLastIndex(e=>l(e)&&"lov-think"===e.name);if(r>=0){let a=t[r];a.done=!0,a.data=e,a.parsedData=n}}p=!1,S="",_=""}else if("<lov-code>"===_.trim())r&&t.push(r),a=!0,r={parts:[],done:!1};else if("</lov-code>"===_.trim())r&&"done"in r&&(r.done=!0,t.push(r),r=null),a=!1;else if("<lov-sql>"===_.trim())r&&t.push(r),o=!0,r={type:"lov-sql",lovSql:"",done:!1};else if("</lov-sql>"===_.trim())r&&"lovSql"in r&&(r.done=!0,t.push(r),n.find(e=>"lov_action__migrate"===e.type)||n.push({type:"lov_action__migrate",done:!0}),r=null),o=!1;else if("<lov-mermaid>"===_.trim())r&&t.push(r),c=!0,r={type:"lov-mermaid",mermaidCode:"",done:!1};else if("</lov-mermaid>"===_.trim())r&&"mermaidCode"in r&&(r.done=!0,t.push(r),r=null),c=!1;else if(["<lov-actions>","<actions>"].includes(_.trim()))g=!0;else if(["</lov-actions>","</actions>"].includes(_.trim()))g=!1,n.push(...function(e){try{return i.parse(e).map(e=>{try{var t,n,r,a,i,l,o,c,d,u,m;if("lov-link"in e)return{type:"lov_action__link",url:null===(t=e[":@"])||void 0===t?void 0:t["@_url"],text:null===(r=e["lov-link"])||void 0===r?void 0:null===(n=r[0])||void 0===n?void 0:n["#text"]};if("lov-knowledge"in e)return{type:"lov_action__knowledge"};if("lov-message-prompt"in e)return{type:"lov_action__message_prompt",message:null===(a=e[":@"])||void 0===a?void 0:a["@_message"],text:null===(l=e["lov-message-prompt"])||void 0===l?void 0:null===(i=l[0])||void 0===i?void 0:i["#text"]};if("lov-secret-form"in e)return{type:"lov_action__secret_form",name:null===(o=e[":@"])||void 0===o?void 0:o["@_name"]};if("lov-suggestion"in e)return{type:"lov_action__suggestion",message:null===(c=e[":@"])||void 0===c?void 0:c["@_message"],text:null===(u=e["lov-suggestion"])||void 0===u?void 0:null===(d=u[0])||void 0===d?void 0:d["#text"]};if("lov-provider-card"in e)return{type:"lov_action__provider_card",provider:null===(m=e[":@"])||void 0===m?void 0:m["@_provider"]};return s.logging.error("Unknown Lov action",{node:e}),null}catch(t){return s.logging.error("Error processing XML node",{error:t,node:e}),null}}).filter(e=>null!==e).reduce((e,t)=>{let n=f.safeParse(t);return n.success?e.push(n.data):s.logging.error("Failed to validate Lov action",{action:t,error:n.error}),e},[])}catch(t){return s.logging.error("Error parsing XML in parseLovActions",{error:t,input:e}),[]}}(w)),w="";else if(_.startsWith('<lov-write file_path="'))d=!0,b=(null===(E=_.match(/"([^"]*)"/))||void 0===E?void 0:E[1])||"",a&&r&&"parts"in r&&r.parts.push({type:"writing_file",file_path:b,content:"",done:!1});else if(_.startsWith('<lov-search-replace file_path="'))u=!0,b=(null===(C=_.match(/"([^"]*)"/))||void 0===C?void 0:C[1])||"",a&&r&&"parts"in r&&r.parts.push({type:"edit",file_path:b,search_replace_parts:[],done:!1});else if(_.startsWith('<lov-delete file_path="'))m=!0,b=(null===(k=_.match(/"([^"]*)"/))||void 0===k?void 0:k[1])||"",a&&r&&"parts"in r&&r.parts.push({type:"delete",file_path:b});else if(_.startsWith('<lov-rename original_file_path="')){let e=(null===(T=_.match(/original_file_path="([^"]*)"/))||void 0===T?void 0:T[1])||"",t=(null===(I=_.match(/new_file_path="([^"]*)"/))||void 0===I?void 0:I[1])||"";a&&r&&"parts"in r&&r.parts.push({type:"rename",original_file_path:e,new_file_path:t})}else if(_.startsWith("<lov-add-dependency>"))x=_.replace("<lov-add-dependency>","").replace("</lov-add-dependency>","").trim(),a&&r&&"parts"in r&&r.parts.push({type:"add_dependency",dependency:x,isDevDependency:!1});else if("</lov-add-dependency>"===_.trim())x="";else if(_.startsWith("<lov-add-dev-dependency>"))x=_.replace("<lov-add-dev-dependency>","").replace("</lov-add-dev-dependency>","").trim(),a&&r&&"parts"in r&&r.parts.push({type:"add_dependency",dependency:x,isDevDependency:!0});else if("</lov-add-dev-dependency>"===_.trim())x="";else if(_.startsWith("<lov-remove-dependency>")){let e=_.replace("<lov-remove-dependency>","").replace("</lov-remove-dependency>","").trim();a&&r&&"parts"in r&&r.parts.push({type:"remove_dependency",removed_dependency:e})}else if("</lov-remove-dependency>"===_.trim())x="";else if("</lov-write>"===_.trim()||"</lov-search-replace>"===_.trim()||"/>"===_.trim()&&m){if(d=!1,u=!1,m=!1,b="",a&&r&&"parts"in r){let e=r.parts[r.parts.length-1];"done"in e&&(e.done=!0)}}else if(a){if(h);else if(r&&"parts"in r){if(r.parts.length>0){let e=r.parts[r.parts.length-1];if(d&&"content"in e)e.content+=_;else if(u&&"search_replace_parts"in e){if("<lov-search>"===_.trim())e.search_replace_parts.push({search:"",replace:""}),j="search";else if("<lov-replace>"===_.trim())j="replace";else if("</lov-search>"===_.trim()||"</lov-replace>"===_.trim())j=null;else{let t=e.search_replace_parts[e.search_replace_parts.length-1];t&&j&&(t[j]+=_)}}else"text"===e.type&&"content"in e?e.content+=_:r.parts.push({type:"text",content:_})}else r.parts.push({type:"text",content:_})}}else o?r&&"lovSql"in r&&(r.lovSql+=_):c?r&&"mermaidCode"in r&&(r.mermaidCode+=_):g?w+=_:p?S+=_:(r&&"content"in r||(r={type:"text",content:""}),"content"in r&&(r.content+=_));_=""}let E=0;for(;E<e.length;){if(o){let t="</lov-sql>",n=e.indexOf(t,E);if(-1===n){_+=e.slice(E),E=e.length;break}_+=e.slice(E,n),N(),_=t,N(),E=n+t.length;continue}if(c){let t="</lov-mermaid>",n=e.indexOf(t,E);if(-1===n){_+=e.slice(E),E=e.length;break}_+=e.slice(E,n),N(),_=t,N(),E=n+t.length;continue}if("<"===e[E]){_&&N();let t=E,n=!1;for(;t<e.length&&!(++t>=e.length);){if('"'===e[t]){t>0&&"\\"===e[t-1]||(n=!n);continue}if(">"===e[t]&&!n)break}t<e.length?(_=e.substring(E,t+1),N(),E=t+1):(_+=e[E],E++)}else _+=e[E],E++}return _&&N(),r&&t.push(r),{parts:t,lovActions:n}}let v=e=>{let t=e.replace(/\\"/g,'"');t=t.replace(/\\\\/g,"\\");try{return JSON.parse(t)}catch(a){let e;let n={},r=/"([^"]+)":\s*(?:"([^"]*)"?|(true|false|null|\d+(?:\.\d+)?))/g;for(;null!==(e=r.exec(t));){let t=e[1],r=void 0!==e[2]?e[2]:e[3];n[t]=r}return n}}},69395:function(e,t,n){n.d(t,{Z:function(){return p}});var r=n(17195),a=n(98244),s=n(12703),i=n(37156),l=n(21198),o=n(70980),c=n(92209),d=n(84864),u=n(65276),m=n(36190);function p(){let{setIsOutOfCreditsDialogOpen:e}=(0,i.SE)(),{removeMessage:t}=(0,l.mx)(),{showErrorDialog:n}=(0,u.t)(),{setIsSendChatMessageMutationPending:p}=(0,o.Xr)();return{handleChatStreamingError:(0,a.useCallback)((a,i)=>{var l,o,u,g,f,h,x;let v;let{lastUserMessageId:b,lastOptimisticMessageId:_,onErrorHandled:y}=i;if(t(b),_&&t(_),"AbortError"!==a.name){if(a instanceof c.O){if(v=a.traceId,429===a.status)d.logging.error("rate_limit_exceeded",{error:a}),(0,m.rI)(),r.ZP.capture("send_chat_request_rate_limit_exceeded"),a.message.includes("We are currently under heavy load, please try again later")?s.Am.error("We are currently under heavy load, please try again later"):n(a.message,!1,v),null==y||y();else if(402===a.status)r.ZP.capture("out_of_credits_dialog_opened"),e(!0),null==y||y();else if(503===a.status)d.logging.error("send_chat_request_service_unavailable",{error:a}),n(("string"==typeof(null===(l=a.response)||void 0===l?void 0:l.details)?a.response.details:void 0)||a.message,!1,v),null==y||y();else if(499===a.status){d.logging.info("send_chat_request_client_closed",{error:a}),null==y||y();return}else{if(a.status>=500?d.logging.error("send_chat_request_internal_error",{error:a}):d.logging.error("send_chat_request_failed",{error:a}),p(!1),400===a.status){let e=(null===(g=a.response)||void 0===g?void 0:g.detail)||(null===(f=a.response)||void 0===f?void 0:f.details)||a.message||"Request failed";s.Am.error(e),null==y||y();return}n((null===(o=a.response)||void 0===o?void 0:o.detail)||(null===(u=a.response)||void 0===u?void 0:u.details)||a.message||"Request failed",!1,v),null==y||y()}}else"message"in a&&"type"in a?(d.logging.error("send_chat_request_error",{error:a}),n(a.message,!1)):(d.logging.error("send_chat_request_unknown_reason",{message:null==a?void 0:a.message,stack:null==a?void 0:a.stack,isOnline:navigator.onLine,errorType:a instanceof TypeError?"NetworkError":"ApplicationError",isNetworkError:null==a?void 0:null===(h=a.message)||void 0===h?void 0:h.includes("Failed to fetch"),isCorsError:null==a?void 0:null===(x=a.message)||void 0===x?void 0:x.includes("CORS"),isTimeout:(null==a?void 0:a.name)==="TimeoutError",isAbort:(null==a?void 0:a.name)==="AbortError",isDomException:a instanceof DOMException,error:a}),n()),null==y||y()}},[t,n,e,p])}}},87950:function(e,t,n){n.d(t,{t:function(){return u}});var r=n(17195),a=n(75970),s=n(21198),i=n(98244);let l="start-request",o="first-token",c="end-request",d="start-request";function u(){let{authUser:e}=(0,a.Eu)(),{snapshot:{getUserMessageCount:t,getLastUserMessage:n}}=(0,s.mx)();return{createChatRequestPerformanceMeasurer:(0,i.useCallback)(a=>{var s,i;let{projectId:u}=a,m=1>=t(),p=null!==(i=null===(s=n())||void 0===s?void 0:s.chatOnly)&&void 0!==i&&i,g=()=>performance.getEntriesByName(l,"mark").length>0;return{measureRequestStart:()=>{performance.mark(l)},measureTimeToFirstToken:()=>{if(!g())return;performance.mark(o);let t=performance.measure(d,l,o);r.ZP.capture("time_to_first_token",{duration:t.duration,project_id:u,user_id:null==e?void 0:e.uid,chat_only:p,is_creation:m})},measureTimeToLastToken:()=>{if(!g())return;performance.mark(c);let t=performance.measure(d,l,c);r.ZP.capture("time_to_last_token",{duration:t.duration,project_id:u,user_id:null==e?void 0:e.uid,chat_only:p,is_creation:m})}}},[t,n,null==e?void 0:e.uid])}}},17001:function(e,t,n){n.d(t,{m:function(){return u},u:function(){return d}});var r=n(95713),a=n(98244),s=n(75970),i=n(21198),l=n(3989),o=n(33619),c=n(39230);let d='\n<lov-tool-use id="thinking-opt" name="lov-think" data="">\n';function u(){let{authUser:e}=(0,s.Eu)(),t=null==e?void 0:e.uid,{updateMessage:n}=(0,i.mx)(),u=(0,l.hT)(e=>e.chatMode!==l.jE.DEFAULT);return{createOptimisticMessage:(0,a.useCallback)(e=>{var a,s;let{body:i}=e,l={id:i.id,createdAt:new Date,role:"user",type:"userMessage",selectedElements:null!==(a=i.selected_elements)&&void 0!==a?a:[],content:i.message,tags:null!==(s=i.tags)&&void 0!==s?s:[],images:[],containsError:!!i.contains_error,userId:t,optimistImageUrls:i.optimisticImageUrls};if(n(i.id,l,!0),("enabled"===i.agent_mode||!0===i.chat_only||u)&&i.ai_message_id){let e={id:i.ai_message_id,created_at:r.EK.fromDate(new Date),content:d,thinking_time_ms:0,exclude_from_history:!1,message_type:"aiMessage",status:"running",stopped:!1,graph_id:"optimistic-graph-id",role:o.r.role.AI,tag:o.r.tag.INSTANT_MODE_MESSAGE},t=(0,c.AR)(e);t&&"aiMessage"===t.type&&n(t.id,t,!0)}},[n,t,u])}}},10178:function(e,t,n){n.d(t,{os:function(){return I},OU:function(){return A},mo:function(){return k}});var r=n(56166),a=n(49790),s=n(36803),i=n(51817),l=n(13018),o=n(84864),c=n(50484),d=n(81922),u=n(3989),m=n(70980),p=n(16022),g=n(77105),f=n(98244),h=n(81121),x=n(7287);let v=e=>{let t=e.map(e=>{let t=JSON.stringify(e);return t.length>1e4?{type:e.type,timestamp:e.timestamp,data:{truncated:!0,originalSize:t.length}}:e}),n=0,r=[];for(let e=t.length-1;e>=0;e--){let a=JSON.stringify(t[e]);if(n+a.length<=1e6)r.unshift(t[e]),n+=a.length;else break}return JSON.stringify(r)};var b=n(21198),_=n(94671),y=n(69395),j=n(12703),w=n(10683),S=n(87950),N=n(17001),E=n(26985),C=n(39230);function k(e){let t=(0,p.C)();return A({...e,repoAccessibilityState:t})}let T={};function I(e,t){return t&&(T[e.id]||(T[e.id]=(0,a.Xm)("aimsg").toString()),e.ai_message_id=T[e.id]),e}function A(e){let{projectId:t,onRepoInaccessible:n,onSubmit:a,autoSwitchToCode:p=!1,onSuccess:k,repoAccessibilityState:T}=e,A=(0,l.dl)(c.P.AgentDefault),R=(0,d.u)(e=>e.currentPage),{setIsSendChatMessageMutationPending:O}=(0,m.Xr)(),{createChatRequestPerformanceMeasurer:D}=(0,S.t)(),{createSseEventHandler:M}=function(e){let{autoSwitchToCode:t=!1}=e,{updateMessage:n,setLatestStreamedMessage:r,isMessageStopped:a}=(0,b.mx)(),{updateConsoleStateOnStreaming:s}=(0,E.k)({autoSwitchToCode:t});return{createSseEventHandler:()=>{let e="";return t=>{if("message"!==t.type){o.logging.error("received_unknown_chat_sse",{event_type:t.type,event_data:t.data});return}let i=t.data.message;if(a(i.id))return;let l={...i,stopped:!!i.stopped,status:"running"};r(l);let c=(0,C.AR)(l);c&&("aiMessage"===c.type||"userMessage"===c.type)?n(i.id,c,!0):o.logging.error("unknown_message_type",{message:i}),e=s(i,e)}}}}({autoSwitchToCode:p}),{handleChatStreamingError:L}=(0,y.Z)(),{isRepoAccessible:P,removeLatestMessageIfRepoInaccessible:z}=function(){let{restoreEditorState:e}=(0,w.WR)(),{removeMessage:t}=(0,b.mx)(),n=(0,f.useCallback)(e=>!e||(null==e?void 0:e.accessibility)==="repo_accessible"||(null==e?void 0:e.accessibility)==="repo_not_found",[]),r=n=>{let{onRepoInaccessible:r,latestMessageId:a}=n;null==r||r(),e(),j.Am.error("We couldn't access this project repository."),a&&t(a)};return{isRepoAccessible:n,removeLatestMessageIfRepoInaccessible:(e,t,a)=>{n(e)||r({onRepoInaccessible:a,latestMessageId:t})}}}(),{sendChatRequest:Z}=function(){let{prepareMessageDiagnostics:e}=function(){let e=(0,h.D)(),{store:t}=(0,x.My)();return{prepareMessageDiagnostics:(0,f.useCallback)(n=>{let{runtimeErrors:r,latestBuildTimestamp:a}=e.store.getState(),s=t.getState().rrwebEvents;n.session_replay=v(s);let i=t.getState().consoleLogs.length,l=t.getState().networkRequests.length;n.client_logs=[...t.getState().consoleLogs.slice(Math.max(i-50,0),i)],n.network_requests=[...t.getState().networkRequests.slice(Math.max(l-50,0),l)],n.runtime_errors=[...r].filter(e=>e.timestamp>=a),e.clearDiagnostics(),t.setState(e=>{e.consoleLogs=[],e.networkRequests=[],e.rrwebEvents=[]})},[e,t])}}(),{addAbortController:t,removeAbortController:n}=(0,b.mx)();return{sendChatRequest:async r=>{let{projectId:a,body:s,onStart:i,onComplete:l}=r;e(s);let o=new AbortController;t(o),null==i||i();let c=(0,_.SJ)();try{await c.postWithStreaming("/projects/".concat(a,"/chat"),s,()=>{o.abort()},o.signal)}finally{null==l||l(),n(o)}}}}(),{createOptimisticMessage:U}=(0,N.m)(),F=(0,u.hT)(e=>e.chatMode!==u.jE.DEFAULT),q=(0,u.hT)(e=>e.chatMode===u.jE.AGENT),[V]=(0,s.pQ)(),{selectedModel:G}=(0,i.L6)(),{getActiveViewDescription:W}=(0,g.sV)(),{view:H,description:B}=W(),J=async(e,r)=>{"preview"===H&&(e.current_page=R),"enabled"!==e.agent_mode&&(e.agent_mode=q?"enabled":"disabled"),"auto"!==G&&(e.model=G),V&&(e.model=s.SS),A&&(e.agent_mode="enabled");let a=r||t;if(!a){let e=Error("Project ID is required to send chat message");throw o.logging.error("missing_project_id",{error:e.message}),e}let{measureRequestStart:i,measureTimeToFirstToken:l}=D({projectId:a});if(!P(T)){var c;z(T,null!==(c=e.id)&&void 0!==c?c:void 0,n);return}await Z({projectId:a,body:e,onMessage:M(),onStart:i,onFirstEvent:l})};return(0,r.D)({mutationFn:async e=>{let{body:n,projectId:r,isCreation:a}=e;O(!0);let s=r||t;if(!s){let e=Error("Project ID is required to send chat message");throw o.logging.error("missing_project_id_in_mutation",{error:e.message}),e}return J(I(n,F),s)},onMutate:e=>{let{body:t,clear:n}=e;U({body:I(t,F)}),null==a||a(t.message),null==n||n()},onSuccess:()=>{null==k||k()},onError:(e,t)=>{let{body:n,restore:r}=t;L(e,{lastOptimisticMessageId:n.ai_message_id,lastUserMessageId:n.id,onErrorHandled:r})}})}},36190:function(e,t,n){n.d(t,{Y:function(){return d},ZK:function(){return s},_g:function(){return u},rI:function(){return l}});var r=n(18587),a=n(95713);let s=e=>{if(!e)return!0;let t=e instanceof a.EK?e.toDate():new Date(e);return(new Date().getTime()-t.getTime())/36e5>=24},i="lovable_rate_limit_timestamp",l=()=>{let e=Date.now();localStorage.setItem(i,e.toString())},o=()=>{let e=localStorage.getItem(i);return e?parseInt(e,10):null},c=()=>{localStorage.removeItem(i)},d=()=>{let e=o();if(!e)return{isRateLimited:!1,secondsRemaining:0};let t=Math.max(0,60-Math.floor((Date.now()-e)/1e3));return 0===t?(c(),{isRateLimited:!1,secondsRemaining:0}):{isRateLimited:!0,secondsRemaining:t}},u=e=>{let t=new Date;return e.getFullYear()===t.getFullYear()?(0,r.WU)(e,"h:mm a 'on' MMM dd"):(0,r.WU)(e,"h:mm a 'on' MMM dd yyyy")}},39230:function(e,t,n){n.d(t,{AR:function(){return o},Fd:function(){return d},Oh:function(){return c}});var r=n(95713),a=n(49790),s=n(84864);let i=[],l=e=>"string"==typeof e?new Date(e):e instanceof r.EK?e.toDate():new r.EK(e.seconds,e.nanoseconds).toDate(),o=(e,t)=>{var n,r,a,o,c,d,u,m,p,g,f,h,x,v,b,_,y,j,w,S,N,E,C,k,T;switch(e.tag){case"instant-mode-message":if("user"===e.role)return{createdAt:l(e.created_at),role:"user",id:e.id,content:e.content,type:"userMessage",selectedElements:null!==(n=e.selected_elements)&&void 0!==n?n:i,images:null!==(r=e.images)&&void 0!==r?r:i,containsError:null!==(a=e.contains_error)&&void 0!==a&&a,tags:null!==(o=e.tags)&&void 0!==o?o:i,userId:null!==(c=e.user_id)&&void 0!==c?c:void 0,chatOnly:null!==(d=e.chat_only)&&void 0!==d&&d,isStuck:null!==(u=e.is_stuck)&&void 0!==u&&u,isSecurityReview:null!==(m=e.is_security_review)&&void 0!==m&&m};return{createdAt:l(e.created_at),role:"ai",id:e.id,content:e.content,type:"aiMessage",editId:null!==(g=e.edit_id)&&void 0!==g?g:void 0,stopped:!!e.stopped,errors:null!==(f=null===(p=e.errors)||void 0===p?void 0:p.sort((e,t)=>t.created_at.seconds-e.created_at.seconds))&&void 0!==f?f:void 0,sqlRunState:null!==(h=e.sql_run_state)&&void 0!==h?h:void 0,persisted:null!==(x=null==t?void 0:t.persisted)&&void 0!==x&&x,status:null!==(v=e.status)&&void 0!==v?v:"completed",thinkingTimeMs:null!==(b=e.thinking_time_ms)&&void 0!==b?b:void 0,timeToFirstTokenMs:null!==(_=e.time_to_first_token_ms)&&void 0!==_?_:void 0,feedbackSentiment:null!==(y=e.feedback_sentiment)&&void 0!==y?y:void 0,feedbackContent:null!==(j=e.feedback_content)&&void 0!==j?j:void 0,feedbackCategory:null!==(w=e.feedback_category)&&void 0!==w?w:void 0,costCredits:null!==(S=e.cost_credits)&&void 0!==S?S:void 0};case"branch-switched":return{createdAt:l(e.created_at),id:e.id,type:"branchSwitched",branchName:e.branch_name};case"external-commit-pushed":return{createdAt:l(e.created_at),id:e.id,type:"userCommit",shortCommitHash:null!==(N=e.commit_hash)&&void 0!==N?N:void 0,commitMessage:e.commit_message};case"revert-success":return{createdAt:l(e.created_at),id:e.id,type:"revertSuccess",shortCommitHash:null!==(E=e.commit_hash)&&void 0!==E?E:void 0,editId:null!==(C=e.edit_id)&&void 0!==C?C:""};case"manual-edit":return{createdAt:l(e.created_at),id:e.id,type:"manualEdit",content:e.content,editId:e.edit_id,errors:null!==(T=null===(k=e.errors)||void 0===k?void 0:k.sort((e,t)=>t.created_at.seconds-e.created_at.seconds))&&void 0!==T?T:void 0};case"revert":if("user"===e.role)return{createdAt:l(e.created_at),id:e.id,type:"userMessage",content:e.content,containsError:!1,tags:[],images:[],selectedElements:[],userId:e.user_id,role:"user"};return{createdAt:l(e.created_at),id:e.id,type:"aiMessage",content:e.content,role:"ai",persisted:!0,status:"completed",sqlRunState:void 0,stopped:!1};default:return s.logging.error("Unknown message tag",{message:e}),null}},c=(e,t)=>{let n={};return e.forEach(e=>{let r=e.data(),a=o(r,t);a&&(n[r.id]=a)}),n},d=()=>(0,a.Xm)("umsg").toString()},65276:function(e,t,n){n.d(t,{Y:function(){return m},t:function(){return u}});var r=n(52155),a=n(17195),s=n(98244),i=n(67801),l=n(59561),o=n(14070),c=n(99792),d=n(26047);let u=(0,i.Ue)(e=>({open:!1,errorMessage:null,showTryAgain:!0,traceId:null,showErrorDialog:function(t){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=arguments.length>2?arguments[2]:void 0;return a.ZP.capture("error_dialog_shown",{error_message:t,show_try_again:n,trace_id:r}),e({open:!0,errorMessage:t,showTryAgain:n,traceId:r})},closeError:()=>e({open:!1,errorMessage:null,showTryAgain:!0,traceId:null})}));function m(){let{open:e,errorMessage:t,closeError:n,showTryAgain:i,traceId:m}=u(),[p,g]=(0,s.useState)(!1),f=(0,d.v)(),h=async()=>{if(m)try{await navigator.clipboard.writeText(m),g(!0),setTimeout(()=>g(!1),2e3)}catch(e){console.error("Failed to copy trace ID: ",e)}},x=()=>m?"https://lovable.grafana.net/a/grafana-exploretraces-app/explore?from=now-24h&to=now&timezone=browser&var-ds=grafanacloud-traces&var-primarySignal=nestedSetParent%3C0&var-filters=&var-metric=rate&var-groupBy=resource.service.name&var-spanListColumns=&var-latencyThreshold=&var-partialLatencyThreshold=&actionView=breakdown&traceId=".concat(m):"";return(0,r.jsx)(o.Vq,{open:e,onOpenChange:e=>{e||(a.ZP.capture("error_dialog_closed",{action:"backdrop",error_message:t,trace_id:m}),n())},children:(0,r.jsxs)(o.cZ,{children:[(0,r.jsxs)(o.fK,{className:"text-left",children:[(0,r.jsx)(o.$N,{className:"text-left",children:"Error"}),(0,r.jsxs)(o.Be,{className:"flex flex-col items-start",children:[(t||"An unexpected error occurred. ").split("\n").map((e,n)=>(0,r.jsxs)("span",{children:[e,n!==(t||"An unexpected error occurred. ").split("\n").length-1&&(0,r.jsx)("br",{})]},n)),i&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("br",{}),(0,r.jsx)("span",{children:"Please try again later."})]}),m&&(0,r.jsx)("div",{className:"mt-2 w-full text-[10px] text-muted-foreground/70",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-1",children:[(0,r.jsx)("p",{children:"ID:"}),(0,r.jsx)("code",{className:"relative break-all rounded bg-muted/50 px-[0.2rem] font-mono",children:m}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(l.z,{variant:"link",size:"icon-xs",className:"p-0 text-muted-foreground/70 hover:text-muted-foreground focus:ring-0 focus-visible:ring-0 focus-visible:ring-offset-0",onClick:h,"aria-label":"Copy Trace ID",tabIndex:-1,children:(0,r.jsx)(c.Z,{name:p?"check":"content_copy",size:"small"})}),f&&(0,r.jsx)(l.z,{variant:"link",size:"icon-xs",className:"p-0 text-muted-foreground/70 hover:text-muted-foreground focus:ring-0 focus-visible:ring-0 focus-visible:ring-offset-0",onClick:()=>window.open(x(),"_blank"),"aria-label":"View in Grafana",tabIndex:-1,children:(0,r.jsx)(c.Z,{name:"monitoring",size:"small"})})]})]})})]})]}),(0,r.jsx)("div",{className:"mt-4 flex justify-end gap-2",children:(0,r.jsxs)(o.cN,{className:"flex flex-row justify-end gap-2",children:[(0,r.jsx)(l.z,{variant:"outline",onClick:()=>{a.ZP.capture("error_dialog_closed",{action:"get_help",error_message:t,trace_id:m}),n(),window.open("https://docs.lovable.dev/#stay-connected","_blank")},children:"Get help"}),(0,r.jsx)(l.z,{onClick:()=>{a.ZP.capture("error_dialog_closed",{action:"ok",error_message:t,trace_id:m}),n()},autoFocus:!0,children:"Dismiss"})]})})]})})}},70766:function(e,t,n){n.d(t,{RA:function(){return c},VJ:function(){return d},hg:function(){return o}});var r=n(52155),a=n(98244),s=n(67801);let i=()=>(0,s.Ue)(()=>({activeMessageId:void 0,activeEditId:void 0,errorContent:void 0,codeContent:void 0,snapshotContent:void 0,mermaidContent:void 0})),l=(0,a.createContext)(null),o=e=>{let{children:t}=e,n=(0,a.useRef)(i()),s={store:n.current,setActiveEditId:e=>{n.current.setState({activeEditId:e})},setMermaidContent:e=>{n.current.setState({mermaidContent:e})},setActiveMessageId:e=>{n.current.setState({activeMessageId:e})},setSnapshotContent:e=>{n.current.setState({snapshotContent:e})},setCodeContent:e=>{n.current.setState({codeContent:e})},setErrorContent:e=>{n.current.setState({errorContent:e})}};return(0,r.jsx)(l.Provider,{value:s,children:t})};function c(){let e=(0,a.useContext)(l);if(!e)throw Error("useUtilityContext must be used within a UtilityProvider");return e}function d(e){let{store:t}=c();return t(e)}},77105:function(e,t,n){n.d(t,{No:function(){return p},jJ:function(){return u},sV:function(){return m}});var r=n(52155),a=n(98244),s=n(67801),i=n(87294),l=n(28069),o=n(53197);let c=()=>(0,s.Ue)(()=>({activeView:"preview",blocker:null,showBlockerDialog:!1,nextView:"preview"})),d=(0,a.createContext)(null),u=e=>{let{children:t}=e,n=(0,a.useRef)(c()),s=(0,i.Z)("md"),{setMobileView:u,setIsPreviewDocked:m}=(0,l.zp)(),p=e=>{n.current.setState({activeView:e})},g=e=>{n.current.setState({blocker:e})},f=e=>{n.current.setState({nextView:e})},h=e=>{null!==n.current.getState().blocker?(f(e),x(!0)):(p(e),s&&"preview"!==e&&(u(l.$.VIEW),m(!0)))},x=e=>{n.current.setState({showBlockerDialog:e})},v={__internal:{store:n.current,setActiveView:p,setShowBlockerDialog:x,setNextView:f},switchToViewRaw:h,exitView:()=>{h("preview")},setBlocker:g,clearBlocker:()=>{g(null)},getActiveViewDescription:()=>{let e=n.current.getState().activeView;return{view:e,description:o.wM[e]}}};return(0,r.jsx)(d.Provider,{value:v,children:t})};function m(){let e=(0,a.useContext)(d);if(!e)throw Error("useViewContext must be used within a ViewProvider");return e}function p(e){let{__internal:{store:t}}=m();return t(e)}},25341:function(e,t,n){n.d(t,{h:function(){return l}});var r=n(98244),a=n(76816),s=n(35127),i=n(59253);let l=()=>{let{openSettings:e}=(0,a.r)(),{switchToView:t}=(0,i.Z)(),n=(0,s.A4)();return{openSecurityView:(0,r.useCallback)(()=>{n?t("security"):e("security")},[n,t,e]),openPageSpeedView:(0,r.useCallback)(()=>{n?t("seo"):e("page_speed")},[n,t,e])}}},59253:function(e,t,n){var r=n(3989),a=n(70766),s=n(77105);t.Z=()=>{let e=(0,s.No)(e=>e.activeView),t=(0,s.No)(e=>e.blocker),{switchToViewRaw:n,exitView:i}=(0,s.sV)(),{setMermaidContent:l,setActiveMessageId:o,setSnapshotContent:c,setActiveEditId:d,setCodeContent:u,setErrorContent:m}=(0,a.RA)(),{setCodeViewType:p}=(0,r.VK)(),g=e=>{let{view:t,data:a}=e;switch(t){case"mermaid":l(a);break;case"snapshot":{let{messageId:e,editId:t,previewUrl:n}=a;o(e),c(n),d(t);break}case"annotation":case"debug":o(a);break;case"codeViewer":{let{code:e,errors:t,messageId:n,editId:s,hasDiffs:i=!0}=a;u(e),m(t),o(n),d(s),p(i?r.es.DIFF:r.es.RAW);break}case"error":{let{code:e,errors:t,messageId:n,editId:s,hasDiffs:i=!0}=a;u(e),m(t),o(n),d(s),p(i?r.es.DIFF:r.es.RAW)}}n(t)};return{switchToView:function(e,t){g({view:e,data:t})},exitView:i,activeView:e,blocker:t,toggleView:function(t,n){e===t?i():g({view:t,data:n})}}}},53197:function(e,t,n){n.d(t,{KZ:function(){return a},bC:function(){return r},wM:function(){return s}});let r={preview:"Preview",analytics:"Analytics",backend:"Backend",mermaid:"Diagram",codeEditor:"Code",codeViewer:"Code",snapshot:"Preview",error:"Error",annotation:"Annotation",debug:"Debug",seo:"Speed",security:"Security"},a=[{label:"Analytics",icon:"bid_landscape",description:"View analytics for your project",view:"analytics",enabledOnMobile:!0},{label:"Backend",icon:"table",description:"View the backend for your project",view:"backend",enabledOnMobile:!0},{label:"Code",icon:"code",description:"View the dev mode for your project",view:"codeEditor",enabledOnMobile:!1},{label:"Security",icon:"security",description:"View the security for your project",view:"security",enabledOnMobile:!0},{label:"Speed",icon:"speed",description:"View the SEO analysis for your project",view:"seo",enabledOnMobile:!0}],s={analytics:"The user is currently viewing analytics for their project. Analytics provides insights into the app's performance, like how many visitors the app gets, how long they stay, what countries they are from, etc.",backend:"The user is currently viewing the backend for their project. Here they can view database tables, see how many users have signed up and information about individual users, browse logs, determine what authentication methods their app can use, see security warnings and suggestions, configure secrets, and view files stored in buckets, like uploaded user images.",mermaid:"The user is currently viewing a mermaid diagram visualizing some aspect of their project.",preview:"The user is currently viewing the live preview of their project.",codeEditor:"The user is currently viewing the code editor for their project. Here they can browse and search files and make changes to their code.",codeViewer:"The user is currently viewing the code viewer for their project. This shows a static version of the code, and allows switching between a DIFF and RAW view.",error:"The user is currently viewing the error for their project. This shows a static version of the code, and allows switching between a DIFF and RAW view. It shows the actual error in their code at the top.",snapshot:"The user is currently viewing a preview of a past commit for their project. They can use the Restore button to revert to this specific commit.",annotation:"The user is currently viewing the annotation view for their project. This is for developers only.",debug:"The user is currently viewing the debug view for their project. This is for developers only.",seo:"The user is currently viewing the Page Speed analysis view for their project. This uses Google Lighthouse to analyze the actual performance of the user's app and gives separate scores for both mobile and desktop performance.",security:"The user is currently viewing the security view for their project. This aggregates several sources of security information, like Supabase or Backend if the user has it enabled, and scans the codebase for security issues like leaked API keys."}},81922:function(e,t,n){n.d(t,{u:function(){return r}});let r=(0,n(67801).Ue)(e=>({currentPage:"index",setCurrentPage:t=>e({currentPage:t})}))},72163:function(e,t,n){n.d(t,{y:function(){return s}});var r=n(17195),a=n(69128);let s=()=>{let{triggerScan:e}=(0,a.JX)(),t=(0,a.Yu)(e=>e.securitySummary),n=(0,a.Yu)(e=>e.scanData),s=(0,a.Yu)(e=>e.isLoading),i=(0,a.Yu)(e=>e.isUpdating),l=(0,a.Yu)(e=>e.error),o=(0,a.Yu)(e=>e.projectId);return{securitySummary:t,scanData:n,isLoading:s,isUpdating:i,error:l,triggerScan:e,captureSecurityEvent:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={project_id:o,...t};r.ZP.capture(e,n)}}}},26985:function(e,t,n){n.d(t,{k:function(){return c}});var r=n(98244),a=n(44854),s=n(59253),i=n(70766),l=n(77105),o=n(7287);function c(e){let{autoSwitchToCode:t=!1}=e,{exitView:n}=(0,s.Z)(),{switchToViewRaw:c}=(0,l.sV)(),{store:d,setActiveMessageId:u,setCodeContent:m}=(0,i.RA)(),{store:p}=(0,o.My)(),g=(0,r.useCallback)((e,r)=>(e.content.includes("</lov-code>")&&!r.includes("</lov-code>")?(n(),p.setState(e=>{e.consoleLogs=[],e.rrwebEvents=[]})):e.content.includes("<lov-code>")&&!r.includes("<lov-code>")&&t&&(c("codeViewer"),e.id&&u(e.id)),r),[n,p,t,u,c]),f=(0,r.useCallback)((e,t)=>{if(!e.content)return t;let n=d.getState().activeMessageId;if(e.id===n){for(let t of(0,a.hP)(e.content).parts)if("parts"in t)return m(t),e.content}return t},[d,m]);return{updateConsoleStateOnStreaming:(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t;return n=g(e,n),n=f(e,n)},[g,f])}}},21198:function(e,t,n){n.d(t,{ei:function(){return f},aM:function(){return T},mx:function(){return I},aK:function(){return A},tV:function(){return R},uO:function(){return O},$m:function(){return L},iY:function(){return M},IE:function(){return D},Fm:function(){return P}});var r=n(52155),a=n(12200),s=n(99526),i=n(98244),l=n(75748),o=n(70980),c=n(95713),d=n(92361);function u(e){let{array:t,batchSize:n}=e;return Array.from({length:Math.ceil(t.length/n)},(e,r)=>t.slice(r*n,(r+1)*n))}var m=n(84864);let p=e=>{let t={};return e.forEach((e,n)=>{var r,a,s,i,l,o,c,d,u;let m=e.data(),p={id:m.id,commit_sha:null!==(r=m.commit_sha)&&void 0!==r?r:"unknown",commit_message:null!==(a=m.commit_message)&&void 0!==a?a:"unknown",created_at:m.created_at,reverted:null!==(s=m.reverted)&&void 0!==s&&s,type:m.type,diff:null!==(i=m.diff)&&void 0!==i?i:null,status:null!==(l=m.status)&&void 0!==l?l:null,previewBuildStatus:null!==(o=m.preview_build_status)&&void 0!==o?o:null,bookmarked:null!==(c=m.bookmarked)&&void 0!==c&&c,revert_target_edit_id:null!==(d=m.revert_target_edit_id)&&void 0!==d?d:void 0,pages:null!==(u=m.pages)&&void 0!==u?u:[]};t[p.id]=p}),t};var g=n(39230);let f={FIRESTORE_BATCH_SIZE:30,COOLDOWN_TIME_MS:300,MESSAGES_PAGE_SIZE:30,EDIT_PAGE_SIZE:30,SCROLL_TO_MESSAGE_DELAY_MS:3e3};var h=n(67801),x=n(70786);(0,a.MD)();let v=()=>(0,h.Ue)()((0,x.n)(e=>({sortedMessageIds:[],messages:{},edits:{},selectedImageUrl:void 0,imageUrlCache:{},loadingMessagesStatus:"idle",loadingEditsStatus:"idle",isInitialized:!1,hasOlderMessages:!0,hasOlderEdits:!0,canLoadMoreMessages:!0,canLoadMoreEdits:!0,stoppedMessageIds:new Set,latestStreamedMessage:void 0,abortControllers:[]})));function b(e,t){var n;return null!==(n=Object.values(e.messages).find(e=>"aiMessage"===e.type&&e.editId===t))&&void 0!==n?n:null}function _(e,t){var n;return null!==(n=Object.values(e.messages).find(e=>"userCommit"===e.type&&e.shortCommitHash===t))&&void 0!==n?n:null}function y(e,t){return Object.values(e.edits).find(e=>e.commit_sha.startsWith(t))||null}function j(e){var t,n;return null!==(n=null===(t=Object.values(e.edits).sort((e,t)=>{let n=e.created_at.toDate().getTime();return t.created_at.toDate().getTime()-n}).find(e=>!!e.pages&&!!e.pages.length))||void 0===t?void 0:t.pages)&&void 0!==n?n:null}function w(e){let{messages:t,sortedMessageIds:n}=e;for(let e=n.length-1;e>=0;e--){var r;let a=n[e];if((null===(r=t[a])||void 0===r?void 0:r.type)==="userMessage")return t[a]}return null}function S(e){let{messages:t,sortedMessageIds:n}=e;for(let e=n.length-1;e>=0;e--){var r;let a=n[e];if((null===(r=t[a])||void 0===r?void 0:r.type)==="aiMessage")return{messageId:a,message:t[a]}}return null}var N=n(92044),E=n(33619);let C=(0,i.createContext)(null),k=e=>{let[t,n]=(0,i.useState)(new Date);return{getStoreSnapshot:(0,i.useCallback)(()=>e.current.getState(),[e]),getPerformanceMetrics:(0,i.useCallback)(()=>{let n=e.current.getState();return{messageCount:Object.keys(n.messages).length,editCount:Object.keys(n.edits).length,memoryUsage:new Blob([JSON.stringify(n)]).size,lastUpdate:t}},[e,t]),resetStore:(0,i.useCallback)(()=>{e.current.setState(()=>v().getState()),n(new Date)},[e]),updateLastUpdate:()=>n(new Date)}},T=e=>{var t;let{projectId:n,children:h}=e,x=(0,s.useSearchParams)(),j=null!==(t=null==x?void 0:x.get("messageId"))&&void 0!==t?t:void 0,S=(0,i.useRef)(v()),T=k(S),I=function(e){let{projectId:t}=e;return(0,i.useMemo)(()=>(0,c.IO)((0,c.hJ)(d.db,"projects",t,"trajectory"),(0,c.Xo)("created_at","desc")),[t])}({projectId:n}),A=function(e){let{projectId:t}=e;return(0,i.useMemo)(()=>(0,c.IO)((0,c.hJ)(d.db,"projects",t,"edits"),(0,c.ar)("type","in",[N.I.type.MANUAL_UPDATE,N.I.type.AI_UPDATE,N.I.type.DEVELOPER_UPDATE,N.I.type.REVERT]),(0,c.Xo)("created_at","desc")),[t])}({projectId:n}),R=function(e){let{projectId:t,messageId:n}=e;return(0,i.useMemo)(()=>n?(0,c.JU)(d.db,"projects",t,"trajectory",n):null,[t,n])}({projectId:n,messageId:j}),{updateMessage:O,removeMessage:D,isMostRecentMessage:M,getMessageByEditId:L,getUserCommitMessageByShortCommitHash:P,getUserMessageCount:z,getLastUserMessage:Z}=function(e){let{storeRef:t}=e,n=(0,i.useCallback)((e,n,r)=>{if(!t.current.getState().isInitialized)return;let s=t.current.getState().messages[e];s&&r&&s.content===n.content&&("ai"!==n.role||"ai"!==s.role||s.thinkingTimeMs===n.thinkingTimeMs&&s.timeToFirstTokenMs===n.timeToFirstTokenMs)||t.current.setState((0,a.Uy)(t=>{let a=s&&r?{...s,content:n.content}:n;"ai"===n.role&&"ai"===a.role&&r&&(a.thinkingTimeMs=n.thinkingTimeMs,a.timeToFirstTokenMs=n.timeToFirstTokenMs),t.messages[e]=a,r&&(t.sortedMessageIds=t.sortedMessageIds.filter(t=>t!==e),t.sortedMessageIds.push(e))}))},[t]),r=(0,i.useCallback)(e=>{t.current.setState(t=>{let{[e]:n,...r}=t.messages;return{messages:r,sortedMessageIds:t.sortedMessageIds.filter(t=>t!==e)}})},[t]),s=(0,i.useCallback)(e=>{let n=t.current.getState().sortedMessageIds;return n[n.length-1]===e},[t]),l=(0,i.useCallback)(e=>b(t.current.getState(),e),[t]);return{updateMessage:n,removeMessage:r,isMostRecentMessage:s,getMessageByEditId:l,getUserCommitMessageByShortCommitHash:(0,i.useCallback)(e=>_(t.current.getState(),e),[t]),getUserMessageCount:(0,i.useCallback)(()=>Object.values(t.current.getState().messages).filter(e=>"userMessage"===e.type).length,[t]),getLastUserMessage:(0,i.useCallback)(()=>w(t.current.getState()),[t])}}({storeRef:S}),{loadEarlierMessages:U,loadMessagesFromId:F,earliestMessageDocRef:q,processMessagesWithEdits:V}=function(e){let{storeRef:t,projectId:n,messagesQuery:r}=e,a=(0,i.useRef)(null),s=(0,i.useCallback)(async e=>{if(0===e.length)return{};let t=u({array:e,batchSize:f.FIRESTORE_BATCH_SIZE});return(await Promise.all(t.map(async e=>p((await (0,c.PL)((0,c.IO)((0,c.hJ)(d.db,"projects",n,"edits"),(0,c.ar)("id","in",e)))).docs)))).reduce((e,t)=>({...e,...t}),{})},[n]),l=(0,i.useCallback)(async(e,t)=>{let n=(0,g.Oh)(e,t),r=e.map(e=>e.data().edit_id).filter(e=>!!e);return{messages:n,edits:await s(r)}},[s]),o=(0,i.useCallback)((e,n)=>{let{messages:r,edits:s}=n,i=e.map(e=>e.id);t.current.setState(e=>({messages:{...e.messages,...r},edits:{...e.edits,...s},sortedMessageIds:[...i,...e.sortedMessageIds]})),e.length>0&&(a.current=e[0])},[t]),h=(0,i.useCallback)(async()=>{let e=t.current.getState();if(a.current&&e.canLoadMoreMessages){t.current.setState({loadingMessagesStatus:"loading",canLoadMoreMessages:!1});try{let e=(await (0,c.PL)((0,c.IO)(r,(0,c.TQ)(a.current),(0,c.b9)(f.MESSAGES_PAGE_SIZE)))).docs.reverse();if(e.length>0){a.current=e[0];let n=await l(e,{persisted:!0});t.current.setState(t=>({messages:{...t.messages,...n.messages},edits:{...t.edits,...n.edits},hasOlderMessages:e.length>=f.MESSAGES_PAGE_SIZE,sortedMessageIds:[...e.map(e=>e.id),...t.sortedMessageIds]}))}else t.current.setState({hasOlderMessages:!1});t.current.setState({loadingMessagesStatus:"success"})}catch(e){t.current.setState({loadingMessagesStatus:"error"}),m.logging.warn("Firestore error - useMessageDataFetching - loadEarlierMessages",{error:e})}finally{setTimeout(()=>{t.current.setState({canLoadMoreMessages:!0})},f.COOLDOWN_TIME_MS)}}},[r,t,l]),x=(0,i.useCallback)((e,n)=>{let r=t.current.getState();return"message_id"===n?r.messages[e]:"shortCommitHash"===n?_(r,e):b(r,e)},[t]),v=(0,i.useCallback)(async e=>{let t=(0,c.IO)(r,(0,c.Lx)(a.current||void 0),(0,c.b9)(1e3)),n=(await (0,c.PL)(t)).docs.reverse(),s=await l(n,{persisted:!0});o(n,s)},[r,l,o]),y=(0,i.useCallback)(async(e,t)=>{let n=(0,c.IO)(r,(0,c.ar)("message_id"===t?"id":"edit_id","==",e),..."message_id"===t?[(0,c.b9)(1)]:[]),s=await (0,c.PL)(n);if(!s.docs[0])return;let i="message_id"===t?s.docs[0]:s.docs.find(e=>e.data().tag===E.r.tag.INSTANT_MODE_MESSAGE);if(!i)return;let d=(0,c.IO)(r,(0,c.Lx)(i),(0,c.TQ)(a.current||void 0)),u=[i,...(await (0,c.PL)(d)).docs.reverse()],m=await l(u,{persisted:!0});o(u,m)},[r,l,o]);return{fetchEditsForMessages:s,processMessagesWithEdits:l,loadEarlierMessages:h,loadMessagesFromId:(0,i.useCallback)(async e=>{let{messageId:n,id_type:r="edit_id"}=e,a=x(n,r),s=t.current.getState();if(!(a&&s.sortedMessageIds.includes(a.id))){t.current.setState({loadingMessagesStatus:"loading"});try{"shortCommitHash"===r?await v(n):await y(n,r),t.current.setState({loadingMessagesStatus:"success"})}catch(e){t.current.setState({loadingMessagesStatus:"error"}),console.error("Error loading messages from ID",{error:e,messageId:n,id_type:r})}}},[x,v,y,t]),earliestMessageDocRef:a}}({storeRef:S,projectId:n,messagesQuery:I}),{loadEarlierEdits:G,earliestEditDocRef:W,fetchMessagesForEdits:H}=function(e){let{storeRef:t,projectId:n,editsQuery:r}=e,a=(0,i.useRef)(null),s=(0,i.useCallback)(async e=>{if(0===e.length)return{};let t=u({array:e,batchSize:f.FIRESTORE_BATCH_SIZE});return(await Promise.all(t.map(async e=>{let t=await (0,c.PL)((0,c.IO)((0,c.hJ)(d.db,"projects",n,"trajectory"),(0,c.ar)("edit_id","in",e)));return(0,g.Oh)(t.docs,{persisted:!0})}))).reduce((e,t)=>({...e,...t}),{})},[n]);return{loadEarlierEdits:(0,i.useCallback)(async()=>{if(a.current&&t.current.getState().canLoadMoreEdits){t.current.setState({loadingEditsStatus:"loading",canLoadMoreEdits:!1});try{let e=(await (0,c.PL)((0,c.IO)(r,(0,c.TQ)(a.current),(0,c.b9)(f.EDIT_PAGE_SIZE)))).docs;if(e.length>0){a.current=e[e.length-1];let n=p(e),r=Object.keys(n),i=await s(r);t.current.setState(t=>({edits:{...t.edits,...n},messages:{...t.messages,...i},hasOlderEdits:e.length>=f.EDIT_PAGE_SIZE}))}else t.current.setState({hasOlderEdits:!1});t.current.setState({loadingEditsStatus:"success"})}catch(e){t.current.setState({loadingEditsStatus:"error"}),m.logging.warn("Firestore error - useEditOperations - loadEarlierEdits",{error:e})}finally{setTimeout(()=>{t.current.setState({canLoadMoreEdits:!0})},f.COOLDOWN_TIME_MS)}}},[r,t,s]),earliestEditDocRef:a,fetchMessagesForEdits:s}}({storeRef:S,projectId:n,editsQuery:A}),{getEditByShortCommitHash:B,updateEdit:J}=function(e){let{storeRef:t}=e;return{getEditByShortCommitHash:(0,i.useCallback)(e=>y(t.current.getState(),e),[t]),updateEdit:(0,i.useCallback)((e,n)=>{let r=t.current.getState().edits[e];r&&Object.entries(n).some(e=>{let[t,n]=e;return r[t]!==n})&&t.current.setState((0,a.Uy)(t=>{t.edits[e]&&Object.assign(t.edits[e],n)}))},[t])}}({storeRef:S}),{cacheImageUrl:K,setSelectedImageUrl:Y}=function(e){let{storeRef:t}=e;return{cacheImageUrl:(0,i.useCallback)((e,n)=>{t.current.getState().imageUrlCache[e]!==n&&t.current.setState((0,a.Uy)(t=>{t.imageUrlCache[e]=n}))},[t]),setSelectedImageUrl:(0,i.useCallback)(e=>{t.current.getState().selectedImageUrl!==e&&t.current.setState((0,a.Uy)(t=>{t.selectedImageUrl=e}))},[t])}}({storeRef:S}),{subscriptionBoundaryTime:X}=function(e){let{storeRef:t,messagesQuery:n,editsQuery:r,processMessagesWithEdits:a}=e,s=(0,i.useRef)(c.EK.now());return(0,i.useEffect)(()=>{let e=t.current,a=(0,c.cf)((0,c.IO)(n,(0,c.ar)("created_at",">=",s.current)),async t=>{let n=[...t.docs].reverse(),r=(0,g.Oh)(n,{persisted:!0});e.setState(e=>{let t=new Set(e.sortedMessageIds),a=n.map(e=>e.id).filter(e=>!t.has(e));return{messages:{...e.messages,...r},sortedMessageIds:[...e.sortedMessageIds,...a]}})}),i=(0,c.cf)((0,c.IO)(r,(0,c.ar)("created_at",">=",s.current)),t=>{let n=p([...t.docs]);e.setState(e=>({...e,edits:{...e.edits,...n}}))});return()=>{a(),i()}},[n,r,t,a]),{subscriptionBoundaryTime:s}}({storeRef:S,messagesQuery:I,editsQuery:A,processMessagesWithEdits:V}),Q=(0,i.useCallback)(e=>{try{if(S.current.getState().isInitialized===e)return;S.current.setState((0,a.Uy)(t=>{t.isInitialized=e})),T.updateLastUpdate()}catch(e){console.error("Failed to set initialization state:",e)}},[S,T]),{loadInitialData:$}=function(e){let{storeRef:t,messagesQuery:n,editsQuery:r,subscriptionBoundaryTime:a,earliestMessageDocRef:s,earliestEditDocRef:l,processMessagesWithEdits:o,fetchMessagesForEdits:d,messageId:u,specificMessageQuery:m}=e,g=(0,i.useRef)(null);return(0,i.useEffect)(()=>()=>{g.current&&(clearTimeout(g.current),g.current=null)},[]),{loadInitialData:(0,i.useCallback)(async()=>{let e;if(u&&m){let t=await (0,c.QT)(m);if(t.exists()){e=await (0,c.PL)((0,c.IO)(n,(0,c.ar)("created_at","<",a.current),(0,c.Wu)(t)));let r=setTimeout(()=>{let e=document.getElementById(u);e&&(e.scrollIntoView({block:"start"}),e.classList.add("animate-message-highlight"),e.addEventListener("animationend",()=>{e.classList.remove("animate-message-highlight")},{once:!0}))},f.SCROLL_TO_MESSAGE_DELAY_MS);g.current=r}else e=await (0,c.PL)((0,c.IO)(n,(0,c.ar)("created_at","<",a.current),(0,c.b9)(f.MESSAGES_PAGE_SIZE)))}else e=await (0,c.PL)((0,c.IO)(n,(0,c.ar)("created_at","<",a.current),(0,c.b9)(f.MESSAGES_PAGE_SIZE)));let i=e.docs.reverse();i.length>0&&(s.current=i[0]);let{messages:h,edits:x}=await o(i,{persisted:!0}),v=await (0,c.PL)((0,c.IO)(r,(0,c.ar)("created_at","<",a.current),(0,c.b9)(f.EDIT_PAGE_SIZE)));v.docs.length>0&&(l.current=v.docs[v.docs.length-1]);let b=p(v.docs),_=p((await (0,c.PL)((0,c.IO)(r,(0,c.ar)("bookmarked","==",!0)))).docs),y=Object.keys(_),j={};y.length>0&&(j=await d(y)),t.current.setState(t=>{let n={...t.messages,...h,...j},r=[...new Set([...t.sortedMessageIds,...i.map(e=>e.id)])];return r=r.sort((e,t)=>{let r=n[e],a=n[t];return r.createdAt.getTime()-a.createdAt.getTime()}),{messages:n,hasOlderMessages:!!u||e.docs.length>=f.MESSAGES_PAGE_SIZE,edits:{...t.edits,...x,...b,..._},hasOlderEdits:v.docs.length>=f.EDIT_PAGE_SIZE,sortedMessageIds:r,isInitialized:!0}})},[n,r,a,s,l,o,d,t,u,m])}}({storeRef:S,messagesQuery:I,editsQuery:A,subscriptionBoundaryTime:X,earliestMessageDocRef:q,earliestEditDocRef:W,processMessagesWithEdits:V,fetchMessagesForEdits:H,messageId:j,specificMessageQuery:R}),{setLatestStreamedMessage:ee,addStoppedMessageId:et,isMessageStopped:en,addAbortController:er,removeAbortController:ea}=function(e){let{storeRef:t}=e,n=(0,i.useCallback)((e,n)=>{n&&e?t.current.setState(t=>({...t,sortedMessageIds:[...t.sortedMessageIds,e.id],latestStreamedMessage:e,messages:{...t.messages,[e.id]:e}})):t.current.setState(t=>({...t,latestStreamedMessage:e}))},[t]),r=(0,i.useCallback)(e=>{e&&t.current.setState(t=>({...t,stoppedMessageIds:new Set([...t.stoppedMessageIds,e])}))},[t]);return{setLatestStreamedMessage:n,addStoppedMessageId:r,isMessageStopped:(0,i.useCallback)(e=>{let n=t.current.getState();return!!n.latestStreamedMessage&&"stopped"in n.latestStreamedMessage&&!!n.latestStreamedMessage.stopped||n.stoppedMessageIds.has(e)},[t]),addAbortController:(0,i.useCallback)(e=>{t.current.setState(t=>({...t,abortControllers:[...t.abortControllers,e]}))},[t]),removeAbortController:(0,i.useCallback)(e=>{t.current.setState(t=>({...t,abortControllers:t.abortControllers.filter(t=>t!==e)}))},[t])}}({storeRef:S}),{setIsSendChatMessageMutationPending:es}=(0,o.Xr)(),ei=(0,i.useCallback)(()=>{try{es(!1),S.current.getState().abortControllers.forEach(e=>{e.abort()}),S.current.setState(e=>({...e,abortControllers:[]})),T.updateLastUpdate()}catch(e){console.error("Failed to abort requests:",e)}},[es,S,T]),{canEdit:el}=(0,l.t)();(0,i.useEffect)(()=>{el&&$()},[$,el]),(0,i.useEffect)(()=>{},[T]);let eo=(0,i.useMemo)(()=>({getEditByShortCommitHash:B,getMessageByEditId:L,getUserCommitMessageByShortCommitHash:P,getUserMessageCount:z,getLastUserMessage:Z}),[B,L,P,z,Z]),ec=(0,i.useMemo)(()=>({getStoreSnapshot:T.getStoreSnapshot,getPerformanceMetrics:T.getPerformanceMetrics,resetStore:T.resetStore}),[T]),ed={store:S.current,updateMessage:O,removeMessage:D,setIsInitialized:Q,loadEarlierMessages:U,loadMessagesFromId:F,loadEarlierEdits:G,cacheImageUrl:K,setSelectedImageUrl:Y,isMostRecentMessage:M,updateEdit:J,setLatestStreamedMessage:ee,addStoppedMessageId:et,isMessageStopped:en,addAbortController:er,removeAbortController:ea,abortRequests:ei,debug:ec,snapshot:eo};return(0,r.jsx)(C.Provider,{value:ed,children:h})};function I(){let e=(0,i.useContext)(C);if(!e)throw Error("useChatContext must be used within a ChatProvider");return e}function A(e){let t=I();if(!t)throw Error("useChatStore must be used within a ChatProvider");return t.store(e)}function R(e){return A(t=>e?t.edits[e]:null)}function O(e){return A(t=>e?y(t,e):null)}function D(){return A(j)}function M(){return A(w)}function L(){return A(S)}function P(e){return A(t=>e?b(t,e):null)}},84516:function(e,t,n){n.d(t,{c:function(){return p},h:function(){return m}});var r=n(52155),a=n(68820),s=n(98244),i=n(67801),l=n(75970),o=n(93846),c=n(21517);let d=()=>(0,i.Ue)(()=>({collaborators:[],accessLevel:null,collaboratorsInitialized:!1,hasFetchedCollaborators:!1})),u=(0,s.createContext)(null),m=e=>{let{children:t,projectId:n}=e,i=(0,s.useRef)(d()),{authUser:m}=(0,l.Eu)(),p=(0,c.iZ)(e=>e.project),{data:g,isFetched:f}=(0,a.a)(o.W.collaborators({projectId:n,projectOwnerId:null==p?void 0:p.user_id}));(0,s.useEffect)(()=>{if(g&&(null==p?void 0:p.user_id)){let e=(0,o.b)({collaborators:g,projectOwnerId:p.user_id});i.current.setState({collaborators:e})}},[g,null==p?void 0:p.user_id]),(0,s.useEffect)(()=>{if(null==m?void 0:m.uid){let e=null==g?void 0:g.find(e=>e.id===(null==m?void 0:m.uid));e&&e.joined_at?i.current.setState({accessLevel:e.access_level}):i.current.setState({accessLevel:null})}},[null==m?void 0:m.uid,g]),(0,s.useEffect)(()=>{f&&i.current.setState({hasFetchedCollaborators:!0})},[f]);let h={store:i.current};return(0,r.jsx)(u.Provider,{value:h,children:t})};function p(e){let{store:t}=function(){let e=(0,s.useContext)(u);if(!e)throw Error("useCollaborationContext must be used within a CollaborationProvider");return e}();return t(e)}},3989:function(e,t,n){n.d(t,{VK:function(){return p},cb:function(){return m},es:function(){return s},hT:function(){return g},jE:function(){return i}});var r,a,s,i,l=n(52155),o=n(98244),c=n(67801);(r=s||(s={})).RAW="RAW",r.DIFF="DIFF",(a=i||(i={})).DEFAULT="default",a.CHAT_ONLY="chat-only",a.AGENT="agent";let d=()=>(0,c.Ue)(()=>({chatMode:"default",codeViewType:"RAW"})),u=(0,o.createContext)(null),m=e=>{let{children:t}=e,n=(0,o.useRef)(d()),r={store:n.current,setChatMode:e=>{let t=n.current;"function"==typeof e?t.setState(t=>({chatMode:e(t.chatMode)})):t.setState({chatMode:e})},setCodeViewType:e=>{n.current.setState({codeViewType:e})}};return(0,l.jsx)(u.Provider,{value:r,children:t})};function p(){let e=(0,o.useContext)(u);if(!e)throw Error("useEditorModeContext must be used within an EditorModeProvider");return e}function g(e){let{store:t}=p();return t(e)}},70980:function(e,t,n){n.d(t,{Xr:function(){return d},bk:function(){return u},pY:function(){return m},vw:function(){return c}});var r=n(52155),a=n(98244),s=n(67801),i=n(70786);let l=()=>(0,s.Ue)()((0,i.n)(e=>({isSendChatMessageMutationPending:!1,isBuildErrorOccurredDuringStream:!1,isSomeRevertMutationPending:!1,editIdToConfirmRestoreFor:void 0}))),o=(0,a.createContext)(null),c=e=>{let{children:t}=e,n=(0,a.useRef)(l()),s=(0,a.useCallback)(e=>{n.current.setState({isSendChatMessageMutationPending:e,isBuildErrorOccurredDuringStream:!1})},[]),i={store:n.current,setIsSendChatMessageMutationPending:s,setIsBuildErrorOccurredDuringStream:e=>{n.current.setState({isBuildErrorOccurredDuringStream:e})},setIsSomeRevertMutationPending:e=>{n.current.setState({isSomeRevertMutationPending:e})},setEditIdToConfirmRestoreFor:e=>{n.current.setState({editIdToConfirmRestoreFor:e})}};return(0,r.jsx)(o.Provider,{value:i,children:t})};function d(){let e=(0,a.useContext)(o);if(!e)throw Error("useMessageSubmissionContext must be used within a MessageSubmissionProvider");return e}function u(e){let{store:t}=d();return t(e)}let m=()=>{let{isSendChatMessageMutationPending:e,isSomeRevertMutationPending:t}=u(e=>e);return e||t}},28069:function(e,t,n){n.d(t,{$:function(){return a},eP:function(){return d},gu:function(){return m},zp:function(){return u}});var r,a,s=n(52155),i=n(98244),l=n(67801);(r=a||(a={})).VIEW="view",r.CHAT="chat";let o=()=>(0,l.Ue)(()=>({mobileView:"chat",isPreviewDocked:!0,showHistoryPanel:!1})),c=(0,i.createContext)(null),d=e=>{let{children:t}=e,n=(0,i.useRef)(o()),r={store:n.current,setMobileView:e=>{let t=n.current;"function"==typeof e?t.setState(t=>({mobileView:e(t.mobileView)})):t.setState({mobileView:e})},setIsPreviewDocked:e=>{let t=n.current;"function"==typeof e?t.setState(t=>({isPreviewDocked:e(t.isPreviewDocked)})):t.setState({isPreviewDocked:e})}};return(0,s.jsx)(c.Provider,{value:r,children:t})};function u(){let e=(0,i.useContext)(c);if(!e)throw Error("useMobileContext must be used within a MobileProvider");return e}function m(e){let{store:t}=u();return t(e)}},7287:function(e,t,n){n.d(t,{i5:function(){return K},wF:function(){return A},g9:function(){return J},XE:function(){return H},My:function(){return R},f6:function(){return O},vE:function(){return D}});var r=n(52155),a=n(68820),s=n(95257),i=n(98244),l=n(36397),o=n(67801),c=n(70786),d=n(28713),u=n(84864);let m=e=>{var t,n,r,a,s,i,l,o;let c=Object.entries(e.headers||{}).reduce((e,t)=>{let[n,r]=t;return e+n.length+String(r).length},0);return((null===(t=e.responseBody)||void 0===t?void 0:t.length)||0)+((null===(n=e.requestBody)||void 0===n?void 0:n.length)||0)+((null===(a=e.error)||void 0===a?void 0:null===(r=a.message)||void 0===r?void 0:r.length)||0)+((null===(i=e.error)||void 0===i?void 0:null===(s=i.stack)||void 0===s?void 0:s.length)||0)+((null===(l=e.url)||void 0===l?void 0:l.length)||0)+((null===(o=e.statusText)||void 0===o?void 0:o.length)||0)+c},p=e=>e.reduce((e,t)=>e+t.message.length,0);var g=n(17138),f=n(77162),h=n(94671),x=n(17176),v=n(81121),b=n(94127),_=n(66813),y=n(52162),j=n(88182),w=e=>{let{isLoading:t}=e,[n,a]=(0,i.useState)(0),[s,l]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{t&&(a(0),l(!0))},[t]),(0,i.useEffect)(()=>{if(!t){a(100);return}let e=[];return[{duration:150,increment:15},{duration:250,increment:10},{duration:400,increment:5},{duration:500,increment:3},{duration:650,increment:3},{duration:750,increment:3},{duration:1500,increment:2},{duration:2e3,increment:1},{duration:3e3,increment:1},{duration:4e3,increment:1},{duration:5e3,increment:1},{duration:6e3,increment:1},{duration:7e3,increment:1},{duration:1e4,increment:1},{duration:14e3,increment:1}].forEach(t=>{let{duration:n,increment:r}=t,s=setTimeout(()=>{a(e=>e<75?e+r+2*Math.random():e)},n);e.push(s)}),()=>{e.forEach(e=>clearTimeout(e))}},[t]),(0,r.jsx)("div",{className:"pointer-events-none absolute left-0 right-0 top-0 h-[3px] w-full overflow-hidden bg-transparent",children:(0,r.jsx)(y.M,{children:s&&(0,r.jsx)(j.E.div,{className:"h-full bg-accent",initial:{width:0,opacity:1},animate:{width:"".concat(Math.min(n,100),"%"),opacity:1},exit:{opacity:0,transition:{delay:.2,duration:.3}},transition:{width:{duration:.15,bounce:0}},onAnimationComplete:()=>{t||l(!1)}})})})};function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return"";try{let n=new URL(e);return t.useCustomScript&&n.searchParams.set("lov-override-script","true"),t.accessToken&&n.searchParams.set("__lovable_token",t.accessToken),n.toString()}catch(t){return console.error("Error formatting preview URL:",t),e}}function N(e){if(!e)return null;try{return e.replace("http://","ws://").replace("https://","wss://")}catch(e){return console.error("Error converting to WebSocket URL:",e),null}}var E=n(70980),C=n(58093),k=n(21517);let T=e=>(0,o.Ue)()((0,c.n)(()=>({device:"desktop",customScript:!1,_sandboxState:null,_isSandboxStateStale:!1,isStartingSandboxInTheBackground:!1,targetMode:C.i.STATIC,activeMode:C.i.STATIC,visibleMode:C.i.STATIC,currentPath:"/",baseUrls:{static:(0,x.t)({projectId:e}),live:null},error:null,consoleLogs:[],networkRequests:[],rrwebEvents:[],accessToken:void 0}))),I=(0,i.createContext)(null);function A(e){let{children:t}=e,n=(0,f.D)(),[a]=(0,i.useState)(()=>T(n)),o=(0,i.useRef)(null),c=(0,i.useRef)(null),d=(0,i.useMemo)(()=>({live:o,static:c}),[]),m=a(e=>e.targetMode===C.i.LIVE&&"running"===e._sandboxState?C.i.LIVE:C.i.STATIC);(0,i.useEffect)(()=>{a.setState(e=>{e.activeMode=m})},[m,a]),(0,i.useEffect)(()=>{if("live"!==m){a.setState(e=>{e.visibleMode=C.i.STATIC});return}if("live"===m){let e=setTimeout(()=>{a.setState(e=>{e.visibleMode=C.i.LIVE})},3e3);return()=>clearTimeout(e)}},[m,a]);let p=a(e=>e.targetMode),x=a(e=>e._sandboxState);!function(e){let t=(0,h.SJ)(),n=(0,f.D)(),{setIsBuildErrorOccurredDuringStream:r}=(0,E.Xr)(),a=(0,v.D)(),s=(0,i.useMemo)(()=>{let t=e.enabled&&e.url?new URL(e.url):null;return t?N("".concat(t.protocol,"//").concat(t.host)):null},[e.enabled,e.url]);(0,l.useWebSocket)(s,{protocols:"vite-hmr",share:!0,onMessage:e=>{try{let i=JSON.parse(e.data);if((null==i?void 0:i.type)==="update"){let e=Date.now()-500;a.updateLatestBuildTimestamp(e)}if((null==i?void 0:i.type)==="error"){var s;r(!0),u.logging.info("build_error_from_devserver",{message:null==i?void 0:null===(s=i.err)||void 0===s?void 0:s.message});let e=_.p.safeParse(null==i?void 0:i.err);e.success?(0,g.e)(e.data,n,t):(u.logging.error("error_parsing_devserver_error",{error:e}),(0,g.e)(null==i?void 0:i.err,n,t))}}catch(e){u.logging.error("error_parsing_devserver_error",{error:e})}},onOpen:t=>{var n;null===(n=e.onStatusChange)||void 0===n||n.call(e,"running"),u.logging.debug("devserver_websocket_open")},onClose:t=>{var n;null===(n=e.onStatusChange)||void 0===n||n.call(e,"stopped"),u.logging.debug("devserver_websocket_close")},onError:t=>{var n;null===(n=e.onStatusChange)||void 0===n||n.call(e,"error"),u.logging.error("devserver_websocket_error",{event:t})},shouldReconnect:()=>!0,reconnectInterval:1e3})}({enabled:"live"===p&&"running"===x,url:a(e=>e.baseUrls.live)});let b=e=>{a.setState(t=>{t.device=e})},y=e=>{a.setState(t=>{t.customScript=e})},j=(0,i.useCallback)(()=>{a.setState(e=>{e.targetMode="static",e._sandboxState=null,e._isSandboxStateStale=!0,e.error=null})},[a]),w=(0,i.useCallback)(()=>{a.setState(e=>{("live"!==e.targetMode||"running"!==e._sandboxState||e.error)&&(e.targetMode="live",e._sandboxState="starting",e.error=null,e.isStartingSandboxInTheBackground=!0)})},[a]),S=(0,i.useCallback)(()=>{a.setState(e=>{("live"!==e.targetMode||"running"!==e._sandboxState||e.error)&&(e.targetMode="live",e._sandboxState="starting",e.error=null,e.isStartingSandboxInTheBackground=!1)})},[a]),A=(0,i.useCallback)(e=>{a.setState(e=>{e._sandboxState="starting",e.targetMode="live",e.error=null})},[a]),R=(0,i.useCallback)(()=>{a.setState(e=>{e._sandboxState="error",e.error={type:"dev_server",message:"Sorry, we ran into an issue starting the live preview!"}})},[a]),O=(0,i.useCallback)(async()=>{a.setState(e=>{e._sandboxState="starting",e.error=null});try{let e=(0,h.SJ)(),t=await e.post("/projects/".concat(n,"/sandbox/start"),{project_id:n});a.setState(e=>{t.url&&!t.url.endsWith("/")&&(t.url=t.url+"/"),e.baseUrls.live=t.url,e._isSandboxStateStale=!0})}catch(e){R()}},[n,R,a]),D=(0,i.useCallback)(async e=>{let t=a.getState();if("live"===t.targetMode&&(t.error||"error"===t._sandboxState)){A(),a.setState(t=>{t.currentPath=null!=e?e:"/"});return}if(e)a.setState(t=>{t.currentPath=e});else{var n;null===(n=d[t.targetMode].current)||void 0===n||n.reload()}},[d,A,a]),M=(0,i.useCallback)(()=>{a.setState(e=>{e._sandboxState="running",e.error=null})},[a]),G=(0,i.useMemo)(()=>({store:a,setDevice:b,setCustomScript:y,startLiveMode:S,startLiveModeInBackground:w,restartLiveMode:A,revertToStaticMode:j,refreshPreview:D,refs:d,buildFullPreviewUrl:V}),[]),W=(0,k.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.latest_commit_sha}),H=a(e=>"live"===e.targetMode&&"starting"===e._sandboxState)&&!!W;(0,i.useEffect)(()=>{H&&O()},[O,H]);let B=(0,s.c3)(18e5);return(0,r.jsxs)(I.Provider,{value:G,children:[(0,r.jsx)(L,{}),(0,r.jsx)(z,{}),"live"===m&&(0,r.jsx)(P,{}),"live"===p&&"error"!==x&&!B&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U,{}),(0,r.jsx)(Z,{}),(0,r.jsx)(F,{}),(0,r.jsx)(q,{onStarted:M,onFatalError:R,onTransientError:A,onInactivityTimeout:j})]}),t]})}function R(){let e=(0,i.useContext)(I);if(!e)throw Error("usePreviewContext must be used within a PreviewProvider");return e}function O(e){let{store:t}=R();return t(e)}function D(){let e=O(e=>e.baseUrls.live);return(0,i.useMemo)(()=>{if(!e)return null;let t=new URL(e);return N("".concat(t.protocol,"//").concat(t.host))},[e])}let M=async e=>{let t;try{if(!(t=await fetch("".concat(e,"_sandbox/dev-server"),{})).ok)return"offline"}catch(e){return"unknown"}try{let e=await t.json();switch(e.state){case"error":case"stopped":case"stopping":case"disabled":case"starting":case"started":case"disabled":return e.state;default:return u.logging.error("unexpected_dev_server_state",{state:e.state}),"unknown"}}catch(e){return u.logging.debug("malformed_dev_server_state_response",{error:e}),"error"}};function L(){let e=R().refs[C.i.STATIC],t=(0,k.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.preview_build_commit_sha}),n=(0,i.useRef)(t);return(0,i.useEffect)(()=>{if(t&&n.current&&t!==n.current){var r;null===(r=e.current)||void 0===r||r.reload()}n.current=t},[t,e]),null}function P(){let e=R().refs[C.i.LIVE];return(0,i.useEffect)(()=>{var t;null===(t=e.current)||void 0===t||t.reload()},[e]),null}function z(){let e=O(e=>e.targetMode),t=R().startLiveMode,n=(0,E.bk)(e=>e.isSendChatMessageMutationPending);return(0,i.useEffect)(()=>{n&&"static"===e&&t()},[n,e,t]),null}function Z(){let e=O(e=>e._isSandboxStateStale),t=R().store;return(0,i.useEffect)(()=>{if(e)return;let n=setTimeout(()=>{t.setState(e=>{e._isSandboxStateStale=!0})},"starting"===t.getState()._sandboxState?250:1e4);return()=>clearTimeout(n)},[e,t]),null}function U(){let e=R().store;return(0,i.useEffect)(()=>{e.setState(e=>{e._isSandboxStateStale||(e._isSandboxStateStale=!0)})},[e]),null}function F(){let e=R().store;return(0,i.useEffect)(()=>{let t=()=>{"visible"===document.visibilityState&&e.setState(e=>{e._isSandboxStateStale||(e._isSandboxStateStale=!0)})};return document.addEventListener("visibilitychange",t),()=>document.removeEventListener("visibilitychange",t)},[e]),null}function q(e){let{onStarted:t,onTransientError:n,onFatalError:r,onInactivityTimeout:a}=e,s=O(e=>e._isSandboxStateStale),l=R().store;return(0,i.useEffect)(()=>{if(!s)return;let e=!0;return async function(){try{let s=l.getState().baseUrls.live;if(!s)return;let i=await M(s);if(!e)return;switch(i){case"offline":a();case"error":r();break;case"unknown":case"stopped":n();break;case"started":t()}}finally{if(!e)return;l.setState(e=>{e._isSandboxStateStale=!1})}}(),()=>{e=!1}},[s,r,n,t,a,l]),null}function V(e){let{baseUrl:t,path:n}=e;if(!t)return null;let r=t.endsWith("/")?t.slice(0,-1):t,a=n.startsWith("/")?n:"/".concat(n);return"".concat(r).concat(a)}let G=e=>{let{data:t}=(0,a.a)({queryKey:["projects",e,"accessToken"],queryFn:async()=>{let t=(0,h.SJ)(),{token:n}=await t.get("/projects/".concat(e,"/auth-token"));return n},enabled:!!e});return t},W=(0,i.forwardRef)((e,t)=>{let{url:n,useCustomScript:a,onNavigate:s,onMessage:l,id:o}=e,c=(0,i.useRef)(null),[u,m]=(0,i.useState)(null),[p,g]=(0,i.useState)(!0),f=(0,k.iZ)(e=>e.project),h=G(null==f?void 0:f.id),x=!!(null==f?void 0:f.id)&&!(null==f?void 0:f.is_protected)||!!h,v=u&&x?S(u,{useCustomScript:a,accessToken:h}):null;return(0,i.useImperativeHandle)(t,()=>({reload(){c.current&&(c.current.src=v||c.current.src)}}),[v]),(0,i.useEffect)(()=>{if(c.current&&n&&n!==u&&x){let e=S(n,{useCustomScript:a,accessToken:h});m(n),g(!0),c.current.src=e}},[h,x,u,s,n,a]),(0,i.useEffect)(()=>{let e=e=>{var t;if((null===(t=c.current)||void 0===t?void 0:t.contentWindow)===e.source){if("URL_CHANGED"===e.data.type){if(e.data.url!==u&&(m(e.data.url),e.data.url)){let{pathname:t,search:n,hash:r}=new URL(e.data.url),a=t;n&&(a+=n),r&&(a+=r),s(a)}}else"404"===e.data?g(!1):l(e)}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[u,l,s]),(0,r.jsxs)(r.Fragment,{children:[p&&(0,r.jsx)(w,{isLoading:!0}),(0,r.jsx)("iframe",{sandbox:d.h,ref:c,id:o,className:"min-h-full w-full flex-grow",allow:"accelerometer; autoplay; camera; encrypted-media; fullscreen; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; payment; usb; vr; xr-spatial-tracking; screen-wake-lock; magnetometer; ambient-light-sensor; battery; gamepad; picture-in-picture; display-capture; bluetooth;",onLoad:()=>g(!1),onError:()=>{g(!1)}})]})});W.displayName="PreviewIframe";let H=e=>"".concat(e,"-preview-panel");function B(e){let t=H(e);return(0,i.memo)(function(){let n=O(t=>t.activeMode===e),a=O(e=>e.currentPath),[s,l]=(0,i.useState)(a);(0,i.useEffect)(()=>{n&&l(a)},[n,a]);let{fullUrl:o,customScript:c}=O(t=>({fullUrl:V({baseUrl:t.baseUrls[e],path:s}),customScript:t.customScript})),d=(0,i.useMemo)(()=>o,[o]),{store:x}=R(),y=R().refs[e],j=(0,f.D)(),w=(0,v.D)(),S=(0,h.SJ)(),N=(0,i.useCallback)(e=>{l(e),n&&x.setState(t=>{t.currentPath!==e&&(t.currentPath=e)})},[x,n,l]),E=(0,i.useCallback)(e=>{if(n){var t,r;if(!function(e,t){if("CONSOLE_OUTPUT"!==e.data.type)return;let n=[];if(Array.isArray(e.data.messages))e.data.messages.forEach(t=>{"object"==typeof t&&null!==t&&"string"==typeof t.message&&"string"==typeof t.level?n.push({level:t.level,message:t.message.length>1e4?t.message.slice(0,1e4):t.message,logged_at:t.logged_at||e.data.logged_at||new Date().toISOString()}):u.logging.warn("Received invalid message format within messages array",{msgData:t})});else if("string"==typeof e.data.message&&"string"==typeof e.data.level)n.push({level:e.data.level,message:e.data.message.length>1e4?e.data.message.slice(0,1e4):e.data.message,logged_at:e.data.logged_at||new Date().toISOString()});else{u.logging.warn("Received invalid CONSOLE_OUTPUT data format",{data:e.data});return}t(e=>{n.length>50?e.consoleLogs=n.slice(0,50):e.consoleLogs.push(...n);let t=p(e.consoleLogs);for(;t>1e4||e.consoleLogs.length>50;){let n=e.consoleLogs.shift();if(!n)break;t-=n.message.length}})}(e,x.setState),t=x.setState,"NETWORK_REQUEST"===e.data.type&&t(t=>{let n={...e.data.request};n.responseBody&&n.responseBody.length>1e4&&(n.responseBody=n.responseBody.slice(0,1e4)),n.requestBody&&n.requestBody.length>1e4&&(n.requestBody=n.requestBody.slice(0,1e4)),n.error&&(n.error.message&&n.error.message.length>1e4&&(n.error.message=n.error.message.slice(0,1e4)),n.error.stack&&n.error.stack.length>1e4&&(n.error.stack=n.error.stack.slice(0,1e4))),n.url&&n.url.length>1e4&&(n.url=n.url.slice(0,1e4)),n.statusText&&n.statusText.length>1e4&&(n.statusText=n.statusText.slice(0,1e4)),t.networkRequests.push(n);let r=t.networkRequests.reduce((e,t)=>e+m(t),0);for(;r>1e5||t.networkRequests.length>50;){let e=t.networkRequests.shift();if(!e)break;r-=m(e)}}),r=x.setState,"RRWEB_EVENT"===e.data.type&&r(t=>{for(t.rrwebEvents.push(e.data.event);t.rrwebEvents.length>60;)t.rrwebEvents.shift()}),"RUNTIME_ERROR"===e.data.type||"UNHANDLED_PROMISE_REJECTION"===e.data.type)w.addRuntimeError(e.data.error,e.data.type);else if("FETCH_ERROR"===e.data.type){let t=_.W.safeParse(e.data.error),n=t.success?t.data:e.data.error;t.error&&u.logging.error("error_parsing_fetch_error",{error:t.error,event_data:e.data}),"status"in n&&(null==n?void 0:n.status)>=400&&(null==n?void 0:n.status)<500?(0,g.e)({...n,error_type:b.N.HTTP_CLIENT_ERROR},j,S):(0,g.e)({...n,error_type:b.N.HTTP_SERVER_ERROR},j,S)}}},[n,x,w,j,S]);return(0,r.jsx)(W,{ref:y,id:t,url:d,useCustomScript:c,onNavigate:N,onMessage:E})})}let J=B("static"),K=B("live")},58093:function(e,t,n){n.d(t,{H:function(){return r},i:function(){return a}});let r={mobile:{name:"mobile",tooltip:"Show desktop preview",icon:"devices"},tablet:{name:"tablet",tooltip:"Show mobile preview",icon:"devices"},desktop:{name:"desktop",tooltip:"Show tablet preview",icon:"devices"}},a={STATIC:"static",LIVE:"live"}},16022:function(e,t,n){n.d(t,{$:function(){return u},C:function(){return m}});var r=n(52155),a=n(68820),s=n(98244),i=n(67801),l=n(75748),o=n(46724);let c=()=>(0,i.Ue)(()=>({repoAccessibilityResponse:void 0})),d=(0,s.createContext)(null),u=e=>{let{children:t,projectId:n}=e,i=(0,s.useRef)(c()),u=(0,s.useMemo)(()=>({store:i.current}),[]),{canEdit:m,isProjectAdmin:p}=(0,l.t)(),{data:g}=(0,a.a)(o.V.repoAccessibility({projectId:n,userProjectPermissions:{admin:p,edit:m}}));return(0,s.useEffect)(()=>{i.current&&i.current.setState(e=>({...e,repoAccessibilityResponse:g}))},[g]),(0,r.jsx)(d.Provider,{value:u,children:t})};function m(){let{store:e}=function(){let e=(0,s.useContext)(d);if(!e)throw Error("useRepoAccessibility must be used within a RepoAccessibilityProvider");return e}();return e(e=>e.repoAccessibilityResponse)}},69128:function(e,t,n){n.d(t,{zV:function(){return v},JX:function(){return _},Yu:function(){return y}});var r=n(52155),a=n(95713),s=n(98244),i=n(67801),l=n(94671),o=n(92361),c=n(84864),d=n(35127);let u={errorCount:0,warnCount:0,infoCount:0},m={results:{},project_id:"",is_scanning:!1},p=e=>{if(!(null==e?void 0:e.results))return null;let t=null,n=null;return(Object.values(e.results).forEach(e=>{(null===t||e.timestamp>t)&&(t=e.timestamp,n=e.commit)}),t&&n)?{timestamp:t,commit:n}:null},g=e=>{if(!(null==e?void 0:e.results))return u;let t=0,n=0,r=0;return Object.values(e.results).forEach(e=>{e.items&&e.items.forEach(e=>{switch(e.level){case"error":t++;break;case"warn":n++;break;case"info":r++}})}),{errorCount:t,warnCount:n,infoCount:r}};var f=n(21517);let h=e=>(0,i.Ue)(()=>({securitySummary:u,scanData:null,isLoading:!0,isUpdating:!1,error:null,projectId:e,lastScanCommit:null,hasTriggeredInitialScan:!1})),x=(0,s.createContext)(null),v=e=>{let{children:t,projectId:n}=e;return(0,r.jsx)(b,{projectId:n,children:t},n)},b=e=>{let{children:t,projectId:n}=e,i=(0,s.useRef)(h(n)),v=(0,d.ZG)(),b=(0,f.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.latest_commit_sha}),_=async()=>{let e=i.current;if(n&&v)try{var t;e.setState({isUpdating:!0,error:null});let r=await (0,l.SJ)().getApi(),a=await r.post("/projects/".concat(n,"/security-scan"));(null===(t=a.data)||void 0===t?void 0:t.status)!=="started"&&e.setState({isUpdating:!1}),c.logging.info("Triggered security scan",{projectId:n})}catch(t){c.logging.error("Error triggering security scan",{projectId:n,error:t}),e.setState({error:"Failed to trigger security scan",isUpdating:!1})}};(0,s.useEffect)(()=>{if(!n)return;let e=i.current;if(!v){e.setState({securitySummary:u,scanData:{...m,project_id:n},isLoading:!1,isUpdating:!1,error:null,lastScanCommit:null,hasTriggeredInitialScan:!0});return}let t=(0,a.JU)(o.db,"projects/".concat(n,"/security/data")),r=(0,a.cf)(t,e=>{let t=i.current;try{if(e.exists()){let n=e.data(),r=p(n);t.setState({scanData:n,securitySummary:g(n),error:null,lastScanCommit:(null==r?void 0:r.commit)||null,isLoading:n.is_scanning||!1,isUpdating:n.is_scanning||!1}),t.getState().hasTriggeredInitialScan||n.is_scanning||(t.setState({hasTriggeredInitialScan:!0}),b&&(null==r?void 0:r.commit)!==b&&_())}else t.setState({securitySummary:u,scanData:{...m,project_id:n},error:null,lastScanCommit:null,isLoading:!0}),t.getState().hasTriggeredInitialScan||(t.setState({hasTriggeredInitialScan:!0}),_())}catch(e){c.logging.error("Error parsing security findings data",{projectId:n,error:e}),t.setState({error:"Failed to parse security data",isLoading:!1,isUpdating:!1})}},e=>{c.logging.error("Error listening to security findings",{projectId:n,error:e}),i.current.setState({error:"Failed to load security data",isLoading:!1,isUpdating:!1})});return()=>r()},[n,b,v]);let y={store:i.current,triggerScan:_};return(0,r.jsx)(x.Provider,{value:y,children:t})};function _(){let e=(0,s.useContext)(x);if(!e)throw Error("useSecurityContext must be used within a SecurityProvider");return e}function y(e){let{store:t}=_();return t(e)}},62797:function(e,t,n){n.d(t,{o:function(){return u}});var r=n(52155),a=n(99526),s=n(81858),i=n(13018),l=n(59561),o=n(14070),c=n(50484),d=n(77658);function u(e){let{open:t,onOpenChange:n}=e,u=(0,a.useRouter)(),m=(0,s.T_)("AuthDialog"),p=(0,i.dl)(c.P.GetStartedForFree);return(0,r.jsx)(o.Vq,{open:t,onOpenChange:n,children:(0,r.jsxs)(o.cZ,{className:"gap-4",size:"sm",children:[(0,r.jsxs)("div",{className:"flex flex-col items-start gap-4",children:[(0,r.jsx)(d.xx,{className:"h-9"}),(0,r.jsxs)(o.fK,{children:[(0,r.jsx)(o.$N,{className:"text-3xl",children:m("title")}),(0,r.jsx)(o.Be,{children:m("description")})]})]}),(0,r.jsxs)("div",{className:"mt-4 flex flex-col gap-3",children:[(0,r.jsx)(l.z,{onClick:()=>u.push("/login"),className:"w-full",variant:"outline",children:m("logIn")}),(0,r.jsx)(l.z,{onClick:()=>u.push("/signup"),className:"w-full",children:m(p?"getStartedForFree":"signUp")})]})]})})}},43115:function(e,t,n){n.d(t,{z:function(){return i}});var r=n(52155),a=n(54140),s=n(92887);let i=e=>{var t;let{isInteractive:n=!1,className:i,workspace:l,...o}=e,c=(0,s.Q)(null==l?void 0:l.id),d=null==l?void 0:l.name,u=null!==(t=null==l?void 0:l.image_url)&&void 0!==t?t:void 0;return(0,r.jsx)(a.N,{name:d,isInteractive:n,photoSrc:u,userColor:c,className:i,isWorkspace:!0,...o})}},29306:function(e,t,n){n.d(t,{T:function(){return i}});var r=n(52155),a=n(4578),s=n(62196);let i=e=>{let{text:t,className:n}=e;return(0,r.jsxs)("div",{className:(0,a.cn)("mt-1 flex items-center gap-2 text-sm opacity-70",n),children:[(0,r.jsx)("div",{className:"my-1",children:(0,r.jsx)(s.$,{size:"small"})}),(0,r.jsx)("div",{children:t})]})}},79572:function(e,t,n){n.d(t,{_:function(){return c}});var r=n(98244),a=n(12703),s=n(10178),i=n(39230),l=n(13273),o=n(26696);let c=(e,t)=>{let{mutateAsync:n,isPending:c}=(0,s.mo)({projectId:e,onSuccess:()=>{a.Am.success("Supabase connected",{description:"Follow the instructions in the chat to complete the integration."}),null==t||t()}});return{handleProjectSelect:(0,r.useCallback)(async t=>{if(t)try{await n({body:{id:(0,i.Fd)(),message:"Please connect my supabase project `".concat(t.name,"`"),mode:o.S.INSTANT,contains_error:!1,integrate_supabase_project_id:t.id,integrate_supabase_org_id:t.organization_id},projectId:e},{})}catch(e){(0,l.Eo)(e)}},[n,e]),isConnecting:c}}},19227:function(e,t,n){n.d(t,{QD:function(){return tW},Iu:function(){return tG},v7:function(){return tY}});var r,a,s=n(52155),i=n(56166),l=n(68820),o=n(56852),c=n(98244),d=n(12703),u=n(54494),m=n(10178),p=n(39230),g=n(25341),f=n(72163),h=n(70980),x=n(21517),v=n(29306),b=n(76816),_=n(59561),y=n(99792);let j=(0,c.createContext)(void 0);function w(e){let{children:t,onStackEmpty:n,initialStack:r=[]}=e,[a,i]=(0,c.useState)(r),l=(0,c.useCallback)(e=>{i(t=>[...t,e])},[]),o=(0,c.useCallback)(()=>{i(e=>{let t=e.slice(0,-1);return 0===t.length&&(null==n||n()),t})},[n]),d=(0,c.useCallback)(e=>{e<0||i(t=>t.slice(0,e+1))},[]),u=(0,c.useCallback)(()=>{i([]),null==n||n()},[n]),m=(0,c.useMemo)(()=>({stack:a,push:l,pop:o,popTo:d,reset:u}),[a,l,o,d,u]);return(0,s.jsx)(j.Provider,{value:m,children:t})}function S(){let e=(0,c.useContext)(j);if(void 0===e)throw Error("useSheetNavigation must be used within a SheetNavigationProvider");return e}function N(e){let{isMobile:t,children:n,navigationItems:r}=e,{stack:a,push:i,popTo:l,reset:o}=S(),c=(e,t)=>{(1!==a.length||a[0].title!==e)&&(o(),i({title:e,component:t}))},d=a[a.length-1],u=a.length>0?a[0].title:null;return t?(0,s.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,s.jsx)("div",{className:"flex h-full flex-col overflow-hidden",children:(0,s.jsx)("div",{className:"grow overflow-y-auto",children:d?d.component:n})}),(0,s.jsx)("div",{className:"border-t bg-background",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsx)("div",{className:"flex min-w-max gap-1 p-2",children:r.map(e=>{let{title:t,icon:n,component:r}=e;return(0,s.jsxs)(_.z,{variant:u===t?"secondary":"ghost",className:"h-16 w-20 min-w-16 flex-col gap-1 px-2 text-xs",onClick:()=>c(t,r),children:[(0,s.jsx)(y.Z,{name:n,size:"small"}),(0,s.jsx)("span",{className:"text-center text-[10px] leading-tight",children:"Auth"===t?"Auth":t})]},t)})})})})]}):(0,s.jsx)("div",{className:"flex h-full w-full",children:(0,s.jsxs)("div",{className:"flex h-full w-full flex-col gap-6",children:[a.length>0&&(0,s.jsx)("div",{className:"relative flex shrink-0 items-center border-b pb-2",children:(0,s.jsxs)("div",{className:"relative z-10 flex items-center gap-1.5 text-sm text-muted-foreground",children:[(0,s.jsx)("button",{onClick:()=>o(),className:"hover:underline",children:"Home"}),a.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"/"}),t===a.length-1?(0,s.jsx)("span",{className:"text-foreground",children:e.title}):(0,s.jsx)("button",{onClick:()=>l(t),className:"hover:underline",children:e.title})]},"".concat(e.title,"-").concat(t)))]})}),(0,s.jsx)("div",{className:"flex grow flex-col gap-6 pb-12",children:d?d.component:n})]})})}var E=n(57602),C=n(45145),k=n(62369),T=n(29605),I=n(16773),A=n(6065),R=n(13273),O=n(14343),D=n(20372),M=n(89594);function L(){let e=(0,D._)(["\n    with\n      tables as (","),\n      columns as (",")\n    select\n      *,\n      ","\n    from tables\n  "]);return L=function(){return e},e}function P(){let e=(0,D._)(["\n    COALESCE(\n      (\n        SELECT\n          array_agg(row_to_json(",")) FILTER (WHERE ",")\n        FROM\n          ","\n      ),\n      '{}'\n    ) AS ","\n  "]);return P=function(){return e},e}let z=["information_schema","pg_catalog","pg_toast","_timescaledb_internal"],Z=(e,t)=>(0,M.Pn)(P(),e,t,e,e),U=async(e,t)=>{let{data:n,error:r}=await t.GET("/v1/projects/{ref}/config/auth",{params:{path:{ref:e}}});if(r)throw r;return n},F=(0,A.t)(),q=e=>{let t=V();return(0,l.a)({queryKey:["auth-config",e],queryFn:()=>U(e,t),enabled:!!e&&!!t,retry:!1})},V=()=>{let e=(0,x.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.id});return(0,c.useMemo)(()=>e?(0,I.ZP)({baseUrl:"".concat(F,"/projects/").concat(e,"/db-proxy"),fetch:async e=>{let t=await O.g.getValidToken();if(!t)throw Error("No token available");return e.headers.append("Authorization","Bearer ".concat(t)),fetch(e)}}):null,[e])},G=async e=>{let{projectRef:t,payload:n,dbClient:r}=e,{data:a,error:s}=await r.PATCH("/v1/projects/{ref}/config/auth",{params:{path:{ref:t}},body:n});if(s)throw s;return a},W=()=>{let e=(0,T.NL)(),t=V();return(0,i.D)({mutationFn:e=>{let{projectRef:n,payload:r}=e;if(!t)throw Error("Database client not available");return G({projectRef:n,payload:r,dbClient:t})},onSuccess:(t,n)=>{d.Am.success("Auth config updated."),e.invalidateQueries({queryKey:["auth-config",n.projectRef]})},onError:e=>{(0,R.Eo)(e)}})},H=async e=>{let{projectRef:t,query:n,readOnly:r,dbClient:a}=e,{data:s,error:i}=await a.POST("/v1/projects/{ref}/database/query",{params:{path:{ref:t}},body:{query:n,read_only:r}});if(i)throw i;return s},B=()=>{let e=V();return(0,i.D)({mutationFn:t=>{let{projectRef:n,query:r,readOnly:a}=t;if(!e)throw Error("Database client not available");return H({projectRef:n,query:r,readOnly:a,dbClient:e})},onError:e=>{(0,R.Eo)(e)}})},J=e=>{let{projectRef:t,schemas:n,dbClient:r}=e;return H({projectRef:t,query:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,M.Pn)(L(),"\nSELECT\n  c.oid :: int8 AS id,\n  nc.nspname AS schema,\n  c.relname AS name,\n  c.relrowsecurity AS rls_enabled,\n  c.relforcerowsecurity AS rls_forced,\n  CASE\n    WHEN c.relreplident = 'd' THEN 'DEFAULT'\n    WHEN c.relreplident = 'i' THEN 'INDEX'\n    WHEN c.relreplident = 'f' THEN 'FULL'\n    ELSE 'NOTHING'\n  END AS replica_identity,\n  pg_total_relation_size(format('%I.%I', nc.nspname, c.relname)) :: int8 AS bytes,\n  pg_size_pretty(\n    pg_total_relation_size(format('%I.%I', nc.nspname, c.relname))\n  ) AS size,\n  pg_stat_get_live_tuples(c.oid) AS live_rows_estimate,\n  pg_stat_get_dead_tuples(c.oid) AS dead_rows_estimate,\n  obj_description(c.oid) AS comment,\n  coalesce(pk.primary_keys, '[]') as primary_keys,\n  coalesce(\n    jsonb_agg(relationships) filter (where relationships is not null),\n    '[]'\n  ) as relationships\nFROM\n  pg_namespace nc\n  JOIN pg_class c ON nc.oid = c.relnamespace\n  left join (\n    select\n      table_id,\n      jsonb_agg(_pk.*) as primary_keys\n    from (\n      select\n        n.nspname as schema,\n        c.relname as table_name,\n        a.attname as name,\n        c.oid :: int8 as table_id\n      from\n        pg_index i,\n        pg_class c,\n        pg_attribute a,\n        pg_namespace n\n      where\n        i.indrelid = c.oid\n        and c.relnamespace = n.oid\n        and a.attrelid = c.oid\n        and a.attnum = any (i.indkey)\n        and i.indisprimary\n    ) as _pk\n    group by table_id\n  ) as pk\n  on pk.table_id = c.oid\n  left join (\n    select\n      c.oid :: int8 as id,\n      c.conname as constraint_name,\n      nsa.nspname as source_schema,\n      csa.relname as source_table_name,\n      sa.attname as source_column_name,\n      nta.nspname as target_table_schema,\n      cta.relname as target_table_name,\n      ta.attname as target_column_name\n    from\n      pg_constraint c\n    join (\n      pg_attribute sa\n      join pg_class csa on sa.attrelid = csa.oid\n      join pg_namespace nsa on csa.relnamespace = nsa.oid\n    ) on sa.attrelid = c.conrelid and sa.attnum = any (c.conkey)\n    join (\n      pg_attribute ta\n      join pg_class cta on ta.attrelid = cta.oid\n      join pg_namespace nta on cta.relnamespace = nta.oid\n    ) on ta.attrelid = c.confrelid and ta.attnum = any (c.confkey)\n    where\n      c.contype = 'f'\n  ) as relationships\n  on (relationships.source_schema = nc.nspname and relationships.source_table_name = c.relname)\n  or (relationships.target_table_schema = nc.nspname and relationships.target_table_name = c.relname)\nWHERE\n  c.relkind IN ('r', 'p')\n  AND NOT pg_is_other_temp_schema(nc.oid)\n  AND (\n    pg_has_role(c.relowner, 'USAGE')\n    OR has_table_privilege(\n      c.oid,\n      'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'\n    )\n    OR has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')\n  )\ngroup by\n  c.oid,\n  c.relname,\n  c.relrowsecurity,\n  c.relforcerowsecurity,\n  c.relreplident,\n  nc.nspname,\n  pk.primary_keys\n","\n-- Adapted from information_schema.columns\n\nSELECT\n  c.oid :: int8 AS table_id,\n  nc.nspname AS schema,\n  c.relname AS table,\n  (c.oid || '.' || a.attnum) AS id,\n  a.attnum AS ordinal_position,\n  a.attname AS name,\n  CASE\n    WHEN a.atthasdef THEN pg_get_expr(ad.adbin, ad.adrelid)\n    ELSE NULL\n  END AS default_value,\n  CASE\n    WHEN t.typtype = 'd' THEN CASE\n      WHEN bt.typelem <> 0 :: oid\n      AND bt.typlen = -1 THEN 'ARRAY'\n      WHEN nbt.nspname = 'pg_catalog' THEN format_type(t.typbasetype, NULL)\n      ELSE 'USER-DEFINED'\n    END\n    ELSE CASE\n      WHEN t.typelem <> 0 :: oid\n      AND t.typlen = -1 THEN 'ARRAY'\n      WHEN nt.nspname = 'pg_catalog' THEN format_type(a.atttypid, NULL)\n      ELSE 'USER-DEFINED'\n    END\n  END AS data_type,\n  COALESCE(bt.typname, t.typname) AS format,\n  a.attidentity IN ('a', 'd') AS is_identity,\n  CASE\n    a.attidentity\n    WHEN 'a' THEN 'ALWAYS'\n    WHEN 'd' THEN 'BY DEFAULT'\n    ELSE NULL\n  END AS identity_generation,\n  a.attgenerated IN ('s') AS is_generated,\n  NOT (\n    a.attnotnull\n    OR t.typtype = 'd' AND t.typnotnull\n  ) AS is_nullable,\n  (\n    c.relkind IN ('r', 'p')\n    OR c.relkind IN ('v', 'f') AND pg_column_is_updatable(c.oid, a.attnum, FALSE)\n  ) AS is_updatable,\n  uniques.table_id IS NOT NULL AS is_unique,\n  check_constraints.definition AS \"check\",\n  array_to_json(\n    array(\n      SELECT\n        enumlabel\n      FROM\n        pg_catalog.pg_enum enums\n      WHERE\n        enums.enumtypid = coalesce(bt.oid, t.oid)\n        OR enums.enumtypid = coalesce(bt.typelem, t.typelem)\n      ORDER BY\n        enums.enumsortorder\n    )\n  ) AS enums,\n  col_description(c.oid, a.attnum) AS comment\nFROM\n  pg_attribute a\n  LEFT JOIN pg_attrdef ad ON a.attrelid = ad.adrelid\n  AND a.attnum = ad.adnum\n  JOIN (\n    pg_class c\n    JOIN pg_namespace nc ON c.relnamespace = nc.oid\n  ) ON a.attrelid = c.oid\n  JOIN (\n    pg_type t\n    JOIN pg_namespace nt ON t.typnamespace = nt.oid\n  ) ON a.atttypid = t.oid\n  LEFT JOIN (\n    pg_type bt\n    JOIN pg_namespace nbt ON bt.typnamespace = nbt.oid\n  ) ON t.typtype = 'd'\n  AND t.typbasetype = bt.oid\n  LEFT JOIN (\n    SELECT DISTINCT ON (table_id, ordinal_position)\n      conrelid AS table_id,\n      conkey[1] AS ordinal_position\n    FROM pg_catalog.pg_constraint\n    WHERE contype = 'u' AND cardinality(conkey) = 1\n  ) AS uniques ON uniques.table_id = c.oid AND uniques.ordinal_position = a.attnum\n  LEFT JOIN (\n    -- We only select the first column check\n    SELECT DISTINCT ON (table_id, ordinal_position)\n      conrelid AS table_id,\n      conkey[1] AS ordinal_position,\n      substring(\n        pg_get_constraintdef(pg_constraint.oid, true),\n        8,\n        length(pg_get_constraintdef(pg_constraint.oid, true)) - 8\n      ) AS \"definition\"\n    FROM pg_constraint\n    WHERE contype = 'c' AND cardinality(conkey) = 1\n    ORDER BY table_id, ordinal_position, oid asc\n  ) AS check_constraints ON check_constraints.table_id = c.oid AND check_constraints.ordinal_position = a.attnum\nWHERE\n  NOT pg_is_other_temp_schema(nc.oid)\n  AND a.attnum > 0\n  AND NOT a.attisdropped\n  AND (c.relkind IN ('r', 'v', 'm', 'f', 'p'))\n  AND (\n    pg_has_role(c.relowner, 'USAGE')\n    OR has_column_privilege(\n      c.oid,\n      a.attnum,\n      'SELECT, INSERT, UPDATE, REFERENCES'\n    )\n  )\n",Z("columns","columns.table_id = tables.id"));return t+="\n",e.length>0?t+="where schema in (".concat(e.map(e=>"'".concat(e,"'")).join(","),")"):t+="where schema not in (".concat(z.map(e=>"'".concat(e,"'")).join(","),")"),t}(n),readOnly:!0,dbClient:r})},K=(e,t)=>{let n=V();return(0,l.a)({queryKey:["tables",e,t],queryFn:()=>J({projectRef:e,schemas:t,dbClient:n}),enabled:!!e&&!!n})},Y=async(e,t)=>{let{data:n,error:r}=await t.GET("/v1/projects/{ref}/storage/buckets",{params:{path:{ref:e}}});if(r)throw r;return n},X=e=>{let t=V();return(0,l.a)({queryKey:["buckets",e],queryFn:()=>Y(e,t),enabled:!!e&&!!t,retry:!1})},Q=e=>{let{projectRef:t,days:n,dbClient:r}=e;return H({projectRef:t,query:"\n    WITH days_series AS (\n      SELECT generate_series(\n        date_trunc('day', now() - interval '".concat(Number(n)-1," days'),\n        date_trunc('day', now()),\n        '1 day'::interval\n      )::date AS date\n    )\n    SELECT\n      d.date,\n      COALESCE(u.users, 0)::int as users\n    FROM\n      days_series d\n    LEFT JOIN (\n      SELECT\n        date_trunc('day', created_at AT TIME ZONE 'UTC')::date as date,\n        count(id) as users\n      FROM\n        auth.users\n      GROUP BY 1\n    ) u ON d.date = u.date\n    ORDER BY\n      d.date ASC;\n  "),readOnly:!0,dbClient:r})},$=(e,t)=>{let n=V();return(0,l.a)({queryKey:["user-counts",e,t],queryFn:()=>Q({projectRef:e,days:t,dbClient:n}),enabled:!!e&&!!n,retry:!1})},ee=async(e,t)=>{let[{data:n,error:r},{data:a,error:s}]=await Promise.all([t.GET("/v1/projects/{ref}/advisors/performance",{params:{path:{ref:e}}}),t.GET("/v1/projects/{ref}/advisors/security",{params:{path:{ref:e}}})]);if(r)throw r;if(s)throw s;return[...((null==n?void 0:n.lints)||[]).map(e=>({...e,type:"performance"})),...((null==a?void 0:a.lints)||[]).map(e=>({...e,type:"security"}))]},et=e=>{let t=V();return(0,l.a)({queryKey:["suggestions",e],queryFn:()=>ee(e,t),enabled:!!e&&!!t,retry:!1})},en=e=>{let t=et(e),n=(0,c.useMemo)(()=>!!t.data&&t.data.filter(e=>"security"!==e.type).some(e=>"ERROR"===e.level||"WARN"===e.level),[t.data]);return{...t,hasWarningsOrErrors:n}},er=async(e,t)=>{let{data:n,error:r}=await t.GET("/v1/projects/{ref}/secrets",{params:{path:{ref:e}}});if(r)throw r;return console.log("SECRETS-DATA",n),n},ea=e=>{let t=V();return(0,l.a)({queryKey:["secrets",e],queryFn:()=>er(e,t),enabled:!!e&&!!t,retry:!1})},es=async e=>{let{projectRef:t,secrets:n,dbClient:r}=e,{data:a,error:s}=await r.POST("/v1/projects/{ref}/secrets",{params:{path:{ref:t}},body:n});if(s)throw s;return a},ei=()=>{let e=(0,T.NL)(),t=V();return(0,i.D)({mutationFn:e=>{let{projectRef:n,secrets:r}=e;if(!t)throw Error("Database client not available");return es({projectRef:n,secrets:r,dbClient:t})},onSuccess:(t,n)=>{d.Am.success("Secrets created successfully."),e.refetchQueries({queryKey:["secrets",n.projectRef]})},onError:e=>{(0,R.Eo)(e)}})},el=async e=>{let{projectRef:t,secretNames:n,dbClient:r}=e,{data:a,error:s}=await r.DELETE("/v1/projects/{ref}/secrets",{params:{path:{ref:t}},body:n});if(s)throw s;return a},eo=()=>{let e=(0,T.NL)(),t=V();return(0,i.D)({mutationFn:e=>{let{projectRef:n,secretNames:r}=e;if(!t)throw Error("Database client not available");return el({projectRef:n,secretNames:r,dbClient:t})},onSuccess:(t,n)=>{d.Am.success("Secrets deleted successfully."),e.invalidateQueries({queryKey:["secrets",n.projectRef]})},onError:e=>{(0,R.Eo)(e)}})};var ec=n(25243),ed=n(35067);let eu={disable_signup:"Disable Signup",external_anonymous_users_enabled:"Allow Anonymous Sign-ins",external_email_enabled:"Enable Email Provider",mailer_autoconfirm:"Confirm Email",mailer_secure_email_change_enabled:"Secure Email Change",security_update_password_require_reauthentication:"Secure Password Change",password_hibp_enabled:"Prevent Leaked Passwords",password_min_length:"Minimum Password Length",password_required_characters:{label:"Password Requirements",options:{NO_REQUIRED_CHARS:"No requirements","abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789":"Letters and numbers","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789":"Lowercase, uppercase, and numbers","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789:!@#$%^&*()_+-=[]{};'\\\\:\"|<>?,./`~":"Letters, numbers, and symbols"}},mailer_otp_exp:"Email OTP Expiration (seconds)",mailer_otp_length:"Email OTP Length",external_phone_enabled:"Enable Phone Provider",sms_provider:{label:"SMS Provider",options:{twilio:"Twilio",messagebird:"MessageBird",textlocal:"TextLocal",vonage:"Vonage",twilio_verify:"Twilio Verify"}},sms_twilio_account_sid:"Twilio Account SID",sms_twilio_auth_token:"Twilio Auth Token",sms_twilio_message_service_sid:"Twilio Message Service SID",sms_twilio_content_sid:"Twilio Content SID",sms_twilio_verify_account_sid:"Twilio Verify Account SID",sms_twilio_verify_auth_token:"Twilio Verify Auth Token",sms_twilio_verify_message_service_sid:"Twilio Verify Message Service SID",sms_messagebird_access_key:"MessageBird Access Key",sms_messagebird_originator:"MessageBird Originator",sms_textlocal_api_key:"TextLocal API Key",sms_textlocal_sender:"TextLocal Sender",sms_vonage_api_key:"Vonage API Key",sms_vonage_api_secret:"Vonage API Secret",sms_vonage_from:"Vonage From Number",sms_autoconfirm:"Enable Phone Confirmations",sms_otp_exp:"SMS OTP Expiry (seconds)",sms_otp_length:"SMS OTP Length",sms_template:"SMS Message Template",sms_test_otp:"Test Phone Numbers and OTPs",sms_test_otp_valid_until:"Test OTPs Valid Until",external_google_enabled:"Enable Google Sign-in",external_google_client_id:"Google Client ID(s)",external_google_secret:"Google OAuth Client Secret",external_google_skip_nonce_check:"Skip Nonce Check",name:"Secret Name",value:"Secret Value",secretNames:"Secret Names"},em=ec.Ry({disable_signup:ec.O7().optional().describe("This will prevent new users from signing up."),external_anonymous_users_enabled:ec.O7().optional().describe("This will enable anonymous users to sign in to your application.")}),ep="NO_REQUIRED_CHARS",eg=ec.Ry({external_email_enabled:ec.O7().optional().describe("This will enable Email based signup and login for your application."),mailer_autoconfirm:ec.O7().optional().describe("Users will need to confirm their email address before signing in for the first time."),mailer_secure_email_change_enabled:ec.O7().optional().describe("Users will be required to confirm any email change on both the old email address and new email address. If disabled, only the new email is required to confirm."),security_update_password_require_reauthentication:ec.O7().optional().describe("Users will need to be recently logged in to change their password without requiring reauthentication. (A user is considered recently logged in if the session was created within the last 24 hours.) If disabled, a user can change their password at any time."),password_hibp_enabled:ec.O7().optional().describe("Rejects the use of known or easy to guess passwords on sign up or password change. Powered by the HaveIBeenPwned.org Pwned Passwords API."),password_min_length:ec.Rx().int().min(6,"Must be greater or equal to 6.").describe("Passwords shorter than this value will be rejected as weak. Minimum 6, recommended 8 or more."),password_required_characters:ec.dj(e=>""===e||null==e?ep:e,ec.Km([ep,"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789:!@#$%^&*()_+-=[]{};'\\\\:\"|<>?,./`~"])).optional().transform(e=>e===ep?"":e).describe("Passwords that do not have at least one of each will be rejected as weak."),mailer_otp_exp:ec.Rx().int().min(0,"Must be more than 0").max(86400,"Must be no more than 86400").describe("Duration before an email one time password (OTP) / link expires in seconds."),mailer_otp_length:ec.Rx().int().min(6,"Must be at least 6").max(10,"Must be no more than 10").optional().describe("Number of digits in the email one time password (OTP)")}).describe("Email provider settings."),ef=ec.Ry({external_phone_enabled:ec.O7().optional().describe("This will enable phone based login for your application"),sms_provider:ec.Km(["twilio","messagebird","textlocal","vonage","twilio_verify"]).optional().describe("External provider that will handle sending SMS messages"),sms_twilio_account_sid:ec.Z_().optional(),sms_twilio_auth_token:ec.Z_().optional(),sms_twilio_message_service_sid:ec.Z_().optional(),sms_twilio_content_sid:ec.Z_().optional().describe("Twilio Content SID (Optional, For WhatsApp Only)"),sms_twilio_verify_account_sid:ec.Z_().optional(),sms_twilio_verify_auth_token:ec.Z_().optional(),sms_twilio_verify_message_service_sid:ec.Z_().optional(),sms_messagebird_access_key:ec.Z_().optional(),sms_messagebird_originator:ec.Z_().optional(),sms_textlocal_api_key:ec.Z_().optional(),sms_textlocal_sender:ec.Z_().optional(),sms_vonage_api_key:ec.Z_().optional(),sms_vonage_api_secret:ec.Z_().optional(),sms_vonage_from:ec.Z_().optional(),sms_autoconfirm:ec.O7().optional().describe("Users will need to confirm their phone number before signing in."),sms_otp_exp:ec.Rx().int().optional().describe("Duration before an SMS OTP expires in seconds."),sms_otp_length:ec.Rx().int().optional().describe("Number of digits in OTP."),sms_template:ec.Z_().optional().describe("To format the OTP code use `{{ .Code }}`"),sms_test_otp:ec.Z_().optional().describe("Register phone number and OTP combinations for testing as a comma separated list of <phone number>=<otp> pairs. Example: `18005550123=789012`"),sms_test_otp_valid_until:ec.Z_().datetime({message:"Invalid datetime string."}).optional().describe("Test phone number and OTP combinations won't be active past this date and time (local time zone).")}).describe("Phone provider settings."),eh=ec.Ry({external_google_enabled:ec.O7().optional().describe("Enable Sign in with Google"),external_google_client_id:ec.Z_().regex(/^([a-z0-9-]+\.[a-z0-9-]+(\.[a-z0-9-]+)*(,[a-z0-9-]+\.[a-z0-9-]+(\.[a-z0-9-]+)*)*)$/i,"Google Client IDs should be a comma-separated list of domain-like strings.").optional(),external_google_secret:ec.Z_().regex(/^[a-z0-9.\/_-]*$/i,"Google OAuth Client Secrets usually contain letters, numbers, dots, dashes, and underscores.").optional(),external_google_skip_nonce_check:ec.O7().optional().describe("Allows ID tokens with any nonce to be accepted, which is less secure.")}),ex=eh.superRefine((e,t)=>{e.external_google_enabled&&!e.external_google_client_id&&t.addIssue({code:ed.NL.custom,path:["external_google_client_id"],message:"At least one Client ID is required when Google sign-in is enabled."}),e.external_google_client_id&&e.external_google_client_id.includes(" ")&&t.addIssue({code:ed.NL.custom,path:["external_google_client_id"],message:"Client IDs should not contain spaces."})}).describe("Google provider settings.");em.merge(eg).merge(ef).merge(eh).partial();let ev=ec.Ry({secrets:ec.IX(ec.Ry({name:ec.Z_().min(1,"Secret name is required.").regex(/^[a-zA-Z_][a-zA-Z0-9_]*$/,"Must contain letters, numbers, and underscores, starting with a letter or underscore."),value:ec.Z_().min(1,"Secret value is required.")}))}).describe("Secrets schema for managing environment variables.");ec.Ry({secretNames:ec.IX(ec.Z_().min(1,"Secret name cannot be empty.")).min(1,"At least one secret name is required.")}).describe("Schema for deleting secrets by name.");var eb=n(72602),e_=n(96869),ey=n(62483),ej=n(7815),ew=n(3011),eS=n(31194),eN=n(4578);let eE=e=>{if(!e||"object"!=typeof e._def||null===e._def)throw Error("unwrapZodType received an invalid Zod schema object. Check the console for the problematic schema/key.");let t=e;for(;"ZodOptional"===t._def.typeName||"ZodDefault"===t._def.typeName||"ZodNullable"===t._def.typeName||"ZodEffects"===t._def.typeName;)t="ZodEffects"===t._def.typeName?t._def.schema:t._def.innerType;return t};function eC(e){let{schema:t,onSubmit:n,isLoading:r=!1,initialValues:a,labels:i,columnInfo:l,onCancel:o}=e,d=(0,c.useRef)(!0),u=Object.keys(t.shape).reduce((e,n)=>{let r=t.shape[n];if(void 0===r)throw Error("Schema error: schema.shape['".concat(n,"'] is undefined. Check schema definition."));if("ZodDefault"===r._def.typeName)return e[n]=r._def.defaultValue(),e;let a=eE(r);switch(a._def.typeName){case"ZodString":e[n]="";break;case"ZodBoolean":e[n]=!1;break;case"ZodEnum":let s=a._def.values||[];e[n]=s.length>0?s[0]:"";break;case"ZodNumber":e[n]=0;break;case"ZodArray":e[n]=[];break;default:e[n]=void 0}return e},{}),m=(0,e_.cI)({resolver:(0,eb.F)(t),defaultValues:u});(0,c.useEffect)(()=>{if(a){d.current=!0;let e=Object.keys(t.shape).reduce((e,n)=>{let r=t.shape[n];if(void 0===r)throw Error("Schema error in useEffect: schema.shape['".concat(n,"'] is undefined."));let s=a.hasOwnProperty(n)?a[n]:void 0,i=eE(r);if("ZodBoolean"===i._def.typeName)e[n]=!!s;else if("ZodString"===i._def.typeName)e[n]=null==s?"":String(s);else if("ZodEnum"===i._def.typeName){let t=i._def.values||[];e[n]=null!=s&&t.includes(s)?String(s):t[0]||""}else if("ZodNumber"===i._def.typeName){let t=Number(s);e[n]=isNaN(t)?0:t}else if("ZodArray"===i._def.typeName){if(Array.isArray(s))e[n]=s;else if(null==s)e[n]=[];else if("string"==typeof s&&s.startsWith("{")&&s.endsWith("}"))try{let t=s.slice(1,-1);""===t.trim()?e[n]=[]:e[n]=t.split(",").map(e=>e.trim())}catch(t){e[n]=[]}else e[n]=[]}else e[n]=s;return e},{});m.reset(e),setTimeout(()=>{d.current=!1},0)}else d.current=!1},[a,m,t]);let p=(e,t,n)=>{let r=eE(t),a=r._def.typeName,o=t.description;return(0,s.jsx)(ej.Wi,{control:m.control,name:e,render:t=>{var c,u,m,p;let{field:g}=t,f=null==i?void 0:i[e],h="string"==typeof f?f:(null==f?void 0:f.label)||e,x=(null==l?void 0:null===(c=l[e])||void 0===c?void 0:c.data_type)||"";switch(a){case"ZodString":return(0,s.jsx)(ek,{isLast:n,children:(0,s.jsxs)("div",{className:"flex w-full flex-col justify-between gap-4 lg:flex-row lg:items-center lg:gap-8",children:[(0,s.jsxs)("div",{className:"flex-1 pr-4",children:[(0,s.jsx)(ej.lX,{children:h}),(0,s.jsx)("div",{className:"mt-1 text-sm text-muted-foreground",children:x}),o&&(0,s.jsx)(ej.pf,{children:o}),(0,s.jsx)(ej.zG,{})]}),(0,s.jsx)("div",{className:"lg:max-w-1/2 flex-1",children:(0,s.jsx)(ej.NI,{children:(0,s.jsx)(ew.I,{placeholder:"Enter your ".concat(e),...g,value:g.value||""})})})]})});case"ZodNumber":return(0,s.jsx)(ek,{isLast:n,children:(0,s.jsxs)("div",{className:"flex w-full flex-col justify-between gap-4 lg:flex-row lg:items-center lg:gap-8",children:[(0,s.jsxs)("div",{className:"flex-1 pr-4",children:[(0,s.jsx)(ej.lX,{children:h}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:x}),o&&(0,s.jsx)(ej.pf,{children:o}),(0,s.jsx)(ej.zG,{})]}),(0,s.jsx)("div",{className:"lg:max-w-1/2 flex-1",children:(0,s.jsx)(ej.NI,{children:(0,s.jsx)(ew.I,{type:"number",placeholder:"Enter value for ".concat(e),...g,value:null!==(u=g.value)&&void 0!==u?u:"",onChange:e=>{let t=parseInt(e.target.value,10);g.onChange(isNaN(t)?void 0:t)}})})})]})});case"ZodBoolean":return(0,s.jsxs)(ek,{isLast:n,className:"flex flex-row items-center justify-between gap-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(ej.lX,{children:h}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:x}),o&&(0,s.jsx)(ej.pf,{children:o}),(0,s.jsx)(ej.zG,{})]}),(0,s.jsx)(ej.NI,{children:(0,s.jsx)(k.r,{checked:!!g.value,onCheckedChange:g.onChange})})]});case"ZodEnum":let v=r._def.values,b="object"==typeof f?f.options:void 0;return(0,s.jsx)(ek,{isLast:n,children:(0,s.jsxs)("div",{className:"flex w-full flex-col justify-between gap-4 lg:flex-row lg:items-center lg:gap-8",children:[(0,s.jsxs)("div",{className:"flex-1 pr-4",children:[(0,s.jsx)(ej.lX,{children:h}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:x}),o&&(0,s.jsx)(ej.pf,{children:o}),(0,s.jsx)(ej.zG,{})]}),(0,s.jsx)("div",{className:"lg:max-w-1/2 flex-1",children:(0,s.jsxs)(eS.Ph,{onValueChange:e=>{d.current||g.onChange(e)},value:g.value,children:[(0,s.jsx)(ej.NI,{children:(0,s.jsx)(eS.i4,{children:(0,s.jsx)(eS.ki,{placeholder:"Select a ".concat(e)})})}),(0,s.jsx)(eS.Bw,{children:v.map(e=>(0,s.jsx)(eS.Ql,{value:e,children:(null==b?void 0:b[e])||e},e))})]})})]})});case"ZodArray":return(0,s.jsx)(ek,{isLast:n,children:(0,s.jsxs)("div",{className:"flex w-full flex-row items-center justify-between gap-8",children:[(0,s.jsxs)("div",{className:"flex-1 pr-4",children:[(0,s.jsx)(ej.lX,{children:h}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:['Enter as JSON array: ["item1", "item2"]',(null==l?void 0:null===(m=l[e])||void 0===m?void 0:m.is_nullable)&&" (leave empty for null)"]}),o&&(0,s.jsx)(ej.pf,{children:o}),(0,s.jsx)(ej.zG,{})]}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(ej.NI,{children:(0,s.jsx)(ew.I,{placeholder:(null==l?void 0:null===(p=l[e])||void 0===p?void 0:p.is_nullable)?'["item1", "item2"] or leave empty for null':'["item1", "item2"]',...g,value:null===g.value||void 0===g.value?"":Array.isArray(g.value)?JSON.stringify(g.value):g.value||"",onChange:e=>{let t=e.target.value;if(""===t.trim())g.onChange(null);else try{let e=JSON.parse(t);Array.isArray(e)?g.onChange(e):g.onChange(t)}catch(e){g.onChange(t)}}})})})]})});default:return(0,s.jsx)(s.Fragment,{})}}},e)},g=m.formState.isDirty;return(0,s.jsx)(ej.l0,{...m,children:(0,s.jsxs)("form",{onSubmit:m.handleSubmit(n),className:"flex flex-col gap-4",children:[Object.keys(t.shape).map((e,n)=>p(e,t.shape[e],n===Object.keys(t.shape).length-1)),g&&(0,s.jsxs)(ey.j,{className:"justify-end gap-2",children:[o&&(0,s.jsx)(_.z,{variant:"outline",type:"button",onClick:o,children:"Cancel"}),(0,s.jsx)(_.z,{type:"submit",loading:r,variant:"affirmative",children:r?"Saving":"Save"})]})]})})}let ek=e=>{let{isLast:t,children:n,className:r}=e;return(0,s.jsx)(ej.xJ,{className:(0,eN.cn)("border-b pb-4",t&&"border-b-0",r),children:n})},eT=e=>{let{title:t,description:n,children:r,className:a}=e;return(0,s.jsxs)("div",{className:(0,eN.cn)("flex min-h-9 w-full items-center justify-between gap-6",a),children:[(0,s.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,s.jsx)("h3",{className:"text-base font-medium lg:text-lg",children:t}),n&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:n})]}),r]})};function eI(e){let{projectRef:t,schema:n,title:r,initialValues:a,onSuccess:i,onCancel:l}=e,{mutate:o,isPending:d}=W(),u="shape"in n?n:n._def.schema,m=(0,c.useMemo)(()=>{if(a)return Object.keys(u.shape).reduce((e,t)=>(Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t]),e),{})},[a,u]);return(0,s.jsx)("div",{className:"mx-auto w-full pb-4 pt-4",children:(0,s.jsx)(eC,{schema:u,onSubmit:e=>{let n=Object.fromEntries(Object.entries(e).filter(e=>{let[t,n]=e;return void 0!==n}));if(0===Object.keys(n).length){alert("No changes to submit. Please modify a field to update.");return}o({projectRef:t,payload:n},{onSuccess:i})},isLoading:d,initialValues:m,labels:eu,onCancel:l})})}function eA(e){let{projectRef:t}=e,{data:n,isLoading:r,error:a}=q(t),{mutate:i,isPending:l}=W(),{push:o,pop:d}=S(),u=[{icon:"mail",name:"Email",description:"Allow users to sign in with their email address",enabledKey:"external_email_enabled",schema:eg},{icon:"phone_iphone",name:"Phone",description:"Allow users to sign in with their phone number",enabledKey:"external_phone_enabled",schema:ef},{icon:"google",name:"Google",description:"Allow users to sign in with their Google account",enabledKey:"external_google_enabled",schema:ex}],m=(0,c.useCallback)(e=>{o({title:"".concat(e.name),component:(0,s.jsx)(eI,{projectRef:t,schema:e.schema,title:"".concat(e.name),initialValues:n,onSuccess:()=>d(),onCancel:()=>d()})})},[t,n,o,d]),p=(e,n)=>{i({projectRef:t,payload:{[e]:n}})},g=(0,c.useMemo)(()=>{if(n)return Object.keys(em.shape).reduce((e,t)=>(Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]),e),{})},[n]);return a?(0,s.jsx)("div",{className:"mx-6 mt-8 lg:mx-8",children:(0,s.jsxs)(E.bZ,{variant:"destructive",children:[(0,s.jsx)(y.Z,{name:"warning",className:"h-4 w-4"}),(0,s.jsx)(E.Cd,{children:"Error loading auth settings"}),(0,s.jsx)(E.X,{children:"There was a problem loading your authentication configuration."})]})}):r?(0,s.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,s.jsx)(C.O,{className:"h-12 w-full"}),(0,s.jsx)(C.O,{className:"h-12 w-full"}),(0,s.jsx)(C.O,{className:"h-12 w-full"})]}):(0,s.jsxs)("div",{className:"flex w-full flex-col gap-6",children:[(0,s.jsx)(eT,{title:"Auth",description:"Configure how users sign in to your app"}),(0,s.jsx)(eC,{schema:em,onSubmit:e=>{let n=Object.fromEntries(Object.entries(e).filter(e=>{let[t,n]=e;return void 0!==n}));if(0===Object.keys(n).length){alert("No changes to submit. Please modify a field to update.");return}i({projectRef:t,payload:n})},isLoading:l,initialValues:g,labels:eu,onCancel:()=>d()}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("p",{className:"text-base font-medium",children:"Sign in methods"}),(0,s.jsx)("div",{className:"overflow-hidden rounded-xl border bg-background",children:u.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-4 border-b px-3 py-3 last:border-b-0",children:[(0,s.jsx)("div",{className:"flex size-12 flex-shrink-0 items-center justify-center rounded-lg bg-muted",children:(0,s.jsx)(y.Z,{name:e.icon,className:"h-4 w-4 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-base font-medium",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]}),(0,s.jsx)(k.r,{checked:!!(null==n?void 0:n[e.enabledKey]),onCheckedChange:t=>p(e.enabledKey,t),disabled:l}),(0,s.jsx)(_.z,{variant:"ghost",size:"icon-sm",onClick:()=>m(e),children:(0,s.jsx)(y.Z,{name:"settings",className:"h-4 w-4 text-muted-foreground"})})]},e.name))})]})]})}function eR(){return(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsx)(eT,{title:"Configuration",description:"Manage your backend settings and plan your scaling options."}),(0,s.jsxs)(E.bZ,{variant:"secondary",className:"border-border bg-card",children:[(0,s.jsx)(y.Z,{name:"info",className:"h-4 w-4"}),(0,s.jsx)(E.Cd,{children:"Backend Infrastructure"}),(0,s.jsx)(E.X,{children:"Your backend is currently running on a free preview tier of Lovable's upcoming backend."})]}),(0,s.jsxs)(E.bZ,{variant:"secondary",children:[(0,s.jsx)(y.Z,{name:"lightbulb_2",className:"h-4 w-4"}),(0,s.jsx)(E.Cd,{children:"Roadmap"}),(0,s.jsx)(E.X,{children:"We're committed to keeping you informed about our backend evolution. Scaling these features will be available as paid upgrades to ensure sustainable, high-quality infrastructure. We are actively working to not lock you into our platformfuture project portability will ensure you can self-host your backend or transfer to other platforms."})]})]})}var eO=n(5620);let eD=c.forwardRef((e,t)=>{let{onClick:n,icon:r,title:a,description:i,className:l,badge:o,...c}=e;return(0,s.jsxs)(eO.Zb,{className:(0,eN.cn)("flex cursor-pointer flex-row items-center gap-4 rounded-2xl border-none bg-transparent p-2 text-left shadow-none hover:bg-accent",l),onClick:n,ref:t,...c,children:[(0,s.jsx)("div",{className:"flex size-12 flex-shrink-0 items-center justify-center rounded-lg bg-muted",children:(0,s.jsx)(y.Z,{name:r,size:"small"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 py-1",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,s.jsx)("h2",{className:"truncate text-lg font-medium leading-tight",children:a}),o]}),(0,s.jsx)("div",{className:"shrink-0 text-sm font-normal leading-none text-muted-foreground",children:i})]})]})});function eM(e){let{projectRef:t,tableName:n,initialPageSize:r=10,initialSort:a={column:null,direction:null}}=e,[s,i]=(0,c.useState)({page:0,pageSize:r,totalCount:0}),[l,o]=(0,c.useState)(a),[d,u]=(0,c.useState)(null),[m,p]=(0,c.useState)(!1),[g,f]=(0,c.useState)(null),{mutate:h}=B(),x=(0,c.useCallback)(()=>{let e=n.includes(".")?n:"public.".concat(n),t="SELECT * FROM ".concat(e);l.column&&l.direction&&(t+=' ORDER BY "'.concat(l.column,'" ').concat(l.direction.toUpperCase()));let r=s.page*s.pageSize;return t+" LIMIT ".concat(s.pageSize," OFFSET ").concat(r)},[n,l,s.page,s.pageSize]),v=(0,c.useCallback)(()=>{let e=n.includes(".")?n:"public.".concat(n);return"SELECT COUNT(*) as total FROM ".concat(e)},[n]),b=(0,c.useCallback)(()=>{p(!0),f(null),h({projectRef:t,query:v(),readOnly:!0},{onSuccess:e=>{var n;let r=(null==e?void 0:null===(n=e[0])||void 0===n?void 0:n.total)||0;i(e=>({...e,totalCount:r})),h({projectRef:t,query:x(),readOnly:!0},{onSuccess:e=>{u(e||[]),p(!1)},onError:e=>{f(e),u(null),p(!1)}})},onError:e=>{f(e),u(null),p(!1)}})},[t,x,v,h]),_=(0,c.useCallback)(e=>{i(t=>({...t,page:e}))},[]),y=(0,c.useCallback)(e=>{i(t=>({...t,pageSize:e,page:0}))},[]),j=(0,c.useCallback)(e=>{o(e),i(e=>({...e,page:0}))},[]),w=(0,c.useCallback)(()=>{b()},[b]);return c.useEffect(()=>{b()},[b]),{data:d,isLoading:m,error:g,pagination:s,sort:l,setPage:_,setPageSize:y,setSort:j,refetch:w}}eD.displayName="NavigationCard";let eL=e=>{let{updateRow:t,refetch:n,successMessage:r="Row updated successfully",errorMessage:a="Failed to update row"}=e;return(0,c.useCallback)(async(e,s)=>{try{(await t(e,s)).success?(d.Am.success(r),n()):d.Am.error(a)}catch(e){console.error("Error updating row:",e),d.Am.error(a)}},[t,n,r,a])},eP=e=>{let{projectRef:t,tableName:n,primaryKeyColumn:r="id"}=e,[a,s]=(0,c.useState)(!1),{mutate:i}=B();return{updateRow:async(e,a)=>{s(!0);try{let s=Object.entries(a).map(e=>{let[t,n]=e;return"string"==typeof n?'"'.concat(t,"\" = '").concat(n.replace(/'/g,"''"),"'"):"number"==typeof n||"boolean"==typeof n?'"'.concat(t,'" = ').concat(n):null===n?'"'.concat(t,'" = NULL'):'"'.concat(t,"\" = '").concat(JSON.stringify(n).replace(/'/g,"''"),"'")}).join(", "),l="UPDATE ".concat(n," SET ").concat(s," WHERE ").concat(r," = '").concat(e,"' RETURNING *");return await i({projectRef:t,query:l,readOnly:!1}),{success:!0}}catch(e){return console.error("Failed to update row:",e),{success:!1,error:e}}finally{s(!1)}},isUpdating:a}};var ez=n(94446),eZ=n(62196),eU=n(76332),eF=n(58915),eq=n(84183);function eV(e){let{onRowClick:t,data:n,isLoading:r,queryKey:a,renderCell:i,pageSize:l=10,renderHeader:o,renderRow:d,additionalHeaderColumns:u=[],currentPage:m=0,totalCount:p,onPageChange:g,onPageSizeChange:f,sortColumn:h,sortDirection:x,onSortChange:v}=e,b=(0,c.useMemo)(()=>Object.keys(n[0]||{}),[n]),[j,w]=(0,c.useState)(new Set(b)),[S,N]=(0,c.useState)(String((null!=m?m:0)+1)),E=(0,c.useRef)(null),C=(0,c.useRef)(null);(0,c.useEffect)(()=>{N(String((null!=m?m:0)+1))},[m]),(0,c.useEffect)(()=>{w(new Set(b))},[b]);let k=p||n.length,T=1===k?"Record":"Records",I=(0,c.useMemo)(()=>b.filter(e=>j.has(e)),[b,j]),A=!r&&n&&n.length>0;(0,c.useEffect)(()=>{let e=()=>{let e=E.current,t=null==e?void 0:e.parentElement;t&&(t.style.overflow="visible",t.style.maxHeight="",t.style.position="static")};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[E,A]);let R=Math.ceil(k/l),O=m*l,D=()=>{let e=Math.max(1,R),t=parseInt(S||"",10);if(isNaN(t)){N(String(m+1));return}let n=Math.min(e,Math.max(1,t));N(String(n));let r=n-1;r!==m&&(null==g||g(r))},M=e=>{let t=e?JSON.stringify(e).replace(/^"|"$/g,""):"";return(0,s.jsx)("div",{className:"font-mono text-xs whitespace-nowrap",children:t})},L=e=>{if(!v)return;let t="asc";h===e&&("asc"===x?t="desc":"desc"===x&&(t=null)),v(e,t)},P="sticky top-0 z-20 bg-muted",z="min-w-[160px]",Z=(e,t)=>{if(c.isValidElement(e)){var n;return(0,s.jsx)(c.Fragment,{children:c.cloneElement(e,{className:(0,eN.cn)(P,z,null===(n=e.props)||void 0===n?void 0:n.className)})},"additional-".concat(t))}return(0,s.jsx)(c.Fragment,{children:e},"additional-".concat(t))},U=e=>c.Children.map(e,e=>{var t,n;if(!c.isValidElement(e))return e;let r=(null===(t=e.props)||void 0===t?void 0:t.children)?U(e.props.children):null;return c.cloneElement(e,{className:(0,eN.cn)(P,z,null===(n=e.props)||void 0===n?void 0:n.className),children:r})});return(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(eG,{columns:b,selectedColumnSet:j,setSelectedColumnSet:w})}),(0,s.jsx)("div",{})]}),!A&&(0,s.jsx)("div",{className:"flex min-h-[200px] w-full flex-col items-center justify-center gap-4",children:(0,s.jsx)("p",{className:"text-center text-sm text-muted-foreground",children:r?(0,s.jsxs)("span",{children:[(0,s.jsx)(eZ.$,{size:"small"})," Loading..."]}):(0,s.jsx)("span",{children:"No results found."})})}),A&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"relative max-h-[60vh] overflow-x-auto overflow-y-auto",children:(0,s.jsxs)(ez.iA,{ref:E,className:"border w-max min-w-full border-separate border-spacing-0",children:[(0,s.jsx)(ez.xD,{className:"sticky top-0 z-20 bg-muted border-b",children:(0,s.jsx)(ez.SC,{children:o?(0,s.jsxs)(s.Fragment,{children:[u.map((e,t)=>Z(e,t)),U(o(I))]}):(0,s.jsxs)(s.Fragment,{children:[u.map((e,t)=>Z(e,t)),I.map(e=>{let t=h===e&&x?(0,s.jsx)(y.Z,{name:"asc"===x?"arrow_upward":"arrow_downward",size:"small",className:"ml-1"}):(0,s.jsx)(y.Z,{name:"unfold_more",size:"small",className:"ml-1 text-muted-foreground/50"});return(0,s.jsx)(ez.ss,{className:(0,eN.cn)("border border-x bg-muted text-primary cursor-pointer hover:bg-muted/80",P,z),onClick:()=>L(e),children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"inline-block whitespace-nowrap",children:e}),t]})},e)})]})})}),(0,s.jsx)(ez.RM,{children:n.map((e,n)=>{var r;return(0,s.jsx)(ez.SC,{onClick:()=>null==t?void 0:t(e,a),className:(0,eN.cn)(t&&"group cursor-pointer hover:bg-muted/50"),children:d?d(e,O+n,I):(0,s.jsx)(s.Fragment,{children:I.map(t=>{let r=e[t];return(0,s.jsx)(ez.pj,{className:(0,eN.cn)("border border-x text-xs text-muted-foreground group-hover:text-foreground whitespace-nowrap",z),children:i?i(r,O+n,t,e.id||(O+n).toString()):M(r)},"".concat(n,"-").concat(t))})})},null!==(r=e.id)&&void 0!==r?r:O+n)})})]})}),R>0&&(0,s.jsxs)("div",{ref:C,className:"flex items-center justify-start gap-4 py-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(_.z,{variant:"outline",size:"sm",onClick:()=>null==g?void 0:g(Math.max(0,m-1)),disabled:0===m,children:(0,s.jsx)(y.Z,{name:"chevron_left",size:"small"})}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Page"}),(0,s.jsx)(ew.I,{className:"h-8 w-14 px-2 text-center",value:S,inputMode:"numeric",onChange:e=>{N(e.target.value.replace(/[^0-9]/g,""))},onBlur:D,onKeyDown:e=>{"Enter"===e.key&&D()}}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:["of ",R]}),(0,s.jsx)(_.z,{variant:"outline",size:"sm",onClick:()=>null==g?void 0:g(Math.min(R-1,m+1)),disabled:m===R-1,children:(0,s.jsx)(y.Z,{name:"chevron_right",size:"small"})})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(eS.Ph,{value:String(l),onValueChange:e=>{let t=Number(e);null==f||f(t)},children:[(0,s.jsx)(eS.i4,{className:"h-8 w-[110px]",children:(0,s.jsx)(eS.ki,{placeholder:"".concat(l," rows")})}),(0,s.jsx)(eS.Bw,{side:"top",children:[10,25,50,100].map(e=>(0,s.jsxs)(eS.Ql,{value:"".concat(e),children:[e," rows"]},e))})]})}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[k," ",T.toLowerCase()]})]})]})]})}let eG=e=>{let{columns:t,selectedColumnSet:n,setSelectedColumnSet:r}=e,a=t.length-n.size,i=a>0,l=1===n.size;return(0,s.jsxs)(eF.J2,{children:[(0,s.jsxs)(eq.u,{children:[(0,s.jsx)(eq.aJ,{asChild:!0,children:(0,s.jsx)(eF.xo,{asChild:!0,children:(0,s.jsxs)(_.z,{variant:i?"default":"outline",size:"sm",children:[(0,s.jsx)(y.Z,{name:"view_column",size:"small"}),(0,s.jsx)("span",{children:"Columns"}),a>0&&(0,s.jsxs)("span",{className:"text-xs",children:["(",a," hidden)"]})]})})}),(0,s.jsx)(eq._v,{children:"Show or hide specific columns"})]}),(0,s.jsx)(eF.yk,{align:"start",className:"flex max-h-[300px] w-48 flex-col gap-1 overflow-y-auto p-2 scrollbar-thin scrollbar-track-muted-foreground/10 scrollbar-thumb-muted-foreground/20",onWheel:e=>{e.stopPropagation()},onTouchMove:e=>{e.stopPropagation()},children:t.map(e=>{let t=n.has(e);return(0,s.jsxs)("div",{className:"flex w-full min-w-0 items-center justify-between gap-2",children:[(0,s.jsx)("div",{className:"min-w-0 truncate text-sm font-medium",children:e}),(0,s.jsx)(eU.b,{showTooltip:l&&t,tooltipContent:"You must keep at least one column selected",className:"flex items-center",children:(0,s.jsx)(k.r,{checked:n.has(e),onCheckedChange:t=>{let a=new Set(n);t?a.add(e):a.delete(e),r(a)},disabled:l&&t,size:"sm"})})]},e)})})]})};function eW(e){let{onRowClick:t,data:n,isLoading:r,queryKey:a,onRowUpdate:i,pageSize:l=10,currentPage:o=0,totalCount:d,onPageChange:u,onPageSizeChange:m,sortColumn:p,sortDirection:g,onSortChange:f}=e,[h,x]=(0,c.useState)(null),v=(e,t,n,r)=>{let a=(null==h?void 0:h.rowIndex)===t&&(null==h?void 0:h.columnId)===n,l=()=>{if(h&&i){let t=h.value;((null==e?void 0:e.toString())||"")!==((null==t?void 0:t.toString())||"")&&i(r,{[n]:t})}x(null)};if(a)return(0,s.jsx)(ew.I,{value:(null==h?void 0:h.value)||"",onChange:e=>x(t=>t?{...t,value:e.target.value}:null),onBlur:l,onKeyDown:e=>{"Enter"===e.key?l():"Escape"===e.key&&x(null)},autoFocus:!0,className:"h-6 w-full text-xs"});let o=e?JSON.stringify(e).replace(/^"|"$/g,""):"";return(0,s.jsx)("div",{className:"w-fit max-w-96 cursor-pointer truncate rounded p-1 font-mono text-xs hover:bg-muted/50",onDoubleClick:()=>{x({rowIndex:t,columnId:n,value:e})},children:o})},b=[(0,s.jsx)(ez.ss,{className:"w-12 border border-x bg-muted text-primary",children:(0,s.jsx)("span",{className:"text-xs",children:"Edit"})},"edit-header")];return(0,s.jsx)(eV,{data:n,isLoading:r,queryKey:a,renderCell:v,pageSize:l,additionalHeaderColumns:b,renderRow:(e,n,r)=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ez.pj,{className:"w-12 border border-x",children:(0,s.jsx)(_.z,{variant:"ghost",size:"icon-sm",onClick:n=>{n.stopPropagation(),null==t||t(e,a)},className:"h-6 w-6",children:(0,s.jsx)(y.Z,{name:"edit",size:"small"})})}),r.map(t=>{let r=e[t];return(0,s.jsx)(ez.pj,{className:"min-w-0 border border-x text-xs text-muted-foreground group-hover:text-foreground",children:v(r,n,t,e.id||n.toString())},"".concat(n,"-").concat(t))})]}),currentPage:o,totalCount:d,onPageChange:u,onPageSizeChange:m,sortColumn:p,sortDirection:g,onSortChange:f})}let eH=e=>e&&e.primary_keys?e.primary_keys.map(e=>e.name):[];function eB(e){let{projectRef:t,table:n,row:r,onSuccess:a}=e,{mutate:i,isPending:l}=B(),o=(0,c.useMemo)(()=>(function(e){if(!e||!e.columns)return ec.Ry({});let t={};for(let n of e.columns){let e;if(!n.is_updatable||n.is_generated)continue;let r=n.data_type.toLowerCase();e=r.includes("array")?ec.IX(ec.Yj()):r.includes("int")||r.includes("numeric")?ec.Rx():r.includes("bool")?ec.O7():"user-defined"===r&&n.enums&&Array.isArray(n.enums)&&n.enums.length>0?ec.Km(n.enums):ec.Z_(),n.is_nullable&&(e=e.nullish()),t[n.name]=e}return ec.Ry(t)})(n),[n]),u=(0,c.useMemo)(()=>{if(!n||!n.columns)return{};let e={};for(let t of n.columns){if(!t.is_updatable||t.is_generated)continue;let n=t.data_type.toLowerCase(),r="user-defined"===n&&t.enums&&Array.isArray(t.enums)&&t.enums.length>0?"enum":n;e[t.name]={data_type:r,is_nullable:t.is_nullable}}return e},[n]),{pop:m}=S(),p=(0,c.useCallback)(e=>{let s=eH(n);if(0===s.length){d.Am.error("Cannot update row. This table does not have a primary key.");return}let l=Object.entries(e).map(e=>{var t;let a,[s,i]=e;if(JSON.stringify(r[s])===JSON.stringify(i))return null;let l=n.columns.find(e=>e.name===s),o=(null==l?void 0:null===(t=l.data_type)||void 0===t?void 0:t.toLowerCase())||"",c=(null==l?void 0:l.is_nullable)||!1;if(null==i||"string"==typeof i&&""===i.trim()){if(c)a="NULL";else if(o.includes("array")){let e=JSON.stringify({[s]:[]});a="(select ".concat(s,' from json_populate_record(null::public."').concat(n.name,"\", '").concat(e.replace(/'/g,"''"),"'))")}else a="''"}else if(Array.isArray(i)&&0===i.length){let e=JSON.stringify({[s]:[]});a="(select ".concat(s,' from json_populate_record(null::public."').concat(n.name,"\", '").concat(e.replace(/'/g,"''"),"'))")}else if(o.includes("array")){let e=JSON.stringify({[s]:i});a="(select ".concat(s,' from json_populate_record(null::public."').concat(n.name,"\", '").concat(e.replace(/'/g,"''"),"'))")}else a="user-defined"===o&&(null==l?void 0:l.enums)?"'".concat(String(i).replace(/'/g,"''"),"'"):"string"==typeof i?"'".concat(i.replace(/'/g,"''"),"'"):i;return'"'.concat(s,'" = ').concat(a)}).filter(Boolean).join(", ");if(!l){d.Am.error("No changes to save"),a();return}let o=s.map(e=>{let t=r[e],n="string"==typeof t?"'".concat(t.replace(/'/g,"''"),"'"):t;return'"'.concat(e,'" = ').concat(n)}).join(" AND ");i({projectRef:t,query:'UPDATE public."'.concat(n.name,'" SET ').concat(l," WHERE ").concat(o,";"),readOnly:!1},{onSuccess:a})},[t,n,r,i,a]);return(0,s.jsxs)("div",{className:"flex flex-col gap-6 pb-12",children:[(0,s.jsx)(eT,{title:"Editing row in ".concat(n.name)}),(0,s.jsx)(eC,{schema:o,initialValues:r,onSubmit:p,isLoading:l,columnInfo:u,onCancel:m})]})}function eJ(e){let{projectRef:t,table:n}=e,{push:r,pop:a}=S(),{data:i,isLoading:l,pagination:o,sort:d,setPage:u,setPageSize:m,setSort:p,refetch:g}=eM({projectRef:t,tableName:n.name,initialPageSize:10}),{updateRow:f,isUpdating:h}=eP({projectRef:t,tableName:n.name}),x=(0,c.useCallback)(e=>{r({title:"Editing row",component:(0,s.jsx)(eB,{projectRef:t,table:n,row:e,onSuccess:()=>{a(),g()}})})},[r,a,t,n,g]),v=eL({updateRow:f,refetch:g,successMessage:"Row updated successfully",errorMessage:"Failed to update row"});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eT,{title:"View records in ".concat(n.name),description:"Double click a value to edit in-line or click the edit icon to edit a full row."}),(0,s.jsx)(eW,{data:i||[],isLoading:l||h,queryKey:"".concat(n.id),onRowClick:x,onRowUpdate:v,currentPage:o.page,totalCount:o.totalCount,pageSize:o.pageSize,onPageChange:u,onPageSizeChange:m,sortColumn:d.column,sortDirection:d.direction,onSortChange:(e,t)=>p({column:e,direction:t})})]})}function eK(e){let{projectRef:t}=e,{push:n}=S(),{data:r,isLoading:a,isError:i}=K(t,["public"]),l=(0,c.useCallback)(e=>{n({title:e.name,component:(0,s.jsx)(eJ,{projectRef:t,table:e})})},[n,t]);return(0,s.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,s.jsx)(eT,{title:"Database",description:"View and manage the data stored in your app."}),i&&(0,s.jsxs)(E.bZ,{variant:"destructive",className:"mt-8",children:[(0,s.jsx)(y.Z,{name:"warning",size:"small"}),(0,s.jsx)(E.Cd,{children:"Error loading tables"}),(0,s.jsx)(E.X,{children:"There was a problem loading your database tables."})]}),a&&(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 xl:grid-cols-2",children:[(0,s.jsx)(C.O,{className:"h-16 w-full rounded-2xl"}),(0,s.jsx)(C.O,{className:"h-16 w-full rounded-2xl"}),(0,s.jsx)(C.O,{className:"h-16 w-full rounded-2xl"})]}),r&&r.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 gap-2 lg:grid-cols-2",children:r.map(e=>(0,s.jsx)(eD,{onClick:()=>l(e),icon:"table",title:e.name,description:"".concat(e.live_rows_estimate," rows")},e.id))}):a||r&&0!==r.length?null:(0,s.jsxs)(E.bZ,{className:"mt-8",children:[(0,s.jsx)(y.Z,{name:"table",size:"small"}),(0,s.jsx)(E.Cd,{children:"No database tables"}),(0,s.jsx)(E.X,{children:"Create tables to store and organize your data."})]})]})}var eY=n(94671);let eX=()=>{let e=(0,x.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.id});return(0,c.useMemo)(()=>{if(!e)return null;let t=t=>"/projects/".concat(e,"/backend").concat(t.startsWith("/")?t:"/".concat(t)),n=(0,eY.SJ)();return{get:async(e,r)=>n.get(t(e),r),post:async(e,r,a)=>n.post(t(e),r,a),put:async(e,r,a)=>n.put(t(e),r,a),patch:async(e,r,a)=>n.patch(t(e),r,a),delete:async(e,r)=>n.delete(t(e),r)}},[e])},eQ=async e=>{let{start:t,end:n,query:r,apiClient:a}=e;return await a.get("logs",{params:{start:t,end:n,query:r}})},e$=e=>{let t=eX(),n=["logs",e.query,e.start,e.end];return(0,l.a)({queryKey:n,queryFn:async()=>eQ({...e,apiClient:t}),enabled:!!t,retry:!1})};(r=a||(a={})).FN_EDGE="function_edge_logs",r.AUTH="auth_logs",r.POSTGRES="postgres_logs",r.REALTIME="realtime_logs",r.STORAGE="storage_logs",r.PG_CRON="pg_cron_logs",r.EDGE="edge_logs",r.FUNCTIONS="function_logs",r.POSTGREST="postgrest_logs",r.SUPAVISOR="supavisor_logs",r.PGBOUNCER="pgbouncer_logs",r.PG_UPGRADE="pg_upgrade_logs";let e0=e=>e.replace(/[^a-zA-Z0-9\s\-_.,!?@#$%&*()+=:;'"`~+?.|()[]{}\^$\\]/g,"").replace(/'/g,"''").trim(),e1=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2?arguments[2]:void 0,r="order by timestamp desc",a=n?e0(n):"",s=a?"where (regexp_contains(event_message, '".concat(a,"'))"):"";switch(e){case"edge_logs":return"select id, ".concat(e,".timestamp, event_message, request.method, request.path, request.search, response.status_code as log_level\nfrom ").concat(e,"\ncross join unnest(metadata) as m\ncross join unnest(m.request) as request\ncross join unnest(m.response) as response\n").concat(s,"\n").concat(r,"\nlimit ").concat(t);case"postgres_logs":return"select ".concat(e,".timestamp, id, event_message, parsed.error_severity as log_level\nfrom ").concat(e,"\ncross join unnest(metadata) as m\ncross join unnest(m.parsed) as parsed\n").concat(s,"\n").concat(r,"\nlimit ").concat(t);case"function_logs":return"select id, ".concat(e,".timestamp, event_message, metadata.event_type, metadata.function_id, metadata.level as log_level\nfrom ").concat(e,"\ncross join unnest(metadata) as metadata\n").concat(s,"\n").concat(r,"\nlimit ").concat(t);case"auth_logs":return"select id, ".concat(e,".timestamp, event_message, metadata.level as log_level, metadata.status, metadata.path, metadata.msg as msg, metadata.error\nfrom ").concat(e,"\ncross join unnest(metadata) as metadata\n").concat(s,"\n").concat(r,"\nlimit ").concat(t);case"function_edge_logs":return"select id, ".concat(e,".timestamp, event_message, response.status_code, request.method, m.function_id, m.execution_time_ms, m.deployment_id, m.version, 'info' as log_level\nfrom ").concat(e,"\ncross join unnest(metadata) as m\ncross join unnest(m.response) as response\ncross join unnest(m.request) as request\n").concat(s,"\n").concat(r,"\nlimit ").concat(t);case"supavisor_logs":return"select id, ".concat(e,".timestamp, event_message, 'info' as log_level\nfrom ").concat(e,"\ncross join unnest(metadata) as m\n").concat(s,"\n").concat(r,"\nlimit ").concat(t);case"pg_upgrade_logs":default:return"select id, ".concat(e,".timestamp, event_message, 'info' as log_level\nfrom ").concat(e,"\n").concat(s,"\n").concat(r,"\nlimit ").concat(t);case"pg_cron_logs":let i=a?" AND (regexp_contains(event_message, '".concat(a,"'))"):"",l="where ".concat("(parsed.application_name = 'pg_cron' OR event_message LIKE '%cron job%')").concat(i);return"select postgres_logs.timestamp, id, event_message, parsed.error_severity as log_level, parsed.query\nfrom postgres_logs\ncross join unnest(metadata) as m\ncross join unnest(m.parsed) as parsed\n".concat(l,"\n").concat(r,"\nlimit ").concat(t)}};function e2(e){let{onRefresh:t}=e;return(0,s.jsxs)(eq.u,{children:[(0,s.jsx)(eq.aJ,{asChild:!0,children:(0,s.jsx)(_.z,{variant:"outline",onClick:t,className:"h-8 w-8 p-0",children:(0,s.jsx)(y.Z,{name:"autorenew",size:"small"})})}),(0,s.jsx)(eq._v,{children:"Refresh logs"})]})}function e4(e){let{searchQuery:t,onSearchChange:n}=e,[r,a]=(0,c.useState)(t),i=(0,c.useRef)(null);(0,c.useEffect)(()=>{a(t)},[t]);let l=()=>{var e;n(r),null===(e=i.current)||void 0===e||e.blur()},o=r!==t,d=""!==r;return(0,s.jsxs)("div",{className:"relative w-64 min-w-0",children:[(0,s.jsx)(y.Z,{name:"search",size:"small",className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"}),(0,s.jsx)(ew.I,{ref:i,placeholder:"Search events",value:r,onChange:e=>{a(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&l()},className:"h-8 pl-8 pr-16"}),(0,s.jsxs)("div",{className:"absolute right-2 top-1/2 flex -translate-y-1/2 items-center gap-1",children:[o&&(0,s.jsx)(_.z,{variant:"ghost",size:"sm",onClick:l,className:"h-6 w-6 p-0 hover:bg-muted",title:"Search for events",children:(0,s.jsx)(y.Z,{name:"subdirectory_arrow_left",size:"small"})}),d&&(0,s.jsx)(_.z,{variant:"ghost",size:"sm",onClick:()=>{var e;a(""),n(""),null===(e=i.current)||void 0===e||e.focus()},className:"h-6 w-6 p-0 hover:bg-muted",title:"Clear search",children:(0,s.jsx)(y.Z,{name:"close",size:"small"})})]})]})}var e5=n(26052),e6=n(53259),e8=n(55302);let e7=e=>{switch(e.toLowerCase()){case"error":case"fatal":return"bg-red-100 text-red-800 border-red-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"info":case"log":return"bg-blue-100 text-blue-800 border-blue-200";case"debug":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},e3=(e,t)=>{let n=new Date(e/1e3);return new Intl.DateTimeFormat(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:null==t?void 0:t.timezone,fractionalSecondDigits:3,timeZoneName:(null==t?void 0:t.showTimezone)!==!1?"short":void 0}).format(n)},e9=e=>{let{logs:t}=e,[n,r]=(0,c.useState)("Copy"),a=(0,c.useRef)(null),[i,l]=(0,c.useState)(new Set),[o,d]=(0,c.useState)(new Set);(0,c.useEffect)(()=>()=>{a.current&&clearTimeout(a.current)},[]);let u=(0,c.useMemo)(()=>{if(!t)return[];let e=new Set;return t.forEach(t=>{t.log_level&&e.add(t.log_level.toLowerCase())}),Array.from(e).sort()},[t]);(0,c.useEffect)(()=>{d(new Set),l(new Set)},[t]);let m=(0,c.useMemo)(()=>t?0===o.size?t:t.filter(e=>e.log_level&&o.has(e.log_level.toLowerCase())):[],[t,o]),p=e=>{let t=new Set(o);t.has(e)?t.delete(e):t.add(e),d(t)};if(!t||0===t.length)return null;let g=m.length>0,f=1===m.length?"log":"logs",h=async()=>{if(!m)return;let e=m.map(e=>JSON.stringify(e)).join("\n");await navigator.clipboard.writeText(e),r("Copied!"),a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{r("Copy")},2e3)};return(0,s.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,s.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,s.jsxs)(eq.u,{children:[(0,s.jsx)(eq.aJ,{asChild:!0,children:(0,s.jsxs)(_.z,{variant:"outline",size:"sm",onClick:h,disabled:!g,children:[(0,s.jsx)(y.Z,{name:"content_copy",size:"small"}),n]})}),(0,s.jsx)(eq._v,{children:"Copy logs to clipboard"})]}),(0,s.jsxs)(eq.u,{children:[(0,s.jsx)(eq.aJ,{asChild:!0,children:(0,s.jsxs)(_.z,{variant:"outline",size:"sm",disabled:!g,onClick:()=>{if(!m)return;let e=new Blob([JSON.stringify(m,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="logs.json",document.body.appendChild(n),n.click(),document.body.removeChild(n),setTimeout(()=>URL.revokeObjectURL(t),100)},children:[(0,s.jsx)(y.Z,{name:"download",size:"small"}),"Download"]})}),(0,s.jsx)(eq._v,{children:"Download logs as a JSON file"})]}),(0,s.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[m.length," ",f," found"]}),(0,s.jsxs)(e6.h_,{children:[(0,s.jsx)(e6.$F,{asChild:!0,children:(0,s.jsx)(_.z,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:(0,s.jsx)(y.Z,{name:"tune",size:"small"})})}),(0,s.jsxs)(e6.AW,{align:"end",className:"w-48",children:[(0,s.jsx)("div",{className:"px-2 py-1.5 text-xs font-medium text-muted-foreground",children:"Level:"}),u.map(e=>(0,s.jsxs)(e6.Xi,{onClick:()=>p(e),className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(e5.C,{variant:"outline",className:"".concat(e7(e)),children:e.toUpperCase()})}),o.has(e)&&(0,s.jsx)(y.Z,{name:"check",size:"small"})]},e)),o.size>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e6.VD,{}),(0,s.jsxs)(e6.Xi,{onClick:()=>{d(new Set)},children:[(0,s.jsx)(y.Z,{name:"close",size:"small"}),"Clear all"]})]})]})]})]})]}),(0,s.jsx)("div",{className:"overflow-hidden rounded-lg border",children:(0,s.jsx)("div",{className:"divide-y",children:m.map((e,t)=>{let n=e.timestamp,r=e3(n),a=i.has(t),o=e.log_level||"N/A",c=e7(o),d=()=>{let e=new Set(i);a?e.delete(t):e.add(t),l(e)};return(0,s.jsxs)("div",{className:"group",children:[(0,s.jsx)("div",{className:"cursor-pointer px-3 py-2 transition-colors hover:bg-muted/50",onClick:d,children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(_.z,{variant:"ghost",size:"sm",className:"mt-0.5 h-4 w-4 flex-shrink-0 p-0",onClick:e=>{e.stopPropagation(),d()},children:(0,s.jsx)(y.Z,{name:a?"chevron_down":"chevron_right",size:"small",className:"transition-transform"})}),(0,s.jsx)("div",{className:"min-w-0 flex-1",children:(0,s.jsxs)("div",{className:"flex min-w-0 items-center gap-2",children:[(0,s.jsxs)(e8.zs,{children:[(0,s.jsx)(e8.Yi,{asChild:!0,children:(0,s.jsx)("span",{className:"cursor-pointer font-mono text-xs text-muted-foreground",children:r})}),(0,s.jsx)(e8.bZ,{className:"max-h-96 w-96 overflow-auto p-3",children:(0,s.jsxs)("div",{className:"space-y-1 font-mono text-xs",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Local:"}),(0,s.jsx)("span",{children:e3(n,{showTimezone:!1})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"UTC:"}),(0,s.jsx)("span",{children:e3(n,{timezone:"UTC",showTimezone:!1})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Unix:"}),(0,s.jsx)("span",{children:n})]})]})})]}),(0,s.jsx)(e5.C,{variant:"outline",className:"font-mono text-xs ".concat(c),children:o.toUpperCase()}),(0,s.jsxs)(e8.zs,{children:[(0,s.jsx)(e8.Yi,{asChild:!0,children:(0,s.jsx)("div",{className:"min-w-0 flex-1 truncate font-mono text-xs text-muted-foreground group-hover:text-foreground",children:e.event_message})}),(0,s.jsx)(e8.bZ,{className:"max-h-96 w-96 overflow-auto p-3",children:(0,s.jsx)("pre",{className:"whitespace-pre-wrap break-words font-mono text-xs",children:e.event_message})})]})]})})]})}),a&&(0,s.jsxs)("div",{className:"border-t bg-muted/50 px-4 py-3",children:[(0,s.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Raw Log Data"}),(0,s.jsxs)(_.z,{variant:"outline",size:"sm",onClick:t=>{t.stopPropagation(),navigator.clipboard.writeText(JSON.stringify(e.details,null,2))},children:[(0,s.jsx)(y.Z,{name:"content_copy",size:"small"}),"Copy JSON"]})]}),(0,s.jsx)("pre",{className:"max-h-96 overflow-auto whitespace-pre-wrap break-words rounded border bg-background p-3 font-mono text-xs",children:(()=>{try{let t=JSON.parse(e.details.event_message),n={...e.details,event_message:t};return JSON.stringify(n,null,2)}catch(t){return JSON.stringify(e.details,null,2)}})()})]})]},e.id||t)})})})]})};var te=n(25393),tt=n(30335),tn=n(85365),tr=n(18587);let ta=[{value:"15m",label:"Last 15 minutes"},{value:"30m",label:"Last 30 minutes"},{value:"1h",label:"Last hour"},{value:"3h",label:"Last 3 hours"},{value:"24h",label:"Last 24 hours"},{value:"2d",label:"Last 2 days"}];function ts(e){let{selectedRange:t,onRangeChange:n}=e,[r,a]=(0,c.useState)(!1),[i,l]=(0,c.useState)(t.type),o=e=>{n({type:"relative",value:e}),a(!1)},d=e=>{l(e)};return(0,s.jsxs)(eF.J2,{open:r,onOpenChange:e=>{a(e),e||l(t.type)},children:[(0,s.jsx)(eF.xo,{asChild:!0,children:(0,s.jsxs)(_.z,{variant:"outline",role:"combobox","aria-expanded":r,className:"w-auto",children:[(0,s.jsx)(y.Z,{name:"schedule",size:"small",className:"mr-1"}),(e=>{if("relative"===e.type){let t=ta.find(t=>t.value===e.value);return t?t.label:"Last hour"}return e.startDate&&e.endDate?"".concat((0,tr.WU)(e.startDate,"MMM dd, yyyy HH:mm:ss")," - ").concat((0,tr.WU)(e.endDate,"MMM dd, yyyy HH:mm:ss")):"Custom time range"})(t),(0,s.jsx)(y.Z,{name:"chevron_down",size:"small",className:"text-muted-foreground"})]})}),(0,s.jsx)(eF.yk,{className:"w-80 p-0",align:"end",children:(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"mb-4 flex",children:[(0,s.jsx)(_.z,{variant:"relative"===i?"default":"outline",size:"sm",onClick:()=>d("relative"),className:"flex-1 rounded-r-none border-r-0",children:"Relative"}),(0,s.jsx)(_.z,{variant:"absolute"===i?"default":"outline",size:"sm",onClick:()=>d("absolute"),className:"flex-1 rounded-l-none",children:"Absolute"})]}),"relative"===i&&(0,s.jsx)(te.mY,{children:(0,s.jsx)(te.e8,{children:(0,s.jsx)(te.fu,{children:ta.map(e=>(0,s.jsx)(te.di,{value:e.value,onSelect:()=>o(e.value),children:e.label},e.value))})})}),"absolute"===i&&(0,s.jsx)(ti,{startDate:t.startDate,endDate:t.endDate,onRangeChange:(e,t)=>{n({type:"absolute",value:"custom",startDate:e,endDate:t})},onClose:()=>a(!1),shouldPrefill:"relative"===t.type,prefillStartDate:"relative"===t.type?tl(t).start:void 0,prefillEndDate:"relative"===t.type?new Date:void 0})]})})]})}function ti(e){let{startDate:t,endDate:n,onRangeChange:r,onClose:a,shouldPrefill:i=!1,prefillStartDate:l,prefillEndDate:o}=e,[d,u]=(0,c.useState)(i?l:t),[m,p]=(0,c.useState)(i?o:n),[g,f]=(0,c.useState)(null);(0,c.useEffect)(()=>{d&&m&&d>=m?f("Start must be before end"):f(null)},[d,m]);let h=!d||!m||!!g;return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(tt.Label,{htmlFor:"start-datetime",children:"Start"}),(0,s.jsx)(ew.I,{id:"start-datetime",type:"datetime-local",value:d?(0,tr.WU)(d,"yyyy-MM-dd'T'HH:mm:ss"):"",max:m?(0,tr.WU)(m,"yyyy-MM-dd'T'HH:mm:ss"):(0,tr.WU)(new Date,"yyyy-MM-dd'T'HH:mm:ss"),step:1,className:g?"border-destructive focus:border-destructive":"",onChange:e=>{e.target.value?u(new Date(e.target.value)):u(void 0)}}),g&&(0,s.jsx)("p",{className:"text-sm text-destructive-foreground",children:g})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(tt.Label,{htmlFor:"end-datetime",children:"End"}),(0,s.jsx)(ew.I,{id:"end-datetime",type:"datetime-local",value:m?(0,tr.WU)(m,"yyyy-MM-dd'T'HH:mm:ss"):"",min:d?(0,tr.WU)(d,"yyyy-MM-dd'T'HH:mm:ss"):void 0,max:(0,tr.WU)(new Date,"yyyy-MM-dd'T'HH:mm:ss"),step:1,className:g?"border-destructive focus:border-destructive":"",onChange:e=>{e.target.value?p(new Date(e.target.value)):p(void 0)}})]})]}),(0,s.jsx)(tn.Separator,{}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)(_.z,{variant:"outline",onClick:a,children:"Cancel"}),(0,s.jsx)(_.z,{onClick:()=>{d&&m&&!g&&(r(d,m),a())},disabled:h,children:"Apply"})]})]})}function tl(e){let t;let n=new Date;if("absolute"===e.type&&e.startDate&&e.endDate)return{start:e.startDate,end:e.endDate};switch(e.value){case"15m":t=new Date(n.getTime()-9e5);break;case"30m":t=new Date(n.getTime()-18e5);break;case"1h":default:t=new Date(n.getTime()-36e5);break;case"3h":t=new Date(n.getTime()-108e5);break;case"24h":t=new Date(n.getTime()-864e5);break;case"2d":t=new Date(n.getTime()-1728e5);break;case"3d":t=new Date(n.getTime()-2592e5);break;case"5d":t=new Date(n.getTime()-432e6)}return{start:t,end:n}}let to=[{value:a.FN_EDGE,label:"Function Edge Logs",description:"Edge function execution logs with request/response data"},{value:a.AUTH,label:"Authentication Logs",description:"User authentication events and security logs"},{value:a.POSTGRES,label:"PostgreSQL Logs",description:"Database queries, errors, and performance metrics"},{value:a.REALTIME,label:"Realtime Logs",description:"WebSocket connections and realtime subscriptions"},{value:a.STORAGE,label:"Storage Logs",description:"File uploads, downloads, and storage operations"},{value:a.PG_CRON,label:"Cron Job Logs",description:"Scheduled job executions and cron task logs"},{value:a.EDGE,label:"Edge Logs",description:"HTTP requests and responses from Edge Functions"},{value:a.FUNCTIONS,label:"Function Logs",description:"Serverless function execution logs and events"},{value:a.POSTGREST,label:"PostgREST Logs",description:"API requests to your database through PostgREST"},{value:a.SUPAVISOR,label:"Supavisor Logs",description:"Connection pooling and database proxy logs"},{value:a.PGBOUNCER,label:"PgBouncer Logs",description:"Legacy connection pooling logs"},{value:a.PG_UPGRADE,label:"PostgreSQL Upgrade Logs",description:"Database upgrade processes and migration logs"}];function tc(e){let{activeTab:t,onTabChange:n}=e,[r,a]=(0,c.useState)(!1),i=to.find(e=>e.value===t);return(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)(eF.J2,{open:r,onOpenChange:a,children:[(0,s.jsx)(eF.xo,{asChild:!0,children:(0,s.jsxs)(_.z,{variant:"outline",role:"combobox","aria-expanded":r,className:"w-auto",children:[i?i.label:"Select log type...",(0,s.jsx)(y.Z,{name:"chevron_down",size:"small",className:"text-muted-foreground"})]})}),(0,s.jsx)(eF.yk,{className:"w-80 p-0",align:"end",children:(0,s.jsxs)(te.mY,{children:[(0,s.jsx)(te.sZ,{placeholder:"Search log types...",className:"h-9"}),(0,s.jsxs)(te.e8,{className:"max-h-60 overflow-y-auto",onWheel:e=>{e.stopPropagation()},style:{overscrollBehavior:"contain"},children:[(0,s.jsx)(te.rb,{children:"No log type found."}),(0,s.jsx)(te.fu,{children:to.map(e=>(0,s.jsxs)(te.di,{value:e.value,onSelect:e=>{n(e),a(!1)},className:"flex items-center gap-2 p-3",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"mb-1 text-xs font-medium leading-none",children:e.label}),(0,s.jsx)("div",{className:"text-xs leading-snug text-muted-foreground",children:e.description})]}),(0,s.jsx)(y.Z,{name:"check",size:"small",className:(0,eN.cn)("mt-0.5 opacity-0",{"opacity-100":t===e.value})})]},e.value))})]})]})})]})})}function td(){let[e,t]=(0,c.useState)(a.FN_EDGE),[n,r]=(0,c.useState)(""),[i,l]=(0,c.useState)({type:"relative",value:"1h"}),[o,d]=(0,c.useState)([]),[u,m]=(0,c.useState)(()=>tl(i)),[p,g]=(0,c.useState)(null),f=()=>tl(i);(0,c.useEffect)(()=>{m(f()),d([]),g(null)},[i,e,n]);let h=(0,c.useMemo)(()=>e1(e,100,n),[e,n]),{data:x,isLoading:v,error:b}=e$({start:u.start.toISOString(),end:u.end.toISOString(),query:h});return(0,c.useEffect)(()=>{(null==x?void 0:x.result)&&(0===o.length?(d(x.result),g(null)):(d(e=>[...e,...x.result]),x.result.length>0&&g(null)))},[null==x?void 0:x.result]),(0,s.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,s.jsx)(eT,{title:"Logs",description:"Debug errors and track activity in your app"}),(0,s.jsxs)("div",{className:"flex w-full flex-wrap items-center justify-between gap-y-3",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsx)(e4,{searchQuery:n,onSearchChange:r}),(0,s.jsx)(ts,{selectedRange:i,onRangeChange:l}),(0,s.jsx)(e2,{onRefresh:()=>{m(f()),d([])}})]}),(0,s.jsx)(tc,{activeTab:e,onTabChange:t})]}),b&&(0,s.jsxs)(E.bZ,{variant:"destructive",children:[(0,s.jsx)(y.Z,{name:"terminal",size:"small"}),(0,s.jsx)(E.Cd,{children:"Error fetching logs"}),(0,s.jsx)(E.X,{children:(null==b?void 0:b.message)||"An unexpected error occurred. Please try again."})]}),(0,s.jsx)(e9,{logs:o}),v&&(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(C.O,{className:"h-6 w-full"}),(0,s.jsx)(C.O,{className:"h-6 w-full"}),(0,s.jsx)(C.O,{className:"h-6 w-full"}),(0,s.jsx)(C.O,{className:"h-6 w-full"})]}),o.length>0&&(0,s.jsx)("div",{className:"flex justify-center pt-2",children:(0,s.jsxs)(_.z,{variant:"outline",size:"sm",onClick:()=>{if(0===o.length)return;let e=p||o[o.length-1].timestamp/1e3,t=e-1728e5;m({start:new Date(t),end:new Date(e)}),g(t)},children:[(0,s.jsx)(y.Z,{name:"add",size:"small",className:"mr-2"}),"Load more"]})}),0===o.length&&!v&&(0,s.jsxs)(E.bZ,{variant:"secondary",children:[(0,s.jsx)(y.Z,{name:"data_table",size:"small"}),(0,s.jsx)(E.Cd,{children:"No logs found"}),(0,s.jsx)(E.X,{children:"Logs will appear here when your application generates activity."})]})]})}function tu(e){let{projectRef:t}=e,{data:n,isLoading:r,error:a}=ea(t),{mutate:i,isPending:l}=ei(),{mutate:o,isPending:c}=eo(),d=(0,e_.cI)({resolver:(0,eb.F)(ev),defaultValues:{secrets:[{name:"",value:""}]}}),{fields:u,append:m,remove:p}=(0,e_.Dq)({control:d.control,name:"secrets"}),g=e=>{window.confirm('Are you sure you want to delete the secret "'.concat(e,'"?'))&&o({projectRef:t,secretNames:[e]})};return r?(0,s.jsxs)("div",{className:"flex w-full flex-col gap-6",children:[(0,s.jsx)(C.O,{className:"h-16 w-full"}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(C.O,{className:"h-12 flex-1"}),(0,s.jsx)(C.O,{className:"h-12 flex-1"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(C.O,{className:"h-12 flex-1"}),(0,s.jsx)(C.O,{className:"h-12 flex-1"})]})]}):a?(0,s.jsxs)(E.bZ,{variant:"destructive",children:[(0,s.jsx)(y.Z,{name:"warning",className:"h-4 w-4"}),(0,s.jsx)(E.Cd,{children:"Error loading secrets"}),(0,s.jsx)(E.X,{children:"There was a problem loading your secrets configuration."})]}):(0,s.jsxs)("div",{className:"flex w-full flex-col gap-6",children:[(0,s.jsx)(eT,{title:"Add New Secret",description:"Add sensitive information like API keys that your app needs to work securely."}),(0,s.jsx)(ej.l0,{...d,children:(0,s.jsxs)("form",{onSubmit:d.handleSubmit(e=>{i({projectRef:t,secrets:e.secrets},{onSuccess:()=>{d.reset({secrets:[{name:"",value:""}]})}})}),className:"flex flex-col gap-4",children:[u.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(ej.Wi,{control:d.control,name:"secrets.".concat(t,".name"),render:e=>{let{field:n}=e;return(0,s.jsxs)(ej.xJ,{className:(0,eN.cn)("relative flex-1"),children:[0===t&&(0,s.jsx)(ej.lX,{className:"mb-4",children:"Name"}),(0,s.jsx)(ej.NI,{children:(0,s.jsx)(ew.I,{placeholder:"SECRET_NAME",...n})}),(0,s.jsx)(ej.zG,{})]})}}),(0,s.jsx)(ej.Wi,{control:d.control,name:"secrets.".concat(t,".value"),render:e=>{let{field:n}=e;return(0,s.jsxs)(ej.xJ,{className:(0,eN.cn)("relative flex-1"),children:[0===t&&(0,s.jsx)(ej.lX,{className:"mb-4",children:"Value"}),(0,s.jsx)(ej.NI,{children:(0,s.jsx)(ew.I,{type:"password",placeholder:"",...n})}),(0,s.jsx)(ej.zG,{})]})}}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[0===t&&(0,s.jsx)(ej.lX,{className:"mb-4 opacity-0",children:"Remove"}),(0,s.jsx)(_.z,{type:"button",variant:"outline",className:(0,eN.cn)("mt-[2px] h-9"),onClick:()=>{1===u.length?(d.setValue("secrets.0.name",""),d.setValue("secrets.0.value","")):p(t)},children:(0,s.jsx)(y.Z,{name:"remove",className:"h-4 w-4"})})]})]},e.id)),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)(_.z,{type:"button",variant:"outline",size:"sm",onClick:()=>m({name:"",value:""}),children:[(0,s.jsx)(y.Z,{name:"add",className:"mr-1 h-4 w-4"}),"Add Secret"]})}),(()=>{let e=d.watch("secrets");return(null==e?void 0:e.some(e=>{var t,n;return(null===(t=e.name)||void 0===t?void 0:t.trim())&&(null===(n=e.value)||void 0===n?void 0:n.trim())}))?(0,s.jsx)(ey.j,{className:"justify-end gap-2",children:(0,s.jsx)(_.z,{type:"submit",loading:l,variant:"affirmative",children:l?"Creating...":"Create Secrets"})}):null})()]})}),(0,s.jsx)(eT,{title:"Existing secrets",description:"Secrets that are already available to your app."}),n&&n.length>0?n.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between border-b last:border-b-0",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-mono text-sm tracking-wider",children:e.name}),e.updated_at&&(0,s.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:["Last updated: ",new Date(e.updated_at).toLocaleString()]})]}),(0,s.jsx)(_.z,{variant:"outline",size:"sm",onClick:()=>g(e.name),disabled:c,children:"Delete"})]},e.name)):(0,s.jsxs)(E.bZ,{variant:"secondary",children:[(0,s.jsx)(y.Z,{name:"key",className:"h-4 w-4"}),(0,s.jsx)(E.Cd,{children:"No secrets found"}),(0,s.jsx)(E.X,{children:"No secrets found for this project."})]})]})}function tm(e){let{projectRef:t}=e,{data:n,isLoading:r,isError:a}=X(t);return(0,s.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,s.jsx)(eT,{title:"Storage",description:"View and manage the files stored in your app."}),a&&(0,s.jsxs)(E.bZ,{variant:"destructive",children:[(0,s.jsx)(y.Z,{name:"warning",className:"h-4 w-4"}),(0,s.jsx)(E.Cd,{children:"Error loading buckets"}),(0,s.jsx)(E.X,{children:"There was a problem loading your storage buckets."})]}),r&&(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 xl:grid-cols-2",children:[(0,s.jsx)(C.O,{className:"h-16 w-full rounded-2xl"}),(0,s.jsx)(C.O,{className:"h-16 w-full rounded-2xl"}),(0,s.jsx)(C.O,{className:"h-16 w-full rounded-2xl"})]}),n&&n.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:n.map(e=>(0,s.jsxs)(eq.u,{children:[(0,s.jsx)(eq.aJ,{asChild:!0,children:(0,s.jsx)(eD,{onClick:()=>{},icon:"folder",title:e.name,description:"Updated ".concat(new Date(e.updated_at).toLocaleDateString()),badge:(0,s.jsx)(e5.C,{variant:"secondary",children:e.public?"Public":"Private"})})}),(0,s.jsx)(eq._v,{children:(0,s.jsx)("p",{children:"Viewing files is coming soon"})})]},e.id))}):n&&0===n.length?(0,s.jsxs)(E.bZ,{variant:"secondary",children:[(0,s.jsx)(y.Z,{name:"folder",className:"h-4 w-4"}),(0,s.jsx)(E.Cd,{children:"No storage buckets"}),(0,s.jsx)(E.X,{children:"A bucket is a container used to store and protect files in your app."})]}):null]})}var tp=n(42262);function tg(e){let{projectRef:t}=e,{data:n,isLoading:r,error:a}=en(t),i=(0,c.useMemo)(()=>{if(!n)return[];let e={ERROR:1,WARN:2,INFO:3};return n.filter(e=>"security"!==e.type).sort((t,n)=>(e[t.level]||99)-(e[n.level]||99))},[n]),l=e=>{switch(e){case"ERROR":return"destructive";case"WARN":return"warning";default:return"outline"}},o=e=>{if(!e.type)return e.level;let t=e.type.charAt(0).toUpperCase()+e.type.slice(1),n="warn"===e.level.toLowerCase()?"warning":e.level.toLowerCase();return"".concat(t," ").concat(n)};return(0,s.jsxs)("div",{className:"mx-auto flex flex-col gap-4",children:[r&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(C.O,{className:"h-6 w-full"}),(0,s.jsx)(C.O,{className:"h-6 w-full"}),(0,s.jsx)(C.O,{className:"h-6 w-full"}),(0,s.jsx)(C.O,{className:"h-6 w-full"})]}),a&&(0,s.jsxs)(E.bZ,{variant:"destructive",className:"mt-8",children:[(0,s.jsx)(y.Z,{name:"code",className:"h-4 w-4"}),(0,s.jsx)(E.Cd,{children:"Error fetching suggestions"}),(0,s.jsx)(E.X,{children:(null==a?void 0:a.message)||"An unexpected error occurred. Please try again."})]}),n&&(0,s.jsx)("div",{className:"flex flex-col gap-4 px-1",children:i.length>0?(0,s.jsx)("div",{children:i.map(e=>(0,s.jsx)("div",{className:"group relative border-b py-4 last:border-b-0",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-start justify-start gap-4",children:[(0,s.jsx)("h4",{className:"font-semibold text-sm",children:e.title}),(0,s.jsx)("div",{className:"flex items-center gap-1",children:(0,s.jsx)(e5.C,{variant:l(e.level),className:"shrink-0",children:o(e)})})]}),(0,s.jsx)("div",{className:"prose prose-sm mt-2 max-w-none text-sm text-muted-foreground",children:(0,s.jsx)(tp.UG,{components:{code(e){let{inline:t,children:n,...r}=e;return t?(0,s.jsx)("code",{className:"rounded bg-muted px-1",...r,children:n}):(0,s.jsx)("pre",{className:"overflow-x-auto rounded bg-muted p-2",...r,children:(0,s.jsx)("code",{children:n})})}},children:e.detail})})]})},e.cache_key))}):(0,s.jsxs)(E.bZ,{children:[(0,s.jsx)(y.Z,{name:"lightbulb_2",className:"h-4 w-4"}),(0,s.jsx)(E.Cd,{children:"No suggestions found"}),(0,s.jsx)(E.X,{children:"Your project looks good! No suggestions at this time."})]})})]})}var tf=n(1e4),th=n(30094),tx=n(11350),tv=n(28968),tb=n(21177),t_=n(71272);let ty={users:{label:"New Users",color:"var(--chart-1)"}};function tj(e){let{projectRef:t,timeRange:n}=e,{data:r,isLoading:a,isError:i}=$(t,n);return(0,s.jsxs)("div",{children:[a&&(0,s.jsx)(C.O,{className:"h-[250px] w-full"}),i&&(0,s.jsxs)(E.bZ,{variant:"destructive",children:[(0,s.jsx)(y.Z,{name:"warning",className:"h-4 w-4"}),(0,s.jsx)(E.Cd,{children:"Error loading chart data"}),(0,s.jsx)(E.X,{children:"There was a problem loading your chart data."})]}),r&&!a&&(0,s.jsx)(t_.BO,{config:ty,className:"aspect-auto h-[250px] w-full",children:(0,s.jsxs)(tf.v,{accessibilityLayer:!0,data:r,margin:{left:-24,right:12},children:[(0,s.jsx)(th.q,{vertical:!1}),(0,s.jsx)(tx.K,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:32,tickFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),(0,s.jsx)(tv.B,{tickLine:!1,axisLine:!1,tickMargin:8,tickCount:5,allowDecimals:!1}),(0,s.jsx)(t_.h7,{content:(0,s.jsx)(t_.dg,{labelFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})}),(0,s.jsx)(tb.$,{dataKey:"users",fill:"var(--color-users)"})]})})]})}function tw(e){let{projectRef:t}=e,[n,r]=(0,c.useState)(7),{data:a,isLoading:i,pagination:l,sort:o,setPage:d,setPageSize:u,setSort:m,refetch:p}=eM({projectRef:t,tableName:"auth.users",initialPageSize:10}),{updateRow:g,isUpdating:f}=eP({projectRef:t,tableName:"auth.users"}),h=eL({updateRow:g,refetch:p,successMessage:"User updated successfully",errorMessage:"Failed to update user"});return(0,s.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,s.jsx)(eT,{title:"Users",description:"View user signups over time",children:(0,s.jsxs)(eS.Ph,{value:String(n),onValueChange:e=>r(Number(e)),children:[(0,s.jsx)(eS.i4,{className:"w-[160px] rounded-lg sm:ml-auto","aria-label":"Select a value",children:(0,s.jsx)(eS.ki,{placeholder:"Select time range"})}),(0,s.jsxs)(eS.Bw,{className:"rounded-xl",children:[(0,s.jsx)(eS.Ql,{value:"90",className:"rounded-lg",children:"Last 90 days"}),(0,s.jsx)(eS.Ql,{value:"30",className:"rounded-lg",children:"Last 30 days"}),(0,s.jsx)(eS.Ql,{value:"7",className:"rounded-lg",children:"Last 7 days"})]})]})}),(0,s.jsx)(tj,{projectRef:t,timeRange:n}),(0,s.jsx)(eT,{title:"Recent users",description:"View recent user signups"}),(0,s.jsx)(eW,{data:a||[],isLoading:i||f,queryKey:"auth.users",onRowUpdate:h,currentPage:l.page,totalCount:l.totalCount,pageSize:l.pageSize,onPageChange:d,onPageSizeChange:u,sortColumn:o.column,sortDirection:o.direction,onSortChange:(e,t)=>m({column:e,direction:t})})]})}var tS=n(29895),tN=n(35127),tE=n(73517),tC=n(14070);let tk=e=>{let{projectId:t,disabled:n}=e,[r,a]=(0,c.useState)(!1),l=()=>a(!1),o=(0,i.D)({mutationFn:()=>(0,eY.SJ)().post("/projects/".concat(t,"/supabase/disconnect")),onSuccess:()=>{(0,d.Am)("Supabase disconnected",{description:"You can connect to a new Supabase project later."}),l()},onError:e=>{d.Am.error("Error",{description:e.message})}});return(0,s.jsxs)(tC.Vq,{open:r,onOpenChange:a,children:[(0,s.jsx)(tC.hg,{asChild:!0,children:(0,s.jsx)(_.z,{variant:"outline",size:"sm",disabled:n,children:"Disconnect"})}),(0,s.jsxs)(tC.cZ,{size:"sm",children:[(0,s.jsxs)(tC.fK,{children:[(0,s.jsx)(tC.$N,{children:"Disconnect Supabase"}),(0,s.jsx)(tC.Be,{children:"Are you sure you want to disconnect Supabase?"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"We will stop deploying edge functions and reading your database schema, but no changes will be made to your code. You can reconnect to Supabase later."}),(0,s.jsxs)(tC.cN,{children:[(0,s.jsx)(_.z,{variant:"outline",onClick:l,children:"Cancel"}),(0,s.jsx)(_.z,{variant:"destructive",onClick:()=>{o.mutate()},loading:o.isPending,children:"Disconnect"})]})]})]})},tT=e=>{let{projectId:t}=e,n=(0,h.bk)(e=>e.isSendChatMessageMutationPending);return(0,s.jsx)(ey.P,{label:"Disconnect Project",description:"Remove the Supabase project from this Lovable project.",justify:"end",children:(0,s.jsx)(tk,{projectId:t,disabled:n})})};var tI=n(77658),tA=n(88021);let tR=e=>{var t;let{workspace:n,myWorkspaceRole:r,setShowConnectDialog:a}=e,{isLoading:i,noOrganizations:l}=(0,tS.S)({workspaceId:n.id}),{handleConnect:o,isConnecting:c}=(0,tA.hb)(null!==(t=null==n?void 0:n.id)&&void 0!==t?t:""),d="admin"===r||"owner"===r;return(0,s.jsx)(ey.P,{label:"Organizations",description:"Connected Supabase organizations will be accessible to all members in this workspace.",justify:"end",badges:["admin"],children:i?(0,s.jsx)(C.O,{className:"h-7 w-40"}):l?(0,s.jsxs)(_.z,{disabled:c||!d,onClick:()=>o(),size:"sm",loading:c,children:[(0,s.jsx)(tI.xR.Supabase,{className:"h-4 w-4"}),"Connect Supabase"]}):(0,s.jsx)(_.z,{disabled:c||!d,onClick:()=>a(!0),size:"sm",variant:"outline",children:"Manage Connected Organizations"})})};var tO=n(68746),tD=n(43487);let tM=e=>{let{setStep:t,workspace:n,supabaseOrganizations:r,handleConnect:a,isConnecting:i,showConnectStep:l}=e,o=0===r.length;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tD.Nj,{title:"Linked Supabase Organizations",description:"Anyone in your Lovable workspace can view and link Supabase projects..",badge:"admin"}),(0,s.jsx)(tn.Separator,{}),(0,s.jsxs)("div",{className:"grid min-h-[200px] grid-cols-1 gap-3 px-6 py-6 md:grid-cols-2",children:[(0,s.jsx)(tD.NZ,{workspace:n}),(0,s.jsxs)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Supabase Organizations"}),r.map(e=>{let t="connected"===e.status;return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-full border bg-muted",children:(0,s.jsx)(tI.xR.Supabase,{className:"h-4 w-4"})}),(0,s.jsx)("p",{className:"break-all font-medium",children:e.name}),!t&&(0,s.jsx)(_.z,{variant:"default",size:"sm",className:"ml-auto",onClick:()=>a({supabaseOrgId:e.id}),disabled:i,children:"Reconnect"})]},e.id)}),(0,s.jsx)(_.z,{variant:"outline",className:"mt-auto w-full",onClick:()=>a(),size:"sm",children:o?"Add Organization":"Add More Organizations"})]})]}),(0,s.jsx)(tn.Separator,{}),l&&(0,s.jsx)(tD.Ff,{children:(0,s.jsx)(_.z,{onClick:()=>t("connect"),className:"ml-auto",size:"sm",disabled:0===r.length,children:"Continue"})})]})};var tL=n(52780),tP=n(77162),tz=n(79572);let tZ=e=>{let{setStep:t,supabaseOrganizations:n,closeDialog:r}=e,a=(0,tP.D)(),i=(0,h.bk)(e=>e.isSendChatMessageMutationPending),[l,o]=(0,c.useState)(null),{handleProjectSelect:d,isConnecting:u}=(0,tz._)(a,r),m=u||i;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tD.Nj,{title:"Connect Project",description:"Select a project of one of your connected Supabase organizations to connect it to your Lovable project."}),(0,s.jsx)(tn.Separator,{}),(0,s.jsx)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto px-6 py-6",children:n.map(e=>{let t=[...e.projects].sort((e,t)=>(0,tL.u)(e)&&!(0,tL.u)(t)?-1:(0,tL.u)(t)&&!(0,tL.u)(e)?1:0),n=0===t.length;return(0,s.jsxs)("div",{className:"flex w-full flex-col gap-3",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:e.name}),t.map(e=>{let t=(0,tL.u)(e),n=l===e.id;return(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),!t&&(0,s.jsx)(eU.b,{showTooltip:!t,tooltipContent:"Check project status in Supabase.",instant:!0,children:(0,s.jsx)(y.Z,{name:"warning_fill",className:"text-destructive-primary",size:"small"})},e.id)]}),(0,s.jsx)(_.z,{size:"sm",disabled:!t||m,onClick:()=>{o(e.id),d(e)},loading:n&&m,children:n&&m?"Connecting":"Connect"})]},e.id)}),(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[n&&(0,s.jsx)("p",{className:"w-full text-sm text-muted-foreground",children:"No Supabase projects found for this organization."}),(0,s.jsx)(_.z,{size:"sm",variant:n?"default":"secondary",className:"ml-auto w-fit",asChild:!0,children:(0,s.jsxs)("a",{href:"https://supabase.com/dashboard/new/".concat(e.id),target:"_blank",children:[(0,s.jsx)(tI.xR.Supabase,{className:"h-3 w-3"}),"Create Project"]})})]})]},e.id)})}),(0,s.jsx)(tn.Separator,{}),(0,s.jsx)(tD.Ff,{children:(0,s.jsx)(_.z,{variant:"outline",onClick:()=>t("organizations"),size:"sm",children:"Back"})})]})},tU=e=>{var t;let{workspace:n,showConnectStep:r,showConnectDialog:a,setShowConnectDialog:i}=e,[l,o]=(0,c.useState)("organizations"),{supabaseOrganizations:d}=(0,tS.S)({workspaceId:n.id}),{handleConnect:u,isConnecting:m}=(0,tA.hb)(null!==(t=null==n?void 0:n.id)&&void 0!==t?t:"");return(0,s.jsxs)(tC.Vq,{open:a,onOpenChange:e=>{i(e),e||o("organizations")},children:[(0,s.jsx)(tC.hg,{asChild:!0,className:"hidden",children:(0,s.jsx)(_.z,{size:"sm",children:"Connect Supabase"})}),(0,s.jsx)(tD.p4,{children:"organizations"===l?(0,s.jsx)(tM,{setStep:o,workspace:n,supabaseOrganizations:null!=d?d:[],handleConnect:u,isConnecting:m,showConnectStep:r}):(0,s.jsx)(tZ,{setStep:o,supabaseOrganizations:null!=d?d:[],closeDialog:()=>{i(!1),o("organizations")}})})]})};var tF=e=>{let t=(0,x.iZ)(e=>e.project),n=null==t?void 0:t.supabase_project_config,r=!!(null==n?void 0:n.supabase_project_id);return(0,s.jsx)(tU,{...e,showConnectStep:!r})},tq=n(32766);let tV=e=>{let{isConnectedToSupabase:t}=e,[n,r]=(0,tq.B)("supabase-explainer",{defaultValue:!0}),[a,i]=(0,c.useState)(!1);return t||!n?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"rounded-md border border-border/50 bg-muted/20 p-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,s.jsx)(y.Z,{name:"info",size:"small",className:"text-muted-foreground"}),(0,s.jsx)("h3",{className:"text-sm font-medium",children:"What is Supabase?"}),(0,s.jsx)(_.z,{variant:"ghost",className:"ml-auto hover:bg-transparent",size:"icon-sm",onClick:()=>r(!1),children:(0,s.jsx)(y.Z,{name:"close",size:"small",className:"text-muted-foreground"})})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Supabase is a complete platform for building apps with user authentication, data storage, and other backend capabilities. Connecting it to your Lovable project will enable you to build more advanced apps and support things such as AI features and payments."}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-3 pt-2",children:[(0,s.jsxs)("a",{href:"https://docs.lovable.dev/integrations/supabase",target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1.5 rounded-md bg-primary/10 px-3 py-1.5 text-sm font-medium text-primary transition-colors hover:bg-primary/20",children:[(0,s.jsx)(y.Z,{name:"menu_book",size:"small"}),"See docs"]}),(0,s.jsxs)("button",{onClick:()=>i(!0),className:"inline-flex items-center gap-1.5 rounded-md bg-primary/10 px-3 py-1.5 text-sm font-medium text-primary transition-colors hover:bg-primary/20",children:[(0,s.jsx)(y.Z,{name:"play_circle",size:"small"}),"Watch tutorial"]})]})]})}),(0,s.jsx)(tC.Vq,{open:a,onOpenChange:i,children:(0,s.jsx)(tC.cZ,{className:"max-w-4xl p-0",children:(0,s.jsx)("div",{className:"aspect-video w-full",children:(0,s.jsx)("iframe",{src:"https://www.youtube.com/embed/eVHg4wipRrU",title:"Supabase Tutorial",className:"h-full w-full rounded-lg",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})})})]})},tG=e=>{var t,n;let{supabaseIntegrationData:r}=tY(null==e?void 0:e.id),a=(0,tN.fs)(),s=(0,u.G)();return null!=r&&!!r.is_managed_by_lovable||(null==e||null===(t=e.supabase_project_config)||void 0===t||!t.supabase_project_id)&&(a||!!(null===(n=s.features)||void 0===n?void 0:n.lovable_backend))},tW=e=>{let{workspace:t,isInsideEditor:n,myWorkspaceRole:r,project:a,resetCallbackRef:i}=e,[l,o]=(0,c.useState)(!1),d=(0,c.useCallback)(()=>{n&&o(!0)},[n]);(0,tS.I)({workspaceId:t.id,onConnectSuccess:d});let u=tG(a),m=u&&a;return(0,s.jsx)(tH,{isSeamless:u,children:m?(0,s.jsx)(tX,{resetCallbackRef:i}):(0,s.jsx)(tB,{workspace:t,project:a,showConnectDialog:l,setShowConnectDialog:o,myWorkspaceRole:r,isInsideEditor:n})})},tH=e=>{let{children:t,isSeamless:n}=e;return(0,tN.A4)()?(0,s.jsx)("div",{className:"flex min-h-full flex-col gap-6 p-4",children:t}):(0,s.jsx)(tE.tM,{value:"supabase",title:n?"Backend":"Supabase",description:"Integrate user authentication, data storage, and backend capabilities.",docsLink:"https://docs.lovable.dev/integrations/supabase",children:t})},tB=e=>{let{workspace:t,project:n,showConnectDialog:r,setShowConnectDialog:a,myWorkspaceRole:i,isInsideEditor:l}=e;return(0,s.jsxs)(s.Fragment,{children:[n?(0,s.jsx)(tF,{workspace:t,showConnectDialog:r,setShowConnectDialog:a}):(0,s.jsx)(tU,{workspace:t,showConnectDialog:r,setShowConnectDialog:a}),n&&(0,s.jsx)(tK,{workspace:t,myWorkspaceRole:i,setShowConnectDialog:a}),(0,s.jsx)(tJ,{workspace:t,myWorkspaceRole:i,isInsideEditor:l,showConnectDialog:r,setShowConnectDialog:a})]})},tJ=e=>{let{workspace:t,myWorkspaceRole:n,isInsideEditor:r,showConnectDialog:a,setShowConnectDialog:i}=e;return(0,s.jsx)(tR,{workspace:t,myWorkspaceRole:n,isInsideEditor:r,showConnectDialog:a,setShowConnectDialog:i})},tK=e=>{var t,n;let{workspace:r,myWorkspaceRole:a,setShowConnectDialog:l}=e,o=(0,x.iZ)(e=>e.project),c=null==o?void 0:o.supabase_project_config,u=!!(null==o?void 0:o.is_supabase_enabled),m=(0,tS.S)({workspaceId:r.id}),p=null==c?void 0:c.supabase_project_id,g=null==o?void 0:o.id,f=(0,i.D)({mutationFn:()=>(0,eY.SJ)().post("/projects/".concat(g,"/supabase/disconnect")),onSuccess:()=>{(0,d.Am)("Supabase disconnected",{description:"You can connect to a new Supabase project later."})},onError:e=>{d.Am.error("Error",{description:e.message})}}),h=null===(t=m.supabaseOrganizations)||void 0===t?void 0:t.find(e=>e.id===(null==c?void 0:c.supabase_organization_id));if(!o)return null;if(u)return(0,s.jsx)("div",{className:"text-sm",children:"Unfortunately, your project is not able to use Supabase."});let b=m.noOrganizations;return m.isLoading?(0,s.jsx)(v.T,{text:"Loading Supabase..."}):(0,s.jsxs)(s.Fragment,{children:[!h&&!!(null==c?void 0:c.supabase_organization_id)&&(0,s.jsxs)(E.bZ,{variant:"destructive",children:[(0,s.jsx)(E.Cd,{children:"Problem with your Supabase connection"}),(0,s.jsxs)(E.X,{children:[(0,s.jsxs)("p",{children:["This project is connected to Supabase organization"," ",(0,s.jsx)("span",{className:"rounded-md bg-muted px-1 py-0.5 font-mono font-medium text-muted-foreground",children:null==c?void 0:c.supabase_organization_id}),", but this workspace is not connected to that organization. Disconnect the project or add the organization again."]}),(0,s.jsx)("div",{className:"mt-4 flex",children:(0,s.jsx)(_.z,{variant:"destructive",onClick:()=>f.mutate(),disabled:f.isPending,size:"sm",children:"Disconnect"})})]})]}),(0,s.jsx)(tV,{isConnectedToSupabase:!m.noOrganizations}),!b&&(0,s.jsx)(tO.c,{workspaceId:r.id,supabaseOrganizations:null!==(n=m.supabaseOrganizations)&&void 0!==n?n:[],supabaseConfig:null!=c?c:null,setShowConnectDialog:l,isWorkspaceAdmin:"admin"===a||"owner"===a}),p&&(0,s.jsx)(tT,{projectId:null==o?void 0:o.id})]})},tY=e=>{let{data:t,isLoading:n}=(0,l.a)({queryKey:["supabase-integration-data",e],queryFn:async()=>{let t=await (0,eY.SJ)().get("/projects/".concat(e,"/integrations/supabase"));return""===t.supabase_project_id?null:t},enabled:!!e});return{supabaseIntegrationData:t,isSupabaseIntegrationDataLoading:n}},tX=e=>{let{resetCallbackRef:t}=e,n=(0,x.iZ)(e=>e.project),r=null==n?void 0:n.id,{closeSettings:a}=(0,b.r)(),{openSecurityView:i}=(0,g.h)(),l=(0,h.bk)(e=>e.isSendChatMessageMutationPending),{supabaseIntegrationData:c,isSupabaseIntegrationDataLoading:d}=tY(r),u=null==c?void 0:c.supabase_project_id,f=(0,tN.fs)(),j=(0,m.mo)({projectId:r});if(d)return(0,s.jsx)("div",{className:"flex h-full w-full flex-col items-center justify-center gap-4",children:(0,s.jsx)(v.T,{text:"Loading..."})});if(!u)return(0,s.jsxs)("div",{className:"flex min-h-full w-full flex-col items-center justify-center pt-20 md:pt-0",children:[(0,s.jsx)("div",{className:"flex size-12 items-center justify-center rounded-lg bg-muted",children:(0,s.jsx)(y.Z,{name:"database",size:"xlarge",className:"text-muted-foreground"})}),(0,s.jsx)("p",{className:"mt-4 text-lg font-medium",children:"No Backend Added"}),(0,s.jsxs)("p",{className:"mt-1 max-w-xs text-center text-sm text-muted-foreground",children:["Setup Backend to store data, add authentication, and execute background functions."," ",(0,s.jsx)(o.default,{href:"https://docs.lovable.dev/integrations/supabase",target:"_blank",className:"inline-block underline underline-offset-1",children:"Learn more"})]}),f?(0,s.jsx)(tQ,{}):(0,s.jsx)("div",{className:"mt-6 flex gap-2",children:(0,s.jsx)(eU.b,{showTooltip:l,tooltipContent:"Wait for Lovable to finish working",children:(0,s.jsx)(_.z,{variant:"default",onClick:()=>{r&&(j.mutate({body:{message:"Please connect Lovable Backend to my existing app.",id:(0,p.Fd)(),chat_only:!1,agent_mode:"enabled"}}),a())},disabled:j.isPending||l,loading:j.isPending,children:"Add Backend"})})})]});let S=[{title:"Database",icon:"table",description:"View tables and edit data",component:(0,s.jsx)(eK,{projectRef:u})},{title:"Storage",icon:"hard_drive",description:"Upload and manage files, images, and documents",component:(0,s.jsx)(tm,{projectRef:u})},{title:"Auth",icon:"shield",description:"Configure how users sign in to your app",component:(0,s.jsx)(eA,{projectRef:u})},{title:"Users",icon:"group",description:"View user data and track new user signups",component:(0,s.jsx)(tw,{projectRef:u})},{title:"Secrets",icon:"key",description:"Store and manage environment variables securely",component:(0,s.jsx)(tu,{projectRef:u})},{title:"Logs",icon:"data_table",description:"Monitor application logs to debug issues",component:(0,s.jsx)(td,{})},{title:"Security",icon:"security",description:"Review security findings and vulnerabilities",component:null,onClick:()=>{i()}},{title:"Performance Suggestions",icon:"lightbulb_2",description:"Get performance recommendations",component:(0,s.jsx)(tg,{projectRef:u})},{title:"Configuration",icon:"settings",description:"Manage backend settings and scaling options",component:(0,s.jsx)(eR,{})}];return(0,s.jsxs)(w,{onStackEmpty:()=>{},initialStack:[],children:[(0,s.jsx)(t$,{resetCallbackRef:t}),(0,s.jsx)(t0,{navigationItems:S,projectRef:u})]})},tQ=()=>(0,s.jsxs)("div",{className:"mt-6 rounded-lg border bg-muted/50 p-6",children:[(0,s.jsx)("h3",{className:"mb-3 text-lg",children:"Add Backend Functionality"}),(0,s.jsx)("p",{className:"mb-4 text-base",children:"Use prompts to add backend functionality to your app. Be specific about what functionality you want to add to save credits and get better results."}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Examples:"}),(0,s.jsxs)("ul",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:""}),(0,s.jsxs)("span",{children:[(0,s.jsx)("strong",{children:"Authentication:"}),' "add login" or "add authentication"']})]}),(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:""}),(0,s.jsxs)("span",{children:[(0,s.jsx)("strong",{children:"Database:"}),' "add transactions to database" for apps with transactions']})]}),(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:""}),(0,s.jsxs)("span",{children:[(0,s.jsx)("strong",{children:"API Integration:"})," Provide API documentation and specify how the API should be used"]})]})]})]})]}),t$=e=>{let{resetCallbackRef:t}=e,{reset:n}=S();return(0,c.useEffect)(()=>{t&&(t.current=n)},[n,t]),null},t0=e=>{let{navigationItems:t}=e,{push:n}=S(),{securitySummary:r}=(0,f.y)(),a=(0,c.useMemo)(()=>r.errorCount>0,[r.errorCount]),i=()=>r.errorCount>0?"destructive":"warning",l=()=>r.errorCount>0?"".concat(r.errorCount," Error").concat(r.errorCount>1?"s":""):r.warnCount>0?"".concat(r.warnCount," Warning").concat(r.warnCount>1?"s":""):"Issues Found";return(0,s.jsx)(N,{navigationItems:t,children:(0,s.jsx)("div",{className:"grid grid-cols-1 gap-4 pb-4 xl:grid-cols-2",children:t.map(e=>{let{title:t,component:r,icon:o,description:c,onClick:d}=e;return(0,s.jsx)(eD,{onClick:d||(()=>{n({title:t,component:r})}),icon:o,title:t,description:c,badge:"Security"===t&&a&&(0,s.jsx)(e5.C,{variant:i(),children:l()})},t)})})})}},68746:function(e,t,n){n.d(t,{c:function(){return j},n:function(){return E}});var r=n(52155),a=n(62483),s=n(98244),i=n(53259),l=n(76332),o=n(99792),c=n(48261),d=n(33160);let u=e=>{let{onProjectSelect:t,triggerComponent:n,supabaseOrganizations:a,handleConnect:u,isConnectLoading:m,isWorkspaceAdmin:p,align:g="start"}=e,[f,h]=(0,s.useState)(!1);return(0,r.jsx)(c.D,{setSelectedProject:t,setOpen:h,children:(0,r.jsxs)(i.h_,{open:f,onOpenChange:h,children:[n,(0,r.jsxs)(i.AW,{className:"w-48",align:g,children:[(0,r.jsx)(i.Ju,{className:"text-xs font-medium text-muted-foreground",children:"Supabase organizations"}),a.map(e=>(0,r.jsx)(d.K,{organization:e,reconnectOrg:u,isWorkspaceAdmin:p},e.id)),(0,r.jsx)(i.VD,{}),(0,r.jsx)(l.b,{showTooltip:!p,tooltipContent:"You are not an admin of this workspace",children:(0,r.jsxs)(i.Xi,{onClick:u,className:"text-sm",disabled:m||!p,children:[(0,r.jsx)(o.Z,{name:"add",size:"small"}),"Add organization"]})})]})]})})};var m=n(26052),p=n(59561),g=n(77162),f=n(88021),h=n(84864),x=n(60446),v=n(26930),b=n(4578),_=n(70980),y=n(79572);let j=e=>{var t,n,s;let{supabaseOrganizations:i,setShowConnectDialog:o,isWorkspaceAdmin:c,supabaseConfig:d,workspaceId:u}=e,m=(0,g.D)(),h=(0,_.bk)(e=>e.isSendChatMessageMutationPending),{handleProjectSelect:x,isConnecting:b}=(0,y._)(m),{handleConnect:j}=(0,f.hb)(u),S=null!==(n=i.find(e=>e.id===(null==d?void 0:d.supabase_organization_id)))&&void 0!==n?n:null,N=null!==(s=null==S?void 0:null===(t=S.projects)||void 0===t?void 0:t.find(e=>e.id===(null==d?void 0:d.supabase_project_id)))&&void 0!==s?s:null;return(0,r.jsx)(a.P,{label:"Project",description:"Choose the Supabase project to sync with.",justify:"end",customBadge:(0,r.jsx)(E,{status:(null==N?void 0:N.status)||"not-connected"}),children:(null==S?void 0:S.status)===v.U.status.NEEDS_REFRESH?(0,r.jsx)(l.b,{showTooltip:!0,tooltipContent:c?"You need to refresh your Supabase organization to continue building.":"You need to refresh your Supabase organization to continue building. Contact your workspace admin to refresh.",children:(0,r.jsx)(p.z,{variant:"outline",size:"sm",onClick:()=>{j({supabaseOrgId:null==d?void 0:d.supabase_organization_id})},disabled:!c,children:"Reconnect"})}):(0,r.jsx)(w,{connectedProjectIsInUnconnectedOrganization:!!d&&!S,supabaseOrganizations:i,isConnecting:b,isSendChatMessageMutationPending:h,isWorkspaceAdmin:c,setShowConnectDialog:o,handleProjectSelect:x,connectedSupabaseProject:N})})},w=e=>{let{connectedProjectIsInUnconnectedOrganization:t,supabaseOrganizations:n,isConnecting:a,isSendChatMessageMutationPending:s,isWorkspaceAdmin:o,setShowConnectDialog:c,handleProjectSelect:d,connectedSupabaseProject:m}=e;return(0,r.jsx)(u,{align:"end",onProjectSelect:e=>{e&&d(e)},triggerComponent:(0,r.jsx)(l.b,{showTooltip:!m&&s,tooltipContent:"Edits ongoing...",children:(0,r.jsx)(i.$F,{asChild:!0,children:(0,r.jsx)(p.z,{disabled:!!m||a||s,size:"sm",variant:"outline",loading:a,children:m?m.name:t?"Project not found":"Connect a project"})})}),supabaseOrganizations:n,handleConnect:()=>c(!0),isConnectLoading:a,isWorkspaceAdmin:o})},S={[x.k.ACTIVE_HEALTHY]:{label:"Connected",className:"bg-success-primary"},[x.k.ACTIVE_UNHEALTHY]:{label:"Issues detected",className:"bg-warning-primary"},[x.k.COMING_UP]:{label:"Starting up",className:"bg-affirmative-primary"},[x.k.GOING_DOWN]:{label:"Shutting down",className:"bg-destructive-primary"},[x.k.INACTIVE]:{label:"Inactive",className:"bg-destructive-primary"},[x.k.INIT_FAILED]:{label:"Setup failed",className:"bg-destructive-primary"},[x.k.REMOVED]:{label:"Removed",className:"bg-destructive-primary"},[x.k.RESTARTING]:{label:"Restarting",className:"bg-warning-primary"},[x.k.UNKNOWN]:{label:"Unknown",className:"bg-destructive-primary"},[x.k.UPGRADING]:{label:"Upgrading",className:"bg-warning-primary"},[x.k.PAUSING]:{label:"Pausing",className:"bg-warning-primary"},[x.k.RESTORING]:{label:"Restoring",className:"bg-warning-primary"},[x.k.RESTORE_FAILED]:{label:"Restore failed",className:"bg-destructive-primary"},[x.k.PAUSE_FAILED]:{label:"Pause failed",className:"bg-destructive-primary"},"not-connected":{label:"Not connected",className:"bg-warning-primary"}},N=e=>e in S?S[e]:(h.logging.warn("Unknown supabase project status",{status:e}),{label:e,className:""}),E=e=>{let{status:t}=e,n=N(t);return n?(0,r.jsxs)(m.C,{className:"flex w-auto items-center gap-1.5 bg-secondary text-xs text-foreground shadow-none hover:bg-secondary",children:[(0,r.jsx)("span",{className:(0,b.cn)("h-1.5 w-1.5 rounded-full",n.className)}),n.label]}):null}},43487:function(e,t,n){n.d(t,{Ff:function(){return c},NZ:function(){return d},Nj:function(){return o},p4:function(){return l}});var r=n(52155);n(98244);var a=n(43115),s=n(14070),i=n(1080);let l=e=>{let{children:t}=e;return(0,r.jsx)(s.cZ,{className:"max-h-[80vh] gap-0 overflow-y-auto p-0",size:"lg",children:t})},o=e=>{let{title:t,description:n,badge:a}=e;return(0,r.jsxs)(s.fK,{className:"px-6 py-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(s.$N,{className:"font-medium",children:t}),a&&(0,r.jsx)(i.p,{badge:a})]}),(0,r.jsx)(s.Be,{className:"text-sm text-muted-foreground",children:n})]})},c=e=>{let{children:t}=e;return(0,r.jsx)("div",{className:"flex gap-4 px-6 py-4",children:t})},d=e=>{let{workspace:t}=e;return(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Workspace"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(a.z,{workspace:t,className:"h-7 w-7"}),(0,r.jsx)("p",{className:"font-medium",children:t.name})]})]})}},1080:function(e,t,n){n.d(t,{p:function(){return l}});var r=n(52155),a=n(26052),s=n(4578);let i={pro:"brand-twilight",business:"brand-twilight",admin:"brand-saffron",labs:"brand-twilight",internal:"secondary"},l=e=>{let{badge:t,className:n}=e;return(0,r.jsx)(a.C,{variant:i[t],className:(0,s.cn)("capitalize",n),children:t})}},62483:function(e,t,n){n.d(t,{P:function(){return i},j:function(){return l}});var r=n(52155),a=n(4578),s=n(1080);let i=e=>{let{children:t,label:n,className:i,isLast:l=!1,description:o,badges:c,customBadge:d,mobileLayout:u="vertical",justify:m="start",...p}=e;return(0,r.jsxs)("div",{className:(0,a.cn)("relative grid gap-4 pb-4 last:border-b-0 md:grid md:grid-cols-2",{"border-b-0":l,"border-b":!l,"flex justify-between":"horizontal"===u,"grid-cols-1":"vertical"===u},i),...p,children:[(n||o)&&(0,r.jsxs)("div",{className:"flex-col gap-1 md:flex",children:[(0,r.jsxs)("p",{className:"flex flex-wrap items-center gap-x-1.5 text-base font-medium",children:[n,null==c?void 0:c.map(e=>(0,r.jsx)(s.p,{badge:e},e)),d]}),o&&(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:o})]}),t&&(0,r.jsx)("div",{className:(0,a.cn)("flex items-center","end"===m&&"md:justify-end"),children:t})]})},l=e=>{let{children:t,className:n,...s}=e;return(0,r.jsx)("div",{className:(0,a.cn)("absolute inset-x-0 bottom-0 z-10 flex min-h-8 items-center rounded-b-lg border-t bg-background px-6 py-3 md:px-10",n),...s,children:t})}},73517:function(e,t,n){n.d(t,{QK:function(){return m},eD:function(){return u},tM:function(){return p},v_:function(){return d},yf:function(){return g}});var r=n(52155),a=n(41932),s=n(76816),i=n(99792),l=n(87294),o=n(4578),c=n(1080);let d=e=>{let{children:t,className:n,...s}=e;return(0,r.jsx)(a.mQ,{className:(0,o.cn)("mt-0 flex w-full flex-1 flex-col items-start overflow-hidden md:flex-row",n),orientation:"vertical",...s,children:t})},u=e=>{let{children:t,className:n,hasActiveTab:s,...i}=e;return(0,r.jsxs)(a.dr,{className:(0,o.cn)("mt-[22px] flex h-full w-full flex-col gap-0.5 overflow-y-auto px-4 py-6 md:mt-0 md:w-[240px] md:flex-nowrap md:border-r",n,s?"hidden md:flex":"flex"),...i,children:[(0,r.jsx)(f,{hideBackButton:!0,className:"mt-[22px]",children:"Settings"}),t]})},m=e=>{let{children:t,className:n,...s}=e;return(0,r.jsx)(a.SP,{className:(0,o.cn)("flex min-h-10 w-full items-center justify-start gap-3 rounded-md px-2.5 py-2 text-start text-base data-[state=active]:bg-muted hover:bg-muted-hover md:min-h-8 md:w-auto md:gap-2 md:text-sm [&>svg]:size-5 md:[&>svg]:size-4",n),...s,children:t})},p=e=>{let{children:t,className:n,title:s,description:l,docsLink:d,descriptionAction:u,badge:m,customBadge:p,...g}=e;return(0,r.jsxs)(a.nU,{className:(0,o.cn)("flex max-h-full w-full flex-1 flex-col gap-6 overflow-y-auto px-6 pb-6 pt-20 data-[state=inactive]:hidden focus:outline-none md:px-10 md:pt-6",n),...g,children:[s&&(0,r.jsxs)("div",{className:"hidden w-full flex-col gap-2 border-b pb-3 md:flex",children:[(0,r.jsxs)("h4",{className:"flex items-center gap-2 text-lg font-medium",children:[(0,r.jsx)("span",{children:s}),m&&(0,r.jsx)(c.p,{badge:m}),p]}),l&&(0,r.jsxs)("p",{className:(0,o.cn)("flex items-start justify-between gap-2 text-sm text-muted-foreground"),children:[(0,r.jsx)("div",{className:"",children:l}),d&&(0,r.jsxs)("a",{href:d,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-muted-foreground duration-150 ease-in-out hover:text-muted-foreground/80",children:[(0,r.jsx)(i.Z,{name:"help",size:"small"}),"Docs"]}),u&&u]})]}),(0,r.jsx)(f,{descriptionAction:u,children:s}),t]})},g=e=>{let{title:t}=e;return(0,r.jsx)("div",{className:(0,o.cn)("mb-1 mt-6 px-3 text-sm font-medium text-muted-foreground first:mt-0 md:text-xs"),children:t})},f=e=>{let{children:t,className:n,hideBackButton:a=!1,descriptionAction:c,...d}=e,{openSettings:u}=(0,s.r)();return(0,l.Z)("md")?(0,r.jsxs)("div",{className:(0,o.cn)("absolute inset-x-0 top-0 z-20 flex min-h-8 items-center justify-between border-b bg-background px-2 py-3 md:hidden",n),...d,children:[(0,r.jsx)("div",{className:"flex items-baseline",children:!a&&(0,r.jsxs)("button",{className:(0,o.cn)("flex items-center gap-1 text-base md:text-sm"),onClick:()=>u(),children:[(0,r.jsx)(i.Z,{name:"chevron_left",size:"default"})," Settings"]})}),(0,r.jsx)("div",{className:"absolute left-1/2 flex -translate-x-1/2 items-baseline justify-center text-center text-lg font-medium",children:t}),(0,r.jsx)("div",{className:"flex min-h-7 items-baseline pr-0.5",children:c})]}):null}},48261:function(e,t,n){n.d(t,{D:function(){return l},e:function(){return i}});var r=n(52155),a=n(98244);let s=(0,a.createContext)({setSelectedProject:()=>{},setOpen:()=>{}}),i=()=>{let e=(0,a.useContext)(s);if(!e)throw Error("useSupabaseConnectMenuContext must be used within a SupabaseConnectMenuContext");return e},l=e=>{let{children:t,setSelectedProject:n,setOpen:a}=e;return(0,r.jsx)(s.Provider,{value:{setSelectedProject:n,setOpen:a},children:t})}},33160:function(e,t,n){n.d(t,{K:function(){return p}});var r=n(52155),a=n(56852),s=n(98244),i=n(25393),l=n(76332),o=n(53259),c=n(99792),d=n(26930),u=n(48261),m=n(52780);let p=e=>{var t;let{organization:n,reconnectOrg:s,isWorkspaceAdmin:u}=e;return n.status===d.U.status.NEEDS_REFRESH?(0,r.jsx)(l.b,{showTooltip:!0,tooltipContent:u?"Click to reconnect to Supabase":"Ask an admin of your workspace to reconnect to Supabase",children:(0,r.jsxs)(o.Xi,{onClick:()=>s({supabaseOrgId:n.id}),className:"flex items-center gap-2 text-destructive-primary",disabled:!u,children:[(0,r.jsx)(c.Z,{name:"warning_fill",size:"small",className:"text-destructive-primary"}),(0,r.jsx)("span",{className:"truncate",children:n.name})]})}):(0,r.jsxs)(o.Ph,{children:[(0,r.jsx)(o.kt,{className:"text-sm",children:(0,r.jsx)("span",{className:"truncate",children:n.name})}),(0,r.jsxs)(o.TG,{className:"w-56 p-0",children:[(0,r.jsxs)(i.mY,{children:[(0,r.jsx)(i.sZ,{placeholder:"Search projects...",autoFocus:!0}),(0,r.jsxs)(i.e8,{className:"max-h-60",children:[(0,r.jsx)(i.rb,{children:"No projects found."}),(0,r.jsx)(i.fu,{children:null===(t=n.projects)||void 0===t?void 0:t.map(e=>(0,r.jsx)(g,{project:e},e.id))})]})]}),(0,r.jsx)(o.VD,{className:"mt-0"}),(0,r.jsx)("div",{className:"px-1 pb-1",children:(0,r.jsx)(o.Xi,{asChild:!0,children:(0,r.jsxs)(a.default,{href:"https://supabase.com/dashboard/new/".concat(n.id),target:"_blank",rel:"noopener noreferrer",className:"flex w-full items-center gap-2",children:[(0,r.jsx)(c.Z,{name:"add",size:"small"}),"Create project",(0,r.jsx)(c.Z,{name:"arrow_outward",size:"small",className:"ml-auto"})]})})})]})]},n.id)},g=e=>{let{project:t}=e,n=(0,m.u)(t),{setSelectedProject:a,setOpen:o}=(0,u.e)(),d=(0,s.useCallback)(()=>{a(t),o(!1)},[t,a,o]);return(0,r.jsx)(l.b,{showTooltip:!n,side:"left",tooltipContent:"Check project status in Supabase.",children:(0,r.jsxs)(i.di,{onSelect:d,disabled:!n,className:"group flex w-full items-center",value:t.name,children:[(0,r.jsx)("span",{className:"truncate",children:t.name}),!n&&(0,r.jsx)(c.Z,{name:"warning_fill",size:"small",className:"ml-auto text-destructive-primary"})]},t.id)})}},52780:function(e,t,n){n.d(t,{u:function(){return a}});var r=n(60446);let a=e=>e.status===r.k.ACTIVE_HEALTHY},57602:function(e,t,n){n.d(t,{Cd:function(){return c},X:function(){return d},bZ:function(){return o}});var r=n(52155),a=n(34255),s=n(98244),i=n(4578);let l=(0,a.j)("relative w-full rounded-lg border p-4 [&>svg]:absolute [&>svg]:text-foreground [&>svg]:left-4 [&>svg]:top-4 [&>svg+div]:translate-y-[-3px] [&>svg~*]:pl-7",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [&>svg]:text-primary-foreground",secondary:"border-transparent bg-secondary text-secondary-foreground [&>svg]:text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground [&>svg]:text-destructive-foreground",warning:"border-transparent bg-warning text-warning-foreground [&>svg]:text-warning-foreground",success:"border-transparent bg-success text-success-foreground [&>svg]:text-success-foreground",accent:"border-transparent bg-accent text-accent-foreground [&>svg]:text-accent-foreground",affirmative:"border-transparent bg-affirmative text-affirmative-foreground [&>svg]:text-affirmative-foreground",outline:"text-foreground border border-border","brand-bubblegum":"bg-brand-bubblegum text-brand-bubblegum-foreground","brand-tiger":"bg-brand-tiger text-brand-tiger-foreground","brand-saffron":"bg-brand-saffron text-brand-saffron-foreground","brand-sapphire":"bg-brand-sapphire text-brand-sapphire-foreground","brand-twilight":"bg-brand-twilight text-brand-twilight-foreground","brand-flamingo":"bg-brand-flamingo text-brand-flamingo-foreground"}},defaultVariants:{variant:"default"}}),o=s.forwardRef((e,t)=>{let{className:n,variant:a,...s}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(l({variant:a}),n),...s})});o.displayName="Alert";let c=s.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",n),...a})});c.displayName="AlertTitle";let d=s.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",n),...a})});d.displayName="AlertDescription"},71272:function(e,t,n){n.d(t,{BO:function(){return u},dg:function(){return g},h7:function(){return p}});var r=n(52155),a=n(98244),s=n(36963),i=n(40305),l=n(49802),o=n(4578);let c={light:"",dark:".dark"},d=a.createContext(null);function u(e){let{id:t,className:n,children:i,config:l,...c}=e,u=a.useId(),p="chart-".concat(t||u.replace(/:/g,""));return(0,r.jsx)(d.Provider,{value:{config:l},children:(0,r.jsxs)("div",{"data-slot":"chart","data-chart":p,className:(0,o.cn)("[&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-surface]:outline-hidden flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent",n),...c,children:[(0,r.jsx)(m,{id:p,config:l}),(0,r.jsx)(s.h,{children:i})]})})}let m=e=>{let{id:t,config:n}=e,a=Object.entries(n).filter(e=>{let[,t]=e;return t.theme||t.color});return a.length?(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(c).map(e=>{let[n,r]=e;return"\n".concat(r," [data-chart=").concat(t,"] {\n").concat(a.map(e=>{var t;let[r,a]=e,s=(null===(t=a.theme)||void 0===t?void 0:t[n])||a.color;return s?"  --color-".concat(r,": ").concat(s,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},p=i.u;function g(e){let{active:t,payload:n,className:s,indicator:i="dot",hideLabel:l=!1,hideIndicator:c=!1,label:u,labelFormatter:m,labelClassName:p,formatter:g,color:h,nameKey:x,labelKey:v}=e,{config:b}=function(){let e=a.useContext(d);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}(),_=a.useMemo(()=>{var e;if(l||!(null==n?void 0:n.length))return null;let[t]=n,a="".concat(v||(null==t?void 0:t.dataKey)||(null==t?void 0:t.name)||"value"),s=f(b,t,a),i=v||"string"!=typeof u?null==s?void 0:s.label:(null===(e=b[u])||void 0===e?void 0:e.label)||u;return m?(0,r.jsx)("div",{className:(0,o.cn)("font-medium",p),children:m(i,n)}):i?(0,r.jsx)("div",{className:(0,o.cn)("font-medium",p),children:i}):null},[u,m,n,l,p,b,v]);if(!t||!(null==n?void 0:n.length))return null;let y=1===n.length&&"dot"!==i;return(0,r.jsxs)("div",{className:(0,o.cn)("grid min-w-32 items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",s),children:[y?null:_,(0,r.jsx)("div",{className:"grid gap-1.5",children:n.map((e,t)=>{let n="".concat(x||e.name||e.dataKey||"value"),a=f(b,e,n),s=h||e.payload.fill||e.color;return(0,r.jsx)("div",{className:(0,o.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===i&&"items-center"),children:g&&(null==e?void 0:e.value)!==void 0&&e.name?g(e.value,e.name,e,t,e.payload):(0,r.jsxs)(r.Fragment,{children:[(null==a?void 0:a.icon)?(0,r.jsx)(a.icon,{}):!c&&(0,r.jsx)("div",{className:(0,o.cn)("border-(--color-border) bg-(--color-bg) shrink-0 rounded-[2px]",{"h-2.5 w-2.5":"dot"===i,"w-1":"line"===i,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===i,"my-0.5":y&&"dashed"===i}),style:{"--color-bg":s,"--color-border":s}}),(0,r.jsxs)("div",{className:(0,o.cn)("flex flex-1 justify-between leading-none",y?"items-end":"items-center"),children:[(0,r.jsxs)("div",{className:"grid gap-1.5",children:[y?_:null,(0,r.jsx)("span",{className:"text-muted-foreground",children:(null==a?void 0:a.label)||e.name})]}),e.value&&(0,r.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})}function f(e,t,n){if("object"!=typeof t||null===t)return;let r="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,a=n;return t&&n in t&&"string"==typeof t[n]?a=t[n]:r&&n in r&&"string"==typeof r[n]&&(a=r[n]),a in e?e[a]:e[n]}l.D},25393:function(e,t,n){n.d(t,{di:function(){return m},e8:function(){return c},fu:function(){return u},mY:function(){return l},rb:function(){return d},sZ:function(){return o}});var r=n(52155),a=n(27461);n(98244),n(14070);var s=n(4578),i=n(99792);function l(e){let{className:t,...n}=e;return(0,r.jsx)(a.mY,{"data-slot":"command",className:(0,s.cn)("flex h-full w-full flex-col overflow-hidden rounded-xl bg-popover text-popover-foreground",t),...n})}function o(e){let{className:t,...n}=e;return(0,r.jsxs)("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[(0,r.jsx)(i.Z,{name:"search",className:"size-4 shrink-0 opacity-50"}),(0,r.jsx)(a.mY.Input,{"data-slot":"command-input",className:(0,s.cn)("flex h-10 w-full rounded-xl bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),...n})]})}function c(e){let{className:t,...n}=e;return(0,r.jsx)(a.mY.List,{"data-slot":"command-list",className:(0,s.cn)("max-h-[300px] scroll-py-1 overflow-y-auto overflow-x-hidden",t),...n})}function d(e){let{...t}=e;return(0,r.jsx)(a.mY.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...t})}function u(e){let{className:t,...n}=e;return(0,r.jsx)(a.mY.Group,{"data-slot":"command-group",className:(0,s.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...n})}function m(e){let{className:t,...n}=e;return(0,r.jsx)(a.mY.Item,{"data-slot":"command-item",className:(0,s.cn)("relative flex cursor-default select-none items-center gap-2 rounded-lg px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg:not([class*='size-'])]:size-4 [&_svg:not([class*='text-'])]:text-muted-foreground [&_svg]:pointer-events-none [&_svg]:shrink-0",t),...n})}},55302:function(e,t,n){n.d(t,{Yi:function(){return o},bZ:function(){return c},zs:function(){return l}});var r=n(52155),a=n(18941),s=n(98244),i=n(4578);let l=a.fC,o=a.xz,c=s.forwardRef((e,t)=>{let{className:n,align:s="center",sideOffset:l=4,...o}=e;return(0,r.jsx)(a.VY,{ref:t,align:s,sideOffset:l,className:(0,i.cn)("z-50 w-64 origin-[--radix-hover-card-content-transform-origin] rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...o})});c.displayName=a.VY.displayName,a.h_},58915:function(e,t,n){n.d(t,{J2:function(){return l},xo:function(){return o},xp:function(){return c},yk:function(){return d}});var r=n(52155),a=n(77736),s=n(98244),i=n(4578);let l=a.fC,o=a.xz;a.ee;let c=a.x8,d=s.forwardRef((e,t)=>{let{className:n,align:s="center",sideOffset:l=4,...o}=e;return(0,r.jsx)(a.h_,{children:(0,r.jsx)(a.VY,{ref:t,align:s,sideOffset:l,className:(0,i.cn)("z-[10000] w-72 rounded-xl border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...o})})});d.displayName=a.VY.displayName},31194:function(e,t,n){n.d(t,{Bw:function(){return f},DI:function(){return d},Ph:function(){return c},Ql:function(){return x},i4:function(){return m},ki:function(){return u},n5:function(){return h}});var r=n(52155),a=n(79546),s=n(368),i=n(98244),l=n(99792),o=n(4578);let c=s.fC,d=s.ZA,u=s.B4,m=i.forwardRef((e,t)=>{let{className:n,children:a,...i}=e;return(0,r.jsxs)(s.xz,{ref:t,className:(0,o.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n),...i,children:[a,(0,r.jsx)(s.JO,{asChild:!0,children:(0,r.jsx)(l.Z,{name:"keyboard_arrow_down",size:"small",className:"opacity-50"})})]})});m.displayName=s.xz.displayName;let p=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)(s.u_,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",n),...i,children:(0,r.jsx)(a.g8U,{className:"h-4 w-4"})})});p.displayName=s.u_.displayName;let g=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,r.jsx)(s.$G,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",n),...i,children:(0,r.jsx)(a.v4q,{className:"h-4 w-4"})})});g.displayName=s.$G.displayName;let f=i.forwardRef((e,t)=>{let{className:n,children:a,position:i="popper",...l}=e;return(0,r.jsx)(s.h_,{children:(0,r.jsxs)(s.VY,{ref:t,className:(0,o.cn)("relative z-[10000] max-h-96 min-w-32 overflow-hidden rounded-md border bg-card text-card-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:i,...l,children:[(0,r.jsx)(p,{}),(0,r.jsx)(s.l_,{className:(0,o.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(g,{})]})})});f.displayName=s.VY.displayName;let h=i.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(s.__,{ref:t,className:(0,o.cn)("px-2 py-1.5 text-sm font-medium",n),...a})});h.displayName=s.__.displayName;let x=i.forwardRef((e,t)=>{let{className:n,children:i,...l}=e;return(0,r.jsxs)(s.ck,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",n),...l,children:[(0,r.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(s.wU,{children:(0,r.jsx)(a.nQG,{className:"h-4 w-4"})})}),(0,r.jsx)(s.eT,{children:i})]})});x.displayName=s.ck.displayName,i.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(s.Z0,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",n),...a})}).displayName=s.Z0.displayName},85365:function(e,t,n){n.d(t,{Separator:function(){return l}});var r=n(52155),a=n(26074),s=n(98244),i=n(4578);let l=s.forwardRef((e,t)=>{let{className:n,orientation:s="horizontal",decorative:l=!0,...o}=e;return(0,r.jsx)(a.f,{ref:t,decorative:l,orientation:s,className:(0,i.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",n),...o})});l.displayName=a.f.displayName},94446:function(e,t,n){n.d(t,{RM:function(){return o},SC:function(){return c},iA:function(){return i},pj:function(){return u},ss:function(){return d},xD:function(){return l}});var r=n(52155),a=n(98244),s=n(4578);let i=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:(0,s.cn)("w-full caption-bottom text-sm",n),...a})})});i.displayName="Table";let l=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("thead",{ref:t,className:(0,s.cn)("[&_tr]:border-b",n),...a})});l.displayName="TableHeader";let o=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,s.cn)("[&_tr:last-child]:border-0",n),...a})});o.displayName="TableBody",a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,s.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",n),...a})}).displayName="TableFooter";let c=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("tr",{ref:t,className:(0,s.cn)("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",n),...a})});c.displayName="TableRow";let d=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("th",{ref:t,className:(0,s.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",n),...a})});d.displayName="TableHead";let u=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("td",{ref:t,className:(0,s.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",n),...a})});u.displayName="TableCell",a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("caption",{ref:t,className:(0,s.cn)("mt-4 text-sm text-muted-foreground",n),...a})}).displayName="TableCaption"},52465:function(e,t,n){n.d(t,{g:function(){return i}});var r=n(52155),a=n(98244),s=n(4578);let i=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)("textarea",{className:(0,s.cn)("flex w-full rounded-md bg-muted px-2 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...a})});i.displayName="Textarea"},17138:function(e,t,n){n.d(t,{e:function(){return s}});var r=n(84864);n(28351);var a=(0,n(42629).$)("da2287705922bbaa0f34883f5fb3e5ba79e3e1b9");async function s(e,t,n){try{let s=await a(e);if(!s){r.logging.debug("skipping_reporting_error",{error:e,err_message:e.message});return}let i=s.error_type;await n.post("/projects/".concat(t,"/report_error"),{message:null==s?void 0:s.message,error_type:i,meta_data:s})}catch(e){r.logging.error("failed_to_report_intercepted_error",{error:e})}}},37355:function(e,t,n){n.d(t,{F:function(){return s}});var r=n(98244),a=n(30646);let s=()=>({upload:(0,r.useCallback)(async e=>{let{fileName:t,file:n,options:r,continueOnError:s=!0}=e;return(0,a.cT)(t,n,r,s)},[]),download:(0,r.useCallback)(async e=>(0,a.Sv)(e),[])})},77162:function(e,t,n){n.d(t,{D:function(){return s},v:function(){return a}});var r=n(99526);let a=()=>{let e=(0,r.useParams)().project_id;return e&&"string"==typeof e?e:null},s=()=>{let e=a();if(!e)throw Error("Project ID is required and should always be set here");return e}},88021:function(e,t,n){n.d(t,{Ef:function(){return u},YP:function(){return c},hb:function(){return m},i6:function(){return d}});var r=n(98244),a=n(12703),s=n(25243),i=n(37156),l=n(84864),o=n(92104);let c="supabaseOAuthNonce",d="supabaseOAuthCodeVerifier",u=s.Ry({workspaceId:s.Z_(),userId:s.Z_().optional(),nonce:s.Z_()}),m=e=>{let[t,n]=(0,r.useState)(!1),{userData:s}=(0,i.SE)();return{handleConnect:(0,r.useCallback)(async t=>{n(!0);try{let r=window.location.origin,i=crypto.randomUUID();try{localStorage.setItem(c,i)}catch(e){l.logging.error("Error storing nonce in localStorage:",{error:e}),a.Am.error("Failed to initiate Supabase OAuth flow",{description:"Try clearing browser local storage and try again."}),n(!1);return}let u=btoa(JSON.stringify({workspaceId:e,userId:null==s?void 0:s.id,nonce:i})),m=o.env.NEXT_PUBLIC_SUPABASE_OAUTH_CLIENT_ID||"dbd565fc-4637-4cb6-ab68-0af4b5708417",g=function(){let e=new Uint8Array(32);return crypto.getRandomValues(e),btoa(String.fromCharCode.apply(null,Array.from(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}(),f=await p(g);localStorage.setItem(d,g);let h=new URL("https://api.supabase.com/v1/oauth/authorize");h.searchParams.set("response_type","code"),h.searchParams.set("client_id",m),h.searchParams.set("redirect_uri","".concat(r,"/supabase/callback")),h.searchParams.set("state",u),h.searchParams.set("code_challenge",f),h.searchParams.set("code_challenge_method","S256"),(null==t?void 0:t.supabaseOrgId)&&h.searchParams.set("organization_slug",encodeURIComponent(t.supabaseOrgId));let x=window.open(h.toString(),"_blank","width=600,height=700,left=100,top=100");x?x.focus():window.location.href=h.toString()}catch(e){l.logging.error("Error initiating Supabase connection:",{error:e}),a.Am.error("Connection Error",{description:"An error occurred while connecting to Supabase. Please try again."})}finally{n(!1)}},[e,null==s?void 0:s.id]),isConnecting:t}};async function p(e){let t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t);return btoa(String.fromCharCode.apply(null,Array.from(new Uint8Array(n)))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}},29895:function(e,t,n){n.d(t,{I:function(){return g},S:function(){return m}});var r=n(68820),a=n(29605),s=n(98244),i=n(12703),l=n(25243),o=n(94671),c=n(32282),d=n(33877),u=n(21517);let m=e=>{let{workspaceId:t}=e,n=(0,d.MD)()?(0,u.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.id}):void 0,{data:a,isLoading:s}=(0,r.a)({queryKey:c.E.supabaseOrganizations(t,n),queryFn:async()=>{let e=(0,o.SJ)();return await e.get(n?"/projects/".concat(n,"/workspace/supabase-organizations"):"/workspaces/".concat(t,"/supabase-organizations"))},enabled:!!t}),i=!a||0===a.length;return{supabaseOrganizations:a,isLoading:s,noOrganizations:i}},p=l.Ry({type:l.i0("supabaseAuth"),success:l.O7(),error:l.Z_().optional()}),g=e=>{let{workspaceId:t,onConnectSuccess:n}=e,r=(0,a.NL)(),l=(0,d.MD)()?(0,u.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.id}):void 0;(0,s.useEffect)(()=>{let e=async e=>{if(e.origin!==window.location.origin)return;let a=p.safeParse(e.data);a.success&&(a.data.success?(i.Am.success("Connection Successful",{description:"Your Supabase organization has been linked to your workspace. Select a project to finish the setup."}),await r.invalidateQueries({queryKey:c.E.supabaseOrganizations(t,l)}),null==n||n()):i.Am.error("Connection Failed",{description:a.data.error||"Failed to connect to Supabase. Please try again."}))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[r,t,n])}},75748:function(e,t,n){n.d(t,{t:function(){return u}});var r=n(75970),a=n(37156),s=n(82259),i=n(84516),l=n(21517),o=n(33877),c=n(65323),d=n(98244);let u=()=>{let e=(0,l.iZ)(e=>e.project),t=(0,o.hO)(e=>e.projectWorkspace),{authUser:n,isAuthenticated:u}=(0,r.Eu)(),{userData:m}=(0,a.SE)(),p=(0,i.c)(e=>e.accessLevel),g=(0,o.hO)(e=>e.membership),f=(0,o.hO)(e=>e.isLoading),h=(0,s.Q)(e=>e.workspaces).some(t=>t.id===(null==e?void 0:e.workspace_id)),x=t&&t.owner_id===(null==n?void 0:n.uid)||(null==g?void 0:g.role)==="owner",v=(null==g?void 0:g.role)==="admin"||x,b=(null==e?void 0:e.user_id)&&(null==e?void 0:e.user_id)===(null==n?void 0:n.uid)||(null==m?void 0:m.is_admin)||(null==e?void 0:e.user_id)==="claimable"||p===c.u.ADMIN||(null==g?void 0:g.role)==="admin"||x,_=(0,d.useMemo)(()=>p===c.u.WRITE||(null==g?void 0:g.role)==="member"||b,[p,null==g?void 0:g.role,b]),y=e&&n&&e.user_id===n.uid,j=p===c.u.READ||(null==g?void 0:g.role)==="member"||_||(null==e?void 0:e.visibility)==="public";return{isProjectAdmin:b,canEdit:_,isProjectOwner:y,isWorkspaceOwner:x,isLoading:u&&!n||!e||f&&h,isWorkspaceMember:!!g,isWorkspaceAdmin:v,canRead:j}}},30646:function(e,t,n){n.d(t,{Sv:function(){return i},_c:function(){return l},cT:function(){return s}});var r=n(94671),a=n(84864);let s=async function(e,t,s){var i,l;let o=!(arguments.length>3)||void 0===arguments[3]||arguments[3],c=null!==(i=null==s?void 0:s.maxFileSize)&&void 0!==i?i:3145728,d=null!==(l=null==s?void 0:s.maxDimension)&&void 0!==l?l:2e3,u=t;if(t.type.startsWith("image/")){let e=new Image;if(e.src=URL.createObjectURL(t),await new Promise(t=>e.onload=t),t.size>c||Math.max(e.width,e.height)>d)try{let{default:e}=await n.e(3109).then(n.bind(n,53109));u=await e(t,{maxSizeMB:c/1024/1024,maxWidthOrHeight:Math.min(d,1920),useWebWorker:!0})}catch(e){if(a.logging.error("Error compressing image:",{error:e}),!o)throw e}}let m={file_name:e,content_type:u.type,status:"uploading"},p=await (0,r.SJ)().post("/files/generate-upload-url",m),g=await fetch(p.url,{method:"PUT",body:u,headers:{"Content-Type":u.type}});if(!g.ok){let t=Error("Upload failed with status ".concat(g.status));if(a.logging.error("File upload failed:",{fileName:e,status:g.status}),!o)throw t}},i=async e=>(0,r.SJ)().post("/files/generate-download-url",e),l=async e=>(0,r.SJ)().post("/files/generate-public-url",e)},10683:function(e,t,n){n.d(t,{qG:function(){return _},Eh:function(){return j},WR:function(){return y}});var r=n(52155),a=n(98244),s=n(67801),i=n(52532),l=n(12703),o=n(75970),c=n(37355);let d=async(e,t)=>{let n=await fetch(e),r=await n.blob();return new File([r],t,{type:r.type})},u=e=>{let{upload:t}=(0,c.F)(),{isAuthenticated:n}=(0,o.Eu)(),r=e(e=>e.setImages),s=(0,a.useCallback)(async e=>{if(!n)return;let a=e.filter(e=>!e.uploaded&&!e.uploading);if(0===a.length)return;r(e=>e.map(e=>a.some(t=>t.id===e.id)?{...e,uploading:!0}:e));let s=a.map(async e=>{let n=await d(e.url,e.name);return await t({fileName:e.id,file:n,continueOnError:!0}),e.id}),i=new Set((await Promise.allSettled(s)).filter(e=>"fulfilled"===e.status).map(e=>e.value)),o=new Set(a.filter(e=>!i.has(e.id)).map(e=>e.id));o.size>0&&l.Am.error("Image upload failed",{description:"Failed to upload ".concat(o.size," file").concat(o.size>1?"s":"",". Removing failed uploads.")}),r(e=>e.filter(e=>!o.has(e.id)).map(e=>a.some(t=>t.id===e.id)?{...e,uploading:!1,uploaded:i.has(e.id)}:e))},[t,r,n]);return(0,a.useEffect)(()=>{if(n){let t=e.getState().images;t.filter(e=>!e.uploaded&&!e.uploading).length>0&&s(t)}},[n,s,e]),{uploadImages:s}},m={message:"",images:[],imagesAddedViaDropdown:!1,suggestionLabel:void 0,wasCleared:!1},p=e=>({id:e.id,url:e.url,name:e.name,uploaded:e.uploaded}),g=e=>({id:e.id,url:e.url,name:e.name,uploading:!1,uploaded:e.uploaded}),f=async e=>{try{return(await fetch(e)).ok}catch(e){return!1}},h=(e,t)=>{let n=e(e=>e.setMessage),r=e(e=>e.setSuggestionLabel),s=e(e=>e.setImages),l=e(e=>e.setImagesAddedViaDropdown),{uploadImages:o}=u(e),c=(0,a.useRef)(!1),[d,h]=(0,i.Z)("editor-store-".concat(t),{defaultValue:m,storageSync:!1});(0,a.useEffect)(()=>{h(e=>{if(!e.wasCleared){let{message:t,images:a,imagesAddedViaDropdown:i,suggestionLabel:o}=e;Promise.all(a.map(async e=>e.url.startsWith("blob:")?await f(e.url)?e:null:e)).then(e=>{let a=e.filter(e=>null!==e).map(g);n(t),r(o),s(a),l(i)})}return e})},[t,s,l,n,r,h]);let x=(0,a.useCallback)(e=>{h(t=>{if(c.current)return c.current=!1,t;let n={message:e.message,images:e.images.map(p),imagesAddedViaDropdown:e.imagesAddedViaDropdown,suggestionLabel:e.suggestionLabel,wasCleared:!1};return o(e.images),n})},[h,o]);return(0,a.useEffect)(()=>e.subscribe(x),[e,x]),{clearEditorState:(0,a.useCallback)(()=>{c.current=!0,h(e=>({...e,wasCleared:!0})),e.getState().clearEditorState()},[h,e]),restoreEditorState:(0,a.useCallback)(()=>{h(e=>{if(e.wasCleared){let{message:t,images:a,imagesAddedViaDropdown:i,suggestionLabel:o}=e,c=a.map(g);return n(t),r(o),s(c),l(i),{...e,wasCleared:!1}}return e})},[h,n,r,s,l]),setStorageData:h}},x={message:"",images:[],imagesAddedViaDropdown:!1,suggestionLabel:void 0},v=()=>(0,s.Ue)(e=>({...x,setMessage:t=>{e({message:t,suggestionLabel:void 0})},setSuggestionLabel:t=>{e({suggestionLabel:t})},setImages:t=>{Array.isArray(t)?0===t.length?e({images:t,imagesAddedViaDropdown:!1}):e({images:t}):e(e=>{let n=t(e.images);return 0===n.length?{images:n,imagesAddedViaDropdown:!1}:{images:n}})},setImagesAddedViaDropdown:t=>{e({imagesAddedViaDropdown:t})},clearEditorState:()=>{e(x)}})),b=(0,a.createContext)(null),_=e=>{let{children:t,localStorageKey:n}=e,s=(0,a.useRef)(v()),{clearEditorState:i,restoreEditorState:l,setStorageData:o}=h(s.current,n),c=(0,a.useMemo)(()=>({store:s.current,clearEditorState:i,restoreEditorState:l,setStorageData:o}),[i,l,o]);return(0,r.jsx)(b.Provider,{value:c,children:t})};function y(){let e=(0,a.useContext)(b);if(!e)throw Error("useEditorStore must be used within an EditorStoreProvider");return e}function j(e){let{store:t}=y();return t(e)}},81121:function(e,t,n){n.d(t,{m:function(){return g},D:function(){return f}});var r=n(52155),a=n(98244),s=n(67801),i=n(17138),l=n(77162),o=n(84864),c=n(25243);let d=c.Ry({message:c.Z_().min(1),stack:c.Z_().optional(),filename:c.Z_().optional(),lineno:c.Rx().optional(),colno:c.Rx().optional(),blankScreen:c.O7().optional()});var u=n(94671);let m=()=>(0,s.Ue)(()=>({runtimeErrors:[],latestBuildTimestamp:0})),p=(0,a.createContext)({store:m(),clearDiagnostics:()=>{},clearBlankScreenErrors:()=>{},updateLatestBuildTimestamp:()=>{},addRuntimeError:()=>{throw Error("ProjectDiagnostics must be used within a ProjectDiagnosticsProvider")}}),g=e=>{let{children:t}=e,n=(0,l.v)();if(!n)throw Error("Project ID is required and should always be set here");let s=(0,a.useRef)();s.current||(s.current=m());let c=(0,u.SJ)(),g={store:s.current,clearDiagnostics:()=>{s.current.setState({runtimeErrors:[]})},addRuntimeError:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"RUNTIME_ERROR",r=function(e){let t=d.safeParse(e);return t.success?(t.data.stack||o.logging.warn("diagnostics.runtime_error.stack_missing",{parse_error:t.error,error_data:e}),t.data.filename||o.logging.warn("diagnostics.runtime_error.filename_missing",{parse_error:t.error,error_data:e}),t.data):(o.logging.error("diagnostics.runtime_error.invalid",{parse_error:t.error,error_data:e}),null)}(e);if(!r)return;r.blankScreen&&(0,i.e)({...r,error_type:"runtime"},n,c).catch(e=>{o.logging.error("error_reporting_runtime_error",{error:e})});let a=s.current,l=function(e,t){let n={timestamp:Date.now(),error_type:e,message:t.message||"Unknown error",filename:t.filename||"Unknown file",lineno:t.lineno||0,colno:t.colno||0,stack:t.stack||"Unavailable",has_blank_screen:(null==t?void 0:t.blankScreen)||!1};return n.message.length>1e4&&(n.message=n.message.slice(0,1e4)),n.stack.length>1e4&&(n.stack=n.stack.slice(0,1e4)),n}(t,r);a.setState(e=>{let t=[...e.runtimeErrors],n=t.findIndex(e=>0==e.lineno?e.message===l.message:e.filename===l.filename&&e.colno===l.colno&&e.lineno===l.lineno);-1!==n&&t.splice(n,1),t.push(l);let r=t.reduce((e,t)=>e+h(t),0);for(;r>1e5||t.length>50;){let e=t.shift();if(!e)break;r-=h(e)}return{runtimeErrors:t}})},updateLatestBuildTimestamp:e=>{let t=s.current;e>t.getState().latestBuildTimestamp&&t.setState({latestBuildTimestamp:e})},clearBlankScreenErrors:()=>{let e=s.current;e.setState({runtimeErrors:e.getState().runtimeErrors.filter(e=>!e.has_blank_screen)})}};return(0,r.jsx)(p.Provider,{value:g,children:t})};function f(){return(0,a.useContext)(p)}let h=e=>{var t,n,r,a,s,i;return((null===(t=e.error_type)||void 0===t?void 0:t.length)||0)+((null===(n=e.message)||void 0===n?void 0:n.length)||0)+((null===(r=e.filename)||void 0===r?void 0:r.length)||0)+((null===(a=e.lineno)||void 0===a?void 0:a.toString().length)||0)+((null===(s=e.colno)||void 0===s?void 0:s.toString().length)||0)+((null===(i=e.stack)||void 0===i?void 0:i.length)||0)}},46724:function(e,t,n){n.d(t,{V:function(){return i}});var r=n(36424),a=n(94671),s=n(32282);let i={repoAccessibility:e=>{let{projectId:t,userProjectPermissions:n}=e;return(0,r.C)({queryKey:s.pL.repoAccessibility(t),queryFn:async()=>(0,a.SJ)().get("/projects/".concat(t,"/repo-accessibility")),enabled:n.edit&&!!t,retry:!1})},installations:e=>{let{enabled:t}=e;return(0,r.C)({queryKey:s.pL.installations(),queryFn:()=>(0,a.SJ)().get("/users/github-installations"),enabled:t,retry:!1})}}},93846:function(e,t,n){n.d(t,{W:function(){return o},b:function(){return c}});var r=n(36424),a=n(94671),s=n(84864),i=n(65323),l=n(32282);let o={sourceCode:e=>{let{projectId:t,enabled:n}=e;return(0,r.C)({queryKey:l.iZ.sourceCode(t),queryFn:async()=>(0,a.SJ)().get("/projects/".concat(t,"/source-code")),enabled:n})},feedbackStatus:e=>{let{projectId:t}=e;return(0,r.C)({queryKey:l.iZ.feedbackStatus(t),queryFn:async()=>(0,a.SJ)().get("/user/feedback-status")})},presence:e=>{let{projectId:t,authUser:n,enablePresence:s}=e;return(0,r.C)({queryKey:l.iZ.presence(t),queryFn:()=>n?(0,a.SJ)().post("/projects/".concat(t,"/presence")):Promise.resolve(null),enabled:!!n&&!!t&&s,refetchInterval:6e4,refetchOnWindowFocus:!0,refetchOnMount:!0})},magicCode:e=>{let{projectId:t}=e;return(0,r.C)({queryKey:l.iZ.secretLinkId(t),queryFn:async()=>{let e=(0,a.SJ)(),n=(await e.get("/projects/".concat(t,"/magic-codes"))).magic_codes;return n&&0!==n.length?{id:n[0].id}:{id:null}}})},sharedWithMe:()=>(0,r.C)({queryKey:l.iZ.sharedWithMe(),queryFn:async()=>(0,a.SJ)().get("/user/projects/shared")}),collaborators:e=>{let{projectId:t,projectOwnerId:n}=e,i=(0,a.SJ)();return(0,r.C)({queryKey:l.iZ.collaborators(null!=t?t:""),enabled:!!t&&!!n,refetchInterval:6e4,queryFn:async()=>{try{var e;let r=null!==(e=await i.get("/projects/".concat(t,"/collaborators")))&&void 0!==e?e:[];return c({collaborators:r,projectOwnerId:n})}catch(e){return s.logging.error("Failed to fetch collaborators",{error:e}),[]}}})},communityProjects:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"recent",n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return(0,r.C)({queryKey:l.iZ.communityProjects(e,t,n,s),queryFn:async()=>(0,a.Tb)().get("".concat("/projects/community","?limit=").concat(e,"&order_by=").concat(t).concat(n&&"all"!==n?"&category=".concat(n):"").concat(s?"&start_after=".concat(s):"").concat("trending"===t?"&feature_source=trending":""))})},securityWarnings:e=>{let{projectId:t,enabled:n}=e;return(0,r.C)({queryKey:l.iZ.securityWarnings(t),queryFn:async()=>(0,a.SJ)().get("/projects/".concat(t,"/security-warnings")),enabled:n})},analytics:e=>{let{projectId:t,timePeriod:n}=e;return(0,r.C)({queryKey:l.iZ.analytics(t,n),queryFn:async()=>(0,a.SJ)().get("/projects/".concat(t,"/analytics"),{params:{startDate:n.startDate,endDate:n.endDate,granularity:n.granularity}})})},analyticsTrend:e=>{let{projectId:t}=e;return(0,r.C)({queryKey:l.iZ.analyticsTrend(t),queryFn:async()=>(0,a.SJ)().get("/projects/".concat(t,"/analytics/trend")),refetchInterval:6e4})},projectDetails:e=>{let{projectId:t}=e;return(0,r.C)({queryKey:l.iZ.projectDetails(t),queryFn:async()=>(0,a.SJ)().get("/projects/".concat(t,"/details"))})}};function c(e){let{collaborators:t,projectOwnerId:n}=e;return[...t].sort((e,t)=>{let r=n&&e.id===n,a=n&&t.id===n;return r&&!a?-1:!r&&a?1:e.access_level===i.u.ADMIN&&t.access_level!==i.u.ADMIN?-1:e.access_level!==i.u.ADMIN&&t.access_level===i.u.ADMIN?1:(e.email||"").localeCompare(t.email||"")})}},25437:function(e,t,n){n.d(t,{V:function(){return o}});var r=n(36424),a=n(75040),s=n(94671),i=n(84864),l=n(32282);let o={workspace:e=>{let{workspaceId:t,userData:n}=e;return(0,r.C)({queryKey:l.TZ.workspace(t),queryFn:async()=>{let e=(0,s.SJ)();return(await e.get("/user/workspaces/".concat(t))).workspace},enabled:!!n&&!!t})},experimentalFeatures:e=>{let{user:t}=e;return(0,r.C)({queryKey:l.TZ.experimentalFeatures(),enabled:!!t&&!!t.idToken&&(0,a.K)(t),refetchOnWindowFocus:!1,queryFn:async()=>{let e=(0,s.SJ)();try{return await e.get("/users/".concat(null==t?void 0:t.uid,"/experimental-features"))}catch(e){return i.logging.error("Failed to fetch experimental features",{error:e}),null}}})},contributions:e=>{let{userData:t}=e;return(0,r.C)({queryKey:l.TZ.contributions(null==t?void 0:t.id),queryFn:async()=>(null==t?void 0:t.id)?(0,s.SJ)().get("/users/".concat(t.id,"/contributions")):{},enabled:!!(null==t?void 0:t.username)})},publicProfile:e=>{let{username:t}=e;return(0,r.C)({queryKey:l.TZ.profile(t),queryFn:()=>(0,s.Tb)().get("/profile/".concat(t)),enabled:!!t,retry:!1})},studentDomains:()=>(0,r.C)({queryKey:l.TZ.studentDomains(),queryFn:async()=>(0,s.SJ)().get("/user/student/domains")})}},65323:function(e,t,n){var r,a;n.d(t,{u:function(){return r}}),(a=r||(r={})).ADMIN="admin",a.WRITE="write",a.READ="read",a.NONE="none"},92044:function(e,t,n){var r,a,s,i;n.d(t,{I:function(){return r}}),(s=(a=r||(r={})).type||(a.type={})).AI_UPDATE="ai_update",s.REVERT="revert",s.INITIAL="initial",s.DEVELOPER_UPDATE="developer_update",s.MANUAL_UPDATE="manual_update",(i=a.feedback||(a.feedback={})).POSITIVE="positive",i.NEGATIVE="negative",i.NO_FEEDBACK="no_feedback"},94127:function(e,t,n){var r,a;n.d(t,{N:function(){return r}}),(a=r||(r={})).IMMEDIATE_RUNTIME="immediate_runtime",a.RUNTIME="runtime",a.BUILD="build",a.DEPLOY_SUPABASE_FUNCTIONS="deploy_supabase_functions",a.HTTP_CLIENT_ERROR="http_client_error",a.CORS_ERROR="cors_error",a.HTTP_SERVER_ERROR="http_server_error",a.NO_CODE_CHANGE="no_code_change",a.CODE_DIFF="code_diff",a.FILE_EDITED_WITHOUT_PERMISSION="file_edited_without_permission",a.EXCLUDED_FILE_EDITED="excluded_file_edited",a.SUPABASE_EDGE_FUNCTION_ERROR="supabase_edge_function_error",a.DEPENDENCY_INSTALL="dependency_install",a.SUPABASE_SQL_ERROR="supabase_sql_error",a.SEARCH_REPLACE_FAILED="search_replace_failed",a.SEARCH_REPLACE_MISSING_FILE="search_replace_missing_file",a.CHANGED_MISSING_FILE="changed_missing_file",a.RENAME_FAILED="rename_failed",a.DELETION_FAILED="deletion_failed"},33619:function(e,t,n){var r,a,s;n.d(t,{r:function(){return r}}),(s=(a=r||(r={})).role||(a.role={})).AI="ai",s.USER="user",(a.tag||(a.tag={})).INSTANT_MODE_MESSAGE="instant-mode-message"},26696:function(e,t,n){var r,a;n.d(t,{S:function(){return r}}),(a=r||(r={})).AGENT="agent",a.INSTANT="instant"},60446:function(e,t,n){var r,a;n.d(t,{k:function(){return r}}),(a=r||(r={})).ACTIVE_HEALTHY="ACTIVE_HEALTHY",a.ACTIVE_UNHEALTHY="ACTIVE_UNHEALTHY",a.COMING_UP="COMING_UP",a.GOING_DOWN="GOING_DOWN",a.INACTIVE="INACTIVE",a.INIT_FAILED="INIT_FAILED",a.REMOVED="REMOVED",a.RESTARTING="RESTARTING",a.UNKNOWN="UNKNOWN",a.UPGRADING="UPGRADING",a.PAUSING="PAUSING",a.RESTORING="RESTORING",a.RESTORE_FAILED="RESTORE_FAILED",a.PAUSE_FAILED="PAUSE_FAILED"},26930:function(e,t,n){var r,a,s;n.d(t,{U:function(){return r}}),(s=(a=r||(r={})).status||(a.status={})).CONNECTED="connected",s.FAILED="failed",s.NEEDS_REFRESH="needs_refresh"},66813:function(e,t,n){n.d(t,{W:function(){return o},p:function(){return s}});var r=n(25243),a=n(94127);let s=r.Ry({frame:r.Z_().optional(),id:r.Z_().optional(),loc:r.Ry({file:r.Z_().optional(),line:r.Rx().optional(),column:r.Rx().optional()}).optional(),message:r.Z_(),plugin:r.Z_().optional(),pluginCode:r.Z_().optional(),stack:r.Z_().optional()}).transform(e=>({...e,error_type:a.N.IMMEDIATE_RUNTIME})),i=r.Ry({body:r.Z_(),message:r.Z_(),status:r.Rx(),statusText:r.Z_().optional(),url:r.Z_()}),l=r.Ry({message:r.Z_(),method:r.Km(["OPTIONS","GET","POST","PUT","DELETE","PATCH"]),origin:r.Z_().optional(),stack:r.Z_().optional(),url:r.Z_()}),o=r.G0([i,l])}}]);